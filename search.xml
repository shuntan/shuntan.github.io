<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Hello World</title>
    <url>/posts/hello-world/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank">GitHub</a>.</p>
<a id="more"></a>
<h2 id="quick-start">Quick Start<a title="#quick-start" href="#quick-start"></a></h2>
<h3 id="create-a-new-post">Create a new post<a title="#create-a-new-post" href="#create-a-new-post"></a></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank">Writing</a></p>
<h3 id="run-server">Run server<a title="#run-server" href="#run-server"></a></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank">Server</a></p>
<h3 id="generate-static-files">Generate static files<a title="#generate-static-files" href="#generate-static-files"></a></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank">Generating</a></p>
<h3 id="deploy-to-remote-sites">Deploy to remote sites<a title="#deploy-to-remote-sites" href="#deploy-to-remote-sites"></a></h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šèµ„è®¯: <a href="https://hexo.io/docs/deployment.html" target="_blank">Deployment</a></p>
]]></content>
      <categories>
        <category>Diary</category>
      </categories>
      <tags>
        <tag>Diary</tag>
      </tags>
  </entry>
  <entry>
    <title>RetroArchä¸Šæ‰‹æ•™ç¨‹</title>
    <url>/posts/RetroArch%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B/</url>
    <content><![CDATA[<h2 id="ç®€ä»‹">ç®€ä»‹<a title="#ç®€ä»‹" href="#ç®€ä»‹"></a></h2>
<blockquote>
<p>RetroArchå¯ä»¥åœ¨Windowsï¼ŒMac OS Xå’ŒLinuxç­‰å¸¸ç”¨å¹³å°ä¸Šè¿è¡Œï¼Œä½†å®ƒå¯ä»¥å•ç‹¬æ”¯æŒå®ƒï¼Œå› æ­¤å¯ä»¥æ”¯æŒæ›´å¤šå¹³å°ã€‚</p>
<p>æˆ‘ä»¬æ”¯æŒç”šè‡³Microsoftå’ŒAppleæœ¬èº«éƒ½ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿï¼Œä¾‹å¦‚PowerPC Macä¸Šçš„macOS Xï¼Œä»¥åŠæ—©äºWindows 95çš„Windows OSä¸Šéƒ½å¯ä»¥ä½¿ç”¨RetroArchã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼ŒRetroArchè¿˜å¯ä»¥åœ¨é€‚ç”¨äºå¹³æ¿ç”µè„‘å’Œæ‰‹æœºçš„iOSå’ŒAndroidä»¥åŠPS2ï¼ŒPS3ï¼ŒPSPï¼ŒPS Vitaï¼ŒWiiï¼ŒWii Uï¼Œ2DSï¼Œ3DSï¼ŒSwitchç­‰æ¸¸æˆæœºä¸Šè¿è¡Œï¼</p>
</blockquote>
<a id="more"></a>
<h2 id="æˆªå›¾">æˆªå›¾<a title="#æˆªå›¾" href="#æˆªå›¾"></a></h2>
<p><img src="/posts/RetroArch%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B/WX20200208-122941@2x.png" alt="WX20200208-122941@2x.png" class="Ï†cx"></p>
<p><img src="/posts/RetroArch%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B/WX20200208-123006@2x.png" alt="WX20200208-123006@2x.png" class="Ï†cx"></p>
<p><img src="/posts/RetroArch%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B/WX20200208-123514@2x.png" alt="WX20200208-123514@2x.png" class="Ï†cx"></p>
<p><img src="/posts/RetroArch%E4%B8%8A%E6%89%8B%E6%95%99%E7%A8%8B/WX20200208-123623@2x.png" alt="WX20200208-123623@2x.png" class="Ï†cx"></p>
<h2 id="ä¸‹è½½">ä¸‹è½½<a title="#ä¸‹è½½" href="#ä¸‹è½½"></a></h2>
<h3 id="æ¨¡æ‹Ÿå™¨ä¸‹è½½">æ¨¡æ‹Ÿå™¨ä¸‹è½½<a title="#æ¨¡æ‹Ÿå™¨ä¸‹è½½" href="#æ¨¡æ‹Ÿå™¨ä¸‹è½½"></a></h3>
<div class="note danger">
            <p><strong>RetroArch</strong></p><p><strong>ä¸‹è½½åœ°å€:</strong>  <a href="https://retroarch.com/?page=platforms" target="_blank">(https://retroarch.com/?page=platforms)</a></p><p>å½“å‰çš„ç¨³å®šç‰ˆæœ¬æ˜¯ï¼š1.8.4</p><div class="text-center"><a class="btn" href="http://buildbot.libretro.com/stable/1.8.4/windows/x86_64/RetroArch-x64-setup.exe" target="_blank" rel="noopener"><i class="fa fa-exe"></i>Windows</a> <a class="btn" href="http://buildbot.libretro.com/stable/1.8.4/apple/osx/x86_64/RetroArch.dmg" target="_blank" rel="noopener"><i class="fa fa-dmg"></i>MacOS</a></div>
          </div>
<h3 id="æ¸¸æˆä¸‹è½½åœ°å€">æ¸¸æˆä¸‹è½½åœ°å€<a title="#æ¸¸æˆä¸‹è½½åœ°å€" href="#æ¸¸æˆä¸‹è½½åœ°å€"></a></h3>
<p><strong>ç™¾åº¦äº‘ï¼š</strong>(<a href="https://pan.baidu.com/s/1WCy6pePZgu86YbCaLPuwmw" target="_blank" rel="noopener">https://pan.baidu.com/s/1WCy6pePZgu86YbCaLPuwmw</a>)</p>
<p>åŒ…å«ä»¥ä¸‹æ¸¸æˆï¼š</p>
<div class="Ï†cy"><div class="Ï†da"><table><thead>
<tr>
<th>â€“è‹±æ–‡â€“</th>
<th>â€“ä¸­æ–‡â€“</th>
</tr>
</thead>
<tbody>
<tr>
<td>SFC ROMï¼ˆä¸­æ–‡ï¼‰</td>
<td>FC ROMï¼ˆè‹±æ–‡ï¼‰</td>
</tr>
<tr>
<td>PEC ROM ï¼ˆä¸­æ–‡ï¼‰</td>
<td>MAME ï¼ˆè‹±æ–‡ï¼‰</td>
</tr>
<tr>
<td>CPS1 ï¼ŒCPS2ï¼ŒCPS3 ROMï¼ˆä¸­æ–‡ï¼‰</td>
<td>NeoGeo ï¼ˆè‹±æ–‡ï¼‰</td>
</tr>
<tr>
<td>GBA ROMï¼ˆä¸­æ–‡ï¼‰</td>
<td>MD ROMï¼ˆè‹±æ–‡ï¼‰</td>
</tr>
</tbody>
</table></div></div><h2 id="æ¨¡æ‹Ÿå™¨é…ç½®">æ¨¡æ‹Ÿå™¨é…ç½®<a title="#æ¨¡æ‹Ÿå™¨é…ç½®" href="#æ¨¡æ‹Ÿå™¨é…ç½®"></a></h2>
<h3 id="ä¸­æ–‡è®¾ç½®">ä¸­æ–‡è®¾ç½®<a title="#ä¸­æ–‡è®¾ç½®" href="#ä¸­æ–‡è®¾ç½®"></a></h3>
<blockquote>
<p>ç”±äºæœ¬è½¯ä»¶æœªå¯¹ä¸­æ–‡é…ç½®ä¼˜åŒ–ï¼Œè¯­è¨€é€‰æ‹©â€œä¸­æ–‡â€æˆ–â€œç¹ä½“ä¸­æ–‡â€æ—¶ä¼šå‡ºç°<span class="label warn">???</span>çš„æƒ…å†µéœ€è¦è‡ªå·±ä¸‹è½½ä¸­æ–‡å­—ä½“ï¼Œèœå•æ ·å¼ä¸€èˆ¬ä¸ºxmbï¼Œæ ·å¼çš®è‚¤ä¸€èˆ¬ä¸ºmonochromeã€‚å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹æ›¿æ¢ä¸ºè‡ªå·±å–œæ¬¢çš„æ ·å¼å’Œçš®è‚¤ã€‚</p>
</blockquote>
<div class="note success">
            <p><strong>è®¾ç½®ä¸­æ–‡æ–¹æ³•</strong></p><ol><li>å°†ä¸‹è½½æ¥çš„&quot;å¾®è½¯é›…é»‘&quot;å­—ä½“æ‹·å‡ºæ¥å¹¶æ”¹åä¸º<span class="label primary">font.ttf</span>ï¼Œæ‹·åˆ°å†…å­˜å¡<span class="label success">:\RetroArch\assets\xmb\monochrome&lt;/span&gt;ç›®å½•ä¸‹æ›¿æ¢</li><li>ä¸»èœå• <span class="label success">Settings --&gt; Onscreen Display --&gt; Onscreen Notifications --&gt; Notification Font</span></li><li><span class="label success">User Interface --&gt; Appearance --&gt; Menu Font</span>ï¼Œé€‰æ‹©åˆšæ‰æ‹·çš„font.ttf</li><li>ä¸»èœå• <span class="label success">Settings --&gt; User --&gt; Language</span> é€‰æ‹©ç®€ä½“ä¸­æ–‡</li></ol>
          </div>
<div class="note success">
            <p><strong>XMBç•Œé¢å¯åŠ¨æ–¹æ³•</strong><br>è®¾ç½®é‡Œé¢-èœå•é©±åŠ¨-é€‰<span class="label success">xmb</span>ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹<span class="label success">User Interface --&gt; Appearance --&gt; Menu Icon Theme</span>åˆ‡æ¢çš®è‚¤ä¸»é¢˜</p>
          </div>
<h3 id="æ ¸å¿ƒè®¾ç½®">æ ¸å¿ƒè®¾ç½®<a title="#æ ¸å¿ƒè®¾ç½®" href="#æ ¸å¿ƒè®¾ç½®"></a></h3>
<blockquote>
<p>ç”±äºåˆšåˆšä¸‹è½½çš„æ¨¡æ‹Ÿå™¨æœ¬ä½“æ˜¯ä¸å¸¦æ ¸å¿ƒçš„ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½æ ¸å¿ƒæ‰èƒ½åŠ è½½å’Œæ¨¡æ‹Ÿå¯¹åº”çš„æ¸¸æˆ</p>
</blockquote>
<div class="note success">
            <p><strong>æ ¸å¿ƒå®‰è£…</strong></p><p>æ ¸å¿ƒå®‰è£…æ–¹æ³•ç›®å‰æœ‰ä¸¤ç§ï¼š</p><ol><li><p>å¤–éƒ¨ä¸‹è½½å¯¼å…¥ï¼š</p><p><strong>Windows:</strong> (<a href="http://buildbot.libretro.com/nightly/windows/x86_64/latest/" target="_blank" rel="noopener">http://buildbot.libretro.com/nightly/windows/x86_64/latest/</a>)</p><p><strong>MacOS:</strong> (<a href="http://buildbot.libretro.com/nightly/apple/osx/x86/latest" target="_blank" rel="noopener">http://buildbot.libretro.com/nightly/apple/osx/x86/latest</a>)</p><p>ä¸‹è½½å¥½å¯¹åº”çš„æ ¸å¿ƒä¹‹åå¯¼å…¥<span class="label default">cores</span>æ–‡ä»¶å¤¹ä¸­</p></li><li><p>å†…éƒ¨ä¸‹è½½å®‰è£…ï¼š</p><p>å¯ä»¥é€šè¿‡è®¾ç½®è·¯å¾„<span class="label success">Main Menu -&gt; Load Core -&gt;Download a Core</span>æ¥ä¸‹è½½æƒ³è¦çš„æ ¸å¿ƒã€‚</p></li></ol>
          </div>
<h3 id="æ¸¸æˆæ‰«æ">æ¸¸æˆæ‰«æ<a title="#æ¸¸æˆæ‰«æ" href="#æ¸¸æˆæ‰«æ"></a></h3>
<div class="note success">
            <p><strong>å¯¼å…¥æ¸¸æˆæ–‡ä»¶å¤¹</strong></p><p>é€šè¿‡è®¾ç½®<span class="label success">Import content -&gt; Scan Directory</span>æ¥è®¾ç½®ä½ è¦æ‰«æçš„æ¸¸æˆè·¯å¾„ï¼Œèƒ½å¤Ÿé€šè¿‡æ ¸å¿ƒè¯†åˆ«å‡ºæ¥çš„æ¸¸æˆä¼šè¢«è‡ªåŠ¨åŠ å…¥æ’­æ”¾åˆ—è¡¨ä¸­ï¼Œæˆ–è€…é€šè¿‡<span class="label success">Import content -&gt; Manual Scan</span>æ¥ä¸»åŠ¨å®šåˆ¶è¯†åˆ«è§„åˆ™ï¼Œæ‰«ææˆåŠŸåç”Ÿæˆplaylistså’Œdatabaseåç§°</p>
          </div>
<h3 id="æ¸¸æˆå°é¢">æ¸¸æˆå°é¢<a title="#æ¸¸æˆå°é¢" href="#æ¸¸æˆå°é¢"></a></h3>
<div class="note success">
            <p><strong>æ¸¸æˆæˆªå›¾é…ç½®</strong></p><p>é¦–å…ˆè¿›å…¥èœå•è®¾ç½®ï¼Œå°†ç¼©ç•¥å›¾é€‰é¡¹è®¾ç½®æˆæˆªå±ï¼Œæ‰¾åˆ°<span class="label success">Settings -&gt; Directory -&gt; Thumbnails</span>æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œå°†ä¸<span class="label danger">Rom</span>åŒåçš„ç•¥ç¼©å›¾æ–‡ä»¶å¤¹å¯¼å…¥å…¶ä¸­ï¼Œä¾‹å¦‚ï¼š<span class="label success">RetroArch\thumbnails\Sega - Dreamcast\Named_Snaps</span>ï¼Œå…¶ä¸­Sega - Dreamcastä¸ºdatabaseåç§°ä¸€èˆ¬ä¹Ÿä¸ºæ ¸å¿ƒåç§°ï¼Œå…¶ä¸­ç•¥ç¼©å›¾æ–‡ä»¶åå’Œæ¸¸æˆæ–‡ä»¶åç›¸åŒä¸”åç¼€æ ¼å¼ä¸º<span class="label primary">.png</span>æ ¼å¼ï¼Œæ ¹æ–‡ä»¶å¤¹åç§°å’Œdatabaseåç§°ä¸€è‡´å³å¯ã€‚</p>
          </div>
]]></content>
      <categories>
        <category>æ¨¡æ‹Ÿå™¨</category>
      </categories>
      <tags>
        <tag>æ¨¡æ‹Ÿå™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§‘å­¦ä¸Šç½‘ï¼šç”¨ VPS æ­å»º shadowsocks æœåŠ¡å™¨</title>
    <url>/posts/shadowsocks/</url>
    <content><![CDATA[<h2 id="shadowsocks-ç®€ä»‹">shadowsocks ç®€ä»‹<a title="#shadowsocks-ç®€ä»‹" href="#shadowsocks-ç®€ä»‹"></a></h2>
<p>shadowsocks æ˜¯ä¸€æ¬¾è‡ªå®šä¹‰åè®®çš„ä»£ç†è½¯ä»¶ï¼Œç”±äºå…¶æµé‡ç‰¹å¾ä¸æ˜æ˜¾ï¼Œï¼ˆç›´åˆ°ä¸ä¹…å‰ï¼‰ä¸€ç›´å¯ä»¥ç¨³å®šæä¾›ä¸Šç½‘ä»£ç†ã€‚</p>
<p>shadowsocks å®¢æˆ·ç«¯ä¼šåœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ª socks5 ä»£ç†ï¼Œé€šè¿‡æ­¤ä»£ç†çš„ç½‘ç»œè®¿é—®è¯·æ±‚ç”±å®¢æˆ·ç«¯å‘é€è‡³æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å‘å‡ºè¯·æ±‚ï¼Œæ”¶åˆ°å“åº”æ•°æ®åå†å‘å›å®¢æˆ·ç«¯ã€‚</p>
<p>å› æ­¤ä½¿ç”¨ shadowsocks éœ€è¦ä¸€å°å¢™å¤–çš„æœåŠ¡å™¨æ¥éƒ¨ç½² shadowsocks æœåŠ¡ç«¯ã€‚</p>
<a id="more"></a>
<h2 id="è´­ä¹°-vps-æœåŠ¡å™¨">è´­ä¹° VPS æœåŠ¡å™¨<a title="#è´­ä¹°-vps-æœåŠ¡å™¨" href="#è´­ä¹°-vps-æœåŠ¡å™¨"></a></h2>
<p>ä¸»æµçš„ VPSï¼ˆè™šæ‹Ÿä¸»æœºï¼‰æœåŠ¡å™¨æä¾›å•†æœ‰ä¸‰å®¶ï¼š</p>
<ul>
<li>linode</li>
<li>digital ocean</li>
<li>bandwagon</li>
</ul>
<p>ä¸‹é¢çš„æ¯”ä¸Šé¢çš„ä¾¿å®œã€‚å¦‚æœåªæ˜¯è‡ªç”¨ï¼Œbandwagon è¶³å¤Ÿã€‚</p>
<p>ä¸€èˆ¬ä½¿ç”¨ paypal ç»‘å®šä¸€ä¸ª visa æˆ– mastercard ä¿¡ç”¨å¡æ¥ä»˜æ¬¾ã€‚æ³¨æ„è¦ç”¨å›½é™… paypal å¸å·ï¼Œå›½å†…çš„æ˜¯ä¸èƒ½ç”¨å¤–å¸ä»˜æ¬¾çš„ã€‚</p>
<p>åœ¨ bandwagon è´­ä¹° VPS ä»¥åä¼šè·å¾—ä¸€ä¸ªä¸»æœºåœ°å€å’Œç”¨äº ssh ç™»å½•çš„ root å¯†ç ã€‚</p>
<h2 id="è¿œç¨‹ç™»é™†-vps">è¿œç¨‹ç™»é™† VPS<a title="#è¿œç¨‹ç™»é™†-vps" href="#è¿œç¨‹ç™»é™†-vps"></a></h2>
<p>Macæˆ– Linux ä¸‹ç›´æ¥åœ¨ç»ˆç«¯ä¸­ssh root@your_vps_ip your_ssh_portå³å¯ã€‚<br>
åœ¨ windows ç³»ç»Ÿä¸‹éœ€è¦ä¸“é—¨çš„å®¢æˆ·ç«¯æ¥ SSH ç™»å½• VPSã€‚åœ¨Â <a href="http://www.netsarang.com/download/down_form.html?code=522&amp;utm_source=textarea.com&amp;utm_medium=textarea.com&amp;utm_campaign=article" target="_blank">xShell å®˜ç½‘</a>Â Â ä¸‹è½½ xShellã€‚</p>
<p>å®¶åº­å’Œå­¦æ ¡ç”¨æˆ·å¯ä»¥å…è´¹è¯•ç”¨ï¼Œä¸‹è½½æ—¶é€‰æ‹© homeÂ andÂ schoolÂ use å³å¯ã€‚éœ€è¦ç”¨é‚®ç®±æ³¨å†Œä¸€ä¸‹ï¼Œä¸‹è½½é“¾æ¥ä¼šå‘é€åˆ°é‚®ç®±ä¸­ã€‚</p>
<p>xShell ä¸­æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œä¼šè¦æ±‚è¾“å…¥ç›®æ ‡ IP åœ°å€å’Œç«¯å£ï¼Œä»¥åŠ root å¯†ç ï¼ŒæŒ‰æç¤ºæ“ä½œå³å¯ã€‚</p>
<h2 id="å®‰è£…-shadowsocks">å®‰è£… shadowsocks<a title="#å®‰è£…-shadowsocks" href="#å®‰è£…-shadowsocks"></a></h2>
<p>æœ€å¥½æ˜¯centos7</p>
<p>1.å®‰è£…pip</p>
<p>ç”±äºå®‰è£…çš„æ˜¯python ç‰ˆæœ¬çš„ shadowsocksï¼Œæ‰€ä»¥é¦–å…ˆå®‰è£…pip</p>
<pre><code>$ curl &quot;https://bootstrap.pypa.io/get-pip.py&quot; -o &quot;get-pip.py&quot;

$ python get-pip.py
</code></pre>
<p>2.å®‰è£…shadowsocks</p>
<pre><code>$ pip install --upgrade pip

$ pip install shadowsocks
</code></pre>
<p>3.åˆ›å»ºé…ç½®æ–‡ä»¶</p>
<pre><code>åˆ›å»ºæ–‡ä»¶æ‰€åœ¨ç›®å½•:/etc
</code></pre>
<p>åˆ›å»ºæ–‡ä»¶å‘½ä»¤</p>
<pre><code>$ vi /etc/shadowsocks.json
</code></pre>
<p>è‹¥è¿›å…¥äº†etcç›®å½•</p>
<pre><code>$ vi shadowsocks.json
</code></pre>
<p>é…ç½®æ–‡ä»¶å†…å®¹ï¼š</p>
<p>å•ç«¯å£ï¼š</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"> <span class="string">"server"</span>:<span class="string">"0.0.0.0"</span>, <span class="comment">--æœåŠ¡å™¨IPï¼Œç›´æ¥ç”¨0.0.0.0ä¹Ÿå¯</span></span><br><span class="line"></span><br><span class="line"> <span class="string">"server_port"</span>:<span class="number">8888</span>, <span class="comment">--ç«¯å£ç«¯å£</span></span><br><span class="line"></span><br><span class="line"> <span class="string">"local_address"</span>: <span class="string">"127.0.0.1"</span>, <span class="comment">--æœ¬åœ°åœ°å€ï¼Œå¯çœç•¥</span></span><br><span class="line"></span><br><span class="line"> <span class="string">"local_port"</span>:<span class="number">1080</span>,<span class="comment">--æœ¬åœ°ç«¯å£ï¼Œå¯çœç•¥</span></span><br><span class="line"></span><br><span class="line"> <span class="string">"password"</span>:<span class="string">"password"</span>,<span class="comment">--å¯†ç </span></span><br><span class="line"></span><br><span class="line"> <span class="string">"timeout"</span>:<span class="number">300</span>, <span class="comment">--è¶…æ—¶æ—¶é—´ï¼Œå¯çœç•¥</span></span><br><span class="line"></span><br><span class="line"> <span class="string">"method"</span>:<span class="string">"aes-256-cfb"</span>, <span class="comment">--åŠ å¯†ç­–ç•¥ï¼Œæœ‰å¤šé‡ç­–ç•¥ï¼Œå…·ä½“è‡ªæŸ¥</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤šç«¯å£ï¼š</p>
<figure class="highlight clojure"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"> <span class="string">"server"</span>:<span class="string">"0.0.0.0"</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"port_password"</span>:&#123;--æ¯ä¸ªç«¯å£å¯¹åº”ä¸€ä¸ªå¯†ç </span><br><span class="line"></span><br><span class="line"> <span class="string">"1111"</span>:<span class="string">"password1"</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"1112"</span>:<span class="string">"password2"</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"1113"</span>:<span class="string">"password3"</span></span><br><span class="line"></span><br><span class="line"> &#125;,</span><br><span class="line"></span><br><span class="line"> <span class="string">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"method"</span>:<span class="string">"aes-256-cfb"</span>,</span><br><span class="line"></span><br><span class="line"> <span class="string">"fast_open"</span><span class="symbol">:false</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.å¯åŠ¨shadowsocks</p>
<p>å¯åŠ¨</p>
<pre><code>ssserver -c /etc/shadowsocks.json -d start
</code></pre>
<p>åœæ­¢</p>
<pre><code>ssserver -c /etc/shadowsocks.json -d stop
</code></pre>
<p>é‡å¯</p>
<pre><code>ssserver -c /etc/shadowsocks.json -d restart
</code></pre>
<p>å¯åŠ¨æˆåŠŸå³å¯é€šè¿‡sså®¢æˆ·ç«¯ä½¿ç”¨ã€‚</p>
<p>åœ¨windowç«¯å¯ä»¥åœ¨æ§åˆ¶å°é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç«¯å£æ˜¯å¦æ‰“å¼€</p>
<pre><code>telnet {ip} {port}
</code></pre>
<p>5.é…ç½®è‡ªå¯åŠ¨</p>
<pre><code>æ–°å»ºå¯åŠ¨è„šæœ¬æ–‡ä»¶/etc/systemd/system/shadowsocks.serviceï¼Œå†…å®¹å¦‚ä¸‹ï¼š
</code></pre>
<p>[Unit]</p>
<pre><code>Description=Shadowsocks
</code></pre>
<p>[Service]</p>
<pre><code>TimeoutStartSec=0

ExecStart=/usr/bin/ssserver -c /etc/shadowsocks.json
</code></pre>
<p>[Install]</p>
<pre><code>WantedBy=multi-user.target
</code></pre>
<p>é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡</p>
<pre><code>$ systemctl enable shadowsocks

$ systemctl start shadowsocks
</code></pre>
<p>å¯åŠ¨åå¯ä»¥æŸ¥çœ‹æœåŠ¡çŠ¶æ€</p>
<pre><code>$ systemctl status shadowsocks -l
</code></pre>
<p>è‹¥å¯åŠ¨æˆåŠŸï¼š</p>
<p>â— shadowsocks.service - Shadowsocks</p>
<p>Loaded: loaded (/etc/systemd/system/shadowsocks.service; enabled; vendor preset: disabled)</p>
<p>Active: active (running) since Sun 2017-08-13 18:03:41 CST; 1h 29min ago</p>
<p>Main PID: 9567 (ssserver)</p>
<p>CGroup: /system.slice/shadowsocks.service</p>
<p>â””â”€9567 /usr/bin/python2 /usr/bin/ssserver -c /etc/shadowsocks.json<br>
å¦‚æœï¼ŒæœåŠ¡å¤±è´¥ï¼Œé‡å¯æœåŠ¡å™¨è¯•ä¸€ä¸‹</p>
<h2 id="å®‰è£…å¹¶å¯åŠ¨-shadowsocks-å®¢æˆ·ç«¯">å®‰è£…å¹¶å¯åŠ¨ shadowsocks å®¢æˆ·ç«¯<a title="#å®‰è£…å¹¶å¯åŠ¨-shadowsocks-å®¢æˆ·ç«¯" href="#å®‰è£…å¹¶å¯åŠ¨-shadowsocks-å®¢æˆ·ç«¯"></a></h2>
<p>shadowsocks æ”¯æŒ windowsã€MacÂ OSÂ Xã€Linuxã€Androidã€iOS ç­‰å¤šä¸ªå¹³å°ã€‚ä¸è¿‡ iOS ç”±äºç³»ç»Ÿå¯¹åº”ç”¨åå°è¿è¡Œçš„é™åˆ¶ï¼Œæ¨èä½¿ç”¨å®¢æˆ·ç«¯å†…åµŒçš„æµè§ˆå™¨ç§‘å­¦ä¸Šç½‘ï¼Œç»™å…¶ä»–åº”ç”¨ä»£ç†æ—¶éœ€è¦æ¯è¿‡å‡ åˆ†é’Ÿé‡æ–°å¯åŠ¨ä¸€ä¸‹ appã€‚</p>
<p>shadowsocks é¡¹ç›® Github ä¸»é¡µåœ¨<a href="https://github.com/shadowsocks/shadowsocks?utm_source=textarea.com&amp;utm_medium=textarea.com&amp;utm_campaign=article" target="_blank">è¿™é‡Œ</a>ã€‚</p>
<p>é‡Œé¢å¯ä»¥æ‰¾åˆ°å®¢æˆ·ç«¯ä¸‹è½½åœ°å€ã€‚</p>
<p>ä¸‹è½½å®‰è£…å®¢æˆ·ç«¯ä»¥åï¼Œåªéœ€æŒ‰æœåŠ¡å™¨çš„é…ç½®å¡«å†™ IP åœ°å€ã€æœåŠ¡å™¨ç«¯å£ã€æœ¬åœ°ç«¯å£ï¼ˆå¦‚æœæ²¡æœ‰æœ¬åœ°ç«¯å£é€‰é¡¹ï¼Œå°±æ˜¯é»˜è®¤çš„ 1080ï¼‰ã€å¯†ç ã€åŠ å¯†æ–¹å¼ç­‰å‚æ•°ï¼Œå¯åŠ¨å°±å¯ä»¥äº†ã€‚</p>
<p>å®¢æˆ·ç«¯æ”¯æŒå…¨å±€ä»£ç†å’Œ PAC ä»£ç†ä¸¤ç§æ–¹å¼ï¼Œåè€…ä¼šä½¿ç”¨ä¸€ä¸ªè„šæœ¬æ¥è‡ªåŠ¨æ£€æŸ¥ä¸€ä¸ªç½‘ç«™æ˜¯å¦åœ¨éœ€è¦ä»£ç†çš„ç½‘ç«™åˆ—è¡¨ä¸­ï¼Œè‡ªåŠ¨é€‰æ‹©ç›´æ¥è¿æ¥æˆ–ä»£ç†è¿æ¥ã€‚</p>
<p>PAC åˆ—è¡¨å¯ä»¥åœ¨çº¿æ›´æ–°ï¼Œä½†æ˜¯éš¾å…æœ‰æ”¶å½•ä¸å…¨çš„æƒ…å†µã€‚è¿™æ—¶å¯ä»¥é€‰æ‹©å…³é—­ shadowsocks ä»£ç†ï¼ˆå®é™…ä¸Šæ˜¯å–æ¶ˆå¯¹ç³»ç»Ÿä»£ç†çš„é…ç½®ï¼Œshadowsocks å®¢æˆ·ç«¯ä»ç„¶ä¿æŒå·¥ä½œï¼‰ï¼Œç„¶åä½¿ç”¨æ”¯æŒè‡ªå®šä¹‰è§„åˆ™çš„ä»£ç†ç®¡ç†æ’ä»¶æ¥å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†ï¼Œæ¯”å¦‚ switchyOmegaã€‚</p>
<h2 id="ä½¿ç”¨-switchyomega-å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†">ä½¿ç”¨ switchyOmega å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†<a title="#ä½¿ç”¨-switchyomega-å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†" href="#ä½¿ç”¨-switchyomega-å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†"></a></h2>
<pre><code>switchyOmega æ˜¯ chrome æµè§ˆå™¨ä¸Šä¸€ä¸ªå¾ˆå¥½ç”¨çš„ä»£ç†ç®¡ç†æ’ä»¶ã€‚å®ƒçš„å‰èº« switchySharp æ›´æœ‰åã€‚

chrome åº”ç”¨å•†åº—æœ¬èº«éœ€è¦ç¿»å¢™æ‰èƒ½è®¿é—®ï¼Œå› æ­¤éœ€è¦å…ˆåœ¨ shadowsocks å¯åŠ¨ä»£ç†æ¨¡å¼ä¸‹ä¸‹è½½å®‰è£…ï¼Œå†å…³é—­ shadowsocks ä»£ç†ã€‚

å®‰è£…å®Œæ¯•åï¼Œå³å‡» switchyOmega å›¾æ ‡ï¼Œé€‰æ‹©é€‰é¡¹ï¼Œè¿›å…¥ switchOmega é…ç½®ç•Œé¢ã€‚
</code></pre>
<h3 id="åˆ›å»º-shadowsocks-æƒ…æ™¯æ¨¡å¼">åˆ›å»º shadowsocks æƒ…æ™¯æ¨¡å¼<a title="#åˆ›å»º-shadowsocks-æƒ…æ™¯æ¨¡å¼" href="#åˆ›å»º-shadowsocks-æƒ…æ™¯æ¨¡å¼"></a></h3>
<pre><code>æ–°å»ºä¸€ä¸ªæƒ…æ™¯æ¨¡å¼ï¼Œæ¯”å¦‚å« SSï¼Œä»£ç†åè®®é€‰æ‹© socks5ï¼Œä»£ç†åœ°å€ä¸º 127.0.0.1ï¼Œç«¯å£ 1080ã€‚

ç°åœ¨åˆ‡æ¢åˆ° SS æƒ…æ™¯æ¨¡å¼å°±å¯ä»¥é€šè¿‡ shadowsocks ç§‘å­¦ä¸Šç½‘äº†ã€‚åé¢è·å–è‡ªåŠ¨åˆ‡æ¢è§„åˆ™åˆ—è¡¨
</code></pre>
<h3 id="è®¾ç½®è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼">è®¾ç½®è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼<a title="#è®¾ç½®è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼" href="#è®¾ç½®è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼"></a></h3>
<p>åœ¨è®¾ç½®ç•Œé¢é€‰æ‹©è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼ï¼Œåœ¨ â€œåˆ‡æ¢è§„åˆ™â€ ä¸­å‹¾é€‰â€œè§„åˆ™åˆ—è¡¨è§„åˆ™â€ï¼Œå¯¹åº”çš„æƒ…æ™¯æ¨¡å¼é€‰æ‹©åˆšåˆšæ–°å»ºçš„ SSã€‚</p>
<p>ç„¶ååœ¨ä¸‹é¢çš„è§„åˆ™åˆ—è¡¨åœ°å€ä¸­å¡«å†™</p>
<p><a href="https://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt" target="_blank" rel="noopener">https://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt</a></p>
<p>è§„åˆ™åˆ—è¡¨æ ¼å¼é€‰æ‹© AutoProxyã€‚</p>
<p>ç„¶åç‚¹å‡»ç«‹å³æ›´æ–°æƒ…æ™¯æ¨¡å¼ï¼Œ æ›´æ–°å®Œæˆåä¼šæœ‰æç¤ºã€‚</p>
<p>ç‚¹å‡»å·¦ä¾§çš„ â€œåº”ç”¨é€‰é¡¹â€ã€‚ç„¶åå•å‡» switchyOmega å›¾æ ‡ï¼Œé€‰æ‹©è‡ªåŠ¨åˆ‡æ¢ï¼Œå°±å¯ä»¥åœ¨è®¿é—®â€œä¸å­˜åœ¨çš„ç½‘ç«™â€ æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ° shadowsocks ä»£ç†äº†ã€‚</p>
<h3 id="æ·»åŠ è‡ªå®šä¹‰è§„åˆ™">æ·»åŠ è‡ªå®šä¹‰è§„åˆ™<a title="#æ·»åŠ è‡ªå®šä¹‰è§„åˆ™" href="#æ·»åŠ è‡ªå®šä¹‰è§„åˆ™"></a></h3>
<p>å¦‚æœé‡åˆ°æŸä¸ªå›½å¤–ç½‘ç«™æ— æ³•ç›´æ¥è¿æ¥æˆ–é€Ÿåº¦å¤ªæ…¢æ—¶ï¼Œå¯ä»¥å•å‡» switchyOmega å›¾æ ‡ï¼Œé€‰æ‹© â€œæ·»åŠ æ¡ä»¶â€ï¼Œæƒ…æ™¯æ¨¡å¼é€‰æ‹© SSï¼Œå°±å¯ä»¥äº†ã€‚</p>
<p>è¿™æ—¶æ‰“å¼€ switchyOmega é€‰é¡¹ï¼Œåœ¨è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼çš„åˆ‡æ¢è§„åˆ™ä¸­å°±å¯ä»¥çœ‹åˆ°åˆšåˆšæ·»åŠ çš„è§„åˆ™ã€‚å¯ä»¥åœ¨è¿™é‡Œç®¡ç†è‡ªå®šä¹‰çš„è§„åˆ™ã€‚</p>
<h3 id="å¯¼å…¥å’Œå¯¼å‡º-switchyomega-è®¾ç½®">å¯¼å…¥å’Œå¯¼å‡º switchyOmega è®¾ç½®<a title="#å¯¼å…¥å’Œå¯¼å‡º-switchyomega-è®¾ç½®" href="#å¯¼å…¥å’Œå¯¼å‡º-switchyomega-è®¾ç½®"></a></h3>
<p>å¦‚æœæ¢äº†ä¸€å°ç”µè„‘ï¼Œé‡æ–°è®¾ç½®ä¸€é switchyOmega å°±å¤ªéº»çƒ¦äº†ã€‚å¯ä»¥åœ¨è®¾ç½®å¥½çš„ switchyOmega ä¸­å¯¼å‡ºè®¾ç½®æ–‡ä»¶ï¼Œåœ¨å¦ä¸€ä¸ª chrome æµè§ˆå™¨ä¸­å¯¼å…¥ï¼Œå°±å¯ä»¥ç›´æ¥å¤åˆ¶åŸæ¥çš„è®¾ç½®äº†ã€‚</p>
<p>åœ¨ switchyOmega é€‰é¡¹çš„å·¦ä¾§ç‚¹å‡» â€œå¯¼å…¥ / å¯¼å‡ºâ€ï¼Œç‚¹å‡»â€œç”Ÿæˆå¤‡ä»½æ–‡ä»¶â€ å³å¯ç”Ÿæˆ switchyOmega è®¾ç½®å¤‡ä»½ã€‚ç‚¹å‡» â€œä»å¤‡ä»½æ–‡ä»¶æ¢å¤â€ å¯ä»¥å¯¼å…¥å¤‡ä»½æ–‡ä»¶ã€‚</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>VPS</tag>
        <tag>shadowsocks</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD</title>
    <url>/posts/%E3%80%8A%E8%BE%90%E5%B0%844%E3%80%8B%E4%BA%8C%E6%AC%A1%E5%85%83%E8%90%8C%E5%A6%B9MOD/</url>
    <content><![CDATA[<h3 id="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹mod">ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD<a title="#ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹mod" href="#ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹mod"></a></h3>
<ul>
<li>è¡¥ä¸ç±»å‹ï¼šæ¸¸æˆMOD</li>
<li>æ•´ç†æ—¶é—´ï¼š2019-05-05</li>
<li>å¤§å°ï¼š18.73MB</li>
<li>è¡¥ä¸åˆ¶ä½œï¼šhiyokomod</li>
<li>è¡¥ä¸è¯­è¨€ï¼šå¤šå›½</li>
<li>ç‰ˆæœ¬ï¼šv1.0</li>
</ul>
<p><a href="http://id.ttz9.cn/thn/%E3%80%8A%E8%BE%90%E5%B0%844%E3%80%8B%E4%BA%8C%E6%AC%A1%E5%85%83%E8%90%8C%E5%A6%B9MOD_id371@371_2138610" target="_blank">download</a></p>
<blockquote><p>ç”±Nç½‘ä½œè€…â€œhiyokomodâ€åˆ¶ä½œçš„ä¸€æ¬¾äººç‰©å¤–è§‚æ›¿æ¢ç¾åŒ–modâ€œ<strong>äºŒæ¬¡å…ƒèŒå¦¹MOD</strong>â€ï¼Œ<br>
å°†æ¸¸æˆä¸­å°†æ¸¸æˆä¸­å¤šä½å¥³æ€§NPCå¤–è§‚ä¿®æ”¹ä¸ºäºŒæ¬¡å…ƒç¾å°‘å¥³ï¼Œéå¸¸ç²¾è‡´çš„é¢éƒ¨å»ºæ¨¡å’Œå¯ä¿®æ”¹é¡¹ï¼Œ<br>
å¸¦ç»™æ¯ä¸€ä¸ªè€å†°æ£ï¼å–œæ¬¢è¿™äº›èŒå¦¹å­å°±æ¥3DMä¸‹è½½ä½“éªŒå§ï¼</p>
</blockquote>
<a id="more"></a>
<h3 id="æˆªå›¾">æˆªå›¾<a title="#æˆªå›¾" href="#æˆªå›¾"></a></h3>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_376264.png" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_327571.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_903130.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_319499.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_929840.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_553987.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_557348.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_140245.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_907658.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<p><img src="https://img.3dmgame.com/uploads/images/news/20190505/1557045450_261890.jpeg" alt="ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD" class="Ï†cx"></p>
<h3 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹<a title="#æ³¨æ„äº‹é¡¹" href="#æ³¨æ„äº‹é¡¹"></a></h3>
<p>éœ€è¦ä¸‹è½½â€œ<strong><span style="color:#E53333;">LooksMenuæè„¸èœå•</span></strong>==&gt;<a href="https://dl.3dmgame.com/patch/138611.html" target="_blank">ç‚¹æˆ‘ä¸‹è½½</a>â€ã€‚</p>
<h3 id="ä½¿ç”¨è¯´æ˜">ä½¿ç”¨è¯´æ˜<a title="#ä½¿ç”¨è¯´æ˜" href="#ä½¿ç”¨è¯´æ˜"></a></h3>
<p><strong>NMMè‡ªåŠ¨å®‰è£…æ–¹æ³•ï¼š</strong><br>
<a href="https://dl.3dmgame.com/patch/128998.html" target="_blank">ç‚¹æˆ‘ä¸‹è½½NMM</a></p>
<pre><code>1ã€æ·»åŠ å‹ç¼©åŒ…åˆ°NMM(åˆ—è¡¨ä¸­å‡ºç°)ï¼›

2ã€åŒå‡»åˆ—è¡¨å®‰è£…ï¼›

3ã€è¿›å…¥æ¸¸æˆå³å¯ã€‚

**æ‰‹åŠ¨å®‰è£…æ–¹æ³•(ä¸æ¨è)ï¼š** 

1ã€è§£å‹ç¼©ï¼›

2ã€å°†dataæ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ¸¸æˆæ ¹ç›®å½•ï¼›

3ã€ç”¨MODç®¡ç†å™¨åŠ è½½ESPï¼›

4ã€è¿›å…¥æ¸¸æˆä¸­å³å¯ã€‚
</code></pre>
<h3 id="æ¼”ç¤ºè§†é¢‘">æ¼”ç¤ºè§†é¢‘<a title="#æ¼”ç¤ºè§†é¢‘" href="#æ¼”ç¤ºè§†é¢‘"></a></h3>
<iframe src="https://player.youku.com/embed/XNDE2Njc1OTM0MA==?client_id=5a73c0df8eb0d91d" allowfullscreen="" width="640" height="480" frameborder="0">
</iframe>
<iframe src="https://player.youku.com/embed/XNDE2Njc2MjM2NA==?client_id=5a73c0df8eb0d91d" allowfullscreen="" width="640" height="480" frameborder="0">
</iframe>
<p>åˆ†æµ</p>
<blockquote>
<p><a href="https://pan.baidu.com/s/1hYTBEc2DQbmP2k98JLSwkA" target="_blank">ç™¾åº¦ç½‘ç›˜(æå–ç ï¼šbr93)</a></p>
</blockquote>
<p>æœ¬åœ°</p>
<blockquote>
<p><a href="http://dl1.cudown.com/buding/mod/3DMGAME-FO4AnimeRaceNanakochanmod.rar" target="_blank">ç”µä¿¡</a><br>
<a href="http://dl1.cudown.com/buding/mod/3DMGAME-FO4AnimeRaceNanakochanmod.rar" target="_blank">ç½‘é€š</a></p>
</blockquote>
<blockquote>
<p><a href="http://id.ttz9.cn/thn/%E3%80%8A%E8%BE%90%E5%B0%844%E3%80%8B%E4%BA%8C%E6%AC%A1%E5%85%83%E8%90%8C%E5%A6%B9MOD_id372@372_2138610" target="_blank">é«˜é€Ÿä¸‹è½½</a><br>
<a href="http://id.ttz9.cn/thn/%E3%80%8A%E8%BE%90%E5%B0%844%E3%80%8B%E4%BA%8C%E6%AC%A1%E5%85%83%E8%90%8C%E5%A6%B9MOD_id372@372_2138610" target="_blank">ç”µä¿¡ä¸‹è½½</a><br>
<a href="http://id.ttz9.cn/thn/%E3%80%8A%E8%BE%90%E5%B0%844%E3%80%8B%E4%BA%8C%E6%AC%A1%E5%85%83%E8%90%8C%E5%A6%B9MOD_id372@372_2138610" target="_blank">è”é€šä¸‹è½½</a></p>
</blockquote>
]]></content>
      <categories>
        <category>Mod</category>
      </categories>
      <tags>
        <tag>Games</tag>
        <tag>PC</tag>
      </tags>
  </entry>
  <entry>
    <title>å·«å¸ˆä¸‰å¹²è´§æ”¶è—</title>
    <url>/posts/%E5%B7%AB%E5%B8%88%E4%B8%89%E5%B9%B2%E8%B4%A7%E6%94%B6%E8%97%8F/</url>
    <content><![CDATA[<blockquote class="blockquote-center"><p><strong>The wither 3</strong>ï¼šèåœæ˜¯ç‹©é­”çŒäººä¸–ç•Œä¸­æœ€å¼ºå¤§çš„ç”Ÿç‰©ã€‚å®ƒå¯ä»¥ç¬é—´ç§»åŠ¨åˆ°æ°æ´›ç‰¹çš„èº«è¾¹ï¼Œå¹¶ä¸”ä¸å—ä»»ä½•é­”æ³•çš„å½±å“ã€‚æ²¡æœ‰äººèƒ½ä¼¤åˆ°èåœï¼Œå½“èåœå—åˆ°æ”»å‡»æ—¶ï¼Œå®ƒä¼šæ„¤æ€’çš„æŠ¬èµ·å®ƒé‚£ç²—å£®çš„åè…¿è¿›è¡Œåå‡»ã€‚åœ¨å •å…¥æ‚¬å´–æ—¶ï¼Œèåœä¼šä½¿ç”¨ç¬é—´ç§»åŠ¨é€ƒè„±ï¼Œå¹¶ä¸”åœ¨ä¸–ç•Œä¸Šæ¶ˆå¤±ï¼Œæ ¹æœ¬æ‰¾ä¸åˆ°ä¸€ä¸è¸ªè¿¹ã€‚è€Œå½“æ°æ´›ç‰¹å†æ¬¡å¬å”¤èåœæ—¶ èåœä¼šä»æŸä¸ªåœ°æ–¹çªç„¶è¹¿å‡ºæ¥ æ…¢æ…¢æ‚ æ‚ çš„èµ°å‘æ°æ´›ç‰¹ã€‚ã€‚<br>
ã€€ã€€â€œè¦è¯´èåœæœ‰ä»€ä¹ˆä¸è¶³çš„è¯ï¼Œå¤§æ¦‚æ˜¯å®ƒä¸ä¼šæ‰“æ˜†ç‰¹ç‰Œå§â€â€”â€”åˆ©ç»´äºšçš„æ°æ´›ç‰¹</p>
</blockquote>
<a id="more"></a>
<div class="note info">
            <h3 id="ã€Šå¼€åœº-cgã€‹">ã€Šå¼€åœº-CGã€‹<a title="#ã€Šå¼€åœº-cgã€‹" href="#ã€Šå¼€åœº-cgã€‹"></a></h3><p><strong>å¯»æ‰¾å¶å¥ˆæ³•</strong></p>
          </div>
<iframe height=370 width=510 src='http://player.youku.com/embed/XODEwNzE1MTAw' frameborder=0 'allowfullscreen'></iframe>
<div class="note info">
            <h3 id="ã€Špresent-cgã€‹">ã€ŠPresent-CGã€‹<a title="#ã€Špresent-cgã€‹" href="#ã€Špresent-cgã€‹"></a></h3><p><strong>æ€ªç‰©çŒäºº</strong></p>
          </div>
<iframe height=370 width=510 src='http://player.youku.com/embed/XNDAwNzQ0NDM1Mg==' frameborder=0 'allowfullscreen'></iframe>
<div class="note info">
            <h3 id="ã€Šéš¾å¿˜ä¹‹å¤œ-cgã€‹">ã€Šéš¾å¿˜ä¹‹å¤œ-CGã€‹<a title="#ã€Šéš¾å¿˜ä¹‹å¤œ-cgã€‹" href="#ã€Šéš¾å¿˜ä¹‹å¤œ-cgã€‹"></a></h3><p><strong>è¡€ä¸é…’</strong></p>
          </div>
<iframe height=370 width=510 src='http://player.youku.com/embed/XMTgxOTI0OTcyOA==' frameborder=0 'allowfullscreen'></iframe>
<div class="note info">
            <h3 id="ã€Še3-cgã€‹">ã€ŠE3-CGã€‹<a title="#ã€Še3-cgã€‹" href="#ã€Še3-cgã€‹"></a></h3><p><strong>E3æ¸¸æˆä¼šå±•</strong></p>
          </div>
<iframe height=370 width=510 src='http://player.youku.com/embed/XMjcyMzI3MDc2MA==' frameborder=0 'allowfullscreen'></iframe>
<div class="note danger">
            <h3 id="ã€Šmarcin-przybyÅ‚owiczã€‹">ã€ŠMarcin PrzybyÅ‚owiczã€‹<a title="#ã€Šmarcin-przybyÅ‚owiczã€‹" href="#ã€Šmarcin-przybyÅ‚owiczã€‹"></a></h3><p><strong>50é¦–ç»å…¸å•æ›²</strong></p>
          </div>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=510 height=430 src="//music.163.com/outchain/player?type=0&id=2493215421&auto=0&height=430"></iframe>
<div class="note danger">
            <h3 id="ã€Šthe-sansretourã€‹">ã€ŠThe Sansretourã€‹<a title="#ã€Šthe-sansretourã€‹" href="#ã€Šthe-sansretourã€‹"></a></h3><p><strong>12é¦–ç»å…¸å•æ›²</strong></p>
          </div>
<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=510 height=430 src="//music.163.com/outchain/player?type=0&id=2684241951&auto=1&height=430"></iframe>]]></content>
      <categories>
        <category>PC</category>
      </categories>
      <tags>
        <tag>å·«å¸ˆ3</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»™hexoåšå®¢nextä¸»é¢˜æ·»åŠ èƒŒæ™¯éŸ³ä¹</title>
    <url>/posts/%E7%BB%99hexo%E5%8D%9A%E5%AE%A2next%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E8%83%8C%E6%99%AF%E9%9F%B3%E4%B9%90/</url>
    <content><![CDATA[<ul>
<li>è¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ <a href="//blog.sourcod.com" target="_blank">sourcod</a></li>
</ul>
<blockquote>
<p>æˆ‘çš„hexoåšå®¢ä½¿ç”¨çš„æ˜¯nextä¸»é¢˜æ‰€æœ‰æ¬¡æ•™ç¨‹åœ¨nextä¸»é¢˜ä¸Šä¿®æ”¹ã€‚</p>
</blockquote>
<h3 id="ä¿®æ”¹-themes/next/layout/_macro/sidebar.swig-æ–‡ä»¶">ä¿®æ”¹ <code>themes/next/layout/_macro/sidebar.swig</code> æ–‡ä»¶<a title="#ä¿®æ”¹-themes/next/layout/_macro/sidebar.swig-æ–‡ä»¶" href="#ä¿®æ”¹-themes/next/layout/_macro/sidebar.swig-æ–‡ä»¶"></a></h3>
<p>æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨å†…å®¹</p>
<p><img src="http://sourcod.oss-cn-beijing.aliyuncs.com/hexo/91fc7624571cb9276c6338b1c9913fa3.png" alt="sidebar" class="Ï†cx"></p>
<a id="more"></a>
<h3 id="åœ¨-themes/next/_config.yml-é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ­Œå•åœ°å€é…ç½®">åœ¨ <code>themes/next/_config.yml</code> é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ­Œå•åœ°å€é…ç½®<a title="#åœ¨-themes/next/_config.yml-é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ­Œå•åœ°å€é…ç½®" href="#åœ¨-themes/next/_config.yml-é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ­Œå•åœ°å€é…ç½®"></a></h3>
<p><code>background_music: //music.163.com/outchain/player?type=0&amp;amp;id=2120628564&amp;amp;auto=1&amp;amp;height=66</code></p>
<p><img src="http://sourcod.oss-cn-beijing.aliyuncs.com/hexo/676e3e18fa9bdc5af7621bc471cc2895.png" alt="æ­Œå•åœ°å€é…ç½®" class="Ï†cx"></p>
<h3 id="&lt;a-name=&quot;t2&quot;&gt;&lt;/a&gt;æ³¨å†Œç½‘æ˜“äº‘éŸ³ä¹"><a name="t2"></a>æ³¨å†Œç½‘æ˜“äº‘éŸ³ä¹<a title="#&lt;a-name=&quot;t2&quot;&gt;&lt;/a&gt;æ³¨å†Œç½‘æ˜“äº‘éŸ³ä¹" href="#&lt;a-name=&quot;t2&quot;&gt;&lt;/a&gt;æ³¨å†Œç½‘æ˜“äº‘éŸ³ä¹"></a></h3>
<p>è‡ªå·±ç ”ç©¶</p>
<h3 id="&lt;a-name=&quot;t3&quot;&gt;&lt;/a&gt;åˆ›å»ºæ­Œå•"><a name="t3"></a>åˆ›å»ºæ­Œå•<a title="#&lt;a-name=&quot;t3&quot;&gt;&lt;/a&gt;åˆ›å»ºæ­Œå•" href="#&lt;a-name=&quot;t3&quot;&gt;&lt;/a&gt;åˆ›å»ºæ­Œå•"></a></h3>
<p>è‡ªå·±ç ”ç©¶</p>
<h3 id="&lt;a-name=&quot;t4&quot;&gt;&lt;/a&gt;ç»™æ­Œå•æ·»åŠ è‡ªå·±å–œæ¬¢çš„éŸ³ä¹"><a name="t4"></a>ç»™æ­Œå•æ·»åŠ è‡ªå·±å–œæ¬¢çš„éŸ³ä¹<a title="#&lt;a-name=&quot;t4&quot;&gt;&lt;/a&gt;ç»™æ­Œå•æ·»åŠ è‡ªå·±å–œæ¬¢çš„éŸ³ä¹" href="#&lt;a-name=&quot;t4&quot;&gt;&lt;/a&gt;ç»™æ­Œå•æ·»åŠ è‡ªå·±å–œæ¬¢çš„éŸ³ä¹"></a></h3>
<p>çœ‹ä½ è‡ªå·±äº†</p>
<h3 id="&lt;a-name=&quot;t5&quot;&gt;&lt;/a&gt;åˆ†äº«æ­Œå•"><a name="t5"></a>åˆ†äº«æ­Œå•<a title="#&lt;a-name=&quot;t5&quot;&gt;&lt;/a&gt;åˆ†äº«æ­Œå•" href="#&lt;a-name=&quot;t5&quot;&gt;&lt;/a&gt;åˆ†äº«æ­Œå•"></a></h3>
<p>ä¸ä¼šè·å–å¤–é“¾çš„è¯·ä¸Šåº¦å¨˜: <a href="https://jingyan.baidu.com/article/d7130635dcdf6813fdf475c7.html" target="_blank">æ€ä¹ˆæŠŠè‡ªå·±çš„æ­Œå•åšæˆå¤–é“¾</a></p>
<h3 id="&lt;a-name=&quot;t6&quot;&gt;&lt;/a&gt;è·å–å¤–é“¾æ’­æ”¾å™¨"><a name="t6"></a>è·å–å¤–é“¾æ’­æ”¾å™¨<a title="#&lt;a-name=&quot;t6&quot;&gt;&lt;/a&gt;è·å–å¤–é“¾æ’­æ”¾å™¨" href="#&lt;a-name=&quot;t6&quot;&gt;&lt;/a&gt;è·å–å¤–é“¾æ’­æ”¾å™¨"></a></h3>
<p><img src="http://sourcod.oss-cn-beijing.aliyuncs.com/hexo/3684d31ccbbb950e018b16113068a967.png" alt="å¤–é“¾æ’­æ”¾å™¨" class="Ï†cx"></p>
<h3 id="&lt;a-name=&quot;t7&quot;&gt;&lt;/a&gt;æŠŠåœ°å€copyå‡ºæ¥height=90æ”¹æˆ-66"><a name="t7"></a>æŠŠåœ°å€copyå‡ºæ¥<code>height=90</code>æ”¹æˆ <code>66</code><a title="#&lt;a-name=&quot;t7&quot;&gt;&lt;/a&gt;æŠŠåœ°å€copyå‡ºæ¥height=90æ”¹æˆ-66" href="#&lt;a-name=&quot;t7&quot;&gt;&lt;/a&gt;æŠŠåœ°å€copyå‡ºæ¥height=90æ”¹æˆ-66"></a></h3>
<p><img src="http://sourcod.oss-cn-beijing.aliyuncs.com/hexo/47f61ed64adaa3db93c0eceec989978e.png" alt="å¤–é“¾" class="Ï†cx"></p>
<blockquote>
<p>è¿™æ ·ä»¥ååªéœ€è¦ä¿®æ”¹ç½‘æ˜“äº‘éŸ³ä¹çš„æ­Œå•ï¼Œåšå®¢çš„èƒŒæ™¯éŸ³ä¹å°±ä¼šè‡ªåŠ¨ä¿®æ”¹äº†ã€‚</p>
<p>å¦‚æœå‡ºç°éŸ³ä¹ä¸è‡ªåŠ¨æ’­æ”¾ï¼Œé‚£æ˜¯èµ„æºçš„é—®é¢˜ï¼Œè‡ªå·±ä¸Šç½‘æ˜“äº‘éŸ³ä¹ç”Ÿæˆå¤–é“¾çš„é¡µé¢çœ‹çœ‹ä¼šä¸ä¼šè‡ªåŠ¨æ’­æ”¾ã€‚æŠŠåèµ„æºåˆ é™¤å°±OKäº†ã€‚</p>
</blockquote>
<hr>
<p><em>ä¿®æ”¹å®Œæˆ‘çš„åšå®¢çš„æ•ˆæœ</em></p>
<p><img src="http://sourcod.oss-cn-beijing.aliyuncs.com/hexo/e10246452ccbc9a5eb5e2f2b8c5c70e7.png" alt="åšå®¢æ•ˆæœ" class="Ï†cx"></p>
]]></content>
      <categories>
        <category>Hexoæ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>é—®é“</title>
    <url>/posts/%E9%97%AE%E9%81%93/</url>
    <content><![CDATA[<div id="hexo-blog-encrypt" data-wpm="æŠ±æ­‰, è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹, è¯·å†è¯•è¯•." data-whm="æŠ±æ­‰, è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹."><div class="hbe-input-container"><input type="password" id="hbePass" placeholder="æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç ." /><label>æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .</label><div class="bottom-line"></div></div><script id="hbeData" type="hbeData" data-hmacdigest="fac1becdd6fb7c960afeff18bcfd2b717dfd9d41ea7a944113e997f84ca15d78">3698665928e6a68add945691fb1910182a839f32c25e7059efaf61d1c75d777feb26f6113c08cf9fc825b7af7dd4362b208ba4943180e37e24933671519f6a9ac5962e287aece003173bbf55627fbd233d5c8c109431cc220a20a50207ee866ba945f943fcdd69e640392b8b903a6a417f192ae9440eb51d88dbf7256aba4e8ae38159d8338f8e61a0ac2798159066f672e9d2ba22e2e77190f47d9d8fc173d699e19c76b5cdbde3afccdcdb2c67874521c4a7b9ff212bc2fa6860a77dc932fc1ebb123eff05596f366e5f3a8b15c55244407782b26938048d0fb2965ab1962485ddd5623c98c2322034a2f09b5e8e001b762de06024a2451d80f00d1d8088a3032f8b9ddfbcef29e75b1031afc50be2e57dcd9ce77394ebb31eb5b61621d7fcaa5303ec51ff7bc688272830e106694a5268a54c8f9e2f318216a9827ded881719ae68decdc4399e35f199cd7da6b1e83bd0012e823ff5bac5e0482465c14b9c1ef325d5ccb1836ac7ff61dd8ad811b17e5daddb533eed05b9ed8d73f80578714b1be5e931e47a17acacff85f60b39d1521e79851f5987154c3b067a6c2bcfc4a9299d333c00e2038b48fbd03b237c6c5d56e649731c8a02a247b9c61bd57fa14a8947e5ea6b30d06783672bd8865098d1bc19fd2e74d24c80fdccd00f5320d57cd907c16eea50d7d3e935fda4beb6c10b436b75e62505d2f0b3230579f13ebed0bb7ef6f39868607e24399b02da10eac9c6610cbe3ae7ef507759ec4f92915c23f4234b91b5925a241aeb0e7d2ee1ea5d1d3a5843d2c6b9afb8ce0d850b08ccff61e40bce219374712bfb72d59180688438248b32b2a54a50e9fc6d33a43f54a5080239fd2875d4c66ae90126f7065fd45038e0f6f468de102543cdfd0b3fbb0e4badacc0e7edc1fffbc407574a09bc41a77924c1e92d3c6f49ce482a7080edd71aa6ea506d763ca77ecc39387288d2fc5cf72f4a2bcde0cfc685d1d31503b966bfe8aab1b6a8f4d9080b62e220217bd6a3f84bc8a0b97ab0e8371e89f895f4ee5a7d13e963d258b5ecf0a067c7ec590bcaca01721aa1e4376728d7886cc6cce211aabc6a4093dc0e5cf40a91130cb46cc585cdf34c204c08b6cee90d9e55e7526ac5a59769694fba5bcea14baea598ab0be7f2bd8be9d8137bd8a9d8d410f2ef25210e61c7a8b32b0059349b1b6b403200cb8713a3fe2986bf68f0489fcaf1c44ca74e8a2c6cf7bac1b718dab970407ffe030fd1e504b36fcd21678f7df4fa11a93301f486b4699675124013120012967c17db014a73d60db5b36d6ecc0fffc8977a1551452691a7ea729817262bbcb877ae152fe62fa01452e40d8fff46ec0baf0e6a72f388ddda3a7366b790783ee70e7a63641d71e374f6fcea22c57ca3b7bdd2cad059482505681f1cdf5c362f9490c93c31960712ec5cc7331fe21428481a7e0bcc3146231fafae7819dd920ff8108d6f336da0beabe29faf983e56e628dc9784e609c7cc36d14d5d6f4c5192df8e303ef40d5fe3dcad104b8a277dd125d1c8c465d6598201f7287414e812ba3c72dfc838015269ffdfa5f3c66595a423c85fca9161935d9f1c17389647820381914066a606e7a2dfd6051f408a8537e3f0018a97cb8cbe252b6f386523ac8799ccb99fe2f7a7ae816b25ab21b3837c2a03f7bd39c60d70162dcf0b08d020ec21a7ddd975dcef6d2b5514bbddf93fb299d3b9cb40a94626f2229368433e780c5fdaf855ee7ead658a5d39dcb1018868fcffffa382917e1f857ee1ebce78ff0533ade2b3fd3d8d7c3632e51002d01b5c772db0da67317627939c172184640d8d5f488323bdab1e7e7aa5c1b361b62c3ecebef831941727745ea4f1e772dfbce43c3af3eb7216cdcf90b9282291cb8e374e8730918d88701d8d62c2572a222a76ee4f86cb436da1b59aee6c21b4c09cf47ffe8152a5dbd60e3c78a389e94647b38ab1f1a55348fe299e0cf18446df3cd01426e3342c32e5d504d2790e8da979893ec8775be9e598ea3cd5dbe7e558498c7081ba58a102f9c9287a2f3f9618e7040cf8ae31d5512a728aecbe5fbcf809fcb93ed8f58f9307190bb760630de4130901027f59354d849c52b8695b60c6afab84111ecbba59b843062d3f858615f5404bd63959c10881fc33e9080b7c3df55c818f3ff78e11405b3cd9d4ed21e5af7eac1b26c1f4fafdf2b97b18978befa021cb421f2f7bdce785cf85cd4adde7d4762ea7d683547f22341b482d73ce3a706a62f866bd1d4aee0f78b2335cf3388c14b720c82701130102ced01eb7a1b90e7ab54ca88ae7744b74371595c33735a65b4d7248d2afd7768dd80439e64395583253ac3a863b2c6ad29a490ed54dff9e49ba19adb770348ea59a863f154f85a26b0d7c1fad42f8a00de4598a27b2b082b57a4a0bfedc40c12ede6c3aa1a2bb122ab6cb30885d309a8d6807dcb3b4a5e117ad9e1145d3c95617a32548bee6ad0c67c63758c00f5707d4ca2e445b65f2806525e175826e7c1fcae4b2dd138fd01783f204aef6318da85fc1cb49f591dc09e5cd3f552dbd6f2f472b0128d6ccbe53fdd3398e620e5afaa5206cdc325d4e76978e3d37e02e7ada0af9b6d89a3c891245db0a45cd8e69ed30a4350cd348403028d3e248232b24d9daa5263199cb1ea87d2791c21e5828d356ffe2b55dc75e447bb4c7976ab16796bb73ebecee2561693ba530cff6cbe129ec53d1699d76570cef40f5e3c15b819f218cc3787a9f46bf7851548a4fbae8a22fea85697060884bb52b957cfdb3a7e9e1e8b34c43809889d89f5fa81eadb01bb229b9f52a7edd01c97270ab5c7bc858a413d66bf83b4d62baaec43a20699b9561431e09d517d9e92249832357c9c8d072b103dcac2dafc6a040a3a293ca47d7074ac9976fefbd46ba4804be79128cced76270b84ba471d57ae94355083020a83815a676d7bc164031a20e8e0963ea8cd54737ecafa99879f7645d9ba97ac33303dc54829871b59d76b7dd2c98600993f7e03fa399930b65c669d671c2ca57eeda791e405bc0e68ac96ec725741cc6874fe37a7f47eb7caa84cb78cbd5ba06f278fd70a269397183dd9762a462a6682321228e0b2817fa7b91e7e7b1ed79c8710a70e5495e829396de5d60b5589e669bed3e739ae12118e81881d7c30ebdeacd0fcb5781e87469513bd2021ea28254b1c95fd816431bfe042d78f414689cefc0a0340894ef92323e6a2391e6cc30cf75ffb3830f965651f2e50568bd3cc529ad79c133c0b0071eef63fb858dbb0b13a265ae4f29f26b7196b7c25b438baad8958b3a1c12bf8fce430aad795cf21cc99a6ada98e2dd447860dc8c0c58798578c93a4cd3fc45b9f219e174063a348f1953bb3276798b76f7038f1df1081e5795f22d235bc3d6144170a098deca6c51cf891350be5edb92ee68700af489ab66aa332d5c6bd5d15622eba33d19395bd1d2ec870206386b3fdd586a2334b171ef8291c7f3c478eb8d60081b9e5a52f0d4129434be28248ab5789dadb65c8eac41d533b0062f4fb1eddc2efca79655d7a1385e0de46893380a76cd9b952f4091299a1d18ead4d6d82c7f241429e1fedcb70fcfaeae2a3cdad054b113aab58ae8ac4155e5d8e98200bb69b0dd7216350783234ca14b38c90ca467726b8e7caf8b6dcd978f6534268f9f3491fc74d134f37416dc41eea1f73a7eabfaed45835c11f32e27bc3bb8347699a48afddb0de322f8dd10a01cdf520f0429772e35261c3ad8610117424f0965b96368bb6c230b4b4f506542ac5ed412bfc06f0ab68b911b99e111d1aaa0e4c031f59258e786bc9585056d41c38f46ff74dbe88cc31cc14a04d0919d01ac2f50575bf2302df97077a94a3ca5e6e5a77a703e13503ddce4d56695b1ac249768dea4369b0730b66c2fc837edc04b3ec2b8387292c713fc6e59ffa88391c4131233d80dedb617639606ef76e9576841f1db692effca8fd849de796254ad37ab6211c2d150c3abfadcf2f8baf1aef30b575c0eb67f922f8e411af90b1c242b3b56f4eca8d90db860e107dd49ffcf2785b78f780abd69e0e9e6ed6eb2cc2c5cdf582f37be5486b15484678a7d3fcc82d6826991a6254cab1d10ccac34caf482c087b584cf8155fa34b114e120e3c00e00ea842aea549957b26217a35383e0290ef868eb415ec1f737f70a5d8884126f4b48b9f74417dec60a639018a88c46fd9bc957a7a4e3cbad338eee1f1443d11034dbe9a23643fb7e8a2ce01df3bcab771f22b8d7f57e3a2d43410495839439515767fc13aa9fd40b15ddd8299a19c5bf5114928f2224ca02816fa696789614c1c327ed973b6699199f0abe20055b2d999fe3c4ccd121f6919b42dc47d1f00dc2a91b6c3cae0d54622b527b367f387e92c609aa1a236390eb2a2dd87b6e061183f137ecee9487d964da95ed533bbe441c4bf1cad33afd7dc2679581afa827abcb01c305a762fc1cf8fdb6a1511e753bc2c5f3881a29e8b7387988defb38588f0570b6a93f0b11525ffbc79ecd337a515114b9755e83a16f65dbe529005b71677324a58f5117251dd488f8a0a336394036da9f52a1a5205b2600fe2aca503407dc9bf08cfb9aca62a35ac65dfea63398d93fef9ea30a10c6a9e534fc0e8607c19807d9d772706cc75fb3fb93362f5472303421dd86a57aa656652c254364baa0638e34c58d5f1241d1a692ff4452fb29707828181883ee937b64d1278f4c4837e332514b5fcf78da50054c158d00367063433142210e43926b1bb3405e74ce9cc8f83d5162e83ac88136a2cc2b9c1630e9e12ab3e06c1776290a40e62c280403caae454e0a2184a22a4099a635c04425f7712220fafe14a061e56a9c99f0aaa3374af025af0d924facd38035e7f1d257afe44c6170fcb6b36fdd9739b485ee14268f623ee2d2109f8f552ae9d88d20fbe29b42a818d44bf0999afaf0db3223ebc9fe3ea9034f9233f34d487a5caa9f80d3e01624f6b7567e9c05d668d3334d26af547b5c70c4fc34776244919b35c74041683686f22865b41a96558f1e5e6a4a08a2587a8747b693ecca1649452439ca749605c3b00a512bf2866cbb4b5581386997ad77d966405a5cea6f6028e6fa5985642a1529c43f46e01ac8f528627b4a36b1ccae1c8393681d4967b890d48f6a84bb9f3950dfe2496525253c4f7780f7d063349dd92eed3b6ed3332884b7089f019306be472564821a57b846cd9ccbf973e365321fa432fca401caa0e648fc9e0614e566de4c5a41caec4867a8aeded1d35c6b3d32e19f58d40a5532825d0863ecc82616d2f261cd88c699bc76c09a81b56aa4af522ac4d16f6f1b183e3ef6cbafefaca9f7d31e4b641694016a60b9dfc21bd04b768b07986ff05bb74b698637197d0b9183b50e7e271d72ea27803bda8b5eb869598055d0fe7bfa697c851aa432c6ad4e763931c3e85e59a6c5c376a8af349ca3289aab277b6bad115baa0407f466ac01cce10c1982d25fe8b1e70e8a3d795c4957388c2f3606f80a24d52b9d10c5c94acc99d076cb91f8ca3237bf0619747fc65361b6ef936e2d644461bdb2a7c514b1babb32b9cb73de6c35c7a7e2d207ff8c64d851b793461abe0c0713e4cb5e0746994837fda85459358c2063aa70cdc24f5ab68d080c22e0512e03adfac10f6880ffe7e39331ce019cad18d6df17d37ce93ceab0ed4a0af7b824fa7f1675d6365f8367f12a72fb12ca04004fc3ba4d3bc0563c6965a9589b4842b2fc5797ccb235be6e6379f0c84d3a205d16c2c419fb115af4b51b835b4db2c75be89fffce695b07beedd4d291351436a68f858a0d7c1b4e6627b7ffdba96d25384d5c31f8fa190dcdb33ec2559a3f292ee9d7787ab7286b48c953d331d29542d504c00e77ed14bc2b956a2ced025f9dab86d1b5ac5f1a9ee43ab4bdf51602b317953f1fdc08a0494e6ff965a413ab292562cf226c57b0bdf5b2e1c46f6b7eec13096b4a67f3f9e3662e5195d25c40da6375589fe955a51538010d40ff167ac02e38a3018f3cdee01e77331553d64c3743ea382dfe1a42c9a3a298aea1714c18e85b1835dd170ec53a74508fe541af3b90d2f536b3a62ffae142c37fc83db8151e7f9290b1b9a6b54b9ced017dd0dd966ab1ea36ea18ad5783f0e85beddbaba4fb231d3c89aedbf94ad72b23379fb7b6941eb47c63d3e8c723b2d927533387b85a7b1649ef4e421b1518f9be492c8ed10cd423785b1b9be2e5167374c5a27d4b28a39db1025ead840ddbe1c38db2983f6a5229f4447c37fbaf679f3974afb8091ef9cec304c77a33a6030f40247567e1913b845e751e265444bf85bc741d05800c605f2af8496647b0ffaaab585c17d9561374707eba4c7206adc31ccc2ca5b98cb6957ad17cf3e443eb0de16096e75c2ebc7b978e79dad725d09a0bf2eed6cee8a71eaa68c9d4157de30f4266c53af63ef965ef404f874eac7770ec92ba4539310ba63688596e1026c862c821c596c3a5801f018f1a18c8db0f105bafe00af2cd80346c8a02f96ddf5b8256a7126f96439af9be19412113a55660ed3c37381f38d763bf1e45f7a8ca119e5104ad609ff6755505b7b6adc9d1d856c878c911771717ca2c9e3ac24628f6acbfd23f214351c72ea1b811e59e53eb1de3f6626139f12386011c59330f8824b9a35a1142483405de317416d57cb4b1fb07b360f40291c663f582e17a677fa44b3d4726b62b619e711d89fb4a253ff7376be26144259b8bf85c4a31b0446d457d4ac47ad25757c6522a806775fa5524934a878999baafe22ef3ec5bca27bafaea023b8f01699b775656332a417d490929c982f22dade3eb2d4e254d25e4f7bfe5132fd7c1fdd716d0d7f51346adef57a24c63f035e1fdaae1611c61149e43fe1c54643f44bb367ab5352520c4fc79a9dbc343e75ca0932c4d1af74242c83b29c9c540012e433abecbd97d4fce5e0b48de2c97bb30a3cde260d1a5529e1a6867dd40fd506a3b032d200f07a082d121688c9fa84d08b3ddb0761bdc87ed7961debff769b560eda8e4fd7a568b79dc8c43999f569b226dd872e8684daa9a33350259b35dc8179e454df67f22842ac00f552d428e46301151692b84da67f7b47aa847c67415fe30d078f02222a5008082ac4dcc9a3b096270c10bb96fb93ddc9bbdb89e94339e5c38a11025841e3db4692226d698de645a2521519b6cb0c2747a5affb304a1743c5fffd99649713a732de0f99909b839b3d13b87af428597891a115e6e286144e5039eda357f227f068299820bc6cf28abe86a5c61b19e1221a3a207c3d4f72d72e9c7c52517884b90edc2eb490712bf70d0ab6b412654a1b6ff03ab</script></div>
<script src="/lib/blog-encrypt.js"></script><link href="/css/blog-encrypt.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>PC</category>
      </categories>
      <tags>
        <tag>online</tag>
        <tag>game</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo + inside åšå®¢ä¸ªæ€§åŒ–å®šåˆ¶</title>
    <url>/posts/Hexo-inside%E4%B8%AA%E6%80%A7%E5%8C%96%E5%AE%9A%E5%88%B6/</url>
    <content><![CDATA[<p><a href="https://blog.fiteen.top/" target="_blank">æˆ‘çš„åšå®¢</a>é‡‡ç”¨çš„æ˜¯ <a href="https://hexo.io/themes/" target="_blank">Hexo å®˜æ–¹ç½‘ç«™</a>ä¸Šç›¸ä¸­çš„ <a href="https://github.com/ikeq/hexo-theme-inside" target="_blank">hexo+theme+inside</a> ä¸»é¢˜ã€‚è™½ç„¶å¼€å‘è€…å·²ç»æä¾›äº†ä¸»é¢˜çš„<a href="https://blog.oniuo.com/theme-inside" target="_blank">ä½¿ç”¨æ–‡æ¡£</a>ï¼Œä½†æ˜¯ä½œä¸ºä¸€æ¬¾å°ä¼—çš„ä¸»é¢˜ï¼Œä¸€äº›å¸¸ç”¨åŠŸèƒ½çš„å®šåˆ¶å¹¶ä¸æ˜¯é‚£ä¹ˆå®Œå–„ï¼Œä¸è¿‡è´´å¿ƒçš„å¼€å‘è€…æä¾›äº† <a href="https://blog.oniuo.com/theme-inside/docs/misc#plugins" target="_blank">plugins é…ç½®æ–¹æ¡ˆ</a>ã€‚</p>
<a id="more"></a>
<p>ä¸‹æ–‡æ€»ç»“äº†éƒ¨åˆ†åŠŸèƒ½çš„æ‹“å±•æ–¹æ¡ˆï¼Œå¯ä¾›éœ€è¦çš„æœ‹å‹å‚è€ƒã€‚</p>
<blockquote>
<p><strong>æ³¨æ„</strong>ï¼šinside v2.6.3 ä¹‹å‰ä¼šå‡ºç°<strong>æ–‡ç« ä¸­ç‚¹å‡»ä¸Š/ä¸‹ä¸€ç¯‡æ—¶ï¼Œæ’ä»¶æ— æ³•ç”Ÿæ•ˆçš„æƒ…å†µ</strong>ã€‚<br>
å…¶åŸå› æ˜¯<strong>ä¸»é¢˜æ’ä»¶æ¨¡å—å­˜åœ¨ç»„ä»¶ç¼“å­˜é—®é¢˜ï¼Œå¯¼è‡´åˆ‡æ¢é¡µé¢æ—¶ js æ‰§è¡Œå¤±è´¥</strong>ï¼Œä¸ºäº†ä¿éšœåŠŸèƒ½æ­£å¸¸ä½¿ç”¨ï¼Œè¯·åŠ¡å¿…å°†ä¸»é¢˜å‡çº§åˆ°<a href="https://github.com/ikeq/hexo-theme-inside/releases" target="_blank">æœ€æ–°ç‰ˆæœ¬</a>ã€‚ï¼ˆ2020.03.14 æ›´æ–°ï¼‰</p>
</blockquote>
<h2 id="plugin-å‰ç½®å‡†å¤‡">plugin å‰ç½®å‡†å¤‡<a title="#plugin-å‰ç½®å‡†å¤‡" href="#plugin-å‰ç½®å‡†å¤‡"></a></h2>
<p><code>themes/inside/_config.yml</code> ä¸­çš„ plugins æ”¯æŒäºç‰¹å®šä½ç½®åŠ¨æ€æ’å…¥å¯æ‰§è¡Œçš„ä»£ç ç‰‡æ®µï¼Œæˆ–å…¨å±€åŠ è½½è„šæœ¬/æ ·å¼ã€‚</p>
<p>æ”¯æŒé€šè¿‡å®‰è£… html-minifierã€babel å’Œ uglify-js æ¥å®ç°ä»£ç å‹ç¼©ã€‚ åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼ˆHexo æ ¹ç›®å½•ï¼Œé <code>themes/inside</code>ï¼‰ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install </span><span class="keyword">babel-core </span><span class="keyword">babel-preset-env </span>html-minifier uglify-<span class="keyword">js </span>--save</span><br></pre></td></tr></table></figure>
<h2 id="font-awesome">Font Awesome<a title="#font-awesome" href="#font-awesome"></a></h2>
<p>æŒ‰ç…§ plugin é…ç½®æè¿°çš„ï¼Œè¦æ”¯æŒ Font Awesome çš„ CSSï¼Œåªéœ€è¦è¿™æ ·è®¾ç½®ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">_config.ymlplugins:</span><br><span class="line">  - <span class="regexp">//</span>netdna.bootstrapcdn.com<span class="regexp">/font-awesome/</span><span class="number">4.7</span>.<span class="number">0</span><span class="regexp">/css/</span>font-awesome.min.css</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯åœ¨å…¨å±€åŠ è½½æ ·å¼ï¼Œ<s>ä¸è¿‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰æ­£å¸¸ç”Ÿæ•ˆğŸ¤”</s>ï¼ˆ<strong><a href="https://github.com/ikeq/hexo-theme-inside/releases/tag/2.6.1" target="_blank">inside-v2.6.1</a> å·²ç»ä¿®å¤äº†è¿™ä¸ªé—®é¢˜</strong>ï¼Œå»ºè®®ä½ å‡çº§åˆ°<a href="https://github.com/ikeq/hexo-theme-inside/releases" target="_blank">æœ€æ–°ç‰ˆæœ¬</a>ï¼‰ã€‚</p>
<blockquote>
<p>å¦‚æœä½ æ˜¯ v2.6.0 åŠä»¥ä¸‹ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ¡ˆè§£å†³ï¼š</p>
<p>åœ¨ <code>themes/inside/layout/index.swig</code> çš„ `` æ ‡ç­¾å†…åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">index.swig&lt;link <span class="attribute">href</span>=<span class="string">"//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"</span> <span class="attribute">rel</span>=<span class="string">"stylesheet"</span>&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼Œè™½ç„¶å›¾æ ‡æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œä½†æ˜¯æ ·å¼è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œå¯èƒ½å’Œä¸»é¢˜æœ¬èº«çš„ CSS æœ‰å…³ç³»ï¼Œæ‰¾åˆ° <code>source</code> ç›®å½•ä¸‹çš„ <code>styles.e4da61f53c7bc99becf4.css</code>ï¼ˆä¹Ÿå¯èƒ½å«åˆ«çš„ï¼‰ é‡Œçš„ <code>.fa</code>ï¼Œåˆ é™¤é‡Œé¢çš„ <code>margin:10rem 0 3rem;</code> ã€‚</p>
<p><img src="https://blog.fiteen.top/2020/hexo-theme-inside-plugin/alter-style-css.png" alt="ä¿®æ”¹ .fa æ ·å¼" class="Ï†cx"></p>
</blockquote>
<p>ä¸è¿‡ä¸ªäººè§‰å¾—æ”¾åœ¨ CDN ä¸Šè®¿é—®é€Ÿåº¦è¿˜æ˜¯æœ‰ç‚¹æ…¢ï¼Œæ‰€ä»¥ä»å®˜ç½‘<a href="http://fontawesome.io/" target="_blank">ä¸‹è½½</a>æœ€æ–°ç‰ˆæ”¾åœ¨ä¸»é¢˜çš„ <code>source/lib</code> ç›®å½•ä¸‹ï¼Œå…¨å±€å¼•ç”¨ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line">_config.<span class="symbol">ymlplugins:</span></span><br><span class="line">  - <span class="class"><span class="keyword">lib</span>/<span class="title">font</span>-<span class="title">awesome</span>/<span class="title">css</span>/<span class="title">font</span>-<span class="title">awesome</span>.<span class="title">min</span>.<span class="title">css</span></span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…åœ¨éœ€è¦çš„ä½ç½®å¼•ç”¨ CSS èµ„æºï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;link <span class="attribute">href</span>=<span class="string">"lib/font-awesome/css/font-awesome.min.css"</span> <span class="attribute">rel</span>=<span class="string">"stylesheet"</span>&gt;</span><br></pre></td></tr></table></figure>
<h2 id="è®¿é—®é‡ç»Ÿè®¡">è®¿é—®é‡ç»Ÿè®¡<a title="#è®¿é—®é‡ç»Ÿè®¡" href="#è®¿é—®é‡ç»Ÿè®¡"></a></h2>
<p>å¾ˆå¤šäººéƒ½æœ‰ç«™ç‚¹è®¿é—®é‡ç»Ÿè®¡çš„éœ€æ±‚ï¼Œåƒè¿™æ ·ï¼š</p>
<p><img src="https://blog.fiteen.top/2020/hexo-theme-inside-plugin/busuanzi-example.png" alt="è®¿é—®é‡ç»Ÿè®¡æ•ˆæœ" class="Ï†cx"></p>
<p>æˆ‘é‡‡ç”¨çš„æ˜¯è½»é‡çš„<a href="http://ibruce.info/2015/04/04/busuanzi/" target="_blank">ä¸è’œå­ç»Ÿè®¡</a>æ¥åšè®¿é—®é‡ç»Ÿè®¡ã€‚</p>
<p>å…ˆ<strong>å®‰è£…è„šæœ¬</strong>ï¼Œåœ¨ä½¿ç”¨ä¸è’œå­çš„é¡µé¢ï¼Œä¹Ÿå°±æ˜¯ <code>sidebar</code> æ¨¡å—æ’å…¥ <code>busuanzi.js</code>ã€‚</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">_config.ymlplugins:</span><br><span class="line">  - position: sidebar</span><br><span class="line">    template: |</span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å†<strong>å®‰è£…æ ‡ç­¾</strong>ï¼Œå®˜æ–¹ç»™å‡ºäº†ç«™ç‚¹ PV/UV çš„ç»Ÿè®¡ä»£ç ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_container_site_pv"</span>&gt;</span>æœ¬ç«™æ€»è®¿é—®é‡<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_pv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>æ¬¡<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_container_site_uv"</span>&gt;</span>æœ¬ç«™è®¿å®¢æ•°<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>äººæ¬¡<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½ ä¹Ÿå¯ä»¥ç”¨è¿™ä¸¤ä¸ª id æ¥æ˜¾ç¤ºè®¿é—®æ•°ï¼š</p>
<ul>
<li><code>busuanzi_value_site_pv</code>ï¼šå¼‚æ­¥å›å¡«è®¿é—®æ•°</li>
<li><code>busuanzi_container_site_pv</code>ï¼šä¸ºé˜²æ­¢è®¡æ•°æœåŠ¡è®¿é—®å‡ºé”™æˆ–è¶…æ—¶ï¼ˆ3 ç§’ï¼‰çš„æƒ…å†µä¸‹ï¼Œä½¿æ•´ä¸ªæ ‡ç­¾è‡ªåŠ¨éšè—æ˜¾ç¤º</li>
</ul>
<p>åœ¨ <code>_config.yml</code> æ–‡ä»¶é‡Œæ‰¾åˆ° <code>footer</code> ä¸‹çš„ <code>custom</code>ï¼Œå†™å…¥ç›¸å…³çš„ html ä»£ç ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">_config.yml# Custom text</span><br><span class="line">custom: <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_container_site_uv"</span> <span class="attr">style</span>=<span class="string">'display:none'</span>&gt;</span>Total <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> visitors. <span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_container_site_pv"</span> <span class="attr">style</span>=<span class="string">'display:none'</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_pv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span> Views<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ä½¿ç”¨ font-awesome å­—ä½“ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">_config.yml# Custom text</span><br><span class="line">custom: &lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_container_site_pv"</span> <span class="attribute">style</span>=<span class="string">'display:none'</span>&gt;&lt;i <span class="attribute">class</span>=<span class="string">"fa fa-eye"</span>&gt;&lt;/i&gt; &lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_value_site_pv"</span>&gt;&lt;/span&gt;&lt;/span&gt; ï½œ &lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_container_site_uv"</span> <span class="attribute">style</span>=<span class="string">'display:none'</span>&gt;&lt;i <span class="attribute">class</span>=<span class="string">"fa fa-user"</span>&gt;&lt;/i&gt; &lt;span <span class="attribute">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;&lt;/span&gt;&lt;/span&gt;</span><br></pre></td></tr></table></figure>
<h2 id="ä»£ç å¤åˆ¶">ä»£ç å¤åˆ¶<a title="#ä»£ç å¤åˆ¶" href="#ä»£ç å¤åˆ¶"></a></h2>
<p>ä¸ºäº†æ–¹ä¾¿åšå®¢çš„è¯»è€…å¼•ç”¨ä»£ç ï¼Œå¯ä»¥åœ¨æ–‡ç« ä¸­ä»£ç å—çš„å³ä¸Šè§’åŠ ä¸€ä¸ªå¤åˆ¶æŒ‰é’®ï¼Œå¦‚ï¼š</p>
<p><img src="https://blog.fiteen.top/2020/hexo-theme-inside-plugin/clipboard-example.png" alt="ä»£ç å—å¤åˆ¶æŒ‰é’®æ•ˆæœ" class="Ï†cx"></p>
<p>å®ƒçš„å®ç°æ˜¯åœ¨é¡µé¢åŠ è½½å®Œæ¯•åï¼Œä½¿ç”¨ js åŠ¨æ€ä¸ºæ¯ä¸ªä»£ç å—æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œå½“é¼ æ ‡æ»‘åŠ¨åˆ°ä»£ç å—ä¸Šæ—¶æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®æ—¶å¤åˆ¶ä»£ç å—é‡Œçš„å†…å®¹ã€‚å› æ­¤éœ€è¦ä¸‰ä¸ªæ–‡ä»¶ï¼š</p>
<ul>
<li><strong>å®ç°å¤åˆ¶ä»£ç å—åŠŸèƒ½</strong>çš„æ–‡ä»¶ <code>clipboard.js</code>ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¼•ç”¨è¿™ä¸ªæ–‡ä»¶ï¼š <code>https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.js</code>ã€‚</li>
<li>æ”¯æŒ<strong>åŠ¨æ€åˆ›å»ºå¤åˆ¶æŒ‰é’®</strong>çš„æ–‡ä»¶ <code>clipboard-use.js</code></li>
<li>å¤åˆ¶æŒ‰é’®çš„<strong>æ ·å¼</strong>æ–‡ä»¶ <code>clipboard.css</code></li>
</ul>
<p>é¡µé¢è½½å…¥å®Œæˆåï¼Œåˆ›å»ºä¸€ä¸ªå¤åˆ¶æŒ‰é’®ï¼Œä¸Šé¢ç”¨ font-awesome çš„ clipboard å›¾æ ‡ï¼Œå®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">clipboard-use.js!<span class="function"><span class="keyword">function</span> (<span class="params">e, t, a</span>) </span>&#123;</span><br><span class="line">  <span class="comment">/* code */</span></span><br><span class="line">  <span class="keyword">var</span> initCopyCode = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> copyHtml = <span class="string">'&lt;button class="btn-copy" data-clipboard-snippet=""&gt;&lt;i class="fa fa-clipboard"&gt;&lt;/i&gt;&lt;/button&gt;'</span>;</span><br><span class="line">    $(<span class="string">".highlight .code pre"</span>).before(copyHtml);</span><br><span class="line">    <span class="keyword">new</span> ClipboardJS(<span class="string">'.btn-copy'</span>, &#123;</span><br><span class="line">      target: <span class="function"><span class="keyword">function</span> (<span class="params">trigger</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> trigger.nextElementSibling;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  initCopyCode();</span><br><span class="line">&#125;(<span class="built_in">window</span>, <span class="built_in">document</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œ <code>clipboard-use.js</code> ä¸­éœ€è¦ç”¨åˆ° <code>jQuery</code>ï¼Œè€Œ inside é‡Œæ²¡æœ‰å¼•å…¥ï¼Œæ•…éœ€è¦æ‰‹åŠ¨å¼•å…¥ã€‚</p>
<p>å¤åˆ¶æŒ‰é’®çš„æ ·å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">clipboard</span><span class="selector-class">.css</span><span class="selector-class">.highlight</span> &#123;</span><br><span class="line">    <span class="comment">/* æ–¹ä¾¿ copy ä»£ç æŒ‰é’®ï¼ˆbtn-copyï¼‰çš„å®šä½ */</span></span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">border-width</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">background</span>: none;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">-webkit-tap-highlight-color</span>: transparent;</span><br><span class="line">    <span class="attribute">-webkit-appearance</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btn-copy</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">5px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.highlight</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.btn-copy</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤åˆ¶æŒ‰é’®å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½è®¾ç½®ï¼Œå¦‚æœæƒ³ç®€å•ä¸€ç‚¹ï¼Œç›´æ¥ç”¨æˆ‘çš„æ ·å¼ï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">_config.ymlplugins:</span><br><span class="line">  # inside ä¸»é¢˜æ²¡æœ‰å¼•å…¥ jQuery æ¡†æ¶ï¼Œéœ€è¦æ‰‹åŠ¨å¼•å…¥</span><br><span class="line">  - //cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js</span><br><span class="line">  # æ’ä»¶ç”Ÿæ•ˆèŒƒå›´ï¼špost å’Œ page</span><br><span class="line">  - position: [post, page]</span><br><span class="line">    template: |</span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/clipboard-use.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"//cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.1/clipboard.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"lib/font-awesome/css/font-awesome.min.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœå·²ç»å…¨å±€å¼•ç”¨è¿‡ font-awesomeï¼Œå¯ä»¥æŠŠæœ€åä¸€æ¡å¼•ç”¨åˆ é™¤ã€‚</p>
<h2 id="è¯„è®ºç³»ç»Ÿ---valine">è¯„è®ºç³»ç»Ÿ - Valine<a title="#è¯„è®ºç³»ç»Ÿ---valine" href="#è¯„è®ºç³»ç»Ÿ---valine"></a></h2>
<p>ä¸»é¢˜çš„å†…ç½®è¯„è®ºï¼Œæ”¯æŒ <a href="https://disqus.com/" target="_blank">Disqus</a> å’Œ <a href="https://livere.com/" target="_blank">LiveRe</a>ã€‚ä½†ä¸ªäººè®¤ä¸ºè¿™ä¸¤æ¬¾è¯„è®ºç³»ç»Ÿçš„ UI é£æ ¼ä¸»é¢˜ä¸æ˜¯å¾ˆæ­é…ï¼Œæœ€åè¿˜æ˜¯å†³å®šé‡‡ç”¨ <a href="https://valine.js.org/" target="_blank">Valine</a>â€”â€”ä¸€æ¬¾åŸºäº LeanCloud çš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿã€‚</p>
<p>è™½ç„¶æ–‡æ¡£ä¸­ä¹Ÿæœ‰æä¾› Valine çš„é…ç½®æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘å®è·µåå‘ç°æ ·å¼è²Œä¼¼å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œè¿™æ¡ <a href="https://github.com/ikeq/hexo-theme-inside/issues/153" target="_blank">issue</a> ä¹Ÿè¯å®äº†è¿™ä¸€ç‚¹ï¼ˆ<strong>inside-2.6.1 å·²ä¿®å¤</strong>ï¼‰ã€‚æ‰€ä»¥æˆ‘å¦æ‰¾äº†ä¸€ä¸ª js æ–‡ä»¶ï¼Œå¹¶åšäº†ä¸€ç‚¹å°æ”¹åŠ¨ã€‚ä½ å¯ä»¥å¼•ç”¨æˆ‘æ”¾åœ¨ CDN ä¸Šçš„èµ„æº <code>https://cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/valine.js</code>ï¼Œæˆ–è€…ç›´æ¥æŠŠ <code>valine.js</code> æ–‡ä»¶<a href="https://github.com/fiteen/fiteen.github.io/releases" target="_blank">ä¸‹è½½</a>åˆ°æœ¬åœ°ï¼Œæ”¾åœ¨ <code>inside/source/lib</code>è·¯å¾„ä¸‹ã€‚ç„¶åå†™å…¥ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">_config.ymlplugin<span class="variable">s:</span></span><br><span class="line">  # inside ä¸»é¢˜æ²¡æœ‰å¼•å…¥ jQuery æ¡†æ¶ï¼Œéœ€è¦æ‰‹åŠ¨å¼•å…¥</span><br><span class="line">  - //cdnjs.loli.net/ajax/libs/jquery/<span class="number">3.2</span>.<span class="number">1</span>/jquery.<span class="built_in">min</span>.js</span><br><span class="line">  - //cdn1.lncld.net/static/js/<span class="number">3.0</span>.<span class="number">4</span>/av-<span class="built_in">min</span>.js</span><br><span class="line">  # å¼•ç”¨æœ¬åœ° <span class="keyword">source</span>/lib è·¯å¾„ä¸‹çš„ valine.js æ–‡ä»¶</span><br><span class="line">  # - lib/valine.js</span><br><span class="line">  # å¼•ç”¨ CDN ä¸Šçš„ valine.js æ–‡ä»¶</span><br><span class="line">  - //cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.<span class="number">1.0</span>/valine.js</span><br><span class="line">  - position: comments</span><br><span class="line">    template: |</span><br><span class="line">      &lt;div id=<span class="string">"vcomment"</span>&gt;&lt;/div&gt;</span><br><span class="line">      <span class="symbol">&lt;script&gt;</span></span><br><span class="line">        <span class="keyword">new</span> Valine(&#123;</span><br><span class="line">          <span class="keyword">e</span><span class="variable">l:</span> <span class="string">'#vcomment'</span>,</span><br><span class="line">          <span class="keyword">lan</span><span class="variable">g:</span> <span class="string">'en'</span>,</span><br><span class="line">          admin_emai<span class="variable">l:</span> <span class="string">'Your EMAIL'</span>,</span><br><span class="line">          appId: <span class="string">'Your APP ID'</span>,</span><br><span class="line">          appKey: <span class="string">'Your APP KEY'</span>,</span><br><span class="line">          placeholder: <span class="string">'Write a Comment'</span>,</span><br><span class="line">          emoticon_ur<span class="variable">l:</span><span class="string">'https://cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@0.1.0/alu'</span>,</span><br><span class="line">          emoticon_lis<span class="variable">t:</span>[<span class="string">"å.png"</span>,<span class="string">"å–·è¡€.png"</span>,<span class="string">"ç‹‚æ±—.png"</span>,<span class="string">"ä¸è¯´è¯.png"</span>,<span class="string">"æ±—.png"</span>,<span class="string">"åç­‰.png"</span>,<span class="string">"çŒ®èŠ±.png"</span>,<span class="string">"ä¸é«˜å…´.png"</span>,<span class="string">"ä¸­åˆ€.png"</span>,<span class="string">"å®³ç¾.png"</span>,<span class="string">"çš±çœ‰.png"</span>,<span class="string">"å°çœ¼ç›.png"</span>,<span class="string">"ä¸­æŒ‡.png"</span>,<span class="string">"å°´å°¬.png"</span>,<span class="string">"ç…ä½ .png"</span>,<span class="string">"æƒ³ä¸€æƒ³.png"</span>,<span class="string">"ä¸­æª.png"</span>,<span class="string">"å¾—æ„.png"</span>,<span class="string">"è‚¿åŒ….png"</span>,<span class="string">"æ‰‡è€³å…‰.png"</span>,<span class="string">"äº²äº².png"</span>,<span class="string">"æƒŠå–œ.png"</span>,<span class="string">"è„¸çº¢.png"</span>,<span class="string">"æ— æ‰€è°“.png"</span>,<span class="string">"ä¾¿ä¾¿.png"</span>,<span class="string">"æ„¤æ€’.png"</span>,<span class="string">"èœ¡çƒ›.png"</span>,<span class="string">"çŒ®é»„ç“œ.png"</span>,<span class="string">"å†…ä¼¤.png"</span>,<span class="string">"æŠ•é™.png"</span>,<span class="string">"è§‚å¯Ÿ.png"</span>,<span class="string">"çœ‹ä¸è§.png"</span>,<span class="string">"å‡»æŒ.png"</span>,<span class="string">"æŠ é¼».png"</span>,<span class="string">"é‚ªæ¶.png"</span>,<span class="string">"çœ‹çƒ­é—¹.png"</span>,<span class="string">"å£æ°´.png"</span>,<span class="string">"æŠ½çƒŸ.png"</span>,<span class="string">"é”çœ‰.png"</span>,<span class="string">"è£…å¤§æ¬¾.png"</span>,<span class="string">"åèˆŒ.png"</span>,<span class="string">"æ— å¥ˆ.png"</span>,<span class="string">"é•¿è‰.png"</span>,<span class="string">"èµä¸€ä¸ª.png"</span>,<span class="string">"å‘²ç‰™.png"</span>,<span class="string">"æ— è¯­.png"</span>,<span class="string">"é˜´æš—.png"</span>,<span class="string">"ä¸å‡ºæ‰€æ–™.png"</span>,<span class="string">"å’½æ°”.png"</span>,<span class="string">"æœŸå¾….png"</span>,<span class="string">"é«˜å…´.png"</span>,<span class="string">"åè¡€å€’åœ°.png"</span>,<span class="string">"å“­æ³£.png"</span>,<span class="string">"æ¬¢å‘¼.png"</span>,<span class="string">"é»‘çº¿.png"</span>,<span class="string">"å–œæè€Œæ³£.png"</span>,<span class="string">"å–·æ°´.png"</span>,<span class="string">"æ·±æ€.png"</span>,<span class="string">"é¼“æŒ.png"</span>,<span class="string">"æš—åœ°è§‚å¯Ÿ.png"</span>],</span><br><span class="line">        &#125;)</span><br><span class="line">      &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å…³äºä¸Šé¢çš„å‚æ•°ä»‹ç»ï¼š</p>
<ul>
<li><strong>lang</strong>ï¼šé€‰å¡«ï¼Œç›®å‰æ”¯æŒè‹±æ–‡ç‰ˆ <code>en</code> å’Œä¸­æ–‡ç‰ˆ <code>zh-cn</code> ä¸¤ç§ï¼Œé»˜è®¤æ˜¯ <code>zh-cn</code>ã€‚</li>
<li><strong>admin_email</strong>ï¼šé€‰å¡«ï¼Œè®¾ç½®ä½œè€…é‚®ç®±ï¼Œä½¿ç”¨è¯¥é‚®ç®±è´¦å·è¯„è®ºæˆ–å›å¤ï¼Œè¯„è®ºè€…åå­—å³ä¾§ä¼šå‡ºç°ä¸€ä¸ªäººå½¢å°å›¾æ ‡æ ‡è¯†ä½œè€…ã€‚</li>
<li><strong>appId&amp;appKey</strong>ï¼šå¿…å¡«ï¼ŒLeanCloud ä¸­åˆ›å»ºåº”ç”¨å¾—åˆ°çš„ <code>APP ID</code> å’Œ <code>APP KEY</code>ï¼Œåˆ›å»ºæ–¹å¼å‚ç…§<a href="https://ioliu.cn/2017/add-valine-comments-to-your-blog/" target="_blank">æ­¤æ–‡</a>ã€‚</li>
<li><strong>emoticon_url</strong>ï¼šå¿…å¡«ï¼Œè¿™é‡Œè®¾ç½®ä¸€ä¸ªè¡¨æƒ…åŒ… CDN è·¯å¾„ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å–œæ¬¢çš„è¡¨æƒ…åŒ…ã€‚</li>
<li><strong>emoticon_list</strong>ï¼šå¿…å¡«ï¼Œ<code>emoticon_url</code>é‡ŒåŒ…å«çš„è¡¨æƒ…åŒ…ä¸­éœ€è¦æ˜¾ç¤ºåœ¨è¯„è®ºåŒºçš„è¡¨æƒ…åŒ…åç§°åˆ—è¡¨ã€‚</li>
</ul>
<p><img src="https://blog.fiteen.top/2020/hexo-theme-inside-plugin/valine-comment-example.png" alt="è¯„è®ºåŒºæ•ˆæœ" class="Ï†cx"></p>
<p>è¿™å°±æ˜¯é…ç½®æˆåŠŸåçš„è¯„è®ºæ¡†æ•ˆæœã€‚</p>
<p>ç›®å‰å·²ç»æœ‰ Valine è¯„è®ºç³»ç»Ÿçš„æ‹“å±•å’Œå¢å¼ºç‰ˆ <a href="https://github.com/DesertsP/Valine-Admin.git" target="_blank">Valine+Admin</a>ï¼Œä¸»è¦å®ç°è¯„è®ºé‚®ä»¶é€šçŸ¥ã€è¯„è®ºç®¡ç†ã€åƒåœ¾è¯„è®ºè¿‡æ»¤ç­‰åŠŸèƒ½ï¼Œè¿˜æ”¯æŒè‡ªå®šä¹‰ä¿®æ”¹é‚®ä»¶é€šçŸ¥æ¨¡æ¿ã€æ¼å‘é‚®ä»¶è‡ªåŠ¨è¡¥å‘ç­‰ã€‚å…·ä½“æ­¥éª¤è¿™ç¯‡<a href="https://deserts.io/valine-admin-document/" target="_blank">é…ç½®æ‰‹å†Œ</a>å·²ç»æ¯”è¾ƒæ¸…æ™°äº†ï¼Œç…§ç€ä¸Šé¢çš„æ­¥éª¤æ“ä½œå³å¯ï¼Œæœ¬æ–‡å°±ä¸å¤åˆ¶ç²˜è´´äº†ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼šæƒ³è¦åœ¨è¯„è®ºåŒºæ˜¾ç¤ºè‡ªå®šä¹‰å¤´åƒï¼Œå…ˆå‰å¾€<a href="http://cn.gravatar.com/" target="_blank">Gravatar å®˜ç½‘</a>æ³¨å†Œè´¦å·ï¼Œæ³¨å†Œçš„é‚®ç®±éœ€è¦å’Œä½ è¯„è®ºæ—¶å¡«å†™çš„é‚®ç®±ä¸€è‡´ã€‚å¦‚æœæ³¨å†ŒæˆåŠŸåï¼Œå¤´åƒä»æ²¡æœ‰æ˜¾ç¤ºï¼Œä¸è¦ç€æ€¥ï¼Œ <code>gravatar.cat.net</code> æœ‰ä¸ƒå¤©çš„ç¼“å­˜æœŸï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚</p>
<p>ä¸‹é¢å†åˆ†äº«å‡ ä¸ª<strong>å°åŠŸèƒ½ç‚¹çš„é…ç½®</strong>ï¼š</p>
<h2 id="åšå®¢èƒŒæ™¯">åšå®¢èƒŒæ™¯<a title="#åšå®¢èƒŒæ™¯" href="#åšå®¢èƒŒæ™¯"></a></h2>
<p>ä¿®æ”¹åšå®¢èƒŒæ™¯å¾ˆç®€å•ï¼Œåªéœ€ä¿®æ”¹ <code>themes/inside/_config.yml</code> ä¸­ <code>appearance.background</code> é…ç½®å³å¯ã€‚</p>
<p>è¿™é‡Œåˆ†äº«ä¸€ä¸ªç½‘ç«™â€”â€”<a href="https://www.toptal.com/designers/subtlepatterns/" target="_blank">Subtle Patterns</a>ï¼Œæ”¯æŒè¶…è¿‡ 500 ç§ PNG é«˜å“è´¨å…è´¹èƒŒæ™¯çº¹ç†ç´ æï¼Œæ— é¡»æ³¨å†Œç™»å½•ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ã€‚</p>
<h2 id="åšå®¢å­—ä½“">åšå®¢å­—ä½“<a title="#åšå®¢å­—ä½“" href="#åšå®¢å­—ä½“"></a></h2>
<p>ä½ å¯èƒ½ä¼šå‘ç°éƒ¨ç½²å¥½çš„åšå®¢é¦–æ¬¡åŠ è½½æ—¶çš„å­—ä½“æ•ˆæœç”Ÿæ•ˆæ¯”è¾ƒæ…¢ï¼Œè¿™æ˜¯å› ä¸ºä¸»é¢˜ä¸­é»˜è®¤é…ç½®çš„å­—ä½“æ ·å¼ç”¨çš„æ˜¯è°·æ­Œçš„æœåŠ¡ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">_config<span class="selector-class">.ymlappearance</span>:</span><br><span class="line">  <span class="attribute">font</span>:</span><br><span class="line">    url: <span class="comment">//fonts.googleapis.com/css?family=Baloo+Bhaijaan|Inconsolata|Josefin+Sans|Montserrat</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœè¢«å¢™äº†å°±æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸ªè®¿é—®æ›´å¿«çš„åœ°å€ï¼Œå¦‚ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">_config<span class="selector-class">.ymlappearance</span>:</span><br><span class="line">  <span class="attribute">font</span>:</span><br><span class="line">    url: <span class="comment">//cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/font.css</span></span><br></pre></td></tr></table></figure>
<h2 id="åˆ†äº«-qq-é“¾æ¥">åˆ†äº« QQ é“¾æ¥<a title="#åˆ†äº«-qq-é“¾æ¥" href="#åˆ†äº«-qq-é“¾æ¥"></a></h2>
<p>æˆ‘ä»¬å¯ä»¥åœ¨ <code>sns.qq</code> é‡Œé…ç½®è‡ªå·±æƒ³è¦é“¾æ¥çš„ QQ ID ä¿¡æ¯ï¼Œç›´æ¥å†™ QQ å·å½“ç„¶æ˜¯ä¸å¯è¡Œçš„ã€‚éœ€è¦å…ˆå¼€é€š <a href="https://shang.qq.com/v3/widget.html" target="_blank">QQ æ¨å¹¿</a>ã€‚</p>
<p><img src="https://blog.fiteen.top/2020/hexo-theme-inside-plugin/qq-link.png" alt="img" class="Ï†cx"></p>
<p><a>Â æ ‡ç­¾é‡Œçš„Â hrefÂ å°±æ˜¯ä½ çš„Â QQ å·åˆ†äº«é“¾æ¥ï¼Œå½¢å¦‚ï¼š<a href="https://wpa.qq.com/msgrd?v=3&amp;uin=$%7BYOUR-QQ-ID%7D&amp;site=qq&amp;menu=yes%E3%80%82" target="_blank" rel="noopener">https://wpa.qq.com/msgrd?v=3&amp;uin=${YOUR-QQ-ID}&amp;site=qq&amp;menu=yesã€‚</a></p>
<p>å¦‚æœä½ è¦<strong>åˆ†äº«ç¾¤å·</strong>ï¼Œé€šè¿‡<a href="https://qun.qq.com/join.html" target="_blank">åŠ ç¾¤ç»„ä»¶</a>ï¼Œæ‹¿åˆ°å½¢å¦‚ï¼š<code>https://shang.qq.com/wpa/qunwpa?idkey=${YOUR-GROUP-ID-KEY}</code> çš„é“¾æ¥ã€‚</p>
<h2 id="é…ç½®-rss">é…ç½® RSS<a title="#é…ç½®-rss" href="#é…ç½®-rss"></a></h2>
<p>æ¯”è¾ƒç®€å•ï¼Œ<a href="https://blog.oniuo.com/theme-inside/docs/basic#sns" target="_blank">æ–‡æ¡£</a>ä¸­æœ‰æåˆ°ï¼š</p>
<blockquote>
<p>è‹¥ä½¿ç”¨ hexo-generator-feedï¼Œsns.feed å¯ç•™ç©ºï¼Œä¸»é¢˜ä¼šå°è¯•å– hexo.config.feed.pathã€‚å¯é€šè¿‡æ”¹å˜é¡¹çš„å…ˆåé¡ºåºæ¥è‡ªå®šä¹‰æ’åºã€‚</p>
</blockquote>
<p>å› æ­¤ç›´æ¥åœ¨ç«™ç‚¹æ ¹ç›®å½•ï¼ˆä¸æ˜¯ä¸»é¢˜æ ¹ç›®å½•ï¼‰ä¸‹æ‰§è¡Œå‘½ä»¤å³å¯ï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> hexo-generator-feed <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<h2 id="q-&amp;-a">Q &amp; A<a title="#q-&amp;-a" href="#q-&amp;-a"></a></h2>
<p><strong>é—®é¢˜ 1ï¼šä¸ºä»€ä¹ˆæˆ‘æŒ‰ç…§æ–‡æ¡£è®¾ç½®äº†ï¼ŒåŠ äº†æ’ä»¶è®¾ç½®åï¼Œä¸ä½†æ²¡æœ‰ç”Ÿæ•ˆï¼Œå…¶å®ƒåŠŸèƒ½è¿˜å‡ºäº†é—®é¢˜æˆ–è€…å·¥ç¨‹éƒ½è·‘ä¸èµ·æ¥äº†ï¼Ÿ</strong></p>
<ol>
<li>æ£€æŸ¥ä¸€ä¸‹é…ç½®ä»£ç çš„ç©ºæ ¼ï¼Œyml æ–‡ä»¶å¯¹ä»£ç æ ¼å¼çš„è¦æ±‚æ¯”è¾ƒä¸¥æ ¼ã€‚</li>
<li>æ£€æŸ¥æ˜¯å¦é‡å¤æ·»åŠ äº† <code>plugins:</code>ï¼Œæ·»åŠ å¤šä¸ªæ’ä»¶ä¹Ÿåªéœ€è¦å£°æ˜ä¸€æ¬¡ã€‚</li>
</ol>
<p><strong>é—®é¢˜ 2ï¼šèƒ½å¦å‡ºä¸€ä¸ªå°ç™½æ•™ç¨‹ï¼Ÿ</strong></p>
<p>å¯ä»¥åœ¨è¯„è®ºåŒºæè¿°ä½ çš„é—®é¢˜ï¼Œæˆ‘ä¼šæŠ½ç©ºæ•´ç†åˆ°ä¸€èµ·ï¼Œè¡¥å……åœ¨åšå®¢ä¸­ã€‚</p>
<p><strong>é—®é¢˜ 3ï¼šæˆ‘å¸Œæœ›åšå®¢å¯ä»¥æ”¯æŒæŸæŸåŠŸèƒ½ï¼Œä½†æ˜¯ä¸çŸ¥é“è¯¥æ€ä¹ˆåšï¼Œèƒ½å¦å¸®å¿™å®ç°ä¸€ä¸‹ï¼Ÿ</strong></p>
<p>å¯ä»¥æ <a href="https://github.com/fiteen/fiteen.github.io/issues" target="_blank">issue</a> ç»™æˆ‘ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>C++ä¸­ä¼˜é›…çš„å¼‚æ­¥æ“ä½œ</title>
    <url>/posts/C++%E4%B8%AD%E4%BC%98%E9%9B%85%E7%9A%84%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<p>c++11ä¸­å¢åŠ äº†çº¿ç¨‹ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿çš„åˆ›å»ºçº¿ç¨‹ï¼Œå®ƒçš„åŸºæœ¬ç”¨æ³•æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="built_in">std</span>::<span class="function">thread <span class="title">t</span><span class="params">(f, n + <span class="number">1</span>)</span></span>;</span><br><span class="line">t.join();</span><br></pre></td></tr></table></figure>
<a id="more"></a>ã€€ã€€
<p>â€‹		ä½†æ˜¯çº¿ç¨‹æ¯•ç«Ÿæ˜¯å±äºæ¯”è¾ƒä½å±‚æ¬¡çš„ä¸œè¥¿ï¼Œæœ‰æ—¶å€™ä½¿ç”¨æœ‰äº›ä¸ä¾¿ï¼Œæ¯”å¦‚æˆ‘å¸Œæœ›è·å–çº¿ç¨‹å‡½æ•°çš„è¿”å›ç»“æœçš„æ—¶å€™ï¼Œæˆ‘å°±ä¸èƒ½ç›´æ¥é€šè¿‡thread.join()å¾—åˆ°ç»“æœï¼Œè¿™æ—¶å°±å¿…é¡»å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œåœ¨çº¿ç¨‹å‡½æ•°ä¸­å»ç»™è¿™ä¸ªå˜é‡èµ‹å€¼ï¼Œç„¶åjoin,æœ€åå¾—åˆ°ç»“æœï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¯”è¾ƒç¹ççš„ã€‚c++11è¿˜æä¾›äº†å¼‚æ­¥æ¥å£std::asyncï¼Œé€šè¿‡è¿™ä¸ªå¼‚æ­¥æ¥å£å¯ä»¥å¾ˆæ–¹ä¾¿çš„è·å–çº¿ç¨‹å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚std::asyncä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»è°ƒç”¨çº¿ç¨‹å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªstd::futureï¼Œè¿™ä¸ªfutureä¸­å­˜å‚¨äº†çº¿ç¨‹å‡½æ•°è¿”å›çš„ç»“æœï¼Œå½“æˆ‘ä»¬éœ€è¦çº¿ç¨‹å‡½æ•°çš„ç»“æœæ—¶ï¼Œç›´æ¥ä»futureä¸­è·å–ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä½†æ˜¯æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œ<strong>å…¶å®std::asyncç»™æˆ‘ä»¬æä¾›çš„ä¾¿åˆ©å¯ä¸ä»…ä»…æ˜¯è¿™ä¸€ç‚¹ï¼Œå®ƒé¦–å…ˆè§£è€¦äº†çº¿ç¨‹çš„åˆ›å»ºå’Œæ‰§è¡Œï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™è·å–å¼‚æ­¥æ“ä½œçš„ç»“æœï¼›å…¶æ¬¡å®ƒè¿˜æä¾›äº†çº¿ç¨‹çš„åˆ›å»ºç­–ç•¥ï¼ˆæ¯”å¦‚å¯ä»¥é€šè¿‡å»¶è¿ŸåŠ è½½çš„æ–¹å¼å»åˆ›å»ºçº¿ç¨‹ï¼‰</strong>ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä»¥å¤šç§æ–¹å¼å»åˆ›å»ºçº¿ç¨‹ã€‚åœ¨ä»‹ç»asyncå…·ä½“ç”¨æ³•ä»¥åŠä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»ºä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯´ä¸€è¯´std::futureã€std::promiseå’Œstd::packaged_taskã€‚</p>
<h2 id="std::futur">std::futur<a title="#std::futur" href="#std::futur"></a></h2>
<p>std::futureæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨ä¹Ÿå¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œç®€å•è¯´std::futureæä¾›äº†ä¸€ç§è®¿é—®å¼‚æ­¥æ“ä½œç»“æœçš„æœºåˆ¶ã€‚ä»å­—é¢æ„æ€æ¥ç†è§£ï¼Œå®ƒè¡¨ç¤ºæœªæ¥ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªåå­—éå¸¸è´´åˆ‡ï¼Œå› ä¸ºä¸€ä¸ªå¼‚æ­¥æ“ä½œæˆ‘ä»¬æ˜¯ä¸å¯èƒ½é©¬ä¸Šå°±è·å–æ“ä½œç»“æœçš„ï¼Œåªèƒ½åœ¨æœªæ¥æŸä¸ªæ—¶å€™è·å–ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»¥åŒæ­¥ç­‰å¾…çš„æ–¹å¼æ¥è·å–ç»“æœï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢futureçš„çŠ¶æ€ï¼ˆfuture_statusï¼‰æ¥è·å–å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚future_statusæœ‰ä¸‰ç§çŠ¶æ€ï¼š</p>
<ul>
<li>deferredï¼šå¼‚æ­¥æ“ä½œè¿˜æ²¡å¼€å§‹</li>
<li>readyï¼šå¼‚æ­¥æ“ä½œå·²ç»å®Œæˆ</li>
<li>timeoutï¼šå¼‚æ­¥æ“ä½œè¶…æ—¶</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//æŸ¥è¯¢futureçš„çŠ¶æ€</span></span><br><span class="line"><span class="built_in">std</span>::future_status status;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        status = future.wait_for(<span class="built_in">std</span>::chrono::seconds(<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span> (status == <span class="built_in">std</span>::future_status::deferred) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"deferred\n"</span>; <span class="comment">//ä»£è¡¨å»¶è¿Ÿæ‰§è¡Œ</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status == <span class="built_in">std</span>::future_status::timeout) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"timeout\n"</span>;  <span class="comment">//ä»£è¡¨æ‰§è¡Œä¸­</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status == <span class="built_in">std</span>::future_status::ready) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ready!\n"</span>;   <span class="comment">//ä»£è¡¨å·²ç»æ‰§è¡Œå®Œæˆ</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (status != <span class="built_in">std</span>::future_status::ready);</span><br></pre></td></tr></table></figure>
<p>è·å–futureç»“æœæœ‰ä¸‰ç§æ–¹å¼ï¼šgetã€waitã€wait_forï¼Œå…¶ä¸­getç­‰å¾…å¼‚æ­¥æ“ä½œç»“æŸå¹¶è¿”å›ç»“æœï¼Œwaitåªæ˜¯ç­‰å¾…å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œwait_foræ˜¯è¶…æ—¶ç­‰å¾…è¿”å›ç»“æœã€‚</p>
<h2 id="std::promise">std::promise<a title="#std::promise" href="#std::promise"></a></h2>
<p>std::promiseä¸ºè·å–çº¿ç¨‹å‡½æ•°ä¸­çš„æŸä¸ªå€¼æä¾›ä¾¿åˆ©ï¼Œåœ¨çº¿ç¨‹å‡½æ•°ä¸­ç»™å¤–é¢ä¼ è¿›æ¥çš„promiseèµ‹å€¼ï¼Œå½“çº¿ç¨‹å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åå°±å¯ä»¥é€šè¿‡promisè·å–è¯¥å€¼äº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å–å€¼æ˜¯é—´æ¥çš„é€šè¿‡promiseå†…éƒ¨æä¾›çš„futureæ¥è·å–çš„ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">std</span>::promise&lt;<span class="keyword">int</span>&gt; pr;</span><br><span class="line"><span class="built_in">std</span>::<span class="function">thread <span class="title">t</span><span class="params">([](<span class="built_in">std</span>::promise&lt;<span class="keyword">int</span>&gt;&amp; p)&#123; p.set_value_at_thread_exit(<span class="number">9</span>); &#125;,<span class="built_in">std</span>::ref(pr))</span></span>;</span><br><span class="line"><span class="built_in">std</span>::future&lt;<span class="keyword">int</span>&gt; f = pr.get_future();</span><br><span class="line"><span class="keyword">auto</span> r = f.get();</span><br></pre></td></tr></table></figure>
<h2 id="std::packaged_task">std::packaged_task<a title="#std::packaged_task" href="#std::packaged_task"></a></h2>
<p>std::packaged_taskå®ƒåŒ…è£…äº†ä¸€ä¸ªå¯è°ƒç”¨çš„ç›®æ ‡ï¼ˆå¦‚function, lambda expression, bind expression, or another function objectï¼‰,ä»¥ä¾¿å¼‚æ­¥è°ƒç”¨ï¼Œå®ƒå’Œpromiseåœ¨æŸç§ç¨‹åº¦ä¸Šæœ‰ç‚¹åƒï¼Œpromiseä¿å­˜äº†ä¸€ä¸ªå…±äº«çŠ¶æ€çš„å€¼ï¼Œè€Œpackaged_taskä¿å­˜çš„æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">std</span>::packaged_task&lt;<span class="keyword">int</span>()&gt; task([]()&#123; <span class="keyword">return</span> <span class="number">7</span>; &#125;);</span><br><span class="line"><span class="built_in">std</span>::<span class="function">thread <span class="title">t1</span><span class="params">(<span class="built_in">std</span>::ref(task))</span></span>; </span><br><span class="line"><span class="built_in">std</span>::future&lt;<span class="keyword">int</span>&gt; f1 = task.get_future(); </span><br><span class="line"><span class="keyword">auto</span> r1 = f1.get();</span><br></pre></td></tr></table></figure>
<h2 id="std::promiseã€std::packaged_taskå’Œstd::futureçš„å…³ç³»">std::promiseã€std::packaged_taskå’Œstd::futureçš„å…³ç³»<a title="#std::promiseã€std::packaged_taskå’Œstd::futureçš„å…³ç³»" href="#std::promiseã€std::packaged_taskå’Œstd::futureçš„å…³ç³»"></a></h2>
<p>è‡³æ­¤, æˆ‘ä»¬ä»‹ç»äº†std::asyncç›¸å…³çš„å‡ ä¸ªå¯¹è±¡std::futureã€std::promiseå’Œstd::packaged_taskï¼Œå…¶ä¸­std::promiseå’Œstd::packaged_taskçš„ç»“æœæœ€ç»ˆéƒ½æ˜¯é€šè¿‡å…¶å†…éƒ¨çš„futureè¿”å›å‡ºæ¥çš„ï¼Œä¸çŸ¥é“è¯»è€…æœ‰æ²¡æœ‰æç³Šæ¶‚ï¼Œä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šä¸œè¥¿å‡ºæ¥ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ°åº•æ˜¯æ€æ ·çš„ï¼Ÿä¸”å¬æˆ‘æ…¢æ…¢é“æ¥ï¼Œstd::futureæä¾›äº†ä¸€ä¸ªè®¿é—®å¼‚æ­¥æ“ä½œç»“æœçš„æœºåˆ¶ï¼Œå®ƒå’Œçº¿ç¨‹æ˜¯ä¸€ä¸ªçº§åˆ«çš„å±äºä½å±‚æ¬¡çš„å¯¹è±¡ï¼Œåœ¨å®ƒä¹‹ä¸Šé«˜ä¸€å±‚çš„æ˜¯std::packaged_taskå’Œstd::promiseï¼Œä»–ä»¬å†…éƒ¨éƒ½æœ‰futureä»¥ä¾¿è®¿é—®å¼‚æ­¥æ“ä½œç»“æœï¼Œ<strong>std::packaged_taskåŒ…è£…çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè€Œstd::promiseåŒ…è£…çš„æ˜¯ä¸€ä¸ªå€¼ï¼Œéƒ½æ˜¯ä¸ºäº†æ–¹ä¾¿å¼‚æ­¥æ“ä½œçš„ï¼Œå› ä¸ºæœ‰æ—¶æˆ‘éœ€è¦è·å–çº¿ç¨‹ä¸­çš„æŸä¸ªå€¼ï¼Œè¿™æ—¶å°±ç”¨std::promiseï¼Œè€Œæœ‰æ—¶æˆ‘éœ€è¦è·ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„è¿”å›å€¼ï¼Œè¿™æ—¶å°±ç”¨std::packaged_taskã€‚</strong>é‚£std::promiseå’Œstd::packaged_taskä¹‹é—´åˆæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿè¯´ä»–ä»¬æ²¡å…³ç³»ä¹Ÿå…³ç³»ï¼Œè¯´ä»–ä»¬æœ‰å…³ç³»ä¹Ÿæœ‰å…³ç³»ï¼Œéƒ½å–å†³äºä½ äº†ï¼Œå› ä¸ºæˆ‘å¯ä»¥å°†ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœä¿å­˜åˆ°std::promiseä¸­ã€‚å¦‚æœè¯»è€…è¿˜æ²¡ææ¸…æ¥šä»–ä»¬çš„å…³ç³»çš„è¯ï¼Œæˆ‘å°±ç”¨æ›´é€šä¿—çš„è¯æ¥è§£é‡Šä¸€ä¸‹ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå°ä¼™å­ç»™ä¸€ä¸ªå§‘å¨˜è¡¨ç™½çœŸå¿ƒçš„æ—¶å€™ä¹Ÿè®¸ä¼šè¯´ï¼šâ€æˆ‘è®¸è¯ºä¼šç»™ä½ ä¸€ä¸ªç¾å¥½çš„æœªæ¥â€œæˆ–è€…â€æˆ‘ä¼šåŠªåŠ›å¥‹æ–—ä¸ºä½ åˆ›é€ ä¸€ä¸ªç¾å¥½çš„æœªæ¥â€œã€‚å§‘å¨˜å¾€å¾€ä¼šè¯´ï¼šâ€æˆ‘ç­‰ç€â€œã€‚ç°åœ¨æˆ‘æ¥å°†è¿™ä¸‰å¥è¯ç”¨c++11æ¥ç¿»è¯‘ä¸€ä¸‹ï¼š</p>
<p>å°ä¼™å­è¯´ï¼šæˆ‘è®¸è¯ºä¼šç»™ä½ ä¸€ä¸ªç¾å¥½çš„æœªæ¥ç­‰äºc<ins>11ä¸­&quot;std::promise a std::future&quot;;<br>
å°ä¼™å­è¯´ï¼šæˆ‘ä¼šåŠªåŠ›å¥‹æ–—ä¸ºä½ åˆ›é€ ä¸€ä¸ªç¾å¥½çš„æœªæ¥ç­‰äºc</ins>11ä¸­&quot;std::packaged_task a future&quot;;<br>
å§‘å¨˜è¯´ï¼šæˆ‘ç­‰ç€ç­‰äºc++11ä¸­&quot;future.get()/wait()&quot;;</p>
<p>å°ä¼™å­ä¸¤å¥è¯çš„ä¸ªä¸­å·®å¼‚ï¼Œè‡ªå·±ç¢ç£¨ä¸€ä¸‹ï¼Œè¿™ç‚¹å·®å¼‚ä¹Ÿæ˜¯std::promiseå’Œstd::packaged_taskçš„å·®å¼‚ã€‚ç°å®ä¸­çš„å±±ç›Ÿæµ·èª“é ä¸é å¾—ä½æˆ‘ä¸çŸ¥é“ï¼Œä½†æ˜¯c<ins>11ä¸­çš„è®¸è¯ºå’Œæœªæ¥æ˜¯ä¸€å®šå¯é çš„ï¼Œå‘èµ·æ¥äº†è®¸è¯ºå°±ä¸€å®šæœ‰æœªæ¥ã€‚ç»†æƒ³èµ·æ¥c</ins>11æ ‡å‡†çš„åˆ¶å®šè€…é€‰å®šçš„å…³é”®å­—çœŸæ˜¯è´´åˆ‡è€Œæœ‰æ„æ€ï¼å¥½äº†ï¼Œæ’ç§‘æ‰“è¯¨åˆ°æ­¤äº†ï¼Œç°åœ¨è¨€å½’æ­£ä¼ ï¼Œå›è¿‡å¤´æ¥è¯´è¯´std::asyncã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»º">ä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»º<a title="#ä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»º" href="#ä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»º"></a></h2>
<p>std::asyncåˆæ˜¯å¹²å•¥çš„ï¼Œå·²ç»æœ‰äº†td::futureã€std::promiseå’Œstd::packaged_taskï¼Œå¤Ÿå¤šçš„äº†ï¼ŒçœŸçš„è¿˜è¦ä¸€ä¸ªstd::asyncæ¥å‡‘çƒ­é—¹å—ï¼Œstd::asyncè¡¨ç¤ºå¾ˆå§”å±ˆï¼šæˆ‘ä¸æ˜¯æ¥å‡‘çƒ­é—¹çš„ï¼Œæˆ‘æ˜¯æ¥å¸®å¿™çš„ã€‚æ˜¯çš„ï¼Œstd::asyncæ˜¯ä¸ºäº†è®©ç”¨æˆ·çš„å°‘è´¹ç‚¹è„‘å­çš„ï¼Œå®ƒè®©è¿™ä¸‰ä¸ªå¯¹è±¡é»˜å¥‘çš„å·¥ä½œã€‚å¤§æ¦‚çš„å·¥ä½œè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šstd::asyncå…ˆå°†å¼‚æ­¥æ“ä½œç”¨std::packaged_taskåŒ…è£…èµ·æ¥ï¼Œç„¶åå°†å¼‚æ­¥æ“ä½œçš„ç»“æœæ”¾åˆ°std::promiseä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åˆ›é€ æœªæ¥çš„è¿‡ç¨‹ã€‚å¤–é¢å†é€šè¿‡future.get/waitæ¥è·å–è¿™ä¸ªæœªæ¥çš„ç»“æœï¼Œæ€ä¹ˆæ ·ï¼Œstd::asyncçœŸçš„æ˜¯æ¥å¸®å¿™çš„å§ï¼Œä½ ä¸ç”¨å†æƒ³åˆ°åº•è¯¥æ€ä¹ˆç”¨std::futureã€std::promiseå’Œstd::packaged_taskäº†ï¼Œstd::asyncå·²ç»å¸®ä½ æå®šä¸€åˆ‡äº†ï¼</p>
<p>ç°åœ¨æ¥çœ‹çœ‹std::asyncçš„åŸå‹async(std::launch::async | std::launch::deferred, f, argsâ€¦)ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çº¿ç¨‹çš„åˆ›å»ºç­–ç•¥ï¼Œæœ‰ä¸¤ç§ç­–ç•¥ï¼Œé»˜è®¤çš„ç­–ç•¥æ˜¯ç«‹å³åˆ›å»ºçº¿ç¨‹ï¼š</p>
<ul>
<li>std::launch::asyncï¼šåœ¨è°ƒç”¨asyncå°±å¼€å§‹åˆ›å»ºçº¿ç¨‹ã€‚</li>
<li>std::launch::deferredï¼šå»¶è¿ŸåŠ è½½æ–¹å¼åˆ›å»ºçº¿ç¨‹ã€‚è°ƒç”¨asyncæ—¶ä¸åˆ›å»ºçº¿ç¨‹ï¼Œç›´åˆ°è°ƒç”¨äº†futureçš„getæˆ–è€…waitæ—¶æ‰åˆ›å»ºçº¿ç¨‹ã€‚å¯èƒ½åœ¨è¿™é‡Œä¼šé˜»å¡ä½ä¸»çº¿ç¨‹ã€‚</li>
</ul>
<p>ç¬¬äºŒä¸ªå‚æ•°æ˜¯çº¿ç¨‹å‡½æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯çº¿ç¨‹å‡½æ•°çš„å‚æ•°ã€‚</p>
<p><strong>std::asyncåŸºæœ¬ç”¨æ³•ï¼š</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="built_in">std</span>::future&lt;<span class="keyword">int</span>&gt; f1 = <span class="built_in">std</span>::async(<span class="built_in">std</span>::launch::async, []()&#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="number">8</span>;  </span><br><span class="line">    &#125;); </span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;f1.get()&lt;&lt;<span class="built_in">endl</span>; <span class="comment">//output: 8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::future&lt;<span class="keyword">int</span>&gt; f2 = <span class="built_in">std</span>::async(<span class="built_in">std</span>::launch::async, []()&#123; </span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="number">8</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;); </span><br><span class="line"></span><br><span class="line">f2.wait(); <span class="comment">//output: 8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::future&lt;<span class="keyword">int</span>&gt; future = <span class="built_in">std</span>::async(<span class="built_in">std</span>::launch::async, []()&#123; </span><br><span class="line">        <span class="built_in">std</span>::this_thread::sleep_for(<span class="built_in">std</span>::chrono::seconds(<span class="number">3</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">8</span>;  </span><br><span class="line">    &#125;); </span><br><span class="line"> </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"waiting...\n"</span>;</span><br><span class="line">    <span class="built_in">std</span>::future_status status;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        status = future.wait_for(<span class="built_in">std</span>::chrono::seconds(<span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span> (status == <span class="built_in">std</span>::future_status::deferred) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"deferred\n"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status == <span class="built_in">std</span>::future_status::timeout) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"timeout\n"</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (status == <span class="built_in">std</span>::future_status::ready) &#123;</span><br><span class="line">            <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"ready!\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (status != <span class="built_in">std</span>::future_status::ready); </span><br><span class="line"> </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"result is "</span> &lt;&lt; future.get() &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">å¯èƒ½çš„ç»“æœï¼š</span><br><span class="line">waiting...</span><br><span class="line">timeout</span><br><span class="line">timeout</span><br><span class="line">ready!</span><br><span class="line">result is <span class="number">8</span></span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“ï¼š">æ€»ç»“ï¼š<a title="#æ€»ç»“ï¼š" href="#æ€»ç»“ï¼š"></a></h2>
<p>std::asyncæ˜¯æ›´é«˜å±‚æ¬¡ä¸Šçš„å¼‚æ­¥æ“ä½œï¼Œä½¿æˆ‘ä»¬ä¸ç”¨å…³æ³¨çº¿ç¨‹åˆ›å»ºå†…éƒ¨ç»†èŠ‚ï¼Œå°±èƒ½æ–¹ä¾¿çš„è·å–å¼‚æ­¥æ‰§è¡ŒçŠ¶æ€å’Œç»“æœï¼Œè¿˜å¯ä»¥æŒ‡å®šçº¿ç¨‹åˆ›å»ºç­–ç•¥ï¼Œåº”è¯¥ç”¨std::asyncæ›¿ä»£çº¿ç¨‹çš„åˆ›å»ºï¼Œè®©å®ƒæˆä¸ºæˆ‘ä»¬åšå¼‚æ­¥æ“ä½œçš„é¦–é€‰ã€‚</p>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Mutexä»‹ç»</title>
    <url>/posts/Mutex%E4%BB%8B%E7%BB%8D/</url>
    <content><![CDATA[<p>Mutex åˆç§°äº’æ–¥é‡ï¼ŒC++ 11ä¸­ä¸ Mutex ç›¸å…³çš„ç±»ï¼ˆåŒ…æ‹¬é”ç±»å‹ï¼‰å’Œå‡½æ•°éƒ½å£°æ˜åœ¨ <mutex> å¤´æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥å¦‚æœä½ éœ€è¦ä½¿ç”¨ std::mutexï¼Œå°±å¿…é¡»åŒ…å« <mutex> å¤´æ–‡ä»¶ã€‚</p>
<a id="more"></a>
<h3 id="&lt;mutex&gt;-å¤´æ–‡ä»¶ä»‹ç»"><mutex> å¤´æ–‡ä»¶ä»‹ç»<a title="#&lt;mutex&gt;-å¤´æ–‡ä»¶ä»‹ç»" href="#&lt;mutex&gt;-å¤´æ–‡ä»¶ä»‹ç»"></a></h3>
<h4 id="mutex-ç³»åˆ—ç±»(å››ç§)">Mutex ç³»åˆ—ç±»(å››ç§)<a title="#mutex-ç³»åˆ—ç±»(å››ç§)" href="#mutex-ç³»åˆ—ç±»(å››ç§)"></a></h4>
<ul>
<li>
<p>std::mutexï¼Œæœ€åŸºæœ¬çš„ Mutex ç±»ã€‚</p>
</li>
<li>
<p>std::recursive_mutexï¼Œé€’å½’ Mutex ç±»ã€‚</p>
</li>
<li>
<p>std::time_mutexï¼Œå®šæ—¶ Mutex ç±»ã€‚</p>
</li>
<li>
<p>std::recursive_timed_mutexï¼Œå®šæ—¶é€’å½’ Mutex ç±»ã€‚</p>
</li>
</ul>
<h4 id="lock-ç±»ï¼ˆä¸¤ç§ï¼‰">Lock ç±»ï¼ˆä¸¤ç§ï¼‰<a title="#lock-ç±»ï¼ˆä¸¤ç§ï¼‰" href="#lock-ç±»ï¼ˆä¸¤ç§ï¼‰"></a></h4>
<ul>
<li>std::lock_guardï¼Œä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ã€‚</li>
<li>std::unique_lockï¼Œä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ï¼Œä½†æä¾›äº†æ›´å¥½çš„ä¸Šé”å’Œè§£é”æ§åˆ¶ã€‚</li>
</ul>
<h4 id="å…¶ä»–ç±»å‹">å…¶ä»–ç±»å‹<a title="#å…¶ä»–ç±»å‹" href="#å…¶ä»–ç±»å‹"></a></h4>
<ul>
<li>std::once_flag</li>
<li>std::adopt_lock_t</li>
<li>std::defer_lock_t</li>
<li>std::try_to_lock_t</li>
</ul>
<h4 id="å‡½æ•°">å‡½æ•°<a title="#å‡½æ•°" href="#å‡½æ•°"></a></h4>
<ul>
<li>std::try_lockï¼Œå°è¯•åŒæ—¶å¯¹å¤šä¸ªäº’æ–¥é‡ä¸Šé”ã€‚</li>
<li>std::lockï¼Œå¯ä»¥åŒæ—¶å¯¹å¤šä¸ªäº’æ–¥é‡ä¸Šé”ã€‚</li>
<li>std::call_onceï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹éœ€è¦åŒæ—¶è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œcall_once å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹å¯¹è¯¥å‡½æ•°åªè°ƒç”¨ä¸€æ¬¡ã€‚</li>
</ul>
<h3 id="std::mutex-ä»‹ç»">std::mutex ä»‹ç»<a title="#std::mutex-ä»‹ç»" href="#std::mutex-ä»‹ç»"></a></h3>
<p>ä¸‹é¢ä»¥ std::mutex ä¸ºä¾‹ä»‹ç» C++11 ä¸­çš„äº’æ–¥é‡ç”¨æ³•ã€‚</p>
<p>std::mutex æ˜¯C++11 ä¸­æœ€åŸºæœ¬çš„äº’æ–¥é‡ï¼Œstd::mutex å¯¹è±¡æä¾›äº†ç‹¬å æ‰€æœ‰æƒçš„ç‰¹æ€§â€”â€”å³ä¸æ”¯æŒé€’å½’åœ°å¯¹ std::mutex å¯¹è±¡ä¸Šé”ï¼Œè€Œ std::recursive_lock åˆ™å¯ä»¥é€’å½’åœ°å¯¹äº’æ–¥é‡å¯¹è±¡ä¸Šé”ã€‚</p>
<h4 id="std::mutex-çš„æˆå‘˜å‡½æ•°">std::mutex çš„æˆå‘˜å‡½æ•°<a title="#std::mutex-çš„æˆå‘˜å‡½æ•°" href="#std::mutex-çš„æˆå‘˜å‡½æ•°"></a></h4>
<ul>
<li>æ„é€ å‡½æ•°ï¼Œstd::mutexä¸å…è®¸æ‹·è´æ„é€ ï¼Œä¹Ÿä¸å…è®¸ move æ‹·è´ï¼Œæœ€åˆäº§ç”Ÿçš„ mutex å¯¹è±¡æ˜¯å¤„äº unlocked çŠ¶æ€çš„ã€‚</li>
<li>lock()ï¼Œè°ƒç”¨çº¿ç¨‹å°†é”ä½è¯¥äº’æ–¥é‡ã€‚çº¿ç¨‹è°ƒç”¨è¯¥å‡½æ•°ä¼šå‘ç”Ÿä¸‹é¢ 3 ç§æƒ…å†µï¼š(1). å¦‚æœè¯¥äº’æ–¥é‡å½“å‰æ²¡æœ‰è¢«é”ä½ï¼Œåˆ™è°ƒç”¨çº¿ç¨‹å°†è¯¥äº’æ–¥é‡é”ä½ï¼Œç›´åˆ°è°ƒç”¨ unlockä¹‹å‰ï¼Œè¯¥çº¿ç¨‹ä¸€ç›´æ‹¥æœ‰è¯¥é”ã€‚(2). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹é”ä½ï¼Œåˆ™å½“å‰çš„è°ƒç”¨çº¿ç¨‹è¢«é˜»å¡ä½ã€‚(3). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å½“å‰è°ƒç”¨çº¿ç¨‹é”ä½ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”(deadlock)ã€‚</li>
<li>unlock()ï¼Œ è§£é”ï¼Œé‡Šæ”¾å¯¹äº’æ–¥é‡çš„æ‰€æœ‰æƒã€‚</li>
<li>try_lock()ï¼Œå°è¯•é”ä½äº’æ–¥é‡ï¼Œå¦‚æœäº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é˜»å¡ã€‚çº¿ç¨‹è°ƒç”¨è¯¥å‡½æ•°ä¹Ÿä¼šå‡ºç°ä¸‹é¢ 3 ç§æƒ…å†µï¼Œ(1). å¦‚æœå½“å‰äº’æ–¥é‡æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œåˆ™è¯¥çº¿ç¨‹é”ä½äº’æ–¥é‡ï¼Œç›´åˆ°è¯¥çº¿ç¨‹è°ƒç”¨ unlock é‡Šæ”¾äº’æ–¥é‡ã€‚(2). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹é”ä½ï¼Œåˆ™å½“å‰è°ƒç”¨çº¿ç¨‹è¿”å› falseï¼Œè€Œå¹¶ä¸ä¼šè¢«é˜»å¡æ‰ã€‚(3). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å½“å‰è°ƒç”¨çº¿ç¨‹é”ä½ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”(deadlock)ã€‚</li>
</ul>
<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªä¸ std::mutex çš„å°ä¾‹å­ï¼ˆ<a href="http://www.cplusplus.com/reference/mutex/mutex/try_lock/" target="_blank">å‚è€ƒ</a>ï¼‰</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;       // std::cout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;         // std::thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mutex&gt;          // std::mutex</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">volatile</span> <span class="keyword">int</span> <span class="title">counter</span><span class="params">(<span class="number">0</span>)</span></span>; <span class="comment">// non-atomic counter</span></span><br><span class="line"><span class="built_in">std</span>::mutex mtx;           <span class="comment">// locks access to counter</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">attempt_10k_increases</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10000</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mtx.try_lock()) &#123;   <span class="comment">// only increase if currently not locked:</span></span><br><span class="line">            ++counter;</span><br><span class="line">            mtx.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::thread threads[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; ++i)</span><br><span class="line">        threads[i] = <span class="built_in">std</span>::thread(attempt_10k_increases);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; th : threads) th.join();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; counter &lt;&lt; <span class="string">" successful increases of the counter.\n"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">$g++ -lpthread -<span class="built_in">std</span>=c++<span class="number">11</span> -o main *.cpp</span><br><span class="line">$main</span><br><span class="line"><span class="number">9012</span> successful increases of the counter.</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯ä»¥çœ‹å‡ºæœ‰å¾ˆå¤šæ¬¡mtx.try_lock()è¿”å›äº†falseï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ++counteræ“ä½œã€‚</p>
<p>å¦‚æœæŠŠmtx.try_lock()æ”¹æˆmtx.lock()ï¼Œåˆ™å¿…å®šä¼šé˜»å¡å…¶ä»–çº¿ç¨‹ã€‚</p>
</blockquote>
<p>è¾“å‡ºç»“æœ2:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">$g++ -lpthread -<span class="built_in">std</span>=c++<span class="number">11</span> -o main *.cpp</span><br><span class="line">$main</span><br><span class="line"><span class="number">100000</span> successful increases of the counter.</span><br></pre></td></tr></table></figure>
<h3 id="std::recursive_mutex-ä»‹ç»">std::recursive_mutex ä»‹ç»<a title="#std::recursive_mutex-ä»‹ç»" href="#std::recursive_mutex-ä»‹ç»"></a></h3>
<p>std::recursive_mutex ä¸ std::mutex ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ç§å¯ä»¥è¢«ä¸Šé”çš„å¯¹è±¡ï¼Œä½†æ˜¯å’Œ std::mutex ä¸åŒçš„æ˜¯ï¼Œstd::recursive_mutex å…è®¸åŒä¸€ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡å¤šæ¬¡ä¸Šé”ï¼ˆå³é€’å½’ä¸Šé”ï¼‰ï¼Œæ¥è·å¾—å¯¹äº’æ–¥é‡å¯¹è±¡çš„å¤šå±‚æ‰€æœ‰æƒï¼Œstd::recursive_mutex é‡Šæ”¾äº’æ–¥é‡æ—¶éœ€è¦è°ƒç”¨ä¸è¯¥é”å±‚æ¬¡æ·±åº¦ç›¸åŒæ¬¡æ•°çš„ unlock()ï¼Œå¯ç†è§£ä¸º lock() æ¬¡æ•°å’Œ unlock() æ¬¡æ•°ç›¸åŒï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œstd::recursive_mutex çš„ç‰¹æ€§å’Œ std::mutex å¤§è‡´ç›¸åŒã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;       // std::cout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;         // std::thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mutex&gt;          // std::mutex</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">volatile</span> <span class="keyword">int</span> <span class="title">counter</span><span class="params">(<span class="number">0</span>)</span></span>; <span class="comment">// non-atomic counter</span></span><br><span class="line"><span class="built_in">std</span>::recursive_mutex  rmtx;           <span class="comment">// locks access to counter</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">attempt_1k_increases</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10000</span>; ++i) &#123;</span><br><span class="line">        rmtx.lock();   </span><br><span class="line">        ++counter; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10000</span>; ++i) &#123; </span><br><span class="line">        counter-=<span class="number">2</span>; </span><br><span class="line">        rmtx.unlock();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span>* argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> th = <span class="built_in">std</span>::thread(attempt_1k_increases);</span><br><span class="line">    th.join();</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; counter &lt;&lt; <span class="string">" successful increases of the counter.\n"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">$g++ -lpthread -o main *.cpp</span><br><span class="line">$main</span><br><span class="line"><span class="number">-10000</span> successful increases of the counter.</span><br></pre></td></tr></table></figure>
<h3 id="std::time_mutex-ä»‹ç»">std::time_mutex ä»‹ç»<a title="#std::time_mutex-ä»‹ç»" href="#std::time_mutex-ä»‹ç»"></a></h3>
<p>std::time_mutex æ¯” std::mutex å¤šäº†ä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼Œtry_lock_for()ï¼Œtry_lock_until()ã€‚</p>
<p>try_lock_for å‡½æ•°æ¥å—ä¸€ä¸ªæ—¶é—´èŒƒå›´ï¼Œè¡¨ç¤ºåœ¨è¿™ä¸€æ®µæ—¶é—´èŒƒå›´ä¹‹å†…çº¿ç¨‹å¦‚æœæ²¡æœ‰è·å¾—é”åˆ™è¢«é˜»å¡ä½ï¼ˆä¸ std::mutex çš„ try_lock() ä¸åŒï¼Œtry_lock å¦‚æœè¢«è°ƒç”¨æ—¶æ²¡æœ‰è·å¾—é”åˆ™ç›´æ¥è¿”å› falseï¼‰ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´å…¶ä»–çº¿ç¨‹é‡Šæ”¾äº†é”ï¼Œåˆ™è¯¥çº¿ç¨‹å¯ä»¥è·å¾—å¯¹äº’æ–¥é‡çš„é”ï¼Œå¦‚æœè¶…æ—¶ï¼ˆå³åœ¨æŒ‡å®šæ—¶é—´å†…è¿˜æ˜¯æ²¡æœ‰è·å¾—é”ï¼‰ï¼Œåˆ™è¿”å› falseã€‚</p>
<p>try_lock_until å‡½æ•°åˆ™æ¥å—ä¸€ä¸ªæ—¶é—´ç‚¹ä½œä¸ºå‚æ•°ï¼Œåœ¨æŒ‡å®šæ—¶é—´ç‚¹æœªåˆ°æ¥ä¹‹å‰çº¿ç¨‹å¦‚æœæ²¡æœ‰è·å¾—é”åˆ™è¢«é˜»å¡ä½ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´å…¶ä»–çº¿ç¨‹é‡Šæ”¾äº†é”ï¼Œåˆ™è¯¥çº¿ç¨‹å¯ä»¥è·å¾—å¯¹äº’æ–¥é‡çš„é”ï¼Œå¦‚æœè¶…æ—¶ï¼ˆå³åœ¨æŒ‡å®šæ—¶é—´å†…è¿˜æ˜¯æ²¡æœ‰è·å¾—é”ï¼‰ï¼Œåˆ™è¿”å› falseã€‚</p>
<p>ä¸‹é¢çš„å°ä¾‹å­è¯´æ˜äº† std::time_mutex çš„ç”¨æ³•ï¼ˆ<a href="http://www.cplusplus.com/reference/mutex/timed_mutex/try_lock_for/" target="_blank">å‚è€ƒ</a>ï¼‰ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;       // std::cout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;chrono&gt;         // std::chrono::milliseconds</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;         // std::thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mutex&gt;          // std::timed_mutex</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::timed_mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fireworks</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// waiting to get a lock: each thread prints "-" every 200ms:</span></span><br><span class="line">  <span class="keyword">while</span> (!mtx.try_lock_for(<span class="built_in">std</span>::chrono::milliseconds(<span class="number">200</span>))) &#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"-"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// got a lock! - wait for 1s, then this thread prints "*"</span></span><br><span class="line">  <span class="built_in">std</span>::this_thread::sleep_for(<span class="built_in">std</span>::chrono::milliseconds(<span class="number">1000</span>));</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"*\n"</span>;</span><br><span class="line">  mtx.unlock();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">std</span>::thread threads[<span class="number">10</span>];</span><br><span class="line">  <span class="comment">// spawn 10 threads:</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; ++i)</span><br><span class="line">    threads[i] = <span class="built_in">std</span>::thread(fireworks);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; th : threads) th.join();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<blockquote>
<p>çº¿ç¨‹è¾“å‡º*è¡¨ç¤ºè¯¥çº¿ç¨‹å·²ç»æ­£å¸¸é€€å‡ºï¼Œå¹¶ä¸”é‡Šæ”¾è¯¥é”ã€‚å¦åˆ™å°†æ¯200mså°è¯•è·å–mutexğŸ”’ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚</p>
</blockquote>
<h3 id="std::recursive_timed_mutex-ä»‹ç»">std::recursive_timed_mutex ä»‹ç»<a title="#std::recursive_timed_mutex-ä»‹ç»" href="#std::recursive_timed_mutex-ä»‹ç»"></a></h3>
<p>å’Œ std:recursive_mutex ä¸ std::mutex çš„å…³ç³»ä¸€æ ·ï¼Œstd::recursive_timed_mutex çš„ç‰¹æ€§ä¹Ÿå¯ä»¥ä» std::timed_mutex æ¨å¯¼å‡ºæ¥ï¼Œæ„Ÿå…´è¶£çš„åŒé‹å¯ä»¥è‡ªè¡ŒæŸ¥é˜…ã€‚ ;-)</p>
<h3 id="std::lock_guard-ä»‹ç»">std::lock_guard ä»‹ç»<a title="#std::lock_guard-ä»‹ç»" href="#std::lock_guard-ä»‹ç»"></a></h3>
<p>ä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ã€‚ä¾‹å­ï¼ˆ<a href="http://www.cplusplus.com/reference/mutex/lock_guard/" target="_blank">å‚è€ƒ</a>ï¼‰:</p>
<ul>
<li>1.std::lock_guard åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡ŒåŠ é”ï¼Œææ„å‡½æ•°ä¸­è¿›è¡Œè§£é”ã€‚</li>
<li>2.é”åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œä½¿ç”¨è¾ƒå¤šï¼Œå› æ­¤c++11æä¾›äº†lock_guardæ¨¡æ¿ç±»ï¼›åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„åœºæ™¯ç¼–å†™<code>resource_guard</code> RAIIç±»ï¼Œé¿å…å¿˜æ‰é‡Šæ”¾èµ„æºã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;       // std::cout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;         // std::thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mutex&gt;          // std::mutex, std::lock_guard</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdexcept&gt;      // std::logic_error</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::mutex mtx;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_even</span> <span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x%<span class="number">2</span>==<span class="number">0</span>) <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; x &lt;&lt; <span class="string">" is even\n"</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">throw</span> (<span class="built_in">std</span>::logic_error(<span class="string">"not even"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_thread_id</span> <span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// using a local lock_guard to lock mtx guarantees unlocking on destruction / exception:</span></span><br><span class="line">        <span class="built_in">std</span>::lock_guard&lt;<span class="built_in">std</span>::mutex&gt; lck (mtx);</span><br><span class="line">        print_even(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (<span class="built_in">std</span>::logic_error&amp;) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"[exception caught]\n"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::thread threads[<span class="number">10</span>];</span><br><span class="line">    <span class="comment">// spawn 10 threads:</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">10</span>; ++i)</span><br><span class="line">        threads[i] = <span class="built_in">std</span>::thread(print_thread_id,i+<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; th : threads) th.join();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">$g++ -lpthread -o main *.cpp</span><br><span class="line">$main</span><br><span class="line">[exception caught]</span><br><span class="line"><span class="number">4</span> is even</span><br><span class="line">[exception caught]</span><br><span class="line"><span class="number">2</span> is even</span><br><span class="line">[exception caught]</span><br><span class="line"><span class="number">6</span> is even</span><br><span class="line"><span class="number">8</span> is even</span><br><span class="line">[exception caught]</span><br><span class="line">[exception caught]</span><br><span class="line"><span class="number">10</span> is even</span><br></pre></td></tr></table></figure>
<h3 id="std::unique_lock-ä»‹ç»">std::unique_lock ä»‹ç»<a title="#std::unique_lock-ä»‹ç»" href="#std::unique_lock-ä»‹ç»"></a></h3>
<p>ä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ï¼Œä½†æä¾›äº†æ›´å¥½çš„ä¸Šé”å’Œè§£é”æ§åˆ¶ã€‚ä¾‹å­ï¼ˆ<a href="http://www.cplusplus.com/reference/mutex/unique_lock/" target="_blank">å‚è€ƒ</a>ï¼‰ï¼š</p>
<ul>
<li>1.ç±» unique_lock æ˜¯é€šç”¨äº’æ–¥åŒ…è£…å™¨ï¼Œå…è®¸<code>å»¶è¿Ÿé”å®šã€é”å®šçš„æœ‰æ—¶é™å°è¯•ã€é€’å½’é”å®šã€æ‰€æœ‰æƒè½¬ç§»å’Œä¸æ¡ä»¶å˜é‡ä¸€åŒä½¿ç”¨</code>ã€‚</li>
<li>2.unique_lockæ¯”lock_guardä½¿ç”¨æ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½æ›´åŠ å¼ºå¤§ã€‚<br>
ä½¿ç”¨unique_lockéœ€è¦ä»˜å‡ºæ›´å¤šçš„æ—¶é—´ã€æ€§èƒ½æˆæœ¬ã€‚</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;       // std::cout</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;thread&gt;         // std::thread</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;mutex&gt;          // std::mutex, std::unique_lock</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">std</span>::mutex mtx;           <span class="comment">// mutex for critical section</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_block</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// critical section (exclusive access to std::cout signaled by lifetime of lck):</span></span><br><span class="line">    <span class="built_in">std</span>::unique_lock&lt;<span class="built_in">std</span>::mutex&gt; lck (mtx);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">'\n'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="function">thread <span class="title">th1</span> <span class="params">(print_block,<span class="number">50</span>,<span class="string">'*'</span>)</span></span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="function">thread <span class="title">th2</span> <span class="params">(print_block,<span class="number">50</span>,<span class="string">'$'</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    th1.join();</span><br><span class="line">    th2.join();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">$g++ -lpthread -o main *.cpp</span><br><span class="line">$main</span><br><span class="line">**************************************************</span><br><span class="line">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œæœ¬æ–‡æš‚æ—¶è®²åˆ°è¿™é‡Œï¼Œè¿˜å‰©ä¸‹ std::try_lockï¼Œstd::lockï¼Œstd::call_once ä¸‰ä¸ªå‡½æ•°æ²¡æœ‰è®²åˆ°ï¼Œç•™åœ¨ä¸‹ä¸€ç¯‡åšå®¢ä¸­è®²å§ ;-)</p>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>newå’Œmallocçš„åŒºåˆ«</title>
    <url>/posts/new%E5%92%8Cmalloc%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
    <content><![CDATA[<h2 id="1.-ç”³è¯·çš„å†…å­˜æ‰€åœ¨ä½ç½®">1. ç”³è¯·çš„å†…å­˜æ‰€åœ¨ä½ç½®<a title="#1.-ç”³è¯·çš„å†…å­˜æ‰€åœ¨ä½ç½®" href="#1.-ç”³è¯·çš„å†…å­˜æ‰€åœ¨ä½ç½®"></a></h2>
<p>newæ“ä½œç¬¦ä»è‡ªç”±å­˜å‚¨åŒºï¼ˆfree storeï¼‰ä¸Šä¸ºå¯¹è±¡åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´ï¼Œè€Œmallocå‡½æ•°ä»å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ã€‚</p>
<p>è‡ªç”±å­˜å‚¨åŒºæ˜¯C++åŸºäºnewæ“ä½œç¬¦çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå‡¡æ˜¯é€šè¿‡newæ“ä½œç¬¦è¿›è¡Œå†…å­˜ç”³è¯·ï¼Œè¯¥å†…å­˜å³ä¸ºè‡ªç”±å­˜å‚¨åŒºã€‚è€Œå †æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„æœ¯è¯­ï¼Œæ˜¯æ“ä½œç³»ç»Ÿæ‰€ç»´æŠ¤çš„ä¸€å—ç‰¹æ®Šå†…å­˜ï¼Œç”¨äºç¨‹åºçš„å†…å­˜åŠ¨æ€åˆ†é…ï¼ŒCè¯­è¨€ä½¿ç”¨mallocä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨freeé‡Šæ”¾å·²åˆ†é…çš„å¯¹åº”å†…å­˜ã€‚</p>
<p>é‚£ä¹ˆè‡ªç”±å­˜å‚¨åŒºæ˜¯å¦èƒ½å¤Ÿæ˜¯å †ï¼ˆé—®é¢˜ç­‰ä»·äºnewæ˜¯å¦èƒ½åœ¨å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ï¼‰ï¼Œè¿™å–å†³äºoperator new çš„å®ç°ç»†èŠ‚ã€‚è‡ªç”±å­˜å‚¨åŒºä¸ä»…å¯ä»¥æ˜¯å †ï¼Œè¿˜å¯ä»¥æ˜¯é™æ€å­˜å‚¨åŒºï¼Œè¿™éƒ½çœ‹operator newåœ¨å“ªé‡Œä¸ºå¯¹è±¡åˆ†é…å†…å­˜ã€‚</p>
<a id="more"></a>
<p>ç‰¹åˆ«çš„ï¼Œnewç”šè‡³å¯ä»¥ä¸ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼å®šä½newçš„åŠŸèƒ½å¯ä»¥åŠåˆ°è¿™ä¸€ç‚¹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> (place_address) type</span><br></pre></td></tr></table></figure>
<p>place_addressä¸ºä¸€ä¸ªæŒ‡é’ˆï¼Œä»£è¡¨ä¸€å—å†…å­˜çš„åœ°å€ã€‚å½“ä½¿ç”¨ä¸Šé¢è¿™ç§ä»…ä»¥ä¸€ä¸ªåœ°å€è°ƒç”¨newæ“ä½œç¬¦æ—¶ï¼Œnewæ“ä½œç¬¦è°ƒç”¨ç‰¹æ®Šçš„operator newï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªç‰ˆæœ¬ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> * <span class="keyword">operator</span> <span class="title">new</span> <span class="params">(<span class="keyword">size_t</span>,<span class="keyword">void</span> *)</span> <span class="comment">//ä¸å…è®¸é‡å®šä¹‰è¿™ä¸ªç‰ˆæœ¬çš„operator new</span></span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªoperator newä¸åˆ†é…ä»»ä½•çš„å†…å­˜ï¼Œå®ƒåªæ˜¯ç®€å•åœ°è¿”å›æŒ‡é’ˆå®å‚ï¼Œç„¶åå³newè¡¨è¾¾å¼è´Ÿè´£åœ¨place_addressæŒ‡å®šçš„åœ°å€è¿›è¡Œå¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œã€‚</p>
<p>â€‹		æ‰€ä»¥ä»¥è¿™ç§æ–¹å¼newçš„æŒ‡é’ˆæ— éœ€deleteï¼Œåªéœ€è¦å…³æ³¨place_addressçš„å†…å­˜çš„é‡Šæ”¾ä¸å¦ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tempalete &lt;<span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> U* <span class="title">create_array</span><span class="params">(<span class="keyword">size_t</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	assert(count &gt; <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">auto</span> p = <span class="keyword">static_cast</span>&lt;U*&gt;((<span class="built_in">malloc</span>)(<span class="keyword">sizeof</span>(U) * count)) <span class="comment">//åˆ›å»ºä¸€å—å†…å­˜</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="literal">nullptr</span> == p)&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">0</span>; i != count; ++i)&#123;</span><br><span class="line">		<span class="keyword">new</span> (p + i) U();  <span class="comment">//åœ¨æŒ‡å®šçš„å†…å­˜åœ°å€åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">tempalete &lt;<span class="keyword">typename</span> U&gt;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">destory_array</span><span class="params">(U* p, <span class="keyword">size_t</span> count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(p != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">		assert(count &gt; <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">size_t</span> i = count; i !- <span class="number">0</span>; )&#123;</span><br><span class="line">			(p + --i)-&gt;~U();  <span class="comment">//ææ„æŒ‡å®šå†…å­˜ä½ç½®çš„å¯¹è±¡</span></span><br><span class="line">		&#125;</span><br><span class="line">		(<span class="built_in">free</span>)(p);  <span class="comment">//é‡Šæ”¾å†…å­˜</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2.è¿”å›ç±»å‹å®‰å…¨æ€§">2.è¿”å›ç±»å‹å®‰å…¨æ€§<a title="#2.è¿”å›ç±»å‹å®‰å…¨æ€§" href="#2.è¿”å›ç±»å‹å®‰å…¨æ€§"></a></h2>
<p>newæ“ä½œç¬¦å†…å­˜åˆ†é…æˆåŠŸæ—¶ï¼Œè¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆï¼Œç±»å‹ä¸¥æ ¼ä¸å¯¹è±¡åŒ¹é…ï¼Œæ— é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ•…newæ˜¯ç¬¦åˆç±»å‹å®‰å…¨æ€§çš„æ“ä½œç¬¦ã€‚è€Œmallocå†…å­˜åˆ†é…æˆåŠŸåˆ™æ˜¯è¿”å›void * ï¼Œéœ€è¦é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢å°†void*æŒ‡é’ˆè½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚</p>
<p>ç±»å‹å®‰å…¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥ç­‰ä»·äºå†…å­˜å®‰å…¨ï¼Œç±»å‹å®‰å…¨çš„ä»£ç ä¸ä¼šè¯•å›¾åˆ†é…è‡ªå·±æ²¡è¢«æˆæƒçš„å†…å­˜åŒºåŸŸã€‚å…³äºC++çš„ç±»å‹å®‰å…¨æ€§å¯è¯´çš„åˆæœ‰å¾ˆå¤šäº†ã€‚</p>
<h2 id="3.å†…å­˜åˆ†é…å¤±è´¥æ—¶çš„è¿”å›å€¼">3.å†…å­˜åˆ†é…å¤±è´¥æ—¶çš„è¿”å›å€¼<a title="#3.å†…å­˜åˆ†é…å¤±è´¥æ—¶çš„è¿”å›å€¼" href="#3.å†…å­˜åˆ†é…å¤±è´¥æ—¶çš„è¿”å›å€¼"></a></h2>
<p>newå†…å­˜åˆ†é…å¤±è´¥æ—¶ï¼Œä¼šæŠ›å‡ºbac_allocå¼‚å¸¸ï¼Œå®ƒä¸ä¼šè¿”å›NULLï¼›mallocåˆ†é…å†…å­˜å¤±è´¥æ—¶è¿”å›NULLã€‚</p>
<p>åœ¨ä½¿ç”¨Cè¯­è¨€æ—¶ï¼Œæˆ‘ä»¬ä¹ æƒ¯åœ¨mallocåˆ†é…å†…å­˜ååˆ¤æ–­åˆ†é…æ˜¯å¦æˆåŠŸï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> *a  = (<span class="keyword">int</span> *)<span class="built_in">malloc</span> ( <span class="keyword">sizeof</span> (<span class="keyword">int</span> ));</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">NULL</span> == a)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»Cè¯­è¨€èµ°å…¥C<ins>é˜µè¥çš„æ–°æ‰‹å¯èƒ½ä¼šæŠŠè¿™ä¸ªä¹ æƒ¯å¸¦å…¥C</ins>ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> * a = <span class="keyword">new</span> <span class="keyword">int</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="literal">NULL</span> == a)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;   </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šè¿™æ ·åšä¸€ç‚¹æ„ä¹‰ä¹Ÿæ²¡æœ‰ï¼Œå› ä¸ºnewæ ¹æœ¬ä¸ä¼šè¿”å›NULLï¼Œè€Œä¸”ç¨‹åºèƒ½å¤Ÿæ‰§è¡Œåˆ°ifè¯­å¥å·²ç»è¯´æ˜å†…å­˜åˆ†é…æˆåŠŸäº†ï¼Œå¦‚æœå¤±è´¥æ—©å°±æŠ›å¼‚å¸¸äº†ã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ä½¿ç”¨å¼‚å¸¸æœºåˆ¶ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> *a = <span class="keyword">new</span> <span class="keyword">int</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (bad_alloc)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ æƒ³é¡ºä¾¿äº†è§£ä¸‹å¼‚å¸¸åŸºç¡€ï¼Œå¯ä»¥çœ‹http://www.cnblogs.com/QG-whz/p/5136883.htmlC++ å¼‚å¸¸æœºåˆ¶åˆ†æã€‚</p>
<h2 id="4.æ˜¯å¦éœ€è¦æŒ‡å®šå†…å­˜å¤§å°">4.æ˜¯å¦éœ€è¦æŒ‡å®šå†…å­˜å¤§å°<a title="#4.æ˜¯å¦éœ€è¦æŒ‡å®šå†…å­˜å¤§å°" href="#4.æ˜¯å¦éœ€è¦æŒ‡å®šå†…å­˜å¤§å°"></a></h2>
<p>ä½¿ç”¨newæ“ä½œç¬¦ç”³è¯·å†…å­˜åˆ†é…æ—¶æ— é¡»æŒ‡å®šå†…å­˜å—çš„å¤§å°ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»å‹ä¿¡æ¯è‡ªè¡Œè®¡ç®—ï¼Œè€Œmallocåˆ™éœ€è¦æ˜¾å¼åœ°æŒ‡å‡ºæ‰€éœ€å†…å­˜çš„å°ºå¯¸ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>&#123;</span>...&#125;</span><br><span class="line">A * ptr = <span class="keyword">new</span> A;</span><br><span class="line">A * ptr = (A *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(A)); <span class="comment">//éœ€è¦æ˜¾å¼æŒ‡å®šæ‰€éœ€å†…å­˜å¤§å°sizeof(A);</span></span><br></pre></td></tr></table></figure>
<p>å½“ç„¶äº†ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨mallocæ¥ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰ç±»å‹åˆ†é…å†…å­˜æ˜¯ä¸æ€ä¹ˆåˆé€‚çš„ï¼Œè¯·çœ‹ä¸‹ä¸€æ¡ã€‚</p>
<h2 id="5.æ˜¯å¦è°ƒç”¨æ„é€ å‡½æ•°/ææ„å‡½æ•°">5.æ˜¯å¦è°ƒç”¨æ„é€ å‡½æ•°/ææ„å‡½æ•°<a title="#5.æ˜¯å¦è°ƒç”¨æ„é€ å‡½æ•°/ææ„å‡½æ•°" href="#5.æ˜¯å¦è°ƒç”¨æ„é€ å‡½æ•°/ææ„å‡½æ•°"></a></h2>
<p>ä½¿ç”¨newæ“ä½œç¬¦æ¥åˆ†é…å¯¹è±¡å†…å­˜æ—¶ä¼šç»å†ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<p>ç¬¬ä¸€æ­¥ï¼šè°ƒç”¨operator new å‡½æ•°ï¼ˆå¯¹äºæ•°ç»„æ˜¯operator new[]ï¼‰åˆ†é…ä¸€å—è¶³å¤Ÿå¤§çš„ï¼ŒåŸå§‹çš„ï¼Œæœªå‘½åçš„å†…å­˜ç©ºé—´ä»¥ä¾¿å­˜å‚¨ç‰¹å®šç±»å‹çš„å¯¹è±¡ã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼šç¼–è¯‘å™¨è¿è¡Œç›¸åº”çš„æ„é€ å‡½æ•°ä»¥æ„é€ å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶ä¼ å…¥åˆå€¼ã€‚</p>
<p>ç¬¬ä¸‰éƒ¨ï¼šå¯¹è±¡æ„é€ å®Œæˆåï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆã€‚</p>
<p>ä½¿ç”¨deleteæ“ä½œç¬¦æ¥é‡Šæ”¾å¯¹è±¡å†…å­˜æ—¶ä¼šç»å†ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<p>ç¬¬ä¸€æ­¥ï¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°ã€‚</p>
<p>ç¬¬äºŒæ­¥ï¼šç¼–è¯‘å™¨è°ƒç”¨operator delete(æˆ–operator delete[])å‡½æ•°é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚</p>
<p>æ€»ä¹‹æ¥è¯´ï¼Œnew/deleteä¼šè°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°/ææ„å‡½æ•°ä»¥å®Œæˆå¯¹è±¡çš„æ„é€ /ææ„ã€‚è€Œmallocåˆ™ä¸ä¼šã€‚å¦‚æœä½ ä¸å«Œå•°å—¦å¯ä»¥çœ‹ä¸‹æˆ‘çš„ä¾‹å­ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    A() :a(<span class="number">1</span>), b(<span class="number">1.11</span>)&#123;&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">double</span> b;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A * ptr = (A*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(A));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨returnå¤„è®¾ç½®æ–­ç‚¹ï¼Œè§‚çœ‹ptræ‰€æŒ‡å†…å­˜çš„å†…å®¹ï¼š</p>
<p><img src="https://images2018.cnblogs.com/blog/1191971/201803/1191971-20180319110403732-1469701660.png" alt="img" class="Ï†cx"></p>
<p>å¯ä»¥çœ‹å‡ºAçš„é»˜è®¤æ„é€ å‡½æ•°å¹¶æ²¡æœ‰è¢«è°ƒç”¨ï¼Œå› ä¸ºæ•°æ®æˆå‘˜a,bçš„å€¼å¹¶æ²¡æœ‰å¾—åˆ°åˆå§‹åŒ–ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢æˆ‘ä¸ºä»€ä¹ˆè¯´ä½¿ç”¨malloc/freeæ¥å¤„ç†C++çš„è‡ªå®šä¹‰ç±»å‹ä¸åˆé€‚ï¼Œå…¶å®ä¸æ­¢è‡ªå®šä¹‰ç±»å‹ï¼Œæ ‡å‡†åº“ä¸­å‡¡æ˜¯éœ€è¦æ„é€ /ææ„çš„ç±»å‹é€šé€šä¸åˆé€‚ã€‚</p>
<p>è€Œä½¿ç”¨newæ¥åˆ†é…å¯¹è±¡æ—¶ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A * ptr = <span class="keyword">new</span> A;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç¨‹åºç”Ÿæˆçš„æ±‡ç¼–ä»£ç å¯ä»¥å‘ç°ï¼ŒAçš„é»˜è®¤æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ï¼š</p>
<p><img src="https://images2018.cnblogs.com/blog/1191971/201803/1191971-20180319110522159-1015504969.png" alt="img" class="Ï†cx"></p>
<h2 id="6.å¯¹æ•°ç»„çš„å¤„ç†">6.å¯¹æ•°ç»„çš„å¤„ç†<a title="#6.å¯¹æ•°ç»„çš„å¤„ç†" href="#6.å¯¹æ•°ç»„çš„å¤„ç†"></a></h2>
<p>C++æä¾›äº†new[]ä¸delete[]æ¥ä¸“é—¨å¤„ç†æ•°ç»„ç±»å‹:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">A * ptr = <span class="keyword">new</span> A[<span class="number">10</span>];<span class="comment">//åˆ†é…10ä¸ªAå¯¹è±¡</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨new[]åˆ†é…çš„å†…å­˜å¿…é¡»ä½¿ç”¨delete[]è¿›è¡Œé‡Šæ”¾ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">delete</span> [] ptr;</span><br></pre></td></tr></table></figure>
<p>newå¯¹æ•°ç»„çš„æ”¯æŒä½“ç°åœ¨å®ƒä¼šåˆ†åˆ«è°ƒç”¨æ„é€ å‡½æ•°å‡½æ•°åˆå§‹åŒ–æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä¸ºæ¯ä¸ªå¯¹è±¡è°ƒç”¨ææ„å‡½æ•°ã€‚æ³¨æ„delete[]è¦ä¸new[]é…å¥—ä½¿ç”¨ï¼Œä¸ç„¶ä¼šæ‰¾å‡ºæ•°ç»„å¯¹è±¡éƒ¨åˆ†é‡Šæ”¾çš„ç°è±¡ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚</p>
<p>è‡³äºmallocï¼Œå®ƒå¹¶çŸ¥é“ä½ åœ¨è¿™å—å†…å­˜ä¸Šè¦æ”¾çš„æ•°ç»„è¿˜æ˜¯å•¥åˆ«çš„ä¸œè¥¿ï¼Œåæ­£å®ƒå°±ç»™ä½ ä¸€å—åŸå§‹çš„å†…å­˜ï¼Œåœ¨ç»™ä½ ä¸ªå†…å­˜çš„åœ°å€å°±å®Œäº‹ã€‚æ‰€ä»¥å¦‚æœè¦åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•°ç»„çš„å†…å­˜ï¼Œè¿˜éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è‡ªå®šæ•°ç»„çš„å¤§å°ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> * ptr = (<span class="keyword">int</span> *) <span class="built_in">malloc</span>( <span class="keyword">sizeof</span>(<span class="keyword">int</span>)* <span class="number">10</span> );<span class="comment">//åˆ†é…ä¸€ä¸ª10ä¸ªintå…ƒç´ çš„æ•°ç»„</span></span><br></pre></td></tr></table></figure>
<h2 id="7.newä¸mallocæ˜¯å¦å¯ä»¥ç›¸äº’è°ƒç”¨">7.newä¸mallocæ˜¯å¦å¯ä»¥ç›¸äº’è°ƒç”¨<a title="#7.newä¸mallocæ˜¯å¦å¯ä»¥ç›¸äº’è°ƒç”¨" href="#7.newä¸mallocæ˜¯å¦å¯ä»¥ç›¸äº’è°ƒç”¨"></a></h2>
<p>operator new /operator deleteçš„å®ç°å¯ä»¥åŸºäºmallocï¼Œè€Œmallocçš„å®ç°ä¸å¯ä»¥å»è°ƒç”¨newã€‚ä¸‹é¢æ˜¯ç¼–å†™operator new /operator delete çš„ä¸€ç§ç®€å•æ–¹å¼ï¼Œå…¶ä»–ç‰ˆæœ¬ä¹Ÿä¸ä¹‹ç±»ä¼¼ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> * <span class="keyword">operator</span> <span class="title">new</span> <span class="params">(<span class="keyword">sieze_t</span> size)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">void</span> * mem = <span class="built_in">malloc</span>(size)</span><br><span class="line">        <span class="keyword">return</span> mem;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">throw</span> bad_alloc();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> <span class="keyword">operator</span> <span class="keyword">delete</span>(<span class="keyword">void</span> *mem) <span class="keyword">noexcept</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">free</span>(mem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="8.æ˜¯å¦å¯ä»¥è¢«é‡è½½">8.æ˜¯å¦å¯ä»¥è¢«é‡è½½<a title="#8.æ˜¯å¦å¯ä»¥è¢«é‡è½½" href="#8.æ˜¯å¦å¯ä»¥è¢«é‡è½½"></a></h2>
<p>opeartor new /operator deleteå¯ä»¥è¢«é‡è½½ã€‚æ ‡å‡†åº“æ˜¯å®šä¹‰äº†operator newå‡½æ•°å’Œoperator deleteå‡½æ•°çš„8ä¸ªé‡è½½ç‰ˆæœ¬ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"> <span class="number">1</span> <span class="comment">//è¿™äº›ç‰ˆæœ¬å¯èƒ½æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"> <span class="number">2</span> <span class="function"><span class="keyword">void</span> * <span class="keyword">operator</span> <span class="title">new</span><span class="params">(<span class="keyword">size_t</span>)</span></span>;</span><br><span class="line"> <span class="number">3</span> <span class="keyword">void</span> * <span class="keyword">operator</span> <span class="keyword">new</span>[](<span class="keyword">size_t</span>);</span><br><span class="line"> <span class="number">4</span> <span class="function"><span class="keyword">void</span> * <span class="keyword">operator</span> <span class="title">delete</span> <span class="params">(<span class="keyword">void</span> * )</span><span class="keyword">noexcept</span></span>;</span><br><span class="line"> <span class="number">5</span> <span class="keyword">void</span> * <span class="keyword">operator</span> <span class="keyword">delete</span>[](<span class="keyword">void</span> *<span class="number">0</span>ï¼‰<span class="keyword">noexcept</span>;</span><br><span class="line"> <span class="number">6</span> <span class="comment">//è¿™äº›ç‰ˆæœ¬æ‰¿è¯ºä¸æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line"> <span class="number">7</span> <span class="keyword">void</span> * <span class="keyword">operator</span> <span class="keyword">new</span>(<span class="keyword">size_t</span> ,<span class="keyword">nothrow_t</span>&amp;) <span class="keyword">noexcept</span>;</span><br><span class="line"> <span class="number">8</span> <span class="keyword">void</span> * <span class="keyword">operator</span> <span class="keyword">new</span>[](<span class="keyword">size_t</span>, <span class="keyword">nothrow_t</span>&amp; );</span><br><span class="line"> <span class="number">9</span> <span class="keyword">void</span> * <span class="keyword">operator</span> <span class="keyword">delete</span> (<span class="keyword">void</span> *,<span class="keyword">nothrow_t</span>&amp; )<span class="keyword">noexcept</span>;</span><br><span class="line"><span class="number">10</span> <span class="keyword">void</span> * <span class="keyword">operator</span> <span class="keyword">delete</span>[](<span class="keyword">void</span> *<span class="number">0</span>,<span class="keyword">nothrow_t</span>&amp; ï¼‰<span class="keyword">noexcept</span>;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸Šé¢å‡½æ•°ç‰ˆæœ¬ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œå‰ææ˜¯è‡ªå®šä¹‰ç‰ˆæœ¬å¿…é¡»ä½äºå…¨å±€ä½œç”¨åŸŸæˆ–è€…ç±»ä½œç”¨åŸŸä¸­ã€‚å¤ªç»†èŠ‚çš„ä¸œè¥¿ä¸åœ¨è¿™é‡Œè®²è¿°ï¼Œæ€»ä¹‹ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„è‡ªç”±å»é‡è½½operator new /operator delete ,ä»¥å†³å®šæˆ‘ä»¬çš„newä¸deleteå¦‚ä½•ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼Œå¦‚ä½•å›æ”¶å¯¹è±¡ã€‚</p>
<p>è€Œmalloc/freeå¹¶ä¸å…è®¸é‡è½½ã€‚</p>
<h2 id="9.-èƒ½å¤Ÿç›´è§‚åœ°é‡æ–°åˆ†é…å†…å­˜">9. èƒ½å¤Ÿç›´è§‚åœ°é‡æ–°åˆ†é…å†…å­˜<a title="#9.-èƒ½å¤Ÿç›´è§‚åœ°é‡æ–°åˆ†é…å†…å­˜" href="#9.-èƒ½å¤Ÿç›´è§‚åœ°é‡æ–°åˆ†é…å†…å­˜"></a></h2>
<p>ä½¿ç”¨mallocåˆ†é…çš„å†…å­˜åï¼Œå¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å†…å­˜ä¸è¶³ï¼Œå¯ä»¥ä½¿ç”¨reallocå‡½æ•°è¿›è¡Œå†…å­˜é‡æ–°åˆ†é…å®ç°å†…å­˜çš„æ‰©å……ã€‚reallocå…ˆåˆ¤æ–­å½“å‰çš„æŒ‡é’ˆæ‰€æŒ‡å†…å­˜æ˜¯å¦æœ‰è¶³å¤Ÿçš„è¿ç»­ç©ºé—´ï¼Œå¦‚æœæœ‰ï¼ŒåŸåœ°æ‰©å¤§å¯åˆ†é…çš„å†…å­˜åœ°å€ï¼Œå¹¶ä¸”è¿”å›åŸæ¥çš„åœ°å€æŒ‡é’ˆï¼›å¦‚æœç©ºé—´ä¸å¤Ÿï¼Œå…ˆæŒ‰ç…§æ–°æŒ‡å®šçš„å¤§å°åˆ†é…ç©ºé—´ï¼Œå°†åŸæœ‰æ•°æ®ä»å¤´åˆ°å°¾æ‹·è´åˆ°æ–°åˆ†é…çš„å†…å­˜åŒºåŸŸï¼Œè€Œåé‡Šæ”¾åŸæ¥çš„å†…å­˜åŒºåŸŸã€‚</p>
<p>newæ²¡æœ‰è¿™æ ·ç›´è§‚çš„é…å¥—è®¾æ–½æ¥æ‰©å……å†…å­˜ã€‚</p>
<h2 id="10.-å®¢æˆ·å¤„ç†å†…å­˜åˆ†é…ä¸è¶³">10. å®¢æˆ·å¤„ç†å†…å­˜åˆ†é…ä¸è¶³<a title="#10.-å®¢æˆ·å¤„ç†å†…å­˜åˆ†é…ä¸è¶³" href="#10.-å®¢æˆ·å¤„ç†å†…å­˜åˆ†é…ä¸è¶³"></a></h2>
<p>åœ¨operator newæŠ›å‡ºå¼‚å¸¸ä»¥åæ˜ ä¸€ä¸ªæœªè·å¾—æ»¡è¶³çš„éœ€æ±‚ä¹‹å‰ï¼Œå®ƒä¼šå…ˆè°ƒç”¨ä¸€ä¸ªç”¨æˆ·æŒ‡å®šçš„é”™è¯¯å¤„ç†å‡½æ•°ï¼Œè¿™å°±æ˜¯new-handlerã€‚new_handleræ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="built_in">std</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*new_handler)</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æŒ‡å‘äº†ä¸€ä¸ªæ²¡æœ‰å‚æ•°æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°,å³ä¸ºé”™è¯¯å¤„ç†å‡½æ•°ã€‚ä¸ºäº†æŒ‡å®šé”™è¯¯å¤„ç†å‡½æ•°ï¼Œå®¢æˆ·éœ€è¦è°ƒç”¨set_new_handlerï¼Œè¿™æ˜¯ä¸€ä¸ªå£°æ˜äºçš„ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="built_in">std</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">new_handler <span class="title">set_new_handler</span><span class="params">(new_handler p )</span> <span class="title">throw</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>set_new_handlerçš„å‚æ•°ä¸ºnew_handleræŒ‡é’ˆï¼ŒæŒ‡å‘äº†operator new æ— æ³•åˆ†é…è¶³å¤Ÿå†…å­˜æ—¶è¯¥è°ƒç”¨çš„å‡½æ•°ã€‚å…¶è¿”å›å€¼ä¹Ÿæ˜¯ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘set_new_handlerè¢«è°ƒç”¨å‰æ­£åœ¨æ‰§è¡Œï¼ˆä½†é©¬ä¸Šå°±è¦å‘ç”Ÿæ›¿æ¢ï¼‰çš„é‚£ä¸ªnew_handlerå‡½æ•°ã€‚</p>
<p>å¯¹äºmallocï¼Œå®¢æˆ·å¹¶ä¸èƒ½å¤Ÿå»ç¼–ç¨‹å†³å®šå†…å­˜ä¸è¶³ä»¥åˆ†é…æ—¶è¦å¹²ä»€ä¹ˆäº‹ï¼Œåªèƒ½çœ‹ç€mallocè¿”å›NULLã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“<a title="#æ€»ç»“" href="#æ€»ç»“"></a></h2>
<p>å°†ä¸Šé¢æ‰€è¿°çš„10ç‚¹å·®åˆ«æ•´ç†æˆè¡¨æ ¼ï¼š</p>
<p><img src="https://images2018.cnblogs.com/blog/1191971/201803/1191971-20180319111342066-1232739079.png" alt="img" class="Ï†cx"></p>
<p><strong>å¦‚æœ‰ä¸å¯¹çš„åœ°æ–¹ï¼Œéå¸¸æ¬¢è¿ç»™äºˆæŒ‡å¯¼ï¼</strong></p>
<p><strong>å¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥ç»™æˆ‘ç•™è¨€</strong></p>
<p><strong>ã€æ„Ÿè°¢ã€‘èµ„æ–™æ¥æºäº</strong></p>
<p><strong>â€”â€”<a href="http://blog.jobbole.com/102002/" target="_blank" rel="noopener">http://blog.jobbole.com/102002/</a></strong></p>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>C++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘</title>
    <url>/posts/%E5%AE%8C%E7%BE%8E%E8%BD%AC%E5%8F%91/</url>
    <content><![CDATA[<h2 id="c++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘">C++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘<a title="#c++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘" href="#c++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘"></a></h2>
<ul>
<li>é˜…è¯»è¿™ç¯‡åšæ–‡éœ€è¦äº†è§£C<ins>ä¸­çš„å·¦å€¼ï¼ˆlvalueï¼‰å’Œå³å€¼ï¼ˆrvalueï¼‰çš„æ¦‚å¿µï¼Œè¯¦æƒ…å‚è§æˆ‘çš„å¦å¤–ä¸€ç¯‡åšæ–‡ï¼šC</ins>ç§»åŠ¨è¯­ä¹‰åŠæ‹·è´ä¼˜åŒ–</li>
<li>ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘å¤šæ¶‰åŠåˆ°æ¨¡æ¿çš„ä½¿ç”¨ï¼Œå¦‚è‹¥ä¸æ˜¯è‡ªå·±å†™æ¨¡æ¿ï¼Œåˆ™å¯ä¸ç”¨å…³å¿ƒ</li>
</ul>
<a id="more"></a>
<h3 id="å·¦å€¼ä¸å³å€¼çš„åŒºåˆ†">å·¦å€¼ä¸å³å€¼çš„åŒºåˆ†<a title="#å·¦å€¼ä¸å³å€¼çš„åŒºåˆ†" href="#å·¦å€¼ä¸å³å€¼çš„åŒºåˆ†"></a></h3>
<p>é¦–å…ˆç†è§£ä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨ï¼ˆä¸‹é¢æ˜¯ç™¾åº¦ç™¾ç§‘ç»™å‡ºçš„è§£é‡Šï¼‰ï¼š</p>
<p>å³å€¼å¼•ç”¨ï¼ˆåŠå…¶æ”¯æŒçš„Moveè¯­æ„å’Œå®Œç¾è½¬å‘ï¼‰æ˜¯C<ins>0xå°†è¦åŠ å…¥çš„æœ€é‡å¤§è¯­è¨€ç‰¹æ€§ä¹‹ä¸€ï¼Œè¿™ç‚¹ä»è¯¥ç‰¹æ€§çš„ææ¡ˆåœ¨C</ins> - State of the Evolutionåˆ—è¡¨ä¸Šé«˜å±…æ¦œé¦–ä¹Ÿå¯ä»¥çœ‹å¾—å‡ºæ¥ã€‚ä»å®è·µè§’åº¦è®²ï¼Œå®ƒèƒ½å¤Ÿå®Œç¾è§£å†³C<ins>ä¸­é•¿ä¹…ä»¥æ¥ä¸ºäººæ‰€è¯Ÿç—…çš„ä¸´æ—¶å¯¹è±¡æ•ˆç‡é—®é¢˜ã€‚ä»è¯­è¨€æœ¬èº«è®²ï¼Œå®ƒå¥å…¨äº†C</ins>ä¸­çš„å¼•ç”¨ç±»å‹åœ¨å·¦å€¼å³å€¼æ–¹é¢çš„ç¼ºé™·ã€‚ä»åº“è®¾è®¡è€…çš„è§’åº¦è®²ï¼Œå®ƒç»™åº“è®¾è®¡è€…åˆå¸¦æ¥äº†ä¸€æŠŠåˆ©å™¨ã€‚ä»åº“ä½¿ç”¨è€…çš„è§’åº¦è®²ï¼Œä¸åŠ¨ä¸€å…µä¸€å’ä¾¿å¯ä»¥è·å¾—â€œå…è´¹çš„â€æ•ˆç‡æå‡â€¦ ã€€ã€€åœ¨æ ‡å‡†C<ins>è¯­è¨€ä¸­ï¼Œä¸´æ—¶é‡ï¼ˆæœ¯è¯­ä¸ºå³å€¼ï¼Œå› å…¶å‡ºç°åœ¨èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹ï¼‰å¯ä»¥è¢«ä¼ ç»™å‡½æ•°ï¼Œä½†åªèƒ½è¢«æ¥å—ä¸ºconst &amp;ç±»å‹ã€‚è¿™æ ·å‡½æ•°ä¾¿æ— æ³•åŒºåˆ†ä¼ ç»™const &amp;çš„æ˜¯çœŸå®çš„å³å€¼è¿˜æ˜¯å¸¸è§„å˜é‡ã€‚è€Œä¸”ï¼Œç”±äºç±»å‹ä¸ºconst &amp;ï¼Œå‡½æ•°ä¹Ÿæ— æ³•æ”¹å˜æ‰€ä¼ å¯¹è±¡çš„å€¼ã€‚C</ins>0xå°†å¢åŠ ä¸€ç§åä¸ºå³å€¼å¼•ç”¨çš„æ–°çš„å¼•ç”¨ç±»å‹ï¼Œè®°ä½œtypename &amp;&amp;ã€‚è¿™ç§ç±»å‹å¯ä»¥è¢«æ¥å—ä¸ºéconstå€¼ï¼Œä»è€Œå…è®¸æ”¹å˜å…¶å€¼ã€‚</p>
<p><strong>åŒºåˆ†å·¦å€¼ä¸å³å€¼ï¼š</strong></p>
<p>C++ 11ä¸­å¼•å…¥çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µå°±æ˜¯å³å€¼å¼•ç”¨ã€‚ç†è§£å³å€¼å¼•ç”¨æ˜¯å­¦ä¹ â€œç§»åŠ¨è¯­ä¹‰â€ï¼ˆmove semanticsï¼‰çš„åŸºç¡€ã€‚è€Œè¦ç†è§£å³å€¼å¼•ç”¨ï¼Œå°±å¿…é¡»å…ˆåŒºåˆ†å·¦å€¼ä¸å³å€¼ã€‚<br>
å¯¹å·¦å€¼å’Œå³å€¼çš„ä¸€ä¸ªæœ€å¸¸è§çš„è¯¯è§£æ˜¯ï¼šç­‰å·å·¦è¾¹çš„å°±æ˜¯å·¦å€¼ï¼Œç­‰å·å³è¾¹çš„å°±æ˜¯å³å€¼ã€‚</p>
<p><strong>ä»€ä¹ˆæ˜¯å·¦å€¼å¼•ç”¨ï¼š</strong><br>
åŒºåˆ†æ¸…æ¥šäº†å·¦å€¼ä¸å³å€¼ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å·¦å€¼å¼•ç”¨ã€‚å·¦å€¼å¼•ç”¨æ ¹æ®å…¶ä¿®é¥°ç¬¦çš„ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºéå¸¸é‡å·¦å€¼å¼•ç”¨(<strong>eg.1 double &amp;r =i;</strong>)å’Œå¸¸é‡å·¦å€¼å¼•ç”¨(<strong>eg.1 const double &amp;r =i;</strong>)ã€‚<br>
éå¸¸é‡å·¦å€¼å¼•ç”¨åªèƒ½ç»‘å®šåˆ°éå¸¸é‡å·¦å€¼ï¼Œä¸èƒ½ç»‘å®šåˆ°å¸¸é‡å·¦å€¼ã€éå¸¸é‡å³å€¼å’Œå¸¸é‡å³å€¼ã€‚å¦‚æœå…è®¸ç»‘å®šåˆ°å¸¸é‡å·¦å€¼å’Œå¸¸é‡å³å€¼ï¼Œåˆ™éå¸¸é‡å·¦å€¼å¼•ç”¨å¯ä»¥ç”¨äºä¿®æ”¹å¸¸é‡å·¦å€¼å’Œå¸¸é‡å³å€¼ï¼Œè¿™æ˜æ˜¾è¿åäº†å…¶å¸¸é‡çš„å«ä¹‰(<strong>eg.1ä¸­å°±æ˜¯å‡ºç°äº†éå¸¸é‡å·¦å€¼å¼•ç”¨ç»‘å®šåˆ°å¸¸é‡å³å€¼çš„æƒ…å†µ</strong>)ã€‚å¦‚æœå…è®¸ç»‘å®šåˆ°éå¸¸é‡å³å€¼ï¼Œåˆ™ä¼šå¯¼è‡´éå¸¸å±é™©çš„æƒ…å†µå‡ºç°ï¼Œå› ä¸ºéå¸¸é‡å³å€¼æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œéå¸¸é‡å·¦å€¼å¼•ç”¨å¯èƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå·²ç»è¢«é”€æ¯äº†çš„ä¸´æ—¶å¯¹è±¡ã€‚<br>
<strong>å¸¸é‡å·¦å€¼å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°æ‰€æœ‰ç±»å‹çš„å€¼ï¼ŒåŒ…æ‹¬éå¸¸é‡å·¦å€¼ã€å¸¸é‡å·¦å€¼ã€éå¸¸é‡å³å€¼å’Œå¸¸é‡å³å€¼ã€‚</strong></p>
<p>å¦‚æœåŒæ—¶åŒ…å«å·¦å€¼å’Œå³å€¼çš„å‡½æ•°é‡è½½ï¼Œå³å€¼ä¼šä¼˜å…ˆåŒ¹é…å³å€¼çš„é‡è½½ç‰ˆæœ¬ï¼Œå…¶æ¬¡åŒ¹é…å¸¸é‡å·¦å€¼é‡è½½ç‰ˆæœ¬ã€‚</p>
<h3 id="ä¸‡èƒ½å¼•ç”¨ï¼ˆuniversal-referenceï¼‰">ä¸‡èƒ½å¼•ç”¨ï¼ˆUniversal Referenceï¼‰<a title="#ä¸‡èƒ½å¼•ç”¨ï¼ˆuniversal-referenceï¼‰" href="#ä¸‡èƒ½å¼•ç”¨ï¼ˆuniversal-referenceï¼‰"></a></h3>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">cout</span>;</span><br><span class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(T&amp; param)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; param &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">2019</span>;</span><br><span class="line">    func(num);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¾‹å­çš„ç¼–è¯‘è¾“å‡ºéƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¿®æ”¹æˆä¸‹é¢çš„è°ƒç”¨æ–¹å¼å‘¢ï¼Ÿ</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span><span class="params">(<span class="number">2019</span>)</span>;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ™ä¼šå¾—åˆ°ä¸€ä¸ªå¤§å¤§çš„ç¼–è¯‘é”™è¯¯ã€‚å› ä¸ºä¸Šé¢çš„æ¨¡æ¿å‡½æ•°åªèƒ½æ¥å—å·¦å€¼æˆ–è€…å·¦å€¼å¼•ç”¨ï¼ˆå·¦å€¼ä¸€èˆ¬æ˜¯æœ‰åå­—çš„å˜é‡ï¼Œå¯ä»¥å–åˆ°åœ°å€çš„ï¼‰ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥é‡è½½ä¸€ä¸ªæ¥å—å³å€¼çš„æ¨¡æ¿å‡½æ•°ï¼Œå¦‚ä¸‹ä¹Ÿå¯ä»¥è¾¾åˆ°æ•ˆæœã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(T&amp; param)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"ä¼ å…¥çš„æ˜¯å·¦å€¼"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(T&amp;&amp; param)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"ä¼ å…¥çš„æ˜¯å³å€¼"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">2019</span>;</span><br><span class="line">    func(num);</span><br><span class="line">    func(<span class="number">2019</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">ä¼ å…¥çš„æ˜¯å·¦å€¼</span><br><span class="line">ä¼ å…¥çš„æ˜¯å³å€¼</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„æ˜¯å·¦å€¼å¾—ç‰ˆæœ¬ï¼Œç¬¬äºŒæ¬¡å‡½æ•°è°ƒç”¨çš„æ˜¯å³å€¼ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œæœ‰æ²¡æœ‰åŠæ³•åªå†™ä¸€ä¸ªæ¨¡æ¿å‡½æ•°å³å¯ä»¥æ¥æ”¶å·¦å€¼åˆå¯ä»¥æ¥æ”¶å³å€¼å‘¢ï¼Ÿ</p>
<p>â€‹     <strong>C++ 11ä¸­æœ‰ä¸‡èƒ½å¼•ç”¨ï¼ˆUniversal Referenceï¼‰çš„æ¦‚å¿µï¼šä½¿ç”¨T&amp;&amp;ç±»å‹çš„å½¢å‚æ—¢èƒ½ç»‘å®šå³å€¼ï¼Œåˆèƒ½ç»‘å®šå·¦å€¼ã€‚åªæœ‰åœ¨æ¨¡ç‰ˆä¸­æ‰ç”Ÿæ•ˆï¼Œæ™®é€šå‡½æ•°ä¸­å·¦å€¼å¼•ç”¨ï¼ˆéå¸¸é‡ï¼‰åªæ¥å—å·¦å€¼ï¼Œå³å€¼å¼•ç”¨åªæ¥å—å³å€¼ï¼Œconst å·¦å€¼å¼•ç”¨å¯ä»¥æ¥å—ä»»ä½•å€¼ï¼Œconst å³å€¼å¼•ç”¨èƒ½æ¥å—ä»»ä½•å³å€¼ï¼Œæ¨å¯¼åçš„æ¨¡ç‰ˆä¹ŸåŒç†ã€‚</strong></p>
<p>ä½†æ˜¯æ³¨æ„äº†ï¼š<strong>åªæœ‰å‘ç”Ÿç±»å‹æ¨å¯¼çš„æ—¶å€™ï¼ŒT&amp;&amp;æ‰è¡¨ç¤ºä¸‡èƒ½å¼•ç”¨ï¼›</strong> å¦åˆ™ï¼Œè¡¨ç¤ºå³å€¼å¼•ç”¨ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸Šé¢çš„æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line">template&lt;typename T&gt;</span><br><span class="line">void <span class="function"><span class="keyword">func</span><span class="params">(T&amp;&amp; param)</span> &#123;</span></span><br><span class="line">    cout &lt;&lt; param &lt;&lt; endl<span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">    <span class="built_in">int</span> num = <span class="number">2019</span><span class="comment">;</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span><span class="params">(num)</span>;</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span><span class="params">(<span class="number">2019</span>)</span>;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¼•ç”¨æŠ˜å ï¼ˆuniversal-collapseï¼‰">å¼•ç”¨æŠ˜å ï¼ˆUniversal Collapseï¼‰<a title="#å¼•ç”¨æŠ˜å ï¼ˆuniversal-collapseï¼‰" href="#å¼•ç”¨æŠ˜å ï¼ˆuniversal-collapseï¼‰"></a></h2>
<p>ä¸‡èƒ½å¼•ç”¨è¯´å®Œäº†ï¼Œæ¥ç€æ¥èŠå¼•ç”¨æŠ˜å ï¼ˆUnivers Collapseï¼‰ï¼Œå› ä¸ºå®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰çš„æ¦‚å¿µæ¶‰åŠå¼•ç”¨æŠ˜å ã€‚ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œæ ¹æ®å®šä¹‰çš„å½¢å‚å’Œä¼ å…¥çš„å®å‚çš„ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä¸‹é¢å››ä¸­ç»„åˆï¼š</p>
<ul>
<li>å·¦å€¼-å·¦å€¼ T&amp; &amp;        # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å·¦å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å·¦å€¼å¼•ç”¨</li>
<li>å·¦å€¼-å³å€¼ T&amp; &amp;&amp;      # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å·¦å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å³å€¼å¼•ç”¨ï¼ˆå¿…é¡»constä¿®é¥°ï¼‰</li>
<li>å³å€¼-å·¦å€¼ T&amp;&amp; &amp;      # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å³å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å·¦å€¼å¼•ç”¨</li>
<li>å³å€¼-å³å€¼ T&amp;&amp; &amp;&amp;    # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å³å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å³å€¼å¼•ç”¨</li>
</ul>
<p>ä½†æ˜¯C++ä¸­ä¸å…è®¸å¯¹å¼•ç”¨å†è¿›è¡Œå¼•ç”¨ï¼Œå¯¹äºä¸Šè¿°æƒ…å†µçš„å¤„ç†æœ‰å¦‚ä¸‹çš„è§„åˆ™ï¼š</p>
<p>æ‰€æœ‰çš„æŠ˜å å¼•ç”¨æœ€ç»ˆéƒ½ä»£è¡¨ä¸€ä¸ªå¼•ç”¨ï¼Œè¦ä¹ˆæ˜¯å·¦å€¼å¼•ç”¨ï¼Œè¦ä¹ˆæ˜¯å³å€¼å¼•ç”¨ã€‚è§„åˆ™æ˜¯ï¼šå¦‚æœä»»ä¸€å¼•ç”¨ä¸ºå·¦å€¼å¼•ç”¨ï¼Œåˆ™ç»“æœä¸ºå·¦å€¼å¼•ç”¨ã€‚å¦åˆ™ï¼ˆå³ä¸¤ä¸ªéƒ½æ˜¯å³å€¼å¼•ç”¨ï¼‰ï¼Œç»“æœä¸ºå³å€¼å¼•ç”¨ã€‚</p>
<p>å³å°±æ˜¯å‰é¢ä¸‰ç§æƒ…å†µä»£è¡¨çš„éƒ½æ˜¯å·¦å€¼å¼•ç”¨ï¼Œè€Œç¬¬å››ç§ä»£è¡¨çš„å³å€¼å¼•ç”¨ã€‚</p>
<h2 id="å®Œç¾è½¬å‘ï¼ˆperfect-forwardingï¼‰">å®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰<a title="#å®Œç¾è½¬å‘ï¼ˆperfect-forwardingï¼‰" href="#å®Œç¾è½¬å‘ï¼ˆperfect-forwardingï¼‰"></a></h2>
<p>ä¸‹é¢æ¥ç€è¯´å®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰ï¼Œé¦–å…ˆï¼Œçœ‹ä¸ªä¾‹å­ï¼š</p>
<p>ğŸŒ°[æ —å­]<br>
è¦äº†è§£å®Œç¾è½¬å‘ï¼Œå…ˆå¾—æ¸…æ¥šæ¨¡æ¿Tçš„<strong>æ¨å¯¼è¿‡ç¨‹</strong>ï¼Œ<span class="label success">åœ¨æ²¡æœ‰åç‰¹åŒ–çš„æ¨¡ç‰ˆå‰æä¸‹ï¼Œæ¨¡æ¿æ€»æ˜¯æ ¹æ®æœ€åŒ¹é…çš„è§„åˆ™æ¥æ¨å¯¼å‚æ•°ï¼Œå·¦å€¼å¼•ç”¨templateå‡½æ•°æ¨å¯¼å‡ºæ¥æ€»æ˜¯å·¦å€¼å¼•ç”¨å‡½æ•°ï¼Œå³å€¼å¼•ç”¨templateå‡½æ•°èƒ½æ¨å¯¼å‡ºå·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨å‡½æ•°</span>ï¼Œå¯ä»¥æ ¹æ®ä¸‹é¢çš„ä¾‹å­æ¥çœ‹å‡ºæ¨å¯¼è¿‡ç¨‹ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(T&amp;&amp; arg)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//auto is_lval = std::is_lvalue_reference&lt;T&gt;::value;</span></span><br><span class="line">    <span class="comment">//auto is_rval  = std::is_rvalue_reference&lt;T&gt;::value;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">std</span>::is_same&lt;T, <span class="keyword">int</span>&gt;::value) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"'T' is type[int]"</span>  &lt;&lt; <span class="string">" arg:"</span> &lt;&lt; arg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">std</span>::is_same&lt;T, <span class="keyword">const</span> <span class="keyword">int</span>&gt;::value) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"'T' is type[const int]"</span> &lt;&lt; <span class="string">" arg:"</span> &lt;&lt; arg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">std</span>::is_same&lt;T, <span class="keyword">int</span>&amp;&gt;::value) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"'T' is type[int&amp;]"</span> &lt;&lt; <span class="string">" arg:"</span> &lt;&lt; arg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">std</span>::is_same&lt;T, <span class="keyword">const</span> <span class="keyword">int</span>&amp;&gt;::value) &#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"'T' is type[const int&amp;]"</span> &lt;&lt; <span class="string">" arg:"</span> &lt;&lt; arg &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="string">"-----------------"</span> &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">int</span>&amp; b = <span class="number">2</span>;</span><br><span class="line">  func(a);  <span class="comment">//ä¼ å…¥å·¦å€¼å¼•ç”¨ T =&gt; int&amp;</span></span><br><span class="line">  func(b);  <span class="comment">//ä¼ å…¥å¸¸é‡å·¦å€¼å¼•ç”¨ T =&gt; const int&amp;</span></span><br><span class="line">  func(<span class="number">3</span>);  <span class="comment">//ä¼ å…¥å³å€¼å¼•ç”¨ T =&gt; int</span></span><br><span class="line">  func(<span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&gt;(a));        <span class="comment">//ä¼ å…¥è½¬æ¢åçš„å³å€¼å¼•ç”¨ T =&gt; int</span></span><br><span class="line">  func(<span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&amp;&gt;(a));       <span class="comment">//ä¼ å…¥è½¬æ¢åçš„å·¦å€¼å¼•ç”¨ T =&gt; int&amp;</span></span><br><span class="line">  func(<span class="keyword">static_cast</span>&lt;<span class="keyword">const</span> <span class="keyword">int</span>&amp;&amp;&gt;(a));<span class="comment">//ä¼ å…¥è½¬æ¢åçš„å¸¸é‡å³å€¼ T =&gt; const int</span></span><br><span class="line">  func&lt;<span class="keyword">int</span>&gt;(a);  <span class="comment">//é”™è¯¯âŒ æ˜¾ç¤ºæŒ‡å®šæ¨¡ç‰ˆå½¢å‚ï¼Œæ¨å¯¼ååªèƒ½æ¥å—å³å€¼å¼•ç”¨ï¼Œè€Œaæ˜¯å·¦å€¼</span></span><br><span class="line">  func&lt;<span class="keyword">int</span>&amp;&gt;(a); <span class="comment">//ç¤ºæŒ‡å®šæ¨¡ç‰ˆå½¢å‚ï¼Œæ¨å¯¼ååªå¯æ¥å—å·¦å€¼å¼•ç”¨ï¼Œaæ˜¯å·¦å€¼</span></span><br><span class="line">  func&lt;<span class="keyword">const</span> <span class="keyword">int</span>&gt;(<span class="number">1</span>); <span class="comment">//ç¤ºæŒ‡å®šæ¨¡ç‰ˆå½¢å‚ï¼Œæ¨å¯¼ååªå¯æ¥å—å³å€¼ï¼Œä¸”ä¸èƒ½ä¿®æ”¹ï¼Œ1æ˜¯å³å€¼</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¾“å‡ºç»“æœä¸ºï¼š</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">$g++ -std=<span class="keyword">c</span>++<span class="number">11</span> -<span class="keyword">o</span> main *.cpp</span><br><span class="line">$main</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[<span class="keyword">int</span>&amp;] <span class="keyword">ar</span><span class="variable">g:1</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[const <span class="keyword">int</span>&amp;] <span class="keyword">ar</span><span class="variable">g:2</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[<span class="keyword">int</span>] <span class="keyword">ar</span><span class="variable">g:3</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[<span class="keyword">int</span>] <span class="keyword">ar</span><span class="variable">g:1</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[<span class="keyword">int</span>&amp;] <span class="keyword">ar</span><span class="variable">g:1</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[const <span class="keyword">int</span>] <span class="keyword">ar</span><span class="variable">g:1</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[<span class="keyword">int</span>&amp;] <span class="keyword">ar</span><span class="variable">g:1</span></span><br><span class="line">-----------------</span><br><span class="line"><span class="string">'T'</span> <span class="keyword">is</span> <span class="built_in">type</span>[const <span class="keyword">int</span>] <span class="keyword">ar</span><span class="variable">g:1</span></span><br><span class="line">-----------------</span><br></pre></td></tr></table></figure>
<p>é”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">main.cpp:6:6: note:   template argument deduction/substitution failed:</span><br><span class="line">main.cpp:35:14: note:   cannot convert â€˜aâ€™ (type â€˜intâ€™) <span class="keyword">to</span><span class="built_in"> type </span>â€˜int&amp;&amp;â€™</span><br><span class="line">   func&lt;int&gt;(a);</span><br></pre></td></tr></table></figure>
<span class="label success">æ ¹æ®C++ Primerä¸­æ–‡ç‰ˆ(ç¬¬äº”ç‰ˆ) 18ç« ç¬¬2èŠ‚æ¨¡æ¿å®å‚æ¨æ–­</span>
<p><strong>Note:å¦‚æœæ˜¾ç¤ºæ¨å¯¼æ¨¡ç‰ˆTçš„ç±»å‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘ä¸è¿‡ï¼Œå› ä¸ºä¼šå¯¼è‡´æ¨åˆ°å‡ºæ¥çš„å‡½æ•°å®å‚å’Œå½¢å‚å¼•ç”¨ç±»å‹ä¸ä¸€è‡´</strong></p>
<h2 id="std::forward()">std::forward()<a title="#std::forward()" href="#std::forward()"></a></h2>
<h3 id="std::forwardå®Œç¾è½¬å‘è§£æ">std::forwardå®Œç¾è½¬å‘è§£æ<a title="#std::forwardå®Œç¾è½¬å‘è§£æ" href="#std::forwardå®Œç¾è½¬å‘è§£æ"></a></h3>
<blockquote>
<p>å®Œç¾è½¬å‘å®ç°äº†å‚æ•°åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ä¿æŒå…¶å€¼å±æ€§çš„åŠŸèƒ½ï¼Œå³è‹¥æ˜¯å·¦å€¼ï¼Œåˆ™ä¼ é€’ä¹‹åä»ç„¶æ˜¯å·¦å€¼ï¼Œè‹¥æ˜¯å³å€¼ï¼Œåˆ™ä¼ é€’ä¹‹åä»ç„¶æ˜¯å³å€¼ã€‚</p>
<p>C++11 lets us perform perfect forwarding, which means that we can forward the parameters passed to a function template to another function call inside it without losing their own qualifiers (const-ref, ref, value, rvalue, etc.).</p>
</blockquote>
<h3 id="std::forward()è§£æ">std::forward()è§£æ<a title="#std::forward()è§£æ" href="#std::forward()è§£æ"></a></h3>
<p>std::forwardåªæœ‰åœ¨å®ƒçš„å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šçš„æ—¶å€™ï¼Œå®ƒæ‰è½¬æ¢å®ƒçš„å‚æ•°åˆ°ä¸€ä¸ªå³å€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> member;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    Foo(T&amp;&amp; member): member&#123;<span class="built_in">std</span>::forward&lt;T&gt;(member)&#125; &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>å¯¹äºFooå‡½æ•°ä¸­memberå˜é‡ï¼Œæ— è®ºä¹‹å‰æ˜¯ä»€ä¹ˆï¼Œéƒ½å˜ä¸ºå·¦å€¼äº†ï¼Œå› ä¸ºä»–æœ‰åå­—äº†</strong>:smile:</p>
<p>ä¼ é€’ä¸€ä¸ªlvalueæˆ–è€…ä¼ é€’ä¸€ä¸ªconst lvaue</p>
<ul>
<li>ä¼ é€’ä¸€ä¸ªlvalueï¼Œæ¨¡æ¿æ¨å¯¼ä¹‹å <code>T = std::string&amp;</code></li>
<li>ä¼ é€’ä¸€ä¸ªconst lvaue, æ¨¡æ¿æ¨å¯¼ä¹‹å<code>T = const std::string&amp;</code></li>
<li><code>T&amp; &amp;&amp;</code>å°†æŠ˜å ä¸ºT&amp;ï¼Œå³<code>std::string&amp; &amp;&amp; æŠ˜å ä¸º std::string&amp;</code></li>
<li>æœ€ç»ˆå‡½æ•°ä¸º: <code>Foo(string&amp; member): member{std::forward&lt;string&amp;&gt;(member)} {}</code></li>
<li>std::forward&lt;string&amp;&gt;(member)å°†è¿”å›ä¸€ä¸ªå·¦å€¼ï¼Œæœ€ç»ˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</li>
</ul>
<p>ä¼ é€’ä¸€ä¸ªrvalue</p>
<ul>
<li>ä¼ é€’ä¸€ä¸ªrvalueï¼Œæ¨¡æ¿æ¨å¯¼ä¹‹å <code>T = std::string</code></li>
<li>æœ€ç»ˆå‡½æ•°ä¸º: <code>Foo(string&amp;&amp; member): member{std::forward&lt;string&gt;(member)} {}</code></li>
<li>std::forward<string>(member) å°†è¿”å›ä¸€ä¸ªå³å€¼ï¼Œæœ€ç»ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼›</li>
</ul>
<p>std::moveå’Œstd::forwardæœ¬è´¨éƒ½æ˜¯è½¬æ¢ã€‚std::moveæ‰§è¡Œåˆ°å³å€¼çš„æ— æ¡ä»¶è½¬æ¢ã€‚std::forwardåªæœ‰åœ¨å®ƒçš„å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šçš„æ—¶å€™ï¼Œæ‰è½¬æ¢å®ƒçš„å‚æ•°åˆ°ä¸€ä¸ªå³å€¼ã€‚</p>
<p>std::moveæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ï¼Œstd::forwardæ²¡æœ‰è½¬å‘ä»»ä½•ä¸œè¥¿ã€‚åœ¨è¿è¡ŒæœŸï¼Œå®ƒä»¬æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚å®ƒä»¬æ²¡æœ‰äº§ç”Ÿéœ€è¦æ‰§è¡Œçš„ä»£ç ï¼Œä¸€byteéƒ½æ²¡æœ‰ã€‚</p>
<h2 id="std::move">std::move<a title="#std::move" href="#std::move"></a></h2>
<h3 id="std::moveçš„ä½¿ç”¨">std::moveçš„ä½¿ç”¨<a title="#std::moveçš„ä½¿ç”¨" href="#std::moveçš„ä½¿ç”¨"></a></h3>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">string</span> member;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Copy member.</span></span><br><span class="line">    Foo(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; m): member(m) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Move member.</span></span><br><span class="line">    Foo(<span class="built_in">std</span>::<span class="built_in">string</span>&amp;&amp; m): member(<span class="built_in">std</span>::move(m)) &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°<code>Foo(std::string&amp;&amp; member)</code>ä¸­çš„memberæ˜¯rvalue referenceï¼Œä½†æ˜¯memberå´æ˜¯ä¸€ä¸ªå·¦å€¼lvalueï¼Œå› æ­¤åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­éœ€è¦ä½¿ç”¨std::moveå°†å…¶è½¬æ¢æˆrvalueã€‚</p>
<h3 id="std::move()è§£æ">std::move()è§£æ<a title="#std::move()è§£æ" href="#std::move()è§£æ"></a></h3>
<p>æ ‡å‡†åº“ä¸­moveçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">typename</span> remove_reference&lt;T&gt;::<span class="function">type &amp;&amp; <span class="title">move</span><span class="params">(T&amp;&amp; t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">static_cast</span>&lt;<span class="keyword">typename</span> remove_reference&lt;T&gt;::type &amp;&amp;&gt;(t);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>moveå‡½æ•°çš„å‚æ•°T&amp;&amp;æ˜¯ä¸€ä¸ªæŒ‡å‘æ¨¡æ¿ç±»å‹å‚æ•°çš„å³å€¼å¼•ç”¨ã€è§„åˆ™2ã€‘ï¼Œé€šè¿‡å¼•ç”¨æŠ˜å ï¼Œæ­¤å‚æ•°å¯ä»¥å’Œä»»ä½•ç±»å‹çš„å®å‚åŒ¹é…ï¼Œå› æ­¤moveæ—¢å¯ä»¥ä¼ é€’ä¸€ä¸ªå·¦å€¼ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå³å€¼ï¼›</li>
<li>std::move(string(â€œhelloâ€))è°ƒç”¨è§£æï¼š
<ul>
<li>é¦–å…ˆï¼Œæ ¹æ®æ¨¡æ¿æ¨æ–­è§„åˆ™ï¼Œç¡®åœ°Tçš„ç±»å‹ä¸ºstring;</li>
<li>typename remove_reference<T>::type &amp;&amp; çš„ç»“æœä¸º string &amp;&amp;;</li>
<li>moveå‡½æ•°çš„å‚æ•°ç±»å‹ä¸ºstring&amp;&amp;;</li>
<li>static_cast&lt;string &amp;&amp;&gt;(t)ï¼Œtå·²ç»æ˜¯string&amp;&amp;ï¼Œäºæ˜¯ç±»å‹è½¬æ¢ä»€ä¹ˆéƒ½ä¸åšï¼Œè¿”å›string &amp;&amp;;</li>
</ul>
</li>
<li>string s1(â€œhelloâ€); std::move(s1); è°ƒç”¨è§£æï¼š
<ul>
<li>é¦–å…ˆï¼Œæ ¹æ®æ¨¡æ¿æ¨æ–­è§„åˆ™ï¼Œç¡®å®šTçš„ç±»å‹ä¸ºstring&amp;;</li>
<li>typename remove_reference<T>::type &amp;&amp; çš„ç»“æœä¸º string&amp;</li>
<li>moveå‡½æ•°çš„å‚æ•°ç±»å‹ä¸ºstring&amp; &amp;&amp;ï¼Œå¼•ç”¨æŠ˜å ä¹‹åä¸ºstring&amp;;</li>
<li>static_cast&lt;string &amp;&amp;&gt;(t)ï¼Œtæ˜¯string&amp;ï¼Œç»è¿‡static_castä¹‹åè½¬æ¢ä¸ºstring&amp;&amp;, è¿”å›string &amp;&amp;;</li>
</ul>
</li>
</ul>
<blockquote>
<p>ä»moveçš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œmoveè‡ªèº«é™¤äº†åšä¸€äº›å‚æ•°çš„æ¨æ–­ä¹‹å¤–ï¼Œè¿”å›å³å€¼å¼•ç”¨æœ¬è´¨ä¸Šè¿˜æ˜¯é static_cast&lt;T&amp;&amp;&gt;å®Œæˆçš„ã€‚</p>
</blockquote>
<p>å› æ­¤ä¸‹é¢ä¸¤ä¸ªè°ƒç”¨æ˜¯ç­‰ä»·çš„ï¼Œstd::moveå°±æ˜¯ä¸ªè¯­æ³•ç³–ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>&amp;&amp; a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a = <span class="number">6</span>;</span><br><span class="line">func(<span class="built_in">std</span>::move(a));</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> b = <span class="number">10</span>;</span><br><span class="line">func(<span class="keyword">static_cast</span>&lt;<span class="keyword">int</span>&amp;&amp;&gt;(b));</span><br></pre></td></tr></table></figure>
<p>std::moveæ‰§è¡Œåˆ°å³å€¼çš„æ— æ¡ä»¶è½¬æ¢ã€‚å°±å…¶æœ¬èº«è€Œè¨€ï¼Œå®ƒæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ã€‚</p>
<h2 id="std::move()å’Œstd::forward()å¯¹æ¯”">std::move()å’Œstd::forward()å¯¹æ¯”<a title="#std::move()å’Œstd::forward()å¯¹æ¯”" href="#std::move()å’Œstd::forward()å¯¹æ¯”"></a></h2>
<ul>
<li>std::moveæ‰§è¡Œåˆ°å³å€¼çš„æ— æ¡ä»¶è½¬æ¢ã€‚å°±å…¶æœ¬èº«è€Œè¨€ï¼Œå®ƒæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ã€‚</li>
<li>std::forwardåªæœ‰åœ¨å®ƒçš„å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šçš„æ—¶å€™ï¼Œå®ƒæ‰è½¬æ¢å®ƒçš„å‚æ•°åˆ°ä¸€ä¸ªå³å€¼ã€‚</li>
<li>std::moveå’Œstd::forwardåªä¸è¿‡å°±æ˜¯æ‰§è¡Œç±»å‹è½¬æ¢çš„ä¸¤ä¸ªå‡½æ•°ï¼›std::moveæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ï¼Œstd::forwardæ²¡æœ‰è½¬å‘ä»»ä½•ä¸œè¥¿ã€‚åœ¨è¿è¡ŒæœŸï¼Œå®ƒä»¬æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚å®ƒä»¬æ²¡æœ‰äº§ç”Ÿéœ€è¦æ‰§è¡Œçš„ä»£ç ï¼Œä¸€byteéƒ½æ²¡æœ‰ã€‚</li>
<li>std::forward<T>()ä¸ä»…å¯ä»¥ä¿æŒå·¦å€¼æˆ–è€…å³å€¼ä¸å˜ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¿æŒconstã€Lreferenceã€Rreferenceã€validateç­‰å±æ€§ä¸å˜ï¼›</li>
</ul>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>C++ æ¨¡æ¿åç‰¹åŒ–ï¼æ¥è‡ªSTLçš„æ€è€ƒ</title>
    <url>/posts/%E6%A8%A1%E6%9D%BF%E7%89%B9%E5%8C%96/</url>
    <content><![CDATA[<p>ä¹‹å‰å­¦ä¹ STLæ—¶æ¥è§¦è¿‡ä¸€æ®µæ—¶é—´çš„æ¨¡æ¿ï¼Œæ¨¡æ¿æ˜¯C++æ³›å‹ç¼–ç¨‹ç¼–ç¨‹çš„åŸºç¡€<br>
STLä»å¤´åˆ°å°¾éƒ½æ˜¯æ¨¡æ¿æ³›å‹ç¼–ç¨‹ï¼Œæˆ‘è§‰å¾—ç”¨çš„æœ€å·§å¦™çš„å°±æ˜¯åœ¨traitsèƒå–æŠ€å·§æ—¶ç”¨åˆ°çš„æ¨¡æ¿åç‰¹åŒ–</p>
<hr>
<ul>
<li>å…ˆç®€è¦å›é¡¾ä¸€ä¸‹æ¨¡æ¿å§ï¼Œæ¨¡æ¿ä¸»è¦åˆ†ä¸ºå‡½æ•°æ¨¡æ¿ä¸ç±»æ¨¡æ¿</li>
</ul>
<h2 id="å‡½æ•°æ¨¡æ¿">å‡½æ•°æ¨¡æ¿<a title="#å‡½æ•°æ¨¡æ¿" href="#å‡½æ•°æ¨¡æ¿"></a></h2>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;</span><br><span class="line"><span class="symbol">T</span> <span class="symbol">add</span>(<span class="symbol">T</span> <span class="symbol">a, <span class="symbol">T</span></span> <span class="symbol">b</span>) &#123; <span class="keyword">return</span> a + b;&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> a = <span class="number">1</span>, b = <span class="number">2</span>;</span><br><span class="line">    std::cout &lt;&lt; add(a + b) &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>å¦‚ä¸Šå°±æ˜¯æœ€ç®€å•çš„å‡½æ•°æ¨¡æ¿ï¼Œå½“å®ä¾‹åŒ–å‡½æ•°æ¨¡æ¿æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œå®å‚ç±»å‹æ¨å¯¼<br>
ä¸Šé¢ç±»å‹Tå°±è¢«è‡ªåŠ¨æ¨å¯¼ä¸ºintç±»å‹</p>
<h2 id="ç±»æ¨¡æ¿">ç±»æ¨¡æ¿<a title="#ç±»æ¨¡æ¿" href="#ç±»æ¨¡æ¿"></a></h2>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">templete&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">A</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">explicit</span> A(T val) : t(val) &#123; &#125;</span><br><span class="line">    T add(T x) &#123; <span class="keyword">return</span> t + y; &#125;    </span><br><span class="line">privete:</span><br><span class="line">    T t;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    A&lt;<span class="built_in">int</span>&gt; a(<span class="number">10</span>);</span><br><span class="line">    std::cout &lt;&lt; a.add(<span class="number">5</span>) &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šå°±æ˜¯æœ€ç®€å•çš„ç±»æ¨¡æ¿ï¼Œå®ä¾‹åŒ–ç±»æ¨¡æ¿å¿…é¡»è¦æŒ‡å®šç±»å‹ï¼Œç¼–è¯‘å™¨æ— æ³•ä¸ºç±»æ¨¡æ¿è‡ªåŠ¨æ¨å¯¼ç±»å‹</p>
<h3 id="å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹">å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹<a title="#å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹" href="#å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹"></a></h3>
<ul>
<li>
<p>ï¼‘ï¼ç±»æ¨¡æ¿çš„å’Œå‡½æ•°æ¨¡æ¿éƒ½å¿…é¡»å®šä¹‰åœ¨.hå¤´æ–‡ä»¶ä¸­</p>
</li>
<li>
<p>ï¼’ï¼æ¨¡æ¿çš„å®ä¾‹åŒ–ç±»å‹ç¡®å®šæ˜¯åœ¨ç¼–è¯‘æœŸé—´</p>
</li>
<li>
<p>ï¼“ï¼åªæ˜¯æ¨¡æ¿å†™å¥½äº†ï¼Œç¼–è¯‘ä¸€èˆ¬ä¸ä¼šå¾ˆå¤šå‡ºé”™ï¼Œå‡ºé”™ä¸€èˆ¬ä¼šåœ¨å®ä¾‹åŒ–ç¼–è¯‘ä¹‹å</p>
</li>
<li>
<p>ï¼”ï¼æ¨¡æ¿å®ä¾‹åŒ–åªä¼šå®ä¾‹åŒ–ç”¨åˆ°çš„éƒ¨åˆ†ï¼Œæ²¡æœ‰ç”¨åˆ°çš„éƒ¨åˆ†å°†ä¸ä¼šè¢«å®ä¾‹åŒ–</p>
</li>
</ul>
<hr>
<p>æˆ‘è§‰å¾—æ¨¡æ¿çš„ç‰¹ä¾‹åŒ–æ˜¯æ¨¡æ¿ä¸­æ¯”è¾ƒç²¾é«“çš„ä¸œè¥¿<br>
æœ‰å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼Œç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼Œå…¶ä¸­åˆåˆ†ä¸ºå…¨ç‰¹åŒ–ä¸åç‰¹åŒ–<br>
ä¸»è¦çš„ç”¨é€”éƒ½æ˜¯å¯¹äºç‰¹å®šçš„ç±»å‹ï¼ŒæŒ‡å®šç‰¹å®šçš„å¤„ç†æ–¹å¼<br>
å°±ç›¸å½“äºæ™®é€šç¼–ç¨‹ä¸­if-else if - elseè¿™æ ·çš„æ–¹å¼<br>
ç¼–è¯‘é˜¶æ®µç¡®å®šå¦‚æœæ˜¯æŸä¸ªç‰¹åŒ–ç±»å‹ï¼Œå°±ç”¨ç‰¹åŒ–çš„æ¨¡æ¿<br>
å¦‚æœéƒ½ä¸æ˜¯ï¼Œå°±ç”¨æœ€ä¸€èˆ¬çš„æ¨¡æ¿</p>
<h2 id="å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–">å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–<a title="#å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–" href="#å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–"></a></h2>
<p>å‡½æ•°æ¨¡æ¿åªèƒ½å…¨ç‰¹åŒ–ï¼Œ<span class="label primary">ä¸èƒ½åç‰¹åŒ–</span>ï¼Œå¦‚æœè¦åç‰¹åŒ–çš„è¯åªèƒ½é‡è½½</p>
<h3 id="å‡½æ•°æ¨¡æ¿å…¨ç‰¹åŒ–">å‡½æ•°æ¨¡æ¿å…¨ç‰¹åŒ–<a title="#å‡½æ•°æ¨¡æ¿å…¨ç‰¹åŒ–" href="#å‡½æ•°æ¨¡æ¿å…¨ç‰¹åŒ–"></a></h3>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; &gt;                                  <span class="comment">// å…¨ç‰¹åŒ–ã€€æ³¨æ„è¯­æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">add</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span>  </span>&#123; <span class="keyword">return</span> a + b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">10</span>, y = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">double</span> z = <span class="number">1.1</span>, w = <span class="number">2.2</span>;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; add(x, y) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è°ƒç”¨æ™®é€šç‰ˆæœ¬</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; add(z, w) &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;   <span class="comment">// è°ƒç”¨å…¨ç‰¹åŒ–ç‰ˆæœ¬</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰ä¸å®å‚æ›´åŠ åŒ¹é…çš„ç‰¹ä¾‹åŒ–ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨å°†ä¼šé€‰æ‹©ç‰¹ä¾‹åŒ–ç‰ˆæœ¬</p>
<h3 id="å‡½æ•°æ¨¡æ¿é‡è½½ï¼ˆä¸å­˜åœ¨åç‰¹åŒ–ï¼‰">å‡½æ•°æ¨¡æ¿é‡è½½ï¼ˆä¸å­˜åœ¨åç‰¹åŒ–ï¼‰<a title="#å‡½æ•°æ¨¡æ¿é‡è½½ï¼ˆä¸å­˜åœ¨åç‰¹åŒ–ï¼‰" href="#å‡½æ•°æ¨¡æ¿é‡è½½ï¼ˆä¸å­˜åœ¨åç‰¹åŒ–ï¼‰"></a></h3>
<p>å› ä¸ºåç‰¹åŒ–ç‰ˆæœ¬æœ¬è´¨ä¸Šä»ç„¶æ˜¯æ¨¡æ¿ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦çš„è¯ï¼Œå¯ä»¥é‡è½½ä¸€ä¸ªå‡½æ•°æ¨¡æ¿</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T1</span>&gt;ã€€ã€€// é‡è½½ç‰ˆæœ¬ï¼Œæ¥æ”¶å‚æ•°ä¸ºæŒ‡é’ˆ</span><br><span class="line"><span class="symbol">T1</span> <span class="symbol">add</span>(<span class="symbol">T1</span>* <span class="symbol">a, <span class="symbol">T1</span></span>* <span class="symbol">b</span>) &#123; <span class="keyword">return</span> *a + *b; &#125;   </span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> a = <span class="number">10</span>, b = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">int</span> *x = &amp;a, *y = &amp;b;</span><br><span class="line">    add(a, b);    <span class="comment">// è°ƒç”¨æ™®é€šæ¨¡æ¿</span></span><br><span class="line">    add(x, y);ã€€  <span class="comment">// è°ƒç”¨é‡è½½çš„æ¨¡æ¿</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªæ¥æ”¶æŒ‡é’ˆçš„åç‰¹åŒ–ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨é‡è½½æ¨¡æ¿å®ç°<br>
å‡½æ•°æ¨¡æ¿ä¸å­˜åœ¨åç‰¹åŒ–</p>
<h2 id="ç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–">ç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–<a title="#ç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–" href="#ç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–"></a></h2>
<p>ç±»æ¨¡æ¿æ—¢æœ‰å…¨ç‰¹åŒ–ï¼Œåˆæœ‰åç‰¹åŒ–<br>
è¿™é‡Œé‡æ–°å†™ä¸€ä¸ªæ›´ä¸€èˆ¬çš„æ¨¡æ¿ç±»æ¥è¯´æ˜ç±»æ¨¡æ¿çš„ç‰¹ä¾‹åŒ–</p>
<p>ç±»æ¨¡æ¿å…¨ç‰¹åŒ–æ¯”è¾ƒå¥½ç†è§£ï¼Œè·Ÿå‡½æ•°æ¨¡æ¿ä¸€æ ·ï¼Œå…¨ç‰¹åŒ–æ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œå½“ç¼–è¯‘å™¨åŒ¹é…æ—¶ä¼šä¼˜å…ˆåŒ¹é…å‚æ•°ä¸€è‡´çš„å®ä¾‹</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; &gt;     ã€€ã€€ã€€<span class="comment">// æ³¨æ„è¯­æ³•</span></span><br><span class="line">class A&lt;<span class="keyword">char</span>*&gt;       <span class="comment">// ä¸€ä¸ªå…¨ç‰¹åŒ–çš„æ¨¡æ¿ç±»A</span></span><br><span class="line">&#123;                    <span class="comment">// å½“ç”¨char*ç±»å‹æ¥å®ä¾‹åŒ–ç±»æ¨¡æ¿Aæ—¶ï¼Œå°†ä¼šä¼˜å…ˆè°ƒç”¨è¿™ä¸ªå…¨ç‰¹åŒ–å®ä¾‹</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">explicit</span> A(<span class="keyword">char</span>* val) : t(val) &#123; &#125;</span><br><span class="line">    <span class="keyword">char</span>* add(<span class="keyword">char</span>* a, <span class="keyword">char</span>* b) &#123; <span class="built_in">return</span> strcat(a, b); &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span>* t;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="ç±»æ¨¡æ¿çš„åç‰¹åŒ–">ç±»æ¨¡æ¿çš„åç‰¹åŒ–<a title="#ç±»æ¨¡æ¿çš„åç‰¹åŒ–" href="#ç±»æ¨¡æ¿çš„åç‰¹åŒ–"></a></h2>
<p>ç±»æ¨¡æ¿çš„åç‰¹åŒ–ä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ç‚¹ï¼Œå®ƒæœ‰å¤šç§å½¢å¼<br>
ç±»æ¨¡æ¿åç‰¹åŒ–æœ¬è´¨ä¸Šéƒ½æ˜¯æŒ‡å®šéƒ¨åˆ†ç±»å‹ï¼Œè®©åç‰¹åŒ–ç‰ˆæœ¬ç§°ä¸ºæ™®é€šç‰ˆæœ¬çš„å­é›†ï¼Œè‹¥å®ä¾‹åŒ–æ—¶å‚æ•°ç±»å‹ä¸ºæŒ‡å®šçš„ç±»å‹ï¼Œåˆ™ä¼˜å…ˆè°ƒç”¨ç‰¹ä¾‹åŒ–ç‰ˆæœ¬<br>
ç¬¬ä¸€ç§å½¢å¼</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T1, <span class="symbol">class</span></span> <span class="symbol">T2</span>&gt;      // æ™®é€šç‰ˆæœ¬ï¼Œæœ‰ä¸¤ä¸ªæ¨¡æ¿å‚æ•°</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span> &#123; ..... &#125;;</span><br><span class="line"></span><br><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T2</span>&gt;ã€€ã€€ã€€         // åç‰¹åŒ–ç‰ˆæœ¬ï¼ŒæŒ‡å®šå…¶ä¸­ä¸€ä¸ªå‚æ•°ï¼Œå³æŒ‡å®šäº†éƒ¨åˆ†ç±»å‹</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span>&lt;<span class="symbol">int</span> , <span class="symbol">T2</span>&gt; &#123; ..... &#125;;ã€€ã€€<span class="comment">// å½“å®ä¾‹åŒ–æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºint åˆ™ä¼šä¼˜å…ˆè°ƒç”¨è¿™ä¸ªç‰ˆæœ¬</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§å½¢å¼ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ç‰ˆæœ¬</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;     // æ™®é€šç‰ˆæœ¬</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span> &#123; ..... &#125;;</span><br><span class="line"></span><br><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;ã€€ã€€ã€€//è¿™ä¸ªåç‰¹åŒ–ç‰ˆæœ¬åªæ¥æ”¶æŒ‡é’ˆç±»å‹çš„æ¨¡æ¿å®å‚ </span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span>&lt;<span class="symbol">T</span>*&gt; &#123; ..... &#125;; </span><br><span class="line"></span><br><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span>&lt;<span class="symbol">T</span>&amp;&gt; &#123; ..... &#125;;     <span class="comment">// è¿™ä¸ªåç‰¹åŒ–ç‰ˆæœ¬åªæ¥å—å¼•ç”¨ç±»å‹çš„æ¨¡æ¿å®å‚</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸‰ç§å½¢å¼</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;    //æ™®é€šç‰ˆæœ¬</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span> &#123; ..... &#125;;</span><br><span class="line"></span><br><span class="line">template&lt;<span class="keyword">class</span> <span class="symbol">T</span>&gt;ã€€ã€€ã€€// è¿™ç§åªæ¥å—ç”¨<span class="symbol">T</span>å®ä¾‹åŒ–çš„<span class="symbol">vector</span>çš„æ¨¡æ¿å®å‚ï¼ä¹Ÿæ˜¯ä¸€ç§åç‰¹åŒ–</span><br><span class="line"><span class="symbol">class</span> <span class="symbol">B</span>&lt;<span class="symbol">vector</span>&lt;<span class="symbol">T</span>&gt;&gt; &#123; ......  &#125;;</span><br></pre></td></tr></table></figure>
<p><strong>å‡ ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹</strong></p>
<ul>
<li>ï¼‘ï¼ç‰¹ä¾‹åŒ–æœ¬è´¨ä¸Šæ˜¯æˆ‘ä»¬é¡¶æ›¿äº†ç¼–è¯‘å™¨çš„å·¥ä½œï¼Œæˆ‘ä»¬å¸®ç¼–è¯‘å™¨åšäº†ç±»å‹æ¨å¯¼</li>
<li>ï¼’ï¼å…¨ç‰¹åŒ–æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œè€Œåç‰¹åŒ–æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œåªæ˜¯åŸæ¥æ¨¡æ¿çš„ä¸€ä¸ªå­é›†</li>
<li>ï¼“ï¼æ‰€ä»¥å…¨ç‰¹åŒ–çš„å‡½æ•°æ¨¡æ¿ï¼Œæœ¬è´¨ä¸Šæ˜¯å®ä¾‹ï¼Œä»è€Œä¸ä¼šä¸å‡½æ•°æ¨¡æ¿äº§ç”ŸäºŒä¹‰æ€§</li>
<li>ï¼”ï¼è‹¥æƒ³è®©ç”¨æˆ·èƒ½ä½¿ç”¨ç‰¹ä¾‹åŒ–ç‰ˆæœ¬ï¼Œç‰¹ä¾‹åŒ–ç‰ˆæœ¬å¿…é¡»ä¸æ¨¡æ¿å®šä¹‰åœ¨åŒä¸€ä¸ª.hå¤´æ–‡ä»¶ä¸­</li>
</ul>
<hr>
<p>STLä¸­çš„è¿­ä»£å™¨å®ç°ä¸é«˜æ•ˆå®ç°ä¸æ¨¡æ¿åç‰¹åŒ–æ¯æ¯ç›¸å…³ï¼</p>
<h2 id="ç±»æ¨¡æ¿åç‰¹åŒ–ä¸stl">ç±»æ¨¡æ¿åç‰¹åŒ–ä¸STL<a title="#ç±»æ¨¡æ¿åç‰¹åŒ–ä¸stl" href="#ç±»æ¨¡æ¿åç‰¹åŒ–ä¸stl"></a></h2>
<p><strong>åç‰¹åŒ–åœ¨STLä¸­æœ€é‡è¦çš„ä¸¤ä¸ªåº”ç”¨</strong></p>
<p>ï¼‘ï¼åº”ç”¨åœ¨è¿­ä»£å™¨è®¾è®¡ä¸­ï¼Œä¸ºäº†ä½¿è¿­ä»£å™¨æ—¢å¯ä»¥èƒå–å‡ºå€¼ç±»å‹ï¼Œåˆå¯ä»¥åŒ…å®¹åŸç”ŸæŒ‡é’ˆ<br>
å¦‚æœè¦é€šè¿‡ä¸€ä¸ªè¿­ä»£å™¨å°±èƒ½çŸ¥é“å®ƒçš„å€¼ç±»å‹ï¼Œé‚£ä¹ˆä¸€èˆ¬ä¼šä½¿ç”¨iterator_traits<br>
è¿­ä»£å™¨èƒå–æŠ€æœ¯çš„ä¸¤ä¸ªæ ¸å¿ƒæ˜¯ï¼š</p>
<ul>
<li>ï¼‘ï¼‰åœ¨æ¯ä¸ªè¿­ä»£å™¨ç±»ä¸­å®šä¹‰value_typeå€¼ç±»å‹çš„ç±»å‹æˆå‘˜ï¼Œè¿™æ ·ç›´æ¥é€šè¿‡è¿­ä»£å™¨çš„value_typeç±»å‹æˆå‘˜å°±å¯ä»¥çŸ¥é“å€¼ç±»å‹</li>
<li>ï¼’ï¼‰é—®é¢˜å°±åœ¨äºï¼Œè¿­ä»£å™¨å¿…é¡»å…¼å®¹åŸç”ŸæŒ‡é’ˆï¼Œè€ŒåŸç”ŸæŒ‡é’ˆå¾ˆéš¾è¢«é‡æ–°å®šä¹‰ï¼Œå³è¦åœ¨åŸç”ŸæŒ‡é’ˆçš„ç±»ä¸­æ·»åŠ value_typeçš„å€¼ç±»å‹çš„ç±»å‹æˆå‘˜ï¼è¿™æ—¶å€™ï¼Œé çš„å°±æ˜¯ç±»æ¨¡æ¿çš„åç‰¹åŒ–äº†ï¼æ–°æ·»åŠ ä¸€å±‚iterator_traitsç±»ï¼Œä¸“é—¨èƒå–è¿­ä»£å™¨çš„å±æ€§ï¼Œç„¶åå†å¯¹iterator_traitsç±»è®¾è®¡åŸç”ŸæŒ‡é’ˆä¸åŸç”Ÿå¼•ç”¨çš„åç‰¹åŒ–ç‰ˆæœ¬ï¼Œå°±è§£å†³äº†è¿™ä¸ªæ£˜æ‰‹çš„é—®é¢˜</li>
</ul>
<p>ï¼’ï¼<span class="label success"> type_traits</span>ç±»å‹èƒå–ï¼Œå¯¹å¾…ç‰¹æ®Šç±»å‹ï¼Œç‰¹æ®Šå¤„ç†ï¼Œæé«˜æ•ˆç‡<br>
å¯¹äºæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œææ„å‡½æ•°ç­‰çš„å†…ç½®ç±»å‹ï¼Œå¦‚æœä¸å¤æ‚ç±»å‹ä¸€æ ·ï¼Œæ‰§è¡ŒåŒæ ·çš„æ“ä½œï¼Œæ˜¾ç„¶æ˜¯æ•ˆç‡ä¸é«˜çš„<br>
å…ˆå®ç°ä¸€ä¸ªå¯¹æ‰€æœ‰ç±»å‹éƒ½è®¾ç½®ä¸€ä¸ªæœ€ä¿å®ˆå€¼çš„type_traitsæ¨¡æ¿ç±»ï¼Œç„¶åå†å¯¹æ¯ä¸ªå†…ç½®ç±»å‹è®¾ç½®åç‰¹åŒ–ç‰ˆæœ¬ï¼Œå†…ç½®ç±»å‹è®¾ç½®ä¸€ä¸ªæ›´ä¸ºæ¿€è¿›çš„å€¼ï¼Œè¡¨æ˜å¯ä»¥é‡‡å–æ›´ä¸ºé«˜æ•ˆçš„æ“ä½œæ¥æé«˜æ•ˆç‡<br>
æ¯”å¦‚copyå‡½æ•°ï¼Œå¦‚æœä¼ é€’çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¤æ‚ç±»å‹ï¼Œé‚£ä¹ˆå¯èƒ½åªèƒ½é‡‡å–æœ€ä¿å®ˆçš„å¤„ç†æ–¹å¼ï¼Œä¸€ä¸ªä¸€ä¸ªçš„æ„é€ ï¼›å¦‚æœæ˜¯å†…ç½®ç±»å‹ï¼Œè¿™æ ·æ˜¾ç„¶å¤ªä½æ•ˆï¼Œä½¿ç”¨memcpy()å¯èƒ½ä¼šå¥½ä¸€äº›</p>
<p>å…¶å®iterator_traitsä¹Ÿä¸æ­¢æ˜¯å¤„ç†å…¼å®¹åŸç”ŸæŒ‡é’ˆçš„é—®é¢˜ï¼Œå®ƒä¹Ÿå¯ä»¥æé«˜æ•ˆç‡ï¼<br>
è¿­ä»£å™¨åˆ†ä¸ºå¾ˆå¤šç§ï¼Œæœ‰å¯ä»¥éšæœºè®¿é—®çš„ï¼ˆvectorï¼‰ï¼Œæœ‰åªèƒ½å‰åä¸€ä¸ªä¸€ä¸ªç§»åŠ¨çš„ï¼ˆlistï¼‰,ä¹Ÿæœ‰åªèƒ½å•å‘ç§»åŠ¨çš„ï¼ˆslistï¼‰ï¼Œæ‰€ä»¥ä¸€èˆ¬æŠŠè¿­ä»£å™¨åˆ†ä¸ºäº”ç§ï¼š</p>
<ul>
<li>InputIteratorã€€ã€€ã€€ã€€ã€€ã€€ã€€è¾“å…¥è¿­ä»£å™¨</li>
<li>OutputIterator ã€€ã€€ã€€ã€€ã€€ ã€€è¾“å‡ºè¿­ä»£å™¨</li>
<li>ForwardIteratorã€€ã€€ã€€ã€€ã€€ã€€å•å‘è¿­ä»£å™¨</li>
<li>BidirectionIteratorã€€ã€€ã€€ã€€ã€€åŒå‘è¿­ä»£å™¨</li>
<li>RandomAccessIteratorã€€ã€€ã€€éšæœºè®¿é—®è¿­ä»£å™¨</li>
</ul>
<p>æ¯”å¦‚ä¸€ä¸ªadvance(n)å‡½æ•°ï¼Œå¯¹äºå•å‘è¿­ä»£å™¨åªèƒ½ä¸€ä¸ªä¸€ä¸ªç§»åŠ¨è¿‡å»ï¼Œä½†æ˜¯è¿™ç§å®ç°å¯¹äºéšæœºè®¿é—®è¿­ä»£å™¨æ˜¾ç„¶ä¸æ˜¯ç†æƒ³çš„å¤„ç†æ–¹å¼<br>
å¤„ç†çš„æ–¹å¼å°±æ˜¯å…ˆå®ç°è¿™äº”ä¸ªç±»ï¼Œç”¨ä½œæ ‡è®°ç”¨ï¼Œåœ¨æ¯ä¸ªè¿­ä»£å™¨é‡Œé¢éƒ½å®šä¹‰è¿­ä»£å™¨ç±»å‹çš„ç±»å‹æˆå‘˜iterator_catagoryï¼Œå†å¯¹ä¸åŒç‰ˆæœ¬çš„è¿­ä»£å™¨å®ç°ä¸åŒçš„advance(n)å¤„ç†æ–¹å¼</p>
<p>æ¯”å¦‚stlä¸­æ·»åŠ å³å€¼å¼•ç”¨å…ƒæ¨¡æ¿çš„å®ç°ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">template&lt;typename _Tp,</span><br><span class="line">		   bool = __and_&lt;__not_&lt;is_reference&lt;_Tp&gt;&gt;,</span><br><span class="line">		   					__not_&lt;is_void&lt;_Tp&gt;&gt;&gt;::value&gt;</span><br><span class="line">	struct __add_rvalue_reference_helper</span><br><span class="line">	&#123;typedef __Tp  <span class="built_in"> type; </span>&#125;;</span><br><span class="line"></span><br><span class="line">template&lt;typename _Tp&gt;</span><br><span class="line">	struct __add_rvalue_reference_helper&lt;__Tp, <span class="literal">true</span>&gt;</span><br><span class="line">	&#123;typedef __Tp&amp;&amp; <span class="built_in"> type; </span>&#125;;</span><br><span class="line">	</span><br><span class="line">template&lt;typename _Tp&gt;</span><br><span class="line">struct add_rvalue_reference</span><br><span class="line">: public __add_rvalue_reference_helper&lt;_Tp&gt;</span><br><span class="line">&#123; &#125;;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‘ç°è°ƒç”¨æ—¶ä¸€èˆ¬ä¸º<code>static_cast&lt;typenameadd_rvalue_reference&lt;T&gt;::type&gt;(__t)</code>,é¦–å…ˆä¼šåŒ¹é…æ³›åŒ–ç‰ˆæœ¬çš„å…ƒæ¨¡æ¿ç±»ï¼Œç¬¬äºŒä¸ªæ¨¡ç‰ˆå‚æ•°boolä¼šåŒ¹é…_Tpçš„ç±»å‹ï¼Œå¦‚æœåŸæ¥ä¸æ˜¯å¼•ç”¨ç±»å‹çš„è¯å°±ç›´æ¥åŒ¹é…trueçš„åç‰¹åŒ–ç‰ˆæœ¬ï¼ˆä¼˜å…ˆçº§é«˜ï¼‰ï¼Œå¦åˆ™falseä¸ºåŸæ³›åŒ–ç‰ˆæœ¬ã€‚</p>
<p>çŸ­çŸ­å‡ è¡Œä»£ç å·²ç»å±•ç¤ºå‡ºäº†æ¨¡æ¿å/å…¨ç‰¹åŒ–çš„å¼ºå¤§åŒ¹é…åŠŸèƒ½ï¼</p>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¼–è¯‘å™¨æ¶æ„çš„ç‹è€…LLVMâ€”â€”ä½¿ç”¨JITå¼•æ“</title>
    <url>/posts/%E7%BC%96%E8%AF%91%E5%99%A8%E6%9E%B6%E6%9E%84%E7%9A%84%E7%8E%8B%E8%80%85LLVM%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8JIT%E5%BC%95%E6%93%8E/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨jitå¼•æ“">ä½¿ç”¨JITå¼•æ“<a title="#ä½¿ç”¨jitå¼•æ“" href="#ä½¿ç”¨jitå¼•æ“"></a></h1>
<p>LLVMä»è®¾è®¡ä¹‹åˆå°±è€ƒè™‘äº†è§£é‡Šæ‰§è¡Œçš„åŠŸèƒ½,è¿™éå¸¸å…¶ä½œä¸ºä¸€æ¬¾è·¨å¹³å°çš„ä¸­é—´å­—èŠ‚ç æ¥ä½¿ç”¨,å¯ä»¥æ–¹ä¾¿åœ°è·¨å¹³å°è¿è¡Œã€‚åˆå…·æœ‰ç¼–è¯‘å‹è¯­è¨€çš„ä¼˜åŠ¿ï¼Œéå¸¸çš„æ–¹ä¾¿ã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨çš„LLVM3.6ç‰ˆï¼Œç§»é™¤äº†åŸç‰ˆJITï¼Œæ”¹æ¢æˆäº†æ–°ç‰ˆçš„MCJITï¼Œæ€§æ ¼æœ‰äº†ä¸å°çš„æå‡ï¼Œæœ¬æ–‡å°±MCJITçš„ä½¿ç”¨å’Œæ³¨æ„äº‹é¡¹ï¼Œè¿›è¡Œç®€è¦çš„ä»‹ç»ã€‚</p>
<a id="more"></a>
<h1 id="jitæŠ€æœ¯">JITæŠ€æœ¯<a title="#jitæŠ€æœ¯" href="#jitæŠ€æœ¯"></a></h1>
<p>Just-In-Time Compilerï¼Œæ˜¯ä¸€ç§åŠ¨æ€ç¼–è¯‘ä¸­é—´ä»£ç çš„æ–¹å¼ï¼Œæ ¹æ®éœ€è¦ï¼Œåœ¨ç¨‹åºä¸­ç¼–è¯‘å¹¶æ‰§è¡Œç”Ÿæˆçš„æœºå™¨ç ï¼Œèƒ½å¤Ÿå¤§å¹…æå‡åŠ¨æ€è¯­è¨€çš„æ‰§è¡Œé€Ÿåº¦ã€‚</p>
<p>åƒJavaè¯­è¨€ï¼Œ.netå¹³å°ï¼Œluajitç­‰ï¼Œå¹¿æ³›ä½¿ç”¨jitæŠ€æœ¯ï¼Œä½¿å¾—ç¨‹åºè¾¾åˆ°äº†éå¸¸é«˜çš„æ‰§è¡Œæ•ˆç‡ï¼Œé€æ¸æ¥è¿‘åŸç”Ÿæœºå™¨è¯­è¨€ä»£ç çš„æ€§èƒ½äº†ã€‚</p>
<p>JITå¼•æ“çš„å·¥ä½œåŸç†å¹¶æ²¡æœ‰é‚£ä¹ˆå¤æ‚ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†åŸæ¥ç¼–è¯‘å™¨è¦ç”Ÿæˆæœºå™¨ç çš„éƒ¨åˆ†è¦ç›´æ¥å†™å…¥åˆ°å½“å‰çš„å†…å­˜ä¸­ï¼Œç„¶åé€šè¿‡å‡½æ•°æŒ‡é’ˆçš„è½¬æ¢ï¼Œæ‰¾åˆ°å¯¹åº”çš„æœºå™¨ç å¹¶è¿›è¡Œæ‰§è¡Œã€‚</p>
<p>ä½†å®è·µä¸­å¾€å¾€éœ€è¦å¤„ç†è®¸å¤šå¤´ç–¼çš„é—®é¢˜ï¼Œä¾‹å¦‚å†…å­˜çš„ç®¡ç†ï¼Œç¬¦å·çš„é‡å®šå‘ï¼Œå¤„ç†å¤–éƒ¨ç¬¦å·ï¼Œç›¸å½“äºè¦å¤„ç†ç¼–è¯‘å™¨åç«¯çš„è¯¸å¤šå¤æ‚çš„äº‹æƒ…ï¼ŒçœŸæ­£è¦è®¾è®¡ä¸€æ¬¾èƒ½ç”¨çš„JITå¼•æ“è¿˜æ˜¯éå¸¸å›°éš¾çš„ã€‚</p>
<p>ä½¿ç”¨LLVMçš„MCJITèƒ½å¼€å‘ä»€ä¹ˆ<br>
å½“ç„¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯æä¾›ä¸€æ¬¾è§£é‡Šå™¨çš„åº•å±‚å·¥å…·ï¼Œå°†LLVMå­—èŠ‚ç è§£é‡Šæ‰§è¡Œï¼Œå…·ä½“èƒ½å¤Ÿåšçš„äº‹ï¼Œä¾‹å¦‚å¯ä»¥åˆ¶ä½œä¸€æ¬¾è·¨å¹³å°çš„C<ins>æ’ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨clangå°†C/C</ins>ä»£ç ä¸€æ¬¡ç¼–è¯‘åˆ°.bcå­—èŠ‚ç ï¼Œç„¶ååœ¨å„ä¸ªå¹³å°ä¸Šè§£é‡Šè¿è¡Œã€‚ä¹Ÿå¯ä»¥åˆ¶ä½œä¸€æ¬¾äº‘è°ƒè¯•ç³»ç»Ÿï¼Œè”ç½‘è¿œç¨‹å‘ç³»ç»Ÿæ³¨å†Œæ–¹æ³•ï¼Œè·å–C++å®¢æˆ·ç«¯çš„debugä¿¡æ¯ç­‰ç­‰ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç”¨æ³•ç­‰ç€å¤§å®¶æ¥å¼€å‘ã€‚</p>
<h1 id="ä½¿ç”¨mcjitåšä¸€æ¬¾è§£é‡Šå™¨">ä½¿ç”¨MCJITåšä¸€æ¬¾è§£é‡Šå™¨<a title="#ä½¿ç”¨mcjitåšä¸€æ¬¾è§£é‡Šå™¨" href="#ä½¿ç”¨mcjitåšä¸€æ¬¾è§£é‡Šå™¨"></a></h1>
<p>åˆ¶ä½œLLVMå­—èŠ‚ç çš„è§£é‡Šå™¨è¿˜æ˜¯éå¸¸ç®€å•çš„ï¼Œæœ€æ£’çš„ç¤ºä¾‹åº”è¯¥æ˜¯LLVMæºç ä¸­çš„å·¥å…·ï¼šlli</p>
<p>ä¸€å…±700è¡Œå·¦å³çš„C++ä»£ç ï¼Œè°ƒç”¨LLVMå·¥å…·é›†å®ç°äº†LLVMå­—èŠ‚ç JITå¼•æ“ï¼Œå¦‚æœæƒ³å¾ˆå¥½çš„å­¦ä¹ llvmä¸­çš„è§£é‡Šå™¨å’ŒJITï¼Œå¯ä»¥å‚è€ƒå…¶åœ¨<a href="https://github.com/llvm-mirror/llvm/blob/master/tools/lli/lli.cpp" target="_blank">github</a>ä¸Šçš„æºç ã€‚</p>
<p>åˆå§‹åŒ–ç³»ç»Ÿ<br>
ä½¿ç”¨LLVMçš„JITåŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨å‡ æ¡åˆå§‹åŒ–è¯­å¥ï¼Œå¯ä»¥æ”¾åœ¨mainå‡½æ•°å¼€å§‹æ—¶ã€‚</p>
<figure class="highlight abnf"><table><tr><td class="code"><pre><span class="line">InitializeNativeTarget()<span class="comment">;</span></span><br><span class="line">InitializeNativeTargetAsmPrinter()<span class="comment">;</span></span><br><span class="line">InitializeNativeTargetAsmParser()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>è¿™å‡ å¥è°ƒç”¨ï¼Œä¸»è¦æ˜¯åœ¨å¤„ç†JITçš„TargetMachineï¼Œåˆå§‹åŒ–æœºå™¨ç›¸å…³ç¼–è¯‘ç›®æ ‡ã€‚</p>
<h1 id="å¼•ç”¨ç›¸å…³çš„å¤´æ–‡ä»¶">å¼•ç”¨ç›¸å…³çš„å¤´æ–‡ä»¶<a title="#å¼•ç”¨ç›¸å…³çš„å¤´æ–‡ä»¶" href="#å¼•ç”¨ç›¸å…³çš„å¤´æ–‡ä»¶"></a></h1>
<p>è¿™é‡Œçš„ç¨ç¨æœ‰ç‚¹å¤šä½™çš„ï¼Œä¸å»ç®¡äº†ã€‚ï¼Œllvmçš„å¤´æ–‡ä»¶æ˜¯å±‚æ¬¡ç»„ç»‡çš„ï¼Œåƒæ‰§è¡Œå¼•æ“ï¼Œéƒ½åœ¨llvm/ExecutionEngine/ä¸‹ï¼Œè€ŒIRç›¸å…³çš„ï¼Œä¹Ÿéƒ½åœ¨llvm/IR/ä¸‹ï¼Œåˆç”¨LLVMå¾€å¾€æä¸æ¸…éœ€è¦å“ªäº›ï¼Œè¿™æ—¶å°±éœ€è¦å¤šæŸ¥ç›¸å…³çš„æ–‡æ¡£ï¼Œäº†è§£LLVMçš„å„ä¸ªæ¨¡å—çš„åŠŸèƒ½ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/ExecutionEngine/GenericValue.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/ExecutionEngine/MCJIT.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/ExecutionEngine/Interpreter.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/ExecutionEngine/SectionMemoryManager.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/Verifier.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/Constants.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/DerivedTypes.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/IRBuilder.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/Instructions.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/LLVMContext.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/IR/Module.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;llvm/IRReader/IRReader.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;llvm/Support/SourceMgr.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/Support/ManagedStatic.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/Support/TargetSelect.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;llvm/Support/MemoryBuffer.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/Support/raw_ostream.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;llvm/Support/DynamicLibrary.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"llvm/Support/Debug.h"</span></span></span><br></pre></td></tr></table></figure>
<p>ä¸»è¦è¯´è¦æ³¨æ„çš„å‡ ä¸ªç»†èŠ‚ï¼Œé¦–å…ˆæ˜¯</p>
<figure class="highlight autoit"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"llvm/ExecutionEngine/MCJIT.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="string">"llvm/ExecutionEngine/Interpreter.h"</span></span></span><br></pre></td></tr></table></figure>
<p>C++ç¼–è¯‘æ—¶ï¼Œè¿™ä¸¤ä¸ªå¤´æ–‡ä»¶å±…ç„¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœä½ ä¸æ³¨æ„æ—¶ï¼Œç¼–è¯‘ä¸ä¼šæŠ¥é”™ã€‚å› ä¸ºæ‰§è¡Œå¼•æ“æ˜¯ä¸€ä¸ªæ¥å£çš„æ¨¡å¼ï¼Œä¸å¯¹å¤–æš´éœ²å­ç±»çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å¿…é¡»æ³¨æ„å¼•ç”¨å…¶ä¸­ä¸€ä¸ªæˆ–ä¸¤ä¸ªéƒ½å¼•ç”¨ï¼Œå¦åˆ™ä¼šé“¾æ¥ä¸åˆ°å¯¹åº”çš„å¼•æ“ã€‚</p>
<p>ä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p>
<p>Create Engine Error<br>
JIT has not been linked in.</p>
<p><img src="https://img-blog.csdn.net/20160108201207936" alt="Ã§Â±Â»Ã§Â»Â“Ã¦ÂÂ„" class="Ï†cx"></p>
<h1 id="ä½¿ç”¨enginebuilderæ„å»ºjitå¼•æ“">ä½¿ç”¨EngineBuilderæ„å»ºJITå¼•æ“<a title="#ä½¿ç”¨enginebuilderæ„å»ºjitå¼•æ“" href="#ä½¿ç”¨enginebuilderæ„å»ºjitå¼•æ“"></a></h1>
<p>ç”±äºJITå¼•æ“æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºå¤šä¸ªï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å•ä¾‹ç±»çš„æ–¹å¼ï¼Œä½¿ç”¨ä¸€ä¸ªLLVMä¸­çš„Moduleè¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœå¼•æ“å·²ç»åˆ›å»ºè¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨addModuleæ–¹æ³•ï¼Œå°†LLVMçš„Moduleæ·»åŠ åˆ°å¼•æ“çš„Moduleé›†åˆä¸­ã€‚</p>
<p>finalizeObjectå‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªå…³é”®çš„å‡½æ•°ï¼Œå¯¹åº”JITå¼•æ“å¾ˆé‡è¦ï¼Œæˆ‘ä»¬è¦ä¿éšœæˆ‘ä»¬åœ¨è°ƒç”¨JITç¼–è¯‘åçš„ä»£ç å‰ï¼Œè¦è°ƒç”¨è¿‡è¯¥å‡½æ•°</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">ExecutionEngine* EE = <span class="literal">NULL</span>;</span><br><span class="line">RTDyldMemoryManager* RTDyldMM = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initEE</span><span class="params">(<span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;Module&gt; Owner)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> ErrStr;</span><br><span class="line">    <span class="keyword">if</span> (EE == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        RTDyldMM = <span class="keyword">new</span> SectionMemoryManager();</span><br><span class="line">        EE = EngineBuilder(<span class="built_in">std</span>::move(Owner))</span><br><span class="line">            .setEngineKind(EngineKind::JIT)</span><br><span class="line">            .setErrorStr(&amp;ErrStr)</span><br><span class="line">            .setVerifyModules(<span class="literal">true</span>)</span><br><span class="line">            .setMCJITMemoryManager(<span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;RTDyldMemoryManager&gt;(RTDyldMM))</span><br><span class="line">            .setOptLevel(CodeGenOpt::Default)</span><br><span class="line">            .create();</span><br><span class="line">&#125; <span class="keyword">else</span></span><br><span class="line">    EE-&gt;addModule(<span class="built_in">std</span>::move(Owner));</span><br><span class="line"><span class="keyword">if</span> (ErrStr.length() != <span class="number">0</span>)</span><br><span class="line">    <span class="built_in">cerr</span> &lt;&lt; <span class="string">"Create Engine Error"</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; ErrStr &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">EE-&gt;finalizeObject();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯finalizeObjectçš„æ–‡æ¡£è§£é‡Šï¼š</p>
<p>finalizeObject - ensure the module is fully processed and is usable.</p>
<p>It is the user-level function for completing the process of making the object usable for execution. It should be called after sections within an object have been relocated using mapSectionAddress. When this method is called the MCJIT execution engine will reapply relocations for a loaded object. This method has no effect for the interpeter.</p>
<p>setEngineKindå¯é€‰çš„æœ‰JITå’ŒInterpreterï¼Œå¦‚æœé»˜è®¤çš„è¯ï¼Œåˆ™æ˜¯ä¼˜å…ˆJITï¼Œæ£€æµ‹åˆ°å“ªä¸ªå¼•æ“èƒ½ç”¨å°±ç”¨å“ªä¸ªã€‚</p>
<p>setMCJITMemoryManageræ˜¯ä¸€ä¸ªå…³é”®çš„ç®¡ç†å™¨ï¼Œå½“ç„¶è²Œä¼¼é»˜è®¤ä¸å†™ä¹Ÿä¼šæ„å»ºï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ºäº†æ¸…æ™°æ‰€è§ï¼Œè¿˜æ˜¯æ·»åŠ äº†è¿™æ¡é…ç½®ï¼Œè¿™ä¸ªå†…å­˜ç®¡ç†å™¨åœ¨æ‰§è¡Œå¼•æ“ä¸­å¾ˆé‡è¦ï¼Œä¸€èˆ¬æœ¬åœ°çš„åº”ç”¨æˆ‘ä»¬è¦é€‰æ‹©SectionMemoryManagerç±»ï¼Œè€Œlliä¸­ç”šè‡³è¿˜åŒ…å«ç€è¿œç¨‹è°ƒç”¨çš„ç›¸å…³ç±»ã€‚</p>
<p>setOptLevelæ˜¯è®¾ç½®ä»£ç çš„ä¼˜åŒ–ç­‰çº§ï¼Œé»˜è®¤æ˜¯O2ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºä¸‹é¢æšä¸¾å€¼ï¼š</p>
<p>None<br>
Less<br>
Default<br>
Aggressive<br>
MCJITæ¶æ„å›¾</p>
<h1 id="ç¼–å†™æ ¸å¿ƒçš„è°ƒç”¨æ–¹æ³•">ç¼–å†™æ ¸å¿ƒçš„è°ƒç”¨æ–¹æ³•<a title="#ç¼–å†™æ ¸å¿ƒçš„è°ƒç”¨æ–¹æ³•" href="#ç¼–å†™æ ¸å¿ƒçš„è°ƒç”¨æ–¹æ³•"></a></h1>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">typedef</span> <span class="title">void</span> <span class="params">(*func_type)</span><span class="params">(<span class="keyword">void</span>*)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pathæ˜¯bcæ–‡ä»¶çš„è·¯å¾„ï¼Œfunc_nameæ˜¯è¦æ‰§è¡Œçš„å‡½æ•°å</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Run</span><span class="params">(<span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; path, <span class="keyword">const</span> <span class="built_in">std</span>::<span class="built_in">string</span>&amp; func_name)</span> </span>&#123;</span><br><span class="line"><span class="comment">// é¦–å…ˆè¦è¯»å–è¦æ‰§è¡Œçš„bcå­—èŠ‚ç </span></span><br><span class="line">SMDiagnostic error;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;Module&gt; Owner = parseIRFile(path, error, context);</span><br><span class="line"><span class="keyword">if</span>(Owner == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Load Error: "</span> &lt;&lt; path &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    Owner-&gt;dump();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å•ä¾‹çš„æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œæš‚æœªè€ƒè™‘å¤šçº¿ç¨‹</span></span><br><span class="line">initEE(<span class="built_in">std</span>::move(Owner));</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–ç¼–è¯‘åçš„å‡½æ•°æŒ‡é’ˆå¹¶æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">uint64_t</span> func_addr = EE-&gt;getFunctionAddress(func_name.c_str());</span><br><span class="line"><span class="keyword">if</span> (func_addr == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"é”™è¯¯, æ‰¾ä¸åˆ°å‡½æ•°: %s\n"</span>, func_name.c_str());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">func_type func = (func_type) func_addr;</span><br><span class="line">func(<span class="literal">NULL</span>); <span class="comment">// éœ€è¦ä¼ å‚æ•°æ—¶å¯ä»¥ä»è¿™é‡Œä¼ é€’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="è§£é‡Šå™¨ç‰ˆæœ¬">è§£é‡Šå™¨ç‰ˆæœ¬<a title="#è§£é‡Šå™¨ç‰ˆæœ¬" href="#è§£é‡Šå™¨ç‰ˆæœ¬"></a></h1>
<p>è§£é‡Šå™¨æ•ˆç‡ç¨ä½ä¸€ä¸‹ï¼Œä¸è¿‡èƒ½å¤Ÿåšåˆ°æƒ°æ€§çš„ä¸€ä¸‹ä»£ç è½½å…¥å’Œæ‰§è¡Œå·¥ä½œï¼Œæœ‰æ—¶ä¹Ÿå¾ˆæœ‰ç”¨é€”ã€‚ä¸‹é¢æˆ‘ä»¬å°±åœ¨jitçš„åŸºç¡€ä¸Šï¼Œä»‹ç»ä¸€ä¸‹ç®€å•çš„è§£é‡Šå™¨åŠŸèƒ½ã€‚ä»‹ç»å™¨æœ€ä¸»è¦éœ€è¦åšçš„å°±æ˜¯å°†ç”Ÿæˆå¼•æ“æ”¹å˜ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">EE = EngineBuilder(<span class="built_in">std</span>::move(Owner))</span><br><span class="line">    <span class="comment">// è¿™é‡Œæ”¹å®Œè§£é‡Šå™¨</span></span><br><span class="line">    .setEngineKind(EngineKind::Interpreter)</span><br><span class="line">    .setErrorStr(&amp;ErrStr)</span><br><span class="line">    .setVerifyModules(<span class="literal">true</span>)</span><br><span class="line">    .setMCJITMemoryManager(<span class="built_in">std</span>::<span class="built_in">unique_ptr</span>&lt;RTDyldMemoryManager&gt;(RTDyldMM))</span><br><span class="line">    .setOptLevel(CodeGenOpt::Default)</span><br><span class="line">    .create();</span><br></pre></td></tr></table></figure>
<p>å¦å¤–è§£é‡Šå™¨å¯ä»¥ä½¿ç”¨getLazyIRFileModuleå‡½æ•°å¯ä»¥æ›¿æ¢parseIRFileå®ç°.bcæ–‡ä»¶çš„æƒ°æ€§åŠ è½½ã€‚</p>
<p>è§£é‡Šå™¨çš„æ‰§è¡Œæ–¹å¼å’ŒJITæœ‰ä¸€äº›ä¸åŒï¼Œè¦ä½¿ç”¨FindFunctionNamedå‡½æ•°æ¥å¯»æ‰¾å¯¹åº”çš„å‡½æ•°å¯¹è±¡ï¼Œè§£é‡Šå™¨èƒ½å¤Ÿè·å–æ›´å…¨çš„LLVMå­—èŠ‚ç çš„ä¸­é—´ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸€äº›å±æ€§å’Œå…ƒæ•°æ®ï¼Œåœ¨åšä¸€äº›çµæ´»çš„åŠ¨æ€è¯­è¨€è§£é‡Šå™¨æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»™è§£é‡Šå™¨ä½¿ç”¨çš„éƒ¨åˆ†</span></span><br><span class="line">Function* func = EE-&gt;FindFunctionNamed(func_name.c_str());</span><br><span class="line"><span class="keyword">if</span> (func == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"å¿½ç•¥, æ‰¾ä¸åˆ°å‡½æ•°: %s\n"</span>, func_name.c_str());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¦‚æœéœ€è¦ä¼ å‚æ•°çš„è¯</span></span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;GenericValue&gt; args;</span><br><span class="line">args.push_back(GenericValue(<span class="literal">NULL</span>));</span><br><span class="line">EE-&gt;runFunction(func, args);</span><br><span class="line">åˆ›å»ºæµ‹è¯•çš„Cä»£ç </span><br><span class="line">æˆ‘åœ¨æ˜¯Eliteç¼–è¯‘å™¨å·¥ç¨‹ä¸‹å¼€å‘çš„ï¼Œæ‰€ä»¥ä¼šæœ‰æ¥å£è°ƒç”¨çš„æµ‹è¯•ï¼Œå¤§å®¶å¯ä»¥ï¼Œåˆ›å»ºç®€å•çš„Cå‡½æ•°è¿›è¡Œè°ƒç”¨æµ‹è¯•ï¼š</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">void</span></span><br><span class="line">testï¼’_elite_plugin_init(CodeGenContext* context) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"testï¼’_elite_plugin_init\n"</span>);</span><br><span class="line">    <span class="keyword">if</span> (context == <span class="literal">NULL</span>) <span class="built_in">printf</span>(<span class="string">"Error for context\n"</span>);</span><br><span class="line">    <span class="keyword">else</span> context-&gt;AddOrReplaceMacros(macro_funcs);</span><br><span class="line">&#125;</span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br></pre></td></tr></table></figure>
<p>æœ€è¿‘ç ”ç©¶çš„LLVMæŠ€æœ¯ï¼Œå¤§éƒ¨åˆ†åº”ç”¨äºæ­£åœ¨è¿›è¡Œçš„ELiteç¼–è¯‘å™¨å¼€å‘ï¼Œæ¬¢è¿æœ‹å‹ä»¬å…³æ³¨å’Œå‚ä¸ã€‚<br>
github: <a href="https://github.com/elite-lang/Elite" target="_blank" rel="noopener">https://github.com/elite-lang/Elite</a><br>
æ–‡æ¡£: <a href="http://elite-lang.org/doc/zh-cn/" target="_blank" rel="noopener">http://elite-lang.org/doc/zh-cn/</a></p>
<hr>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œè¥¿é£é€é¥æ¸¸ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>
åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/xfxyy_sxfancy/article/details/50485090" target="_blank" rel="noopener">https://blog.csdn.net/xfxyy_sxfancy/article/details/50485090</a></p>
]]></content>
      <categories>
        <category>ç¼–è¯‘å™¨</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>C++ä¹‹Lambdaç ”ç©¶</title>
    <url>/posts/Lambda/</url>
    <content><![CDATA[<h1 id="1.Â å‰è¨€">1.Â å‰è¨€<a title="#1.Â å‰è¨€" href="#1.Â å‰è¨€"></a></h1>
<p>æœ¬æ–‡ä»£ç æµ‹è¯•ç¯å¢ƒä¸ºâ€œGCC-9.1.0â€ï¼Œæœ‰å…³ç¼–è¯‘å™¨çš„å®‰è£…è¯·å‚è€ƒã€Š<a href="https://blog.csdn.net/Aquester/article/details/89735466" target="_blank">å®‰è£…GCC-8.3.0åŠå…¶ä¾èµ–</a>ã€‹ï¼Œé€‚ç”¨äºâ€œGCC-9.1.0â€ã€‚</p>
<p>æœ¬æ–‡è¯•å›¾æ­éœ²LambdaèƒŒåä¸€é¢ï¼Œä»¥æ–¹ä¾¿æ›´å¥½çš„ç†è§£å’ŒæŒæ¡Lambdaã€‚Lambdaä»£ç æ®µå®é™…ä¸ºä¸€ä¸ªç¼–è¯‘å™¨ç”Ÿæˆçš„ç±»çš„â€œoperatorÂ ()â€å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸€ä¸ªLambdaå‡½æ•°ç”Ÿæˆä¸€ä¸ªåŒ¿åçš„ç±»ï¼ˆåœ¨C++ä¸­ï¼Œç±»å’Œç»“æ„ä½“å®é™…ä¸€æ ·ï¼Œæ— æœ¬è´¨åŒºåˆ«ï¼Œé™¤äº†é»˜è®¤çš„è®¿é—®æ§åˆ¶ï¼‰ã€‚</p>
<p>å¯¹Lambdaçš„æœ€ç®€å•ç†è§£ï¼Œæ˜¯å°†å®ƒçœ‹ä½œä¸€ä¸ªåŒ¿åç±»ï¼ˆæˆ–ç»“æ„ä½“ï¼‰ï¼Œå®é™…ä¸Šä¹Ÿç¡®å®å¦‚æ­¤ï¼Œç¼–è¯‘å™¨æŠŠLambdaç¼–è¯‘æˆäº†åŒ¿åç±»ã€‚</p>
<a id="more"></a>
<h1 id="2.-ç¤ºä¾‹1">2. ç¤ºä¾‹1<a title="#2.-ç¤ºä¾‹1" href="#2.-ç¤ºä¾‹1"></a></h1>
<p>å…ˆçœ‹ä¸€æ®µå‡ ä¹æœ€ç®€å•çš„Lambdaä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â <span class="keyword">auto</span>Â fÂ =Â []Â &#123;Â <span class="built_in">printf</span>(<span class="string">"f\n"</span>);Â &#125;;Â <span class="comment">//Â æ³¨æ„â€œ&#125;â€åçš„â€œ;â€å¿…ä¸å¯å°‘ï¼Œå¦åˆ™ç¼–è¯‘æŠ¥é”™</span></span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœLambdaè¡¨è¾¾å¼ï¼ˆæˆ–å‡½æ•°ï¼‰æ²¡æœ‰ä»¥â€œ;â€ç»“å°¾ï¼Œåˆ™ç¼–è¯‘æ—¶å°†æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">a3.cpp:Â <span class="keyword">In</span>Â <span class="keyword">function</span>Â <span class="string">'intÂ main()'</span>:</span><br><span class="line">a3.cpp:<span class="number">4</span>:<span class="number">3</span>:Â error:Â expectedÂ <span class="string">','</span>Â <span class="keyword">or</span>Â <span class="string">';'</span>Â <span class="keyword">before</span>Â <span class="string">'return'</span></span><br><span class="line">Â Â Â Â <span class="number">4</span>Â |Â Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">Â Â Â Â Â Â |Â Â Â ^~~~~~</span><br></pre></td></tr></table></figure>
<p>Lambdaä¹‹æ‰€ä»¥ç¥å¥‡ï¼Œè¿™å¾—ç›ŠäºC++ç¼–è¯‘å™¨çš„å·¥ä½œï¼Œä¸Šè¿°â€œfâ€å®é™…é•¿è¿™æ ·ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â <span class="class"><span class="keyword">struct</span>Â &lt;<span class="title">lambda</span>()&gt;Â &#123;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸€ä¸ªåŒ¿åçš„ç±»ï¼ˆæˆ–ç»“æ„ä½“ï¼‰ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°â€œoperatorÂ ()Â constâ€ã€‚æ³¨æ„è¿™é‡Œæˆå‘˜å‡½æ•°æ˜¯â€constâ€ç±»å‹ï¼Œè¿™æ˜¯é»˜è®¤çš„ã€‚å¦‚æœéœ€éâ€constâ€æˆå‘˜å‡½æ•°ï¼Œéœ€è¦åŠ â€mutableâ€ä¿®é¥°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">autoÂ fÂ =Â [<span class="string">n</span>](<span class="link"></span>)Â mutableÂ &#123;Â printf("%d\n",Â n);Â &#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¾‹å­å¯¹åº”çš„åŒ¿åç±»æ²¡æœ‰ä»»ä½•ç±»æ•°æ®æˆå‘˜ï¼Œç°åœ¨æ¥ä¸ªæœ‰ç±»æ•°æ®æˆå‘˜çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â <span class="keyword">int</span>Â nÂ =Â <span class="number">3</span>;</span><br><span class="line">Â Â <span class="keyword">auto</span>Â fÂ =Â [n]Â &#123;Â <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,Â n);Â &#125;;</span><br><span class="line">Â Â f();Â <span class="comment">//Â è¿™é‡Œå®é™…è°ƒç”¨çš„æ˜¯åŒ¿åç±»çš„æˆå‘˜å‡½æ•°â€œoperatorÂ ()â€</span></span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼Œâ€œfâ€å®é™…é•¿è¿™æ ·ï¼Œå®ƒæ˜¯ä¸€ä¸ªå«æœ‰ç±»æ•°æ®æˆå‘˜çš„åŒ¿åç±»ï¼Œè€Œä¸å†æ˜¯ç©ºæ— ä¸€ç‰¹çš„ç±»ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â <span class="class"><span class="keyword">struct</span>Â &lt;<span class="title">lambda</span>()&gt;Â &#123;</span></span><br><span class="line">Â Â Â Â intÂ __n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="3.Â ç¤ºä¾‹2">3.Â ç¤ºä¾‹2<a title="#3.Â ç¤ºä¾‹2" href="#3.Â ç¤ºä¾‹2"></a></h1>
<p>ç»§ç»­æ¥ä¸ªå˜ç§ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â <span class="keyword">int</span>Â nÂ =Â <span class="number">3</span>;</span><br><span class="line">Â Â <span class="keyword">auto</span>Â fÂ =Â [&amp;n]()Â <span class="keyword">mutable</span>Â &#123;Â <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,Â n);Â &#125;;</span><br><span class="line">Â Â f();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼Œâ€œfâ€å®é™…é•¿è¿™æ ·ï¼Œä¸€ä¸ªåŒ…å«äº†å¼•ç”¨ç±»å‹çš„åŒ¿åç±»ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â <span class="class"><span class="keyword">struct</span>Â &lt;<span class="title">lambda</span>()&gt;Â &#123;</span></span><br><span class="line">Â Â Â Â intÂ &amp;__n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="4.Â ç¤ºä¾‹3">4.Â ç¤ºä¾‹3<a title="#4.Â ç¤ºä¾‹3" href="#4.Â ç¤ºä¾‹3"></a></h1>
<p>ç»§ç»­å˜ç§ï¼Œâ€œ&amp;â€çš„ä½œç”¨è®©Lambdaå‡½æ•°å¯ä½¿ç”¨Lambdaæ‰€åœ¨ä½œç”¨åŸŸå†…æ‰€æœ‰å¯è§çš„å±€éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬Lambdaæ‰€åœ¨ç±»çš„thisï¼‰ï¼Œå¹¶ä¸”æ˜¯ä»¥å¼•ç”¨ä¼ é€’æ–¹å¼ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â <span class="keyword">int</span>Â nÂ =Â <span class="number">3</span>;</span><br><span class="line">Â Â <span class="keyword">auto</span>Â fÂ =Â [&amp;]()Â <span class="keyword">mutable</span>Â &#123;Â <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,Â n);Â &#125;;</span><br><span class="line">Â Â f();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â€œfâ€å®é™…é•¿è¿™æ ·ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â <span class="class"><span class="keyword">struct</span>Â &lt;<span class="title">lambda</span>()&gt;Â &#123;</span></span><br><span class="line">Â Â Â Â intÂ &amp;__n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å˜ç¨å¤æ‚ä¸€ç‚¹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â <span class="keyword">int</span>Â nÂ =Â <span class="number">3</span>;</span><br><span class="line">Â Â <span class="keyword">int</span>Â mÂ =Â <span class="number">5</span>;</span><br><span class="line">Â Â <span class="keyword">auto</span>Â fÂ =Â [&amp;]()Â <span class="keyword">mutable</span>Â &#123;Â <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,Â n);Â &#125;;</span><br><span class="line">Â Â f();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œâ€œfâ€å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â <span class="class"><span class="keyword">struct</span>Â &lt;<span class="title">lambda</span>()&gt;Â &#123;</span></span><br><span class="line">Â Â Â Â intÂ &amp;__n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="5.Â ç¤ºä¾‹4">5.Â ç¤ºä¾‹4<a title="#5.Â ç¤ºä¾‹4" href="#5.Â ç¤ºä¾‹4"></a></h1>
<p>ç»§ç»­å¢åŠ å¤æ‚åº¦ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â <span class="keyword">int</span>Â nÂ =Â <span class="number">3</span>;</span><br><span class="line">Â Â <span class="keyword">int</span>Â mÂ =Â <span class="number">5</span>;</span><br><span class="line">Â Â <span class="keyword">auto</span>Â fÂ =Â [&amp;]()Â <span class="keyword">mutable</span>Â &#123;Â <span class="built_in">printf</span>(<span class="string">"%d,%d\n"</span>,Â n,Â m);Â &#125;;</span><br><span class="line">Â Â f();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°â€œfâ€å˜äº†ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â <span class="class"><span class="keyword">struct</span>Â &lt;<span class="title">lambda</span>()&gt;Â &#123;</span></span><br><span class="line">Â Â Â Â intÂ &amp;__n;</span><br><span class="line">Â Â Â Â intÂ &amp;__m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢ä¸éš¾çœ‹å‡ºï¼Œç¼–è¯‘å™¨åªä¼šæŠŠLambdaå‡½æ•°ç”¨åˆ°çš„å˜é‡æ‰“åŒ…è¿›å¯¹åº”çš„åŒ¿åç±»ã€‚ç»§ç»­ä¸€ä¸ªç¨å¤æ‚ç‚¹çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span>Â <span class="title">X</span>Â &#123;</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">foo</span><span class="params">()</span>Â </span>&#123;Â <span class="built_in">printf</span>(<span class="string">"foo\n"</span>);Â &#125;</span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">xoo</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">auto</span>Â fÂ =Â [&amp;]Â &#123;Â foo();Â &#125;;</span><br><span class="line">Â Â Â Â f();</span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â X().xoo();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼Œâ€œfâ€å®é™…é•¿è¿™æ ·ï¼š</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â structÂ <span class="type">X</span>::&lt;lambda()&gt;Â &#123;</span><br><span class="line">Â Â Â Â <span class="type">X</span>Â *Â constÂ __this;Â //Â <span class="type">X</span>ç±»å‹çš„æŒ‡é’ˆï¼ˆéå¯¹è±¡ï¼‰</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå°†â€œautoÂ fÂ =Â [&amp;]Â {Â foo();Â };â€ä¸­çš„â€œ&amp;â€å»æ‰ï¼Œåˆ™ä¼šé‡åˆ°ç¼–è¯‘é”™è¯¯ï¼Œæç¤ºâ€œthisâ€æ²¡æœ‰è¢«Lambdaå‡½æ•°æ•è·ï¼š</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">a2.cpp:Â <span class="keyword">In</span>Â lambdaÂ <span class="keyword">function</span>:</span><br><span class="line">a2.cpp:<span class="number">5</span>:<span class="number">23</span>:Â error:Â <span class="symbol">'this</span>'Â wasÂ <span class="keyword">not</span>Â capturedÂ <span class="keyword">for</span>Â thisÂ lambdaÂ <span class="keyword">function</span></span><br><span class="line">Â Â Â Â <span class="number">5</span>Â |Â Â Â Â Â autoÂ fÂ =Â []Â &#123;Â foo();Â &#125;;</span><br><span class="line">Â Â Â Â Â Â |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^</span><br><span class="line">a2.cpp:<span class="number">5</span>:<span class="number">23</span>:Â error:Â cannotÂ callÂ memberÂ <span class="keyword">function</span>Â <span class="title">'void</span>Â X::foo()'Â <span class="keyword">with</span><span class="keyword">out</span>Â object</span><br></pre></td></tr></table></figure>
<p>æ”¹æˆä¸‹åˆ—æ–¹å¼æ•è·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span>Â <span class="title">X</span>Â &#123;</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">foo</span><span class="params">()</span>Â </span>&#123;Â <span class="built_in">printf</span>(<span class="string">"foo\n"</span>);Â &#125;</span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">xoo</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">auto</span>Â fÂ =Â [<span class="keyword">this</span>]Â &#123;Â foo();Â &#125;;</span><br><span class="line">Â Â Â Â f();</span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â X().xoo();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯C++17ï¼Œè¿˜å¯ä»¥è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++17</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span>Â <span class="title">X</span>Â &#123;</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">foo</span><span class="params">()</span>Â </span>&#123;Â <span class="built_in">printf</span>(<span class="string">"foo\n"</span>);Â &#125;</span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">xoo</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">auto</span>Â fÂ =Â [*<span class="keyword">this</span>]()Â <span class="keyword">mutable</span>Â &#123;Â foo();Â &#125;;</span><br><span class="line">Â Â Â Â f();</span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â X().xoo();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„å¾—æœ‰â€œmutableâ€ä¿®é¥°ï¼Œä¸ç„¶æŠ¥å¦‚ä¸‹ç¼–è¯‘é”™è¯¯ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">a2.<span class="string">cpp:</span>Â InÂ lambdaÂ <span class="string">function:</span></span><br><span class="line">a2.<span class="string">cpp:</span><span class="number">5</span>:<span class="number">30</span>:Â <span class="string">error:</span>Â passingÂ <span class="string">'constÂ X'</span>Â <span class="keyword">as</span>Â <span class="string">'this'</span>Â argumentÂ discardsÂ qualifiersÂ [-fpermissive]</span><br><span class="line">Â Â Â Â <span class="number">5</span>Â |Â Â Â Â Â autoÂ fÂ =Â [*<span class="keyword">this</span>]()Â &#123;Â foo();Â &#125;;</span><br><span class="line">Â Â Â Â Â Â |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^</span><br><span class="line">a2.<span class="string">cpp:</span><span class="number">3</span>:<span class="number">8</span>:Â <span class="string">note:</span>Â Â Â <span class="keyword">in</span>Â callÂ toÂ <span class="string">'voidÂ X::foo()'</span></span><br><span class="line">Â Â Â Â <span class="number">3</span>Â |Â Â Â <span class="keyword">void</span>Â foo()Â &#123;Â printf(<span class="string">"foo\n"</span>);Â &#125;</span><br><span class="line">Â Â Â Â Â Â |Â Â Â Â Â Â Â Â ^~~</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥è¿™æ ·ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++17</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span>Â <span class="title">X</span>Â &#123;</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">foo</span><span class="params">()</span>Â </span>&#123;Â <span class="built_in">printf</span>(<span class="string">"foo\n"</span>);Â &#125;</span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">xoo</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">auto</span>Â fÂ =Â [&amp;,*<span class="keyword">this</span>]()Â <span class="keyword">mutable</span>Â &#123;Â foo();Â &#125;;</span><br><span class="line">Â Â Â Â f();</span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â X().xoo();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨â€œ*thisâ€æ—¶çš„â€œfâ€æ ·å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight elm"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span>Â =Â structÂ <span class="type">X</span>::&lt;lambda()&gt;Â &#123;</span><br><span class="line">Â Â Â Â <span class="type">X</span>Â __this;Â //Â <span class="type">X</span>ç±»å‹çš„å¯¹è±¡ï¼ˆéæŒ‡é’ˆï¼‰</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="6.Â ç¤ºä¾‹5">6.Â ç¤ºä¾‹5<a title="#6.Â ç¤ºä¾‹5" href="#6.Â ç¤ºä¾‹5"></a></h1>
<p>ç»§ç»­ç ”ç©¶ï¼Œä½¿ç”¨C++Â RTTIï¼ˆRun-TimeÂ TypeÂ Identificationï¼Œè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰è®¾æ–½â€œtypeidâ€æŸ¥çœ‹Lambdaå‡½æ•°ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span>Â <span class="meta-string">&lt;typeinfo&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">struct</span>Â <span class="title">X</span>Â &#123;</span></span><br><span class="line">Â Â <span class="function"><span class="keyword">void</span>Â <span class="title">xoo</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â Â Â <span class="keyword">auto</span>Â fÂ =Â []Â &#123;Â <span class="built_in">printf</span>(<span class="string">"f\n"</span>);Â &#125;;</span><br><span class="line">Â Â Â Â <span class="built_in">printf</span>(<span class="string">"%s\n"</span>,Â <span class="keyword">typeid</span>(f).name());</span><br><span class="line">Â Â Â Â <span class="comment">//Â æ³¨ï¼štypeidè¿”å›å€¼ç±»å‹ä¸ºâ€œstd::type_infoâ€</span></span><br><span class="line">Â Â &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>Â <span class="title">main</span><span class="params">()</span>Â </span>&#123;</span><br><span class="line">Â Â X().xoo();</span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œè¾“å‡ºï¼š</p>
<p><code>ZN1X3xooEvEUlvE_</code></p>
<h1 id="7.-åŒ¿åç±»è§„åˆ™">7. åŒ¿åç±»è§„åˆ™<a title="#7.-åŒ¿åç±»è§„åˆ™" href="#7.-åŒ¿åç±»è§„åˆ™"></a></h1>
<p>ç¼–è¯‘å™¨ä¸ºLambdaç”Ÿæˆçš„åŒ¿åç±»è§„åˆ™ï¼ˆä¸åŒæ ‡å‡†æœ‰åŒºåˆ«ï¼‰ï¼š</p>
<table align="center" border="1" cellspacing="0"><tbody><tr><td rowspan="4">			<p style="margin-left:0pt;">æ„é€ å‡½æ•°</p>			<p style="margin-left:0pt;">æ‹·è´æ„é€ å‡½æ•°</p>			</td>			<td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType()&nbsp;=&nbsp;<strong>delete</strong>;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">C++14å‰</p>			</td>		</tr><tr><td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType()&nbsp;=&nbsp;default;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">C++20èµ·ï¼Œ</p>			<p style="margin-left:0pt;">ä»…å½“æœªæŒ‡å®šä»»ä½•ä¿˜è·æ—¶</p>			</td>		</tr><tr><td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType(const&nbsp;ClosureType&amp;&nbsp;)&nbsp;=&nbsp;default;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">C++14èµ·</p>			</td>		</tr><tr><td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType(ClosureType&amp;&amp;&nbsp;)&nbsp;=&nbsp;default;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">C++14èµ·</p>			</td>		</tr><tr><td rowspan="3" style="width:69.35pt;">			<p style="margin-left:0pt;">æ‹·è´å¤åˆ¶å‡½æ•°</p>			</td>			<td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType&amp;&nbsp;operator=(const&nbsp;ClosureType&amp;)&nbsp;=&nbsp;<strong>delete</strong>;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;"><span style="color:#0000ff;"><strong>C++20å‰</strong></span></p>			</td>		</tr><tr><td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType&amp;&nbsp;operator=(const&nbsp;ClosureType&amp;)&nbsp;=&nbsp;default;</p>			<p style="margin-left:0pt;">ClosureType&amp;&nbsp;operator=(ClosureType&amp;&amp;)&nbsp;=&nbsp;default;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">C++20èµ·ï¼Œ</p>			<p style="margin-left:0pt;">ä»…å½“æœªæŒ‡å®šä»»ä½•ä¿˜è·æ—¶</p>			</td>		</tr><tr><td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">ClosureType&amp;&nbsp;operator=(const&nbsp;ClosureType&amp;)&nbsp;=&nbsp;<strong>delete</strong>;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">C++20èµ·ï¼Œå…¶ä»–æƒ…å†µ</p>			</td>		</tr><tr><td style="vertical-align:top;width:69.35pt;">			<p style="margin-left:0pt;">ææ„å‡½æ•°</p>			</td>			<td style="vertical-align:top;width:250.8pt;">			<p style="margin-left:0pt;">~ClosureType()&nbsp;=&nbsp;default;</p>			</td>			<td style="vertical-align:top;width:105.95pt;">			<p style="margin-left:0pt;">ææ„å‡½æ•°æ˜¯éšå¼å£°æ˜çš„</p>			</td>		</tr></tbody></table>
å¯¹äºæ ‡è®°ä¸ºâ€œdeleteâ€çš„å‡½æ•°æ˜¯ä¸èƒ½è°ƒç”¨çš„ï¼Œå¦‚ä¸‹åˆ—ä»£ç ä¸­çš„â€œf2Â =Â f1;â€å°†è§¦å‘ç¼–è¯‘é”™è¯¯ï¼š
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span>Â main()Â &#123;</span><br><span class="line"></span><br><span class="line">Â Â <span class="built_in">auto</span>Â f1Â =Â []&#123;&#125;;</span><br><span class="line"></span><br><span class="line">Â Â <span class="built_in">auto</span>Â f2Â =Â f1;</span><br><span class="line"></span><br><span class="line">Â Â f2Â =Â f1;</span><br><span class="line"></span><br><span class="line">Â Â <span class="keyword">return</span>Â <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šåˆ—ä»£ç åœ¨C<ins>11ã€C</ins>14å’ŒC<ins>17å‡ä¼šæŠ¥é”™ã€‚ä¸è¿‡å¦‚è§„åˆ™æ‰€ç¤ºï¼ŒC</ins>20ï¼ˆå«C++2aï¼‰ä¸Šåˆ™å¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼š</p>
<figure class="highlight scilab"><table><tr><td class="code"><pre><span class="line">a3.cpp:Â InÂ <span class="function"><span class="keyword">function</span>Â '<span class="title">int</span>Â <span class="title">main</span><span class="params">()</span>':</span></span><br><span class="line">a3.cpp:<span class="number">4</span>:<span class="number">8</span>:Â <span class="built_in">error</span>:Â useÂ ofÂ deletedÂ <span class="function"><span class="keyword">function</span>Â '<span class="title">main</span><span class="params">()</span>::&lt;<span class="title">lambda</span><span class="params">()</span>&gt;&amp;Â <span class="title">main</span><span class="params">()</span>::&lt;<span class="title">lambda</span><span class="params">()</span>&gt;::<span class="title">operator</span>=<span class="params">(constÂ main()</span>::&lt;<span class="title">lambda</span><span class="params">()</span>&gt;&amp;)'</span></span><br><span class="line">Â Â Â Â <span class="number">4</span>Â |Â Â Â f2Â =Â f1;</span><br><span class="line">Â Â Â Â Â Â |Â Â Â Â Â Â Â Â ^~</span><br><span class="line">a3.cpp:<span class="number">2</span>:<span class="number">14</span>:Â note:Â aÂ lambdaÂ closureÂ <span class="built_in">type</span>Â hasÂ aÂ deletedÂ copyÂ assignmentÂ operator</span><br><span class="line">Â Â Â Â <span class="number">2</span>Â |Â Â Â autoÂ f1Â =Â []&#123;&#125;;</span><br><span class="line">Â Â Â Â Â Â |Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^</span><br></pre></td></tr></table></figure>
<p>å¸Œæœ›é€šè¿‡æœ¬æ–‡ï¼Œå¯¹ç†è§£Lambdaæœ‰æ‰€å¸®åŠ©ã€‚</p>
<h1 id="8.Â å‚è€ƒèµ„æ–™">8.Â å‚è€ƒèµ„æ–™<a title="#8.Â å‚è€ƒèµ„æ–™" href="#8.Â å‚è€ƒèµ„æ–™"></a></h1>
<ul>
<li>
<p>1)Â <a href="https://zh.cppreference.com/w/cpp/language/lambda" target="_blank">https://zh.cppreference.com/w/cpp/language/lambda</a></p>
</li>
<li>
<p>2)Â <a href="https://docs.microsoft.com/en-us/cpp/cpp/lambda-expressions-in-cpp?view=vs-2019" target="_blank">https://docs.microsoft.com/en-us/cpp/cpp/lambda-expressions-in-cpp?view=vs-2019</a></p>
</li>
<li>
<p>3)Â <a href="https://en.cpprefeence.com/w/cpp/language/lambda" target="_blank">https://en.cpprefeence.com/w/cpp/language/lambda</a></p>
</li>
<li>
<p>4)Â <a href="https://stackoverflow.com/questions/7627098/what-is-a-lambda-expression-in-c11" target="_blank">https://stackoverflow.com/questions/7627098/what-is-a-lambda-expression-in-c11</a></p>
</li>
<li>
<p>5)Â <a href="https://www.cprogramming.com/c++11/c++11-lambda-closures.html" target="_blank">https://www.cprogramming.com/c<ins>11/c</ins>11-lambda-closures.html</a></p>
</li>
</ul>
<hr>
<div class="note info">
            <p>ä½œè€…ï¼šä¸€è§<br>æ¥æºï¼šCSDN<br>åŸæ–‡ï¼š<a href="https://blog.csdn.net/Aquester/article/details/90691479" target="_blank" rel="noopener">https://blog.csdn.net/Aquester/article/details/90691479</a></p>
          </div>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux--awkå‘½ä»¤</title>
    <url>/posts/Linux-awk%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h2 id="ä¸€ï¼šawkç®€ä»‹">ä¸€ï¼šawkç®€ä»‹<a title="#ä¸€ï¼šawkç®€ä»‹" href="#ä¸€ï¼šawkç®€ä»‹"></a></h2>
<p>â€‹        awkå…¶åç§°å¾—è‡ªäºå®ƒçš„åˆ›å§‹äºº Alfred Aho ã€Peter Weinberger å’Œ Brian Kernighan å§“æ°çš„é¦–ä¸ªå­—æ¯ã€‚å®é™…ä¸Š AWK çš„ç¡®æ‹¥æœ‰è‡ªå·±çš„è¯­è¨€ï¼š AWK ç¨‹åºè®¾è®¡è¯­è¨€ ï¼Œ ä¸‰ä½åˆ›å»ºè€…å·²å°†å®ƒæ­£å¼å®šä¹‰ä¸ºâ€œæ ·å¼æ‰«æå’Œå¤„ç†è¯­è¨€â€ã€‚å®ƒå…è®¸æ‚¨åˆ›å»ºç®€çŸ­çš„ç¨‹åºï¼Œè¿™äº›ç¨‹åºè¯»å–è¾“å…¥æ–‡ä»¶ã€ä¸ºæ•°æ®æ’åºã€å¤„ç†æ•°æ®ã€å¯¹è¾“å…¥æ‰§è¡Œè®¡ç®—ä»¥åŠç”ŸæˆæŠ¥è¡¨ï¼Œè¿˜æœ‰æ— æ•°å…¶ä»–çš„åŠŸèƒ½ã€‚</p>
<p>â€‹       awk æ˜¯ä¸€ç§å¾ˆæ£’çš„è¯­è¨€ï¼Œå®ƒé€‚åˆæ–‡æœ¬å¤„ç†å’ŒæŠ¥è¡¨ç”Ÿæˆï¼Œå…¶è¯­æ³•è¾ƒä¸ºå¸¸è§ï¼Œå€Ÿé‰´äº†æŸäº›è¯­è¨€çš„ä¸€äº›ç²¾åï¼Œå¦‚ C è¯­è¨€ç­‰ã€‚åœ¨ linux ç³»ç»Ÿæ—¥å¸¸å¤„ç†å·¥ä½œä¸­ï¼Œå‘æŒ¥å¾ˆé‡è¦çš„ä½œç”¨ï¼ŒæŒæ¡äº† awkå°†ä¼šä½¿ä½ çš„å·¥ä½œå˜çš„é«˜å¤§ä¸Šã€‚ awk æ˜¯ä¸‰å‰‘å®¢çš„è€å¤§ï¼Œåˆ©å‰‘å‡ºé˜ï¼Œå¿…ä¼šä¸åŒå‡¡å“ã€‚</p>
<a id="more"></a>
<p><a href="https://www.cnblogs.com/yaohong/p/9163471.html#_labelTop" target="_blank">å›åˆ°é¡¶éƒ¨</a></p>
<h2 id="äºŒï¼šä½¿ç”¨æ–¹æ³•"><strong>äºŒï¼šä½¿ç”¨æ–¹æ³•</strong><a title="#äºŒï¼šä½¿ç”¨æ–¹æ³•" href="#äºŒï¼šä½¿ç”¨æ–¹æ³•"></a></h2>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`awk ``<span class="string">'&#123;pattern + action&#125;'</span>` `&#123;filenames&#125;`</span><br></pre></td></tr></table></figure>
<p>â€‹        å°½ç®¡æ“ä½œå¯èƒ½ä¼šå¾ˆå¤æ‚ï¼Œä½†è¯­æ³•æ€»æ˜¯è¿™æ ·ï¼Œå…¶ä¸­ pattern è¡¨ç¤º AWK åœ¨æ•°æ®ä¸­æŸ¥æ‰¾çš„å†…å®¹ï¼Œè€Œ action æ˜¯åœ¨æ‰¾åˆ°åŒ¹é…å†…å®¹æ—¶æ‰€æ‰§è¡Œçš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚èŠ±æ‹¬å·ï¼ˆ{}ï¼‰ä¸éœ€è¦åœ¨ç¨‹åºä¸­å§‹ç»ˆå‡ºç°ï¼Œä½†å®ƒä»¬ç”¨äºæ ¹æ®ç‰¹å®šçš„æ¨¡å¼å¯¹ä¸€ç³»åˆ—æŒ‡ä»¤è¿›è¡Œåˆ†ç»„ã€‚ patternå°±æ˜¯è¦è¡¨ç¤ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ–œæ æ‹¬èµ·æ¥ã€‚</p>
<p>â€‹        awkè¯­è¨€çš„æœ€åŸºæœ¬åŠŸèƒ½æ˜¯åœ¨æ–‡ä»¶æˆ–è€…å­—ç¬¦ä¸²ä¸­åŸºäºæŒ‡å®šè§„åˆ™æµè§ˆå’ŒæŠ½å–ä¿¡æ¯ï¼ŒawkæŠ½å–ä¿¡æ¯åï¼Œæ‰èƒ½è¿›è¡Œå…¶ä»–æ–‡æœ¬æ“ä½œã€‚å®Œæ•´çš„awkè„šæœ¬é€šå¸¸ç”¨æ¥æ ¼å¼åŒ–æ–‡æœ¬æ–‡ä»¶ä¸­çš„ä¿¡æ¯ã€‚</p>
<p>é€šå¸¸ï¼Œawkæ˜¯ä»¥æ–‡ä»¶çš„ä¸€è¡Œä¸ºå¤„ç†å•ä½çš„ã€‚awkæ¯æ¥æ”¶æ–‡ä»¶çš„ä¸€è¡Œï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„å‘½ä»¤ï¼Œæ¥å¤„ç†æ–‡æœ¬ã€‚</p>
<p><a href="https://www.cnblogs.com/yaohong/p/9163471.html#_labelTop" target="_blank">å›åˆ°é¡¶éƒ¨</a></p>
<h2 id="ä¸‰ï¼šawk-çš„åŸç†">ä¸‰ï¼šawk çš„åŸç†<a title="#ä¸‰ï¼šawk-çš„åŸç†" href="#ä¸‰ï¼šawk-çš„åŸç†"></a></h2>
<p>é€šè¿‡ä¸€ä¸ªç®€çŸ­çš„å‘½ä»¤ï¼Œæˆ‘ä»¬æ¥äº†è§£å…¶å·¥ä½œåŸç†ã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'&#123;print $0&#125;'</span>` `/etc/passwd``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin``.....................................................`` ` `[root@Gin scripts]# echo hhh|awk ``<span class="string">'&#123;print "hello,world"&#125;'</span>``hello,world`` ` `[root@Gin scripts]# awk ``<span class="string">'&#123;print "hiya"&#125;'</span>` /etc/passwd``hiya``hiya``hiya``hiya``...............................................`</span><br></pre></td></tr></table></figure>
<p></p>
<p>â€‹       ä½ å°†ä¼šè§åˆ°/etc/passwd æ–‡ä»¶çš„å†…å®¹å‡ºç°åœ¨çœ¼å‰ã€‚ç°åœ¨ï¼Œè§£é‡Š awk åšäº†äº›ä»€ä¹ˆã€‚è°ƒç”¨ awkæ—¶ï¼Œæˆ‘ä»¬æŒ‡å®š/etc/passwd ä½œä¸ºè¾“å…¥æ–‡ä»¶ã€‚æ‰§è¡Œ awk æ—¶ï¼Œå®ƒä¾æ¬¡å¯¹/etc/passwd ä¸­çš„æ¯ä¸€è¡Œæ‰§è¡Œ print å‘½ä»¤ã€‚</p>
<p>â€‹       æ‰€æœ‰è¾“å‡ºéƒ½å‘é€åˆ° stdoutï¼Œæ‰€å¾—åˆ°çš„ç»“æœä¸æ‰§è¡Œ cat /etc/passwd å®Œå…¨ç›¸åŒã€‚<br>
â€‹       ç°åœ¨ï¼Œè§£é‡Š{ print }ä»£ç å—ã€‚åœ¨ awk ä¸­ï¼ŒèŠ±æ‹¬å·ç”¨äºå°†å‡ å—ä»£ç ç»„åˆåˆ°ä¸€èµ·ï¼Œè¿™ä¸€ç‚¹ç±»ä¼¼äº C è¯­è¨€ã€‚åœ¨ä»£ç å—ä¸­åªæœ‰ä¸€æ¡ print å‘½ä»¤ã€‚åœ¨ awk ä¸­ï¼Œå¦‚æœåªå‡ºç° print å‘½ä»¤ï¼Œé‚£ä¹ˆå°†æ‰“å°å½“å‰è¡Œçš„å…¨éƒ¨å†…å®¹ã€‚<br>
<strong>å†æ¬¡è¯´æ˜ï¼Œ awk å¯¹è¾“å…¥æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚</strong></p>
<p><img src="https://images2015.cnblogs.com/blog/1089507/201701/1089507-20170126222420597-662074402.jpg" alt="img" class="Ï†cx"></p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`$ awk -F``<span class="string">":"</span>` `<span class="string">'&#123; print $1 &#125;'</span>` `/etc/passwd``$ awk -F``<span class="string">":"</span>` `<span class="string">'&#123; print $1 $3 &#125;'</span>` `/etc/passwd``$ awk -F``<span class="string">":"</span>` `<span class="string">'&#123; print $1 " " $3 &#125;'</span>` `/etc/passwd``$ awk -F``<span class="string">":"</span>` `<span class="string">'&#123; print "username: " $1 "\t\tuid:" $3" &#125;'</span>` `/etc/passwd`</span><br></pre></td></tr></table></figure>
<p>-Få‚æ•°ï¼šæŒ‡å®šåˆ†éš”ç¬¦ï¼Œå¯æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª</p>
<p>print åé¢åšå­—ç¬¦ä¸²çš„æ‹¼æ¥</p>
<p><strong>ä¸‹é¢é€šè¿‡å‡ å®ä¾‹æ¥äº†è§£ä¸‹awkçš„å·¥ä½œåŸç†ï¼š</strong></p>
<h4 id="å®ä¾‹ä¸€ï¼šåªæŸ¥çœ‹test.txtæ–‡ä»¶ï¼ˆ100è¡Œï¼‰å†…ç¬¬20åˆ°ç¬¬30è¡Œçš„å†…å®¹ï¼ˆä¼ä¸šé¢è¯•ï¼‰">å®ä¾‹ä¸€ï¼šåªæŸ¥çœ‹test.txtæ–‡ä»¶ï¼ˆ100è¡Œï¼‰å†…ç¬¬20åˆ°ç¬¬30è¡Œçš„å†…å®¹ï¼ˆä¼ä¸šé¢è¯•ï¼‰<a title="#å®ä¾‹ä¸€ï¼šåªæŸ¥çœ‹test.txtæ–‡ä»¶ï¼ˆ100è¡Œï¼‰å†…ç¬¬20åˆ°ç¬¬30è¡Œçš„å†…å®¹ï¼ˆä¼ä¸šé¢è¯•ï¼‰" href="#å®ä¾‹ä¸€ï¼šåªæŸ¥çœ‹test.txtæ–‡ä»¶ï¼ˆ100è¡Œï¼‰å†…ç¬¬20åˆ°ç¬¬30è¡Œçš„å†…å®¹ï¼ˆä¼ä¸šé¢è¯•ï¼‰"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`#print $aå–åˆ—#NRå–è¡Œæ•°[root@Gin scripts]# awk <span class="string">'&#123;if(NR&gt;=20 &amp;&amp; NR&lt;=30) print $1&#125;'</span> test.txt  ``<span class="number">20</span>``<span class="number">21</span>``<span class="number">22</span>``<span class="number">23</span>``<span class="number">24</span>``<span class="number">25</span>``<span class="number">26</span>``<span class="number">27</span>``<span class="number">28</span>``<span class="number">29</span>``<span class="number">30</span>`</span><br></pre></td></tr></table></figure>
<h4 id="å®ä¾‹äºŒï¼šå·²çŸ¥test.txtæ–‡ä»¶å†…å®¹ä¸ºï¼š">å®ä¾‹äºŒï¼šå·²çŸ¥test.txtæ–‡ä»¶å†…å®¹ä¸ºï¼š<a title="#å®ä¾‹äºŒï¼šå·²çŸ¥test.txtæ–‡ä»¶å†…å®¹ä¸ºï¼š" href="#å®ä¾‹äºŒï¼šå·²çŸ¥test.txtæ–‡ä»¶å†…å®¹ä¸ºï¼š"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat test.txt``I am Poe,my qq ``is` `<span class="number">33794712</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>è¯·ä»è¯¥æ–‡ä»¶ä¸­è¿‡æ»¤å‡ºâ€™Poeâ€™å­—ç¬¦ä¸²ä¸33794712ï¼Œæœ€åè¾“å‡ºçš„ç»“æœä¸ºï¼šPoe 33794712</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk -F ``<span class="string">'[ ,]+'</span>` `<span class="string">'&#123;print $3" "$7&#125;'</span>` `test.txt``Poe <span class="number">33794712</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<h3 id="begin-å’Œ-end-æ¨¡å—">BEGIN å’Œ END æ¨¡å—<a title="#begin-å’Œ-end-æ¨¡å—" href="#begin-å’Œ-end-æ¨¡å—"></a></h3>
<p>é€šå¸¸ï¼Œå¯¹äºæ¯ä¸ªè¾“å…¥è¡Œï¼Œ awk éƒ½ä¼šæ‰§è¡Œæ¯ä¸ªè„šæœ¬ä»£ç å—ä¸€æ¬¡ã€‚ç„¶è€Œï¼Œåœ¨è®¸å¤šç¼–ç¨‹æƒ…å†µä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨ awk å¼€å§‹å¤„ç†è¾“å…¥æ–‡ä»¶ä¸­çš„æ–‡æœ¬ä¹‹å‰æ‰§è¡Œåˆå§‹åŒ–ä»£ç ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œ awk å…è®¸æ‚¨å®šä¹‰ä¸€ä¸ª BEGIN å—ã€‚</p>
<p>å› ä¸º awk åœ¨å¼€å§‹å¤„ç†è¾“å…¥æ–‡ä»¶ä¹‹å‰ä¼šæ‰§è¡Œ BEGIN å—ï¼Œå› æ­¤å®ƒæ˜¯åˆå§‹åŒ– FSï¼ˆå­—æ®µåˆ†éš”ç¬¦ï¼‰å˜é‡ã€æ‰“å°é¡µçœ‰æˆ–åˆå§‹åŒ–å…¶å®ƒåœ¨ç¨‹åºä¸­ä»¥åä¼šå¼•ç”¨çš„å…¨å±€å˜é‡çš„æä½³ä½ç½®ã€‚<br>
awk è¿˜æä¾›äº†å¦ä¸€ä¸ªç‰¹æ®Šå—ï¼Œå«ä½œ END å—ã€‚ awk åœ¨å¤„ç†äº†è¾“å…¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡Œä¹‹åæ‰§è¡Œè¿™ä¸ªå—ã€‚é€šå¸¸ï¼Œ END å—ç”¨äºæ‰§è¡Œæœ€ç»ˆè®¡ç®—æˆ–æ‰“å°åº”è¯¥å‡ºç°åœ¨è¾“å‡ºæµç»“å°¾çš„æ‘˜è¦ä¿¡æ¯ã€‚</p>
<h4 id="å®ä¾‹ä¸€ï¼šç»Ÿè®¡/etc/passwdçš„è´¦æˆ·äººæ•°">å®ä¾‹ä¸€ï¼šç»Ÿè®¡/etc/passwdçš„è´¦æˆ·äººæ•°<a title="#å®ä¾‹ä¸€ï¼šç»Ÿè®¡/etc/passwdçš„è´¦æˆ·äººæ•°" href="#å®ä¾‹ä¸€ï¼šç»Ÿè®¡/etc/passwdçš„è´¦æˆ·äººæ•°"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'&#123;count++;print $0;&#125; END&#123;print "user count is ",count&#125;'</span>` `passwd``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``..............................................``user count ``is`  `<span class="number">27</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>countæ˜¯è‡ªå®šä¹‰å˜é‡ã€‚ä¹‹å‰çš„action{}é‡Œéƒ½æ˜¯åªæœ‰ä¸€ä¸ªprint,å…¶å®printåªæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œè€Œaction{}å¯ä»¥æœ‰å¤šä¸ªè¯­å¥ï¼Œä»¥;å·éš”å¼€ã€‚è¿™é‡Œæ²¡æœ‰åˆå§‹åŒ–countï¼Œè™½ç„¶é»˜è®¤æ˜¯0ï¼Œä½†æ˜¯å¦¥å½“çš„åšæ³•è¿˜æ˜¯åˆå§‹åŒ–ä¸º0:</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN &#123;count=0;print "[start] user count is ",count&#125; &#123;count=count+1;print $0&#125; END&#123;print "[end] user count is ",count&#125;'</span>` `passwd``[start] user count ``is`  `<span class="number">0</span>``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``...................................................................``[end] user count ``is`  `<span class="number">27</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<h4 id="å®ä¾‹äºŒï¼šç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°">å®ä¾‹äºŒï¼šç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°<a title="#å®ä¾‹äºŒï¼šç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°" href="#å®ä¾‹äºŒï¼šç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# ll |awk ``<span class="string">'BEGIN &#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print "[end]size is ",size&#125;'</span>``[end]size ``is`  `<span class="number">1489</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>å¦‚æœä»¥Mä¸ºå•ä½æ˜¾ç¤º:</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# ll |awk ``<span class="string">'BEGIN&#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print "[end]size is ",size/1024/1024,"M"&#125;'</span>`  `[end]size ``is`  `<span class="number">0.00142002</span> M`</span><br></pre></td></tr></table></figure>
<p></p>
<h3 id="awkè¿ç®—ç¬¦">awkè¿ç®—ç¬¦<a title="#awkè¿ç®—ç¬¦" href="#awkè¿ç®—ç¬¦"></a></h3>
<p><img src="https://images2015.cnblogs.com/blog/1089507/201701/1089507-20170126224150269-207487187.jpg" alt="img" class="Ï†cx"></p>
<h4 id="awk-èµ‹å€¼è¿ç®—ç¬¦ï¼ša+5;ç­‰ä»·äºï¼š-a=a+5;å…¶ä»–åŒç±»">awk èµ‹å€¼è¿ç®—ç¬¦ï¼ša+5;ç­‰ä»·äºï¼š a=a+5;å…¶ä»–åŒç±»<a title="#awk-èµ‹å€¼è¿ç®—ç¬¦ï¼ša+5;ç­‰ä»·äºï¼š-a=a+5;å…¶ä»–åŒç±»" href="#awk-èµ‹å€¼è¿ç®—ç¬¦ï¼ša+5;ç­‰ä»·äºï¼š-a=a+5;å…¶ä»–åŒç±»"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a=5;a+=5;print a&#125;'</span>``<span class="number">10</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<h4 id="awké€»è¾‘è¿ç®—ç¬¦ï¼š">awké€»è¾‘è¿ç®—ç¬¦ï¼š<a title="#awké€»è¾‘è¿ç®—ç¬¦ï¼š" href="#awké€»è¾‘è¿ç®—ç¬¦ï¼š"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a=1;b=2;print (a&gt;2&amp;&amp;b&gt;1,a=1||b&gt;1)&#125;'</span>``<span class="number">0</span> <span class="number">1</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>åˆ¤æ–­è¡¨è¾¾å¼ a&gt;2&amp;&amp;b&gt;1ä¸ºçœŸè¿˜æ˜¯ä¸ºå‡ï¼Œåé¢çš„è¡¨è¾¾å¼åŒç†</p>
<h4 id="awkæ­£åˆ™è¿ç®—ç¬¦ï¼š">awkæ­£åˆ™è¿ç®—ç¬¦ï¼š<a title="#awkæ­£åˆ™è¿ç®—ç¬¦ï¼š" href="#awkæ­£åˆ™è¿ç®—ç¬¦ï¼š"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a="100testaa";if(a~/100/) &#123;print "ok"&#125;&#125;'</span>``ok`</span><br></pre></td></tr></table></figure>
<p></p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# echo|awk ``<span class="string">'BEGIN&#123;a="100testaaa"&#125;a~/test/&#123;print "ok"&#125;'</span>``ok`</span><br></pre></td></tr></table></figure>
<p></p>
<h4 id="å…³ç³»è¿ç®—ç¬¦ï¼š">å…³ç³»è¿ç®—ç¬¦ï¼š<a title="#å…³ç³»è¿ç®—ç¬¦ï¼š" href="#å…³ç³»è¿ç®—ç¬¦ï¼š"></a></h4>
<p>å¦‚ï¼š &gt; &lt; å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥ç”¨ä½œæ•°å€¼æ¯”è¾ƒï¼Œå…³é”®çœ‹æ“ä½œæ•°å¦‚æœæ˜¯å­—ç¬¦ä¸²å°±ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¯”è¾ƒã€‚ä¸¤ä¸ªéƒ½ä¸ºæ•°å­— æ‰è½¬ä¸ºæ•°å€¼æ¯”è¾ƒã€‚å­—ç¬¦ä¸²æ¯”è¾ƒï¼šæŒ‰ç…§asciiç é¡ºåºæ¯”è¾ƒã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a="11";if(a&gt;=9)&#123;print "ok"&#125;&#125;'</span>` `#æ— è¾“å‡º``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a=11;if(a&gt;=9)&#123;print "ok"&#125;&#125;'</span>``ok``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a;if(a&gt;=b)&#123;print "ok"&#125;&#125;'</span>``ok`</span><br></pre></td></tr></table></figure>
<p></p>
<h4 id="awk-ç®—æœ¯è¿ç®—ç¬¦ï¼š">awk ç®—æœ¯è¿ç®—ç¬¦ï¼š<a title="#awk-ç®—æœ¯è¿ç®—ç¬¦ï¼š" href="#awk-ç®—æœ¯è¿ç®—ç¬¦ï¼š"></a></h4>
<p>è¯´æ˜ï¼Œæ‰€æœ‰ç”¨ä½œç®—æœ¯è¿ç®—ç¬¦è¿›è¡Œæ“ä½œï¼Œæ“ä½œæ•°è‡ªåŠ¨è½¬ä¸ºæ•°å€¼ï¼Œæ‰€æœ‰éæ•°å€¼éƒ½å˜ä¸º0ã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a="b";print a++,++a&#125;'</span>``<span class="number">0</span> <span class="number">2</span>``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a="20b4";print a++,++a&#125;'</span>``<span class="number">20</span> <span class="number">22</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>è¿™é‡Œçš„a++ , <ins>aä¸javascriptè¯­è¨€ä¸€æ ·ï¼ša</ins>æ˜¯å…ˆèµ‹å€¼åŠ ++ï¼›<ins>aæ˜¯å…ˆ</ins>å†èµ‹å€¼</p>
<h4 id="ä¸‰ç›®è¿ç®—ç¬¦-?:">ä¸‰ç›®è¿ç®—ç¬¦ ?:<a title="#ä¸‰ç›®è¿ç®—ç¬¦-?:" href="#ä¸‰ç›®è¿ç®—ç¬¦-?:"></a></h4>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a="b";print a=="b"?"ok":"err"&#125;'</span>``ok``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;a="b";print a=="c"?"ok":"err"&#125;'</span>``err`</span><br></pre></td></tr></table></figure>
<p></p>
<h3 id="å¸¸ç”¨-awk-å†…ç½®å˜é‡">å¸¸ç”¨ awk å†…ç½®å˜é‡<a title="#å¸¸ç”¨-awk-å†…ç½®å˜é‡" href="#å¸¸ç”¨-awk-å†…ç½®å˜é‡"></a></h3>
<p><img src="https://images2015.cnblogs.com/blog/1089507/201701/1089507-20170126225731300-1873454323.jpg" alt="img" class="Ï†cx"></p>
<p>æ³¨ï¼šå†…ç½®å˜é‡å¾ˆå¤šï¼Œå‚é˜…ç›¸å…³èµ„æ–™</p>
<h4 id="å­—æ®µåˆ†éš”ç¬¦-fs">å­—æ®µåˆ†éš”ç¬¦ FS<a title="#å­—æ®µåˆ†éš”ç¬¦-fs" href="#å­—æ®µåˆ†éš”ç¬¦-fs"></a></h4>
<p>FS=&quot;\t&quot; ä¸€ä¸ªæˆ–å¤šä¸ª Tab åˆ†éš”</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat tab.txt``ww   CC        IDD``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;FS="\t+"&#125;&#123;print $1,$2,$3&#125;'</span>` `tab.txt``ww   CC        IDD`</span><br></pre></td></tr></table></figure>
<p></p>
<p>FS=&quot;[[:space:]+]&quot; ä¸€ä¸ªæˆ–å¤šä¸ªç©ºç™½ç©ºæ ¼ï¼Œé»˜è®¤çš„</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat space.txt``we are    studing awk now!``[root@Gin scripts]# awk -F [[:space:]+] ``<span class="string">'&#123;print $1,$2,$3,$4,$5&#125;'</span>` `space.txt``we are ``[root@Gin scripts]# awk -F [[:space:]+] ``<span class="string">'&#123;print $1,$2&#125;'</span>` `space.txt``we are`</span><br></pre></td></tr></table></figure>
<p></p>
<p>FS=&quot;[&quot; â€œ:]+â€ ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼æˆ–ï¼šåˆ†éš”</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat hello.txt``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``[root@Gin scripts]# awk -F [``<span class="string">" "</span>``:]+ ``<span class="string">'&#123;print $1,$2,$3&#125;'</span>` `hello.txt``root x <span class="number">0</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>å­—æ®µæ•°é‡ NF</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat hello.txt``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin:<span class="number">888</span>``[root@Gin scripts]# awk -F ``<span class="string">":"</span>` `<span class="string">'NF==8&#123;print $0&#125;'</span>` `hello.txt``bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin:<span class="number">888</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>è®°å½•æ•°é‡ NR</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# ifconfig eth0|awk -F [``<span class="string">" "</span>``:]+ ``<span class="string">'NR==2&#123;print $4&#125;'</span>`  `## NR==<span class="number">2</span>ä¹Ÿå°±æ˜¯å–ç¬¬<span class="number">2</span>è¡Œ``<span class="number">192.168</span><span class="number">.17</span><span class="number">.129</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>RS è®°å½•åˆ†éš”ç¬¦å˜é‡<br>
å°† FS è®¾ç½®æˆ&quot;\n&quot;å‘Šè¯‰ awk æ¯ä¸ªå­—æ®µéƒ½å æ®ä¸€è¡Œã€‚é€šè¿‡å°† RS è®¾ç½®æˆ&quot;&quot;ï¼Œè¿˜ä¼šå‘Šè¯‰ awkæ¯ä¸ªåœ°å€è®°å½•éƒ½ç”±ç©ºç™½è¡Œåˆ†éš”ã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat recode.txt``Jimmy the Weasel``<span class="number">100</span> Pleasant Drive``San Francisco,CA <span class="number">123456</span>`` ` `Big Tony``<span class="number">200</span> Incognito Ave.``Suburbia,WA <span class="number">64890</span>``[root@Gin scripts]# cat awk.txt``#!/bin/awk``BEGIN &#123;``        ``FS=``<span class="string">"\n"</span>``        ``RS=``<span class="string">""</span>``&#125;``&#123;``        ``print $<span class="number">1</span>``<span class="string">","</span>``$<span class="number">2</span>``<span class="string">","</span>``$<span class="number">3</span>``&#125;``[root@Gin scripts]# awk -f awk.txt recode.txt``Jimmy the Weasel,<span class="number">100</span> Pleasant Drive,San Francisco,CA <span class="number">123456</span>``Big Tony,<span class="number">200</span> Incognito Ave.,Suburbia,WA <span class="number">64890</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>OFS è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat hello.txt``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``bin:x:<span class="number">1</span>:<span class="number">1</span>:bin:/bin:/sbin/nologin:<span class="number">888</span>``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;FS=":"&#125;&#123;print $1","$2","$3&#125;'</span>` `hello.txt``root,x,<span class="number">0</span>``bin,x,<span class="number">1</span>``[root@Gin scripts]# awk ``<span class="string">'BEGIN&#123;FS=":";OFS="#"&#125;&#123;print $1,$2,$3&#125;'</span>` `hello.txt``root#x#<span class="number">0</span>``bin#x#<span class="number">1</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>ORS è¾“å‡ºè®°å½•åˆ†éš”ç¬¦</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# cat recode.txt``Jimmy the Weasel``<span class="number">100</span> Pleasant Drive``San Francisco,CA <span class="number">123456</span>`` ` `Big Tony``<span class="number">200</span> Incognito Ave.``Suburbia,WA <span class="number">64890</span>``[root@Gin scripts]# cat awk.txt``#!/bin/awk``BEGIN &#123;``        ``FS=``<span class="string">"\n"</span>``        ``RS=``<span class="string">""</span>``        ``ORS=``<span class="string">"\n\n"</span>``&#125;``&#123;``        ``print $<span class="number">1</span>``<span class="string">","</span>``$<span class="number">2</span>``<span class="string">","</span>``$<span class="number">3</span>``&#125;``[root@Gin scripts]# awk -f awk.txt recode.txt``Jimmy the Weasel,<span class="number">100</span> Pleasant Drive,San Francisco,CA <span class="number">123456</span>`` ` `Big Tony,<span class="number">200</span> Incognito Ave.,Suburbia,WA <span class="number">64890</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<h3 id="awk-æ­£åˆ™">awk æ­£åˆ™<a title="#awk-æ­£åˆ™" href="#awk-æ­£åˆ™"></a></h3>
<p><img src="https://images2015.cnblogs.com/blog/1089507/201701/1089507-20170126232437800-1355193233.jpg" alt="img" class="Ï†cx"></p>
<h4 id="æ­£åˆ™åº”ç”¨">æ­£åˆ™åº”ç”¨<a title="#æ­£åˆ™åº”ç”¨" href="#æ­£åˆ™åº”ç”¨"></a></h4>
<p>è§„åˆ™è¡¨è¾¾å¼</p>
<p>awk '/REG/{action} â€™ file,/REG/ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥å°†$0 ä¸­ï¼Œæ»¡è¶³æ¡ä»¶çš„è®°å½•é€å…¥åˆ°ï¼šaction è¿›è¡Œå¤„ç†</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk ``<span class="string">'/root/&#123;print $0&#125;'</span>` `passwd ##åŒ¹é…æ‰€æœ‰åŒ…å«rootçš„è¡Œ``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``operator``:x:<span class="number">11</span>:<span class="number">0</span>:``operator``:/root:/sbin/nologin`` ` `[root@Gin scripts]# awk -F: ``<span class="string">'$5~/root/&#123;print $0&#125;'</span>` `passwd  ## ä»¥åˆ†å·ä½œä¸ºåˆ†éš”ç¬¦ï¼ŒåŒ¹é…ç¬¬<span class="number">5</span>ä¸ªå­—æ®µæ˜¯rootçš„è¡Œ``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash`` ` `[root@Gin scripts]# ifconfig eth0|awk ``<span class="string">'BEGIN&#123;FS="[[:space:]:]+"&#125; NR==2&#123;print $4&#125;'</span>``<span class="number">192.168</span><span class="number">.17</span><span class="number">.129</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>å¸ƒå°”è¡¨è¾¾å¼<br>
awk â€˜å¸ƒå°”è¡¨è¾¾å¼{action}â€™ file ä»…å½“å¯¹å‰é¢çš„å¸ƒå°”è¡¨è¾¾å¼æ±‚å€¼ä¸ºçœŸæ—¶ï¼Œ awk æ‰æ‰§è¡Œä»£ç å—ã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`[root@Gin scripts]# awk -F: ``<span class="string">'$1=="root"&#123;print $0&#125;'</span>` `passwd``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash``[root@Gin scripts]# awk -F: ``<span class="string">'($1=="root")&amp;&amp;($5=="root") &#123;print $0&#125;'</span>` `passwd``root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/bin/bash`</span><br></pre></td></tr></table></figure>
<p></p>
<h3 id="awk-çš„-ifã€å¾ªç¯å’Œæ•°ç»„">awk çš„ ifã€å¾ªç¯å’Œæ•°ç»„<a title="#awk-çš„-ifã€å¾ªç¯å’Œæ•°ç»„" href="#awk-çš„-ifã€å¾ªç¯å’Œæ•°ç»„"></a></h3>
<h4 id="æ¡ä»¶è¯­å¥">æ¡ä»¶è¯­å¥<a title="#æ¡ä»¶è¯­å¥" href="#æ¡ä»¶è¯­å¥"></a></h4>
<p>awk æä¾›äº†éå¸¸å¥½çš„ç±»ä¼¼äº C è¯­è¨€çš„ if è¯­å¥ã€‚</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`&#123;``        ``<span class="keyword">if</span>` `($<span class="number">1</span>==``<span class="string">"foo"</span>``)&#123;``                ``<span class="keyword">if</span>``($<span class="number">2</span>==``<span class="string">"foo"</span>``)&#123;``                        ``print ``<span class="string">"uno"</span>``                ``&#125;``else``&#123;``                        ``print ``<span class="string">"one"</span>``                ``&#125;``        ``&#125;elseif($<span class="number">1</span>==``<span class="string">"bar"</span>``)&#123;``                ``print ``<span class="string">"two"</span>``        ``&#125;``else``&#123;``                ``print ``<span class="string">"three"</span>``        ``&#125;``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>ä½¿ç”¨ if è¯­å¥è¿˜å¯ä»¥å°†ä»£ç ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">`! /matchme/ &#123; <span class="builtin-name">print</span> <span class="variable">$1</span> <span class="variable">$3</span> <span class="variable">$4</span> &#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>è½¬æ¢æˆï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`&#123;``ã€€ã€€``<span class="keyword">if</span>` `( $<span class="number">0</span> !~ /matchme/ ) &#123;``ã€€ã€€ã€€ã€€print $<span class="number">1</span> $<span class="number">3</span> $<span class="number">4</span>``ã€€ã€€&#125;``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<h4 id="å¾ªç¯ç»“æ„">å¾ªç¯ç»“æ„<a title="#å¾ªç¯ç»“æ„" href="#å¾ªç¯ç»“æ„"></a></h4>
<p>æˆ‘ä»¬å·²ç»çœ‹åˆ°äº† awk çš„ while å¾ªç¯ç»“æ„ï¼Œå®ƒç­‰åŒäºç›¸åº”çš„ C è¯­è¨€ while å¾ªç¯ã€‚ awk è¿˜æœ‰&quot;doâ€¦while&quot;å¾ªç¯ï¼Œå®ƒåœ¨ä»£ç å—ç»“å°¾å¤„å¯¹æ¡ä»¶æ±‚å€¼ï¼Œè€Œä¸åƒæ ‡å‡† while å¾ªç¯é‚£æ ·åœ¨å¼€å§‹å¤„æ±‚å€¼ã€‚</p>
<p>å®ƒç±»ä¼¼äºå…¶å®ƒè¯­è¨€ä¸­çš„&quot;repeatâ€¦until&quot;å¾ªç¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š<br>
doâ€¦while ç¤ºä¾‹</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`&#123;``    ``count=<span class="number">1</span>do &#123;``        ``print ``<span class="string">"I get printed at least once no matter what"</span>``    ``&#125; ``while` `( count !=<span class="number">1</span> )``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>ä¸ä¸€èˆ¬çš„ while å¾ªç¯ä¸åŒï¼Œç”±äºåœ¨ä»£ç å—ä¹‹åå¯¹æ¡ä»¶æ±‚å€¼ï¼Œ &quot;doâ€¦while&quot;å¾ªç¯æ°¸è¿œéƒ½è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¬¬ä¸€æ¬¡é‡åˆ°æ™®é€š while å¾ªç¯æ—¶ï¼Œå¦‚æœæ¡ä»¶ä¸ºå‡ï¼Œå°†æ°¸è¿œä¸æ‰§è¡Œè¯¥å¾ªç¯ã€‚</p>
<h4 id="for-å¾ªç¯">for å¾ªç¯<a title="#for-å¾ªç¯" href="#for-å¾ªç¯"></a></h4>
<p>awk å…è®¸åˆ›å»º for å¾ªç¯ï¼Œå®ƒå°±è±¡ while å¾ªç¯ï¼Œä¹Ÿç­‰åŒäº C è¯­è¨€çš„ for å¾ªç¯ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`for` `( initial assignment; comparison; increment ) &#123;``    ``<span class="keyword">code</span> block``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€çŸ­ç¤ºä¾‹ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`for` `( x=<span class="number">1</span>;x&lt;=<span class="number">4</span>;x++ ) &#123;``    ``print ``<span class="string">"iteration"</span>``, x``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>æ­¤æ®µä»£ç å°†æ‰“å°ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`iteration1``iteration2``iteration3``iteration4`</span><br></pre></td></tr></table></figure>
<p></p>
<h4 id="break-å’Œ-continue">break å’Œ continue<a title="#break-å’Œ-continue" href="#break-å’Œ-continue"></a></h4>
<p>æ­¤å¤–ï¼Œå¦‚åŒ C è¯­è¨€ä¸€æ ·ï¼Œ awk æä¾›äº† break å’Œ continue è¯­å¥ã€‚ä½¿ç”¨è¿™äº›è¯­å¥å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ awk çš„å¾ªç¯ç»“æ„ã€‚ä»¥ä¸‹æ˜¯è¿«åˆ‡éœ€è¦ break è¯­å¥çš„ä»£ç ç‰‡æ–­ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`while` `æ­»å¾ªç¯``while` `(<span class="number">1</span>) &#123;``print ``<span class="string">"forever and ever..."</span>``&#125;``while` `æ­»å¾ªç¯ <span class="number">1</span> æ°¸è¿œä»£è¡¨æ˜¯çœŸï¼Œè¿™ä¸ª ``while` `å¾ªç¯å°†æ°¸è¿œè¿è¡Œä¸‹å»ã€‚`</span><br></pre></td></tr></table></figure>
<p></p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªåªæ‰§è¡Œåæ¬¡çš„å¾ªç¯ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`#break è¯­å¥ç¤ºä¾‹``x=<span class="number">1</span>``while``(<span class="number">1</span>) &#123;``ã€€ã€€print ``<span class="string">"iteration"</span>``, x``ã€€ã€€``<span class="keyword">if</span>` `( x==<span class="number">10</span> ) &#123;``ã€€ã€€ã€€ã€€``break``ã€€ã€€&#125;``ã€€ã€€x++``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>è¿™é‡Œï¼Œ break è¯­å¥ç”¨äºâ€œé€ƒå‡ºâ€æœ€æ·±å±‚çš„å¾ªç¯ã€‚ &quot;break&quot;ä½¿å¾ªç¯ç«‹å³ç»ˆæ­¢ï¼Œå¹¶ç»§ç»­æ‰§è¡Œå¾ªç¯ä»£ç å—åé¢çš„è¯­å¥ã€‚<br>
continue è¯­å¥è¡¥å……äº† breakï¼Œå…¶ä½œç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`x=<span class="number">1</span>while (<span class="number">1</span>) &#123;``        ``<span class="keyword">if</span>` `( x==<span class="number">4</span> ) &#123;``        ``x++``        ``continue``    ``&#125;``    ``print ``<span class="string">"iteration"</span>``, x``    ``<span class="keyword">if</span>` `( x&gt;<span class="number">20</span> ) &#123;``        ``break``    ``&#125;``    ``x++``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>è¿™æ®µä»£ç æ‰“å°&quot;iteration1&quot;åˆ°&quot;iteration21&quot;ï¼Œ &quot;iteration4&quot;é™¤å¤–ã€‚å¦‚æœè¿­ä»£ç­‰äº 4ï¼Œåˆ™å¢åŠ  xå¹¶è°ƒç”¨ continue è¯­å¥ï¼Œè¯¥è¯­å¥ç«‹å³ä½¿ awk å¼€å§‹æ‰§è¡Œä¸‹ä¸€ä¸ªå¾ªç¯è¿­ä»£ï¼Œè€Œä¸æ‰§è¡Œä»£ç å—çš„å…¶ä½™éƒ¨åˆ†ã€‚å¦‚åŒ break ä¸€æ ·ï¼Œ</p>
<p>continue è¯­å¥é€‚åˆå„ç§ awk è¿­ä»£å¾ªç¯ã€‚åœ¨ for å¾ªç¯ä¸»ä½“ä¸­ä½¿ç”¨æ—¶ï¼Œ continue å°†ä½¿å¾ªç¯æ§åˆ¶å˜é‡è‡ªåŠ¨å¢åŠ ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç­‰ä»·å¾ªç¯ï¼š</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`for` `( x=<span class="number">1</span>;x&lt;=<span class="number">21</span>;x++ ) &#123;``    ``<span class="keyword">if</span>` `( x==<span class="number">4</span> ) &#123;``        ``continue``    ``&#125;``    ``print ``<span class="string">"iteration"</span>``, x``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>åœ¨while å¾ªç¯ä¸­æ—¶ï¼Œåœ¨è°ƒç”¨ continue ä¹‹å‰æ²¡æœ‰å¿…è¦å¢åŠ  xï¼Œå› ä¸º for å¾ªç¯ä¼šè‡ªåŠ¨å¢åŠ  xã€‚</p>
<h4 id="æ•°ç»„">æ•°ç»„<a title="#æ•°ç»„" href="#æ•°ç»„"></a></h4>
<p>AWK ä¸­çš„æ•°ç»„éƒ½æ˜¯å…³è”æ•°ç»„,æ•°å­—ç´¢å¼•ä¹Ÿä¼šè½¬å˜ä¸ºå­—ç¬¦ä¸²ç´¢å¼•</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`&#123;``    ``cities[<span class="number">1</span>]=â€beijingâ€``    ``cities[<span class="number">2</span>]=â€shanghaiâ€``    ``cities[â€œthreeâ€]=â€guangzhouâ€``    ``for``( c ``<span class="keyword">in</span>` `cities) &#123;``        ``print cities[c]``    ``&#125;``    ``print cities[<span class="number">1</span>]``    ``print cities[â€œ<span class="number">1</span>â€]``    ``print cities[â€œthreeâ€]``&#125;`</span><br></pre></td></tr></table></figure>
<p></p>
<p>forâ€¦in è¾“å‡ºï¼Œå› ä¸ºæ•°ç»„æ˜¯å…³è”æ•°ç»„ï¼Œé»˜è®¤æ˜¯æ— åºçš„ã€‚æ‰€ä»¥é€šè¿‡ forâ€¦in å¾—åˆ°æ˜¯æ— åºçš„æ•°ç»„ã€‚å¦‚æœéœ€è¦å¾—åˆ°æœ‰åºæ•°ç»„ï¼Œéœ€è¦é€šè¿‡ä¸‹æ ‡è·å¾—ã€‚</p>
<h4 id="æ•°ç»„çš„å…¸å‹åº”ç”¨">æ•°ç»„çš„å…¸å‹åº”ç”¨<a title="#æ•°ç»„çš„å…¸å‹åº”ç”¨" href="#æ•°ç»„çš„å…¸å‹åº”ç”¨"></a></h4>
<p>ç”¨ awk ä¸­æŸ¥çœ‹æœåŠ¡å™¨è¿æ¥çŠ¶æ€å¹¶æ±‡æ€»</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`netstat -an|awk ``<span class="string">'/^tcp/&#123;++s[$NF]&#125;END&#123;for(a in s)print a,s[a]&#125;'</span>``ESTABLISHED <span class="number">1</span>``LISTEN <span class="number">20</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>ç»Ÿè®¡ web æ—¥å¿—è®¿é—®æµé‡ï¼Œè¦æ±‚è¾“å‡ºè®¿é—®æ¬¡æ•°ï¼Œè¯·æ±‚é¡µé¢æˆ–å›¾ç‰‡ï¼Œæ¯ä¸ªè¯·æ±‚çš„æ€»å¤§å°ï¼Œæ€»è®¿é—®æµé‡çš„å¤§å°æ±‡æ€»</p>
<figure class="highlight n1ql"><table><tr><td class="code"><pre><span class="line">`awk '&#123;a[$7]+=$10;++b[$7];total+=$10&#125;<span class="keyword">END</span>&#123;<span class="symbol">``</span><span class="keyword">for</span><span class="symbol">``</span>(x <span class="symbol">``</span><span class="keyword">in</span><span class="symbol">` `</span>a)print b[x],x,a[x]|<span class="symbol">``</span><span class="string">"sort -rn -k1"</span><span class="symbol">``</span>;print``"total size is :"``total&#125;' /app/log/access_log``total size ``is` `:172230``21 /icons/poweredby.png 83076``14 / 70546``8 /icons/apache_pb.gif 18608``a[$7]+=$10 è¡¨ç¤ºä»¥ç¬¬ <span class="number">7</span> åˆ—ä¸ºä¸‹æ ‡çš„æ•°ç»„ï¼ˆ $<span class="number">10</span> åˆ—ä¸º$<span class="number">7</span> åˆ—çš„å¤§å°ï¼‰ï¼ŒæŠŠä»–ä»¬å¤§å°ç´¯åŠ å¾—åˆ°<span class="symbol">``</span>$<span class="number">7</span> æ¯æ¬¡è®¿é—®çš„å¤§å°ï¼Œåé¢çš„ <span class="symbol">``</span><span class="keyword">for</span><span class="symbol">` `</span>å¾ªç¯æœ‰ä¸ªå–å·§çš„åœ°æ–¹ï¼Œ a å’Œ b æ•°ç»„çš„ä¸‹æ ‡ç›¸åŒï¼Œæ‰€ä»¥ä¸€<span class="symbol">``</span>æ¡ <span class="symbol">``</span><span class="keyword">for</span><span class="symbol">` `</span>è¯­å¥è¶³çŸ£<span class="symbol">`</span></span><br></pre></td></tr></table></figure>
<p></p>
<h3 id="å¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°">å¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°<a title="#å¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°" href="#å¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°"></a></h3>
<p><img src="https://images2015.cnblogs.com/blog/1089507/201701/1089507-20170126235509019-257728577.jpg" alt="img" class="Ï†cx"></p>
<p><img src="https://images2015.cnblogs.com/blog/1089507/201701/1089507-20170126235518706-915272948.jpg" alt="img" class="Ï†cx"></p>
<h4 id="å­—ç¬¦ä¸²å‡½æ•°çš„åº”ç”¨">å­—ç¬¦ä¸²å‡½æ•°çš„åº”ç”¨<a title="#å­—ç¬¦ä¸²å‡½æ•°çš„åº”ç”¨" href="#å­—ç¬¦ä¸²å‡½æ•°çš„åº”ç”¨"></a></h4>
<p>æ›¿æ¢</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`awk ``<span class="string">'BEGIN&#123;info="this is a test2010test!";gsub(/[0-9]+/,"!",info);print info&#125;'</span>` `this` `is` `a test!test!``åœ¨ info ä¸­æŸ¥æ‰¾æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ï¼Œ /[<span class="number">0</span><span class="number">-9</span>]+/ ç”¨â€!â€æ›¿æ¢ï¼Œå¹¶ä¸”æ›¿æ¢åçš„å€¼ï¼Œèµ‹å€¼ç»™ info æœª``ç»™ info å€¼ï¼Œé»˜è®¤æ˜¯$<span class="number">0</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>æŸ¥æ‰¾</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`awk ``<span class="string">'BEGIN&#123;info="this is a test2010test!";print index(info,"test")?"ok":"no found";&#125;'</span>``ok #æœªæ‰¾åˆ°ï¼Œè¿”å› <span class="number">0</span>`</span><br></pre></td></tr></table></figure>
<p></p>
<p>åŒ¹é…æŸ¥æ‰¾</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`awk ``<span class="string">'BEGIN&#123;info="this is a test2010test!";print match(info,/[0-9]+/)?"ok":"no found";&#125;'</span>``ok #å¦‚æœæŸ¥æ‰¾åˆ°æ•°å­—åˆ™åŒ¹é…æˆåŠŸè¿”å› okï¼Œå¦åˆ™å¤±è´¥ï¼Œè¿”å›æœªæ‰¾åˆ°`</span><br></pre></td></tr></table></figure>
<p></p>
<p>æˆªå–</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`awk ``<span class="string">'BEGIN&#123;info="this is a test2010test!";print substr(info,4,10);&#125;'</span>``s ``is` `a tes #ä»ç¬¬ <span class="number">4</span> ä¸ª å­—ç¬¦å¼€å§‹ï¼Œæˆªå– <span class="number">10</span> ä¸ªé•¿åº¦å­—ç¬¦ä¸²`</span><br></pre></td></tr></table></figure>
<p></p>
<p>åˆ†å‰²</p>
<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line">`awk ``<span class="string">'BEGIN&#123;info="this is a test";split(info,tA," ");print length(tA);for(k in tA)&#123;print k,tA[k];&#125;&#125;'</span>` `<span class="number">4</span>``<span class="number">4</span> test <span class="number">1</span> ``this` `<span class="number">2</span> ``is` `<span class="number">3</span> a``#åˆ†å‰² info,åŠ¨æ€åˆ›å»ºæ•°ç»„ tA,awk for â€¦<span class="keyword">in</span> å¾ªç¯ï¼Œæ˜¯ä¸€ä¸ªæ— åºçš„å¾ªç¯ã€‚ å¹¶ä¸æ˜¯ä»æ•°ç»„ä¸‹æ ‡``<span class="number">1</span>â€¦n å¼€å§‹`</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>awk</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>squidä»‹ç»åŠå…¶ç®€å•é…ç½®</title>
    <url>/posts/squid/</url>
    <content><![CDATA[<h1 id="squidçš„æ¦‚å¿µ">squidçš„æ¦‚å¿µ<a title="#squidçš„æ¦‚å¿µ" href="#squidçš„æ¦‚å¿µ"></a></h1>
<p>squidæ˜¯ä¸€ç§ç”¨æ¥ç¼“å­˜Internetæ•°æ®çš„è½¯ä»¶ã€‚æ¥å—æ¥è‡ªäººä»¬éœ€è¦ä¸‹è½½çš„ç›®æ ‡ï¼ˆobjectï¼‰çš„è¯·æ±‚å¹¶é€‚å½“çš„å¤„ç†è¿™äº›è¯·æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªäººæƒ³ä¸‹è½½ä¸€webç•Œé¢ï¼Œä»–è¯·æ±‚squidä¸ºä»–å–å¾—è¿™ä¸ªé¡µé¢ã€‚squidéšä¹‹è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨å¹¶å‘è¿™ä¸ªé¡µé¢å‘å‡ºè¯·æ±‚ã€‚ç„¶åï¼Œsquidæ˜¾å¼åœ°èšé›†æ•°æ®åˆ°å®¢æˆ·ç«¯æœºå™¨ï¼Œè€Œä¸”åŒæ—¶å¤åˆ¶ä¸€ä»½ã€‚å½“ä¸‹ä¸€æ¬¡æœ‰äººéœ€è¦åŒä¸€é¡µé¢æ—¶ï¼Œ squidå¯ä»¥ç®€å•çš„ä»ç£ç›˜ä¸­è¯»åˆ°å®ƒï¼Œé‚£æ ·æ•°æ®ä¼šç«‹å³ä¼ è¾“åˆ°å®¢æˆ·æœºä¸Šã€‚</p>
<a id="more"></a>
<h1 id="ä¸‹è½½åœ°å€">ä¸‹è½½åœ°å€<a title="#ä¸‹è½½åœ°å€" href="#ä¸‹è½½åœ°å€"></a></h1>
<p>squid-cache å®˜ç½‘ <a href="http://www.squid-cache.org" target="_blank" rel="noopener">http://www.squid-cache.org</a></p>
<p>squidä»‹ç»åŠå…¶ç®€å•é…ç½® <a href="https://www.cnblogs.com/cherishry/p/5706736.html" target="_blank" rel="noopener">https://www.cnblogs.com/cherishry/p/5706736.html</a></p>
<p>CentOS 7å®‰è£…squidä»£ç†æœåŠ¡å™¨ <a href="https://blog.csdn.net/ithomer/article/details/78136993" target="_blank" rel="noopener">https://blog.csdn.net/ithomer/article/details/78136993</a></p>
<h2 id="squidä»£ç†çš„ä½œç”¨">squidä»£ç†çš„ä½œç”¨<a title="#squidä»£ç†çš„ä½œç”¨" href="#squidä»£ç†çš„ä½œç”¨"></a></h2>
<ul>
<li>é€šè¿‡ç¼“å­˜çš„æ–¹å¼ä¸ºç”¨æˆ·æä¾›Webè®¿é—®åŠ é€Ÿ</li>
<li>å¯¹ç”¨æˆ·çš„Webè®¿é—®è¿›è¡Œè¿‡æ»¤æ§åˆ¶</li>
</ul>
<h2 id="å·¥ä½œæµç¨‹">å·¥ä½œæµç¨‹<a title="#å·¥ä½œæµç¨‹" href="#å·¥ä½œæµç¨‹"></a></h2>
<p>å½“ä»£ç†æœåŠ¡å™¨ä¸­æœ‰å®¢æˆ·ç«¯éœ€è¦çš„æ•°æ®æ—¶ï¼š</p>
<p>a.å®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ï¼›</p>
<p>b.ä»£ç†æœåŠ¡å™¨æ£€æŸ¥è‡ªå·±çš„æ•°æ®ç¼“å­˜ï¼›</p>
<p>c.ä»£ç†æœåŠ¡å™¨åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°äº†ç”¨æˆ·æƒ³è¦çš„æ•°æ®ï¼Œå–å‡ºæ•°æ®ï¼›</p>
<p>d.ä»£ç†æœåŠ¡å™¨å°†ä»ç¼“å­˜ä¸­å–å¾—çš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p>
<p>å½“ä»£ç†æœåŠ¡å™¨ä¸­æ²¡æœ‰å®¢æˆ·ç«¯éœ€è¦çš„æ•°æ®æ—¶äº†ï¼š</p>
<p>1.å®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ï¼›</p>
<p>2.ä»£ç†æœåŠ¡å™¨æ£€æŸ¥è‡ªå·±çš„æ•°æ®ç¼“å­˜ï¼›</p>
<p>3.ä»£ç†æœåŠ¡å™¨åœ¨ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°ç”¨æˆ·æƒ³è¦çš„æ•°æ®ï¼›</p>
<p>4.ä»£ç†æœåŠ¡å™¨å‘Internet ä¸Šçš„è¿œç«¯æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ï¼›</p>
<p>5.è¿œç«¯æœåŠ¡å™¨å“åº”ï¼Œè¿”å›ç›¸åº”çš„æ•°æ®ï¼›</p>
<p>6.ä»£ç†æœåŠ¡å™¨å–å¾—è¿œç«¯æœåŠ¡å™¨çš„æ•°æ®ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¹¶ä¿ç•™ä¸€ä»½åˆ°è‡ªå·±çš„æ•°æ®ç¼“å­˜ä¸­ã€‚</p>
<p><img src="https://images2015.cnblogs.com/blog/872781/201607/872781-20160726112850919-758636566.jpg" alt="" class="Ï†cx"></p>
<p>Squidä»£ç†æœåŠ¡å™¨å·¥ä½œåœ¨TCP/IPåº”ç”¨å±‚</p>
<p><img src="https://images2015.cnblogs.com/blog/872781/201607/872781-20160726112935653-887103660.jpg" alt="" class="Ï†cx"></p>
<h2 id="squidå„ç§ä»£ç†çš„å®šä¹‰">Squidå„ç§ä»£ç†çš„å®šä¹‰<a title="#squidå„ç§ä»£ç†çš„å®šä¹‰" href="#squidå„ç§ä»£ç†çš„å®šä¹‰"></a></h2>
<h3 id="æ­£å‘ä»£ç†">æ­£å‘ä»£ç†<a title="#æ­£å‘ä»£ç†" href="#æ­£å‘ä»£ç†"></a></h3>
<h4 id="æ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡å™¨">æ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡å™¨<a title="#æ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡å™¨" href="#æ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡å™¨"></a></h4>
<p>ä¸€ä¸ªæ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡è¢«ç”¨äºç¼“å­˜é™æ€çš„ç½‘é¡µåˆ°æœ¬åœ°ç½‘ç»œä¸Šçš„ä¸€å°ä¸»æœºä¸Šï¼ˆå³ä»£ç†æœåŠ¡å™¨ï¼‰ã€‚å½“è¢«ç¼“å­˜çš„é¡µé¢è¢«ç¬¬äºŒæ¬¡è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°†ç›´æ¥ä»æœ¬åœ°ä»£ç†æœåŠ¡å™¨é‚£é‡Œè·å–è¯·æ±‚æ•°æ®è€Œä¸å†å‘åŸwebç«™ç‚¹è¯·æ±‚æ•°æ®ã€‚è¿™æ ·å°±èŠ‚çœäº†å®è´µçš„ç½‘ç»œå¸¦å®½ï¼Œè€Œä¸”æé«˜äº†è®¿é—®é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œè¦æƒ³å®ç°è¿™ç§æ–¹å¼ï¼Œå¿…é¡»åœ¨æ¯ä¸€ä¸ªå†…éƒ¨ä¸»æœºçš„æµè§ˆå™¨ä¸Šæ˜ç¡®æŒ‡åä»£ç†æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·ã€‚å®¢æˆ·ç«¯ä¸Šç½‘æ—¶ï¼Œæ¯æ¬¡éƒ½æŠŠè¯·æ±‚å‘é€ç»™ä»£ç†æœåŠ¡å™¨å¤„ç†,ä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚ç¡®å®šæ˜¯å¦è¿æ¥åˆ°è¿œç¨‹webæœåŠ¡å™¨è·å–æ•°æ®ã€‚å¦‚æœåœ¨æœ¬åœ°ç¼“å†²åŒºæœ‰ç›®æ ‡æ–‡ä»¶ï¼Œåˆ™ç›´æ¥å°†æ–‡ä»¶ä¼ ç»™ç”¨æˆ·å³å¯ã€‚å¦‚æœæ²¡æœ‰çš„è¯åˆ™å…ˆå–å›æ–‡ä»¶ï¼Œå…ˆåœ¨æœ¬åœ°ä¿å­˜ä¸€ä»½ç¼“å†²ï¼Œç„¶åå°†æ–‡ä»¶å‘é€ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚</p>
<h4 id="é€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨">é€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨<a title="#é€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨" href="#é€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨"></a></h4>
<p>é€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨å’Œæ ‡å‡†ä»£ç†æœåŠ¡å™¨çš„åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚ä½†æ˜¯ï¼Œä»£ç†æ“ä½œå¯¹å®¢æˆ·ç«¯çš„æµè§ˆå™¨æ˜¯é€æ˜çš„ï¼ˆå³ä¸éœ€æŒ‡æ˜ä»£ç†æœåŠ¡å™¨çš„IPå’Œç«¯å£ï¼‰ã€‚é€æ˜ä»£ç†æœåŠ¡å™¨é˜»æ–­ç½‘ç»œé€šä¿¡ï¼Œå¹¶ä¸”è¿‡æ»¤å‡ºè®¿é—®å¤–éƒ¨çš„HTTPï¼ˆ80ç«¯å£ï¼‰æµé‡ã€‚å¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚åœ¨æœ¬åœ°æœ‰ç¼“å†²åˆ™å°†ç¼“å†²çš„æ•°æ®ç›´æ¥å‘ç»™ç”¨æˆ·ï¼Œå¦‚æœåœ¨æœ¬åœ°æ²¡æœ‰ç¼“å†²åˆ™å‘è¿œç¨‹webæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå…¶ä½™æ“ä½œå’Œæ ‡å‡†çš„ä»£ç†æœåŠ¡å™¨å®Œå…¨ç›¸åŒã€‚å¯¹äºlinuxæ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œé€æ˜ä»£ç†ä½¿ç”¨Iptablesæˆ–è€…Ipchainså®ç°ã€‚å› æ­¤ä¸éœ€è¦å¯¹æµè§ˆå™¨ä½œä»»ä½•è®¾ç½®ï¼Œæ‰€ä»¥ï¼Œé€æ˜ä»£ç†å¯¹äºISPï¼ˆInternetæœåŠ¡å™¨æä¾›å•†ï¼‰ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<h3 id="åå‘ä»£ç†">åå‘ä»£ç†<a title="#åå‘ä»£ç†" href="#åå‘ä»£ç†"></a></h3>
<h4 id="åå‘ä»£ç†ç¼“å†²å™¨">åå‘ä»£ç†ç¼“å†²å™¨<a title="#åå‘ä»£ç†ç¼“å†²å™¨" href="#åå‘ä»£ç†ç¼“å†²å™¨"></a></h4>
<p>åå‘ä»£ç†æ˜¯å’Œå‰ä¸¤ç§ä»£ç†å®Œå…¨ä¸åŒçš„ä¸€ç§ä»£ç†æœåŠ¡ã€‚ä½¿ç”¨å®ƒå¯ä»¥é™ä½åŸå§‹WEBæœåŠ¡å™¨çš„è´Ÿè½½ã€‚åå‘ä»£ç†æœåŠ¡å™¨æ‰¿æ‹…äº†å¯¹åŸå§‹WEBæœåŠ¡å™¨çš„é™æ€é¡µé¢çš„è¯·æ±‚ï¼Œé˜²æ­¢åŸå§‹æœåŠ¡å™¨è¿‡è½½ã€‚å®ƒä½äºWEBæœåŠ¡å™¨å’ŒInternetä¹‹é—´ï¼Œå¤„ç†æ‰€æœ‰å¯¹WEBæœåŠ¡å™¨çš„è¯·æ±‚ï¼Œç»„ç»‡äº†WEBæœåŠ¡å™¨å’ŒInternetçš„ç›´æ¥é€šä¿¡ã€‚å¦‚æœäº’è”ç½‘ç”¨æˆ·è¯·æ±‚çš„é¡µé¢åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šæœ‰ç¼“å†²çš„è¯ï¼Œä»£ç†æœåŠ¡å™¨ç›´æ¥å°†ç¼“å†²å†…å®¹å‘é€ç»™ç”¨æˆ·ã€‚å¦‚æœæ²¡æœ‰ç¼“å†²åˆ™å…ˆå‘WEBæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå–å›æ•°æ®ï¼Œæœ¬åœ°ç¼“å­˜åå†å‘ç»™ç”¨æˆ·ã€‚è¿™ç§æ–¹å¼é€šè¿‡é™ä½äº†WEBæœåŠ¡å™¨çš„è¯·æ±‚æ•°ä»è€Œé™ä½äº†WEBæœåŠ¡å™¨çš„è´Ÿè½½ã€‚</p>
<h3 id="æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«">æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«<a title="#æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«" href="#æ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«"></a></h3>
<h3 id="æ¦‚å¿µ">æ¦‚å¿µ<a title="#æ¦‚å¿µ" href="#æ¦‚å¿µ"></a></h3>
<p>æ­£å‘ä»£ç†ï¼šå¯¹äºåŸå§‹æœåŠ¡å™¨è€Œè¨€ï¼Œå°±æ˜¯å®¢æˆ·ç«¯çš„ä»£è¨€äºº<br>
åå‘ä»£ç†ï¼šå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œå°±åƒæ˜¯åŸå§‹æœåŠ¡å™¨</p>
<h3 id="ç”¨é€”">ç”¨é€”<a title="#ç”¨é€”" href="#ç”¨é€”"></a></h3>
<p>æ­£å‘ä»£ç†çš„å…¸å‹ç”¨é€”æ˜¯ä¸ºåœ¨é˜²ç«å¢™å†…çš„å±€åŸŸç½‘å®¢æˆ·ç«¯æä¾›è®¿é—®Internetçš„é€”å¾„ã€‚æ­£å‘ä»£ç†è¿˜å¯ä»¥ä½¿ç”¨ç¼“å†²ç‰¹æ€§å‡å°‘ç½‘ç»œä½¿ç”¨ç‡ã€‚<br>
åå‘ä»£ç†è¿˜å¯ä»¥ä¸ºåç«¯çš„å¤šå°æœåŠ¡å™¨æä¾›è´Ÿè½½å¹³è¡¡ï¼Œæˆ–ä¸ºåç«¯è¾ƒæ…¢çš„æœåŠ¡å™¨æä¾›ç¼“å†²æœåŠ¡ã€‚å¦å¤–ï¼Œåå‘ä»£ç†è¿˜å¯ä»¥å¯ç”¨é«˜çº§URLç­–ç•¥å’Œç®¡ç†æŠ€æœ¯ï¼Œä»è€Œä½¿å¤„äºä¸åŒwebæœåŠ¡å™¨ç³»ç»Ÿçš„webé¡µé¢åŒæ—¶å­˜åœ¨äºåŒä¸€ä¸ªURLç©ºé—´ä¸‹ã€‚</p>
<h3 id="å®‰å…¨æ€§">å®‰å…¨æ€§<a title="#å®‰å…¨æ€§" href="#å®‰å…¨æ€§"></a></h3>
<p>æ­£å‘ä»£ç†å…è®¸å®¢æˆ·ç«¯é€šè¿‡å®ƒè®¿é—®ä»»æ„ç½‘ç«™å¹¶ä¸”éšè—å®¢æˆ·ç«¯è‡ªèº«ï¼Œå› æ­¤ä½ å¿…é¡»é‡‡å–å®‰å…¨æªæ–½ä»¥ç¡®ä¿ä»…ä¸ºç»è¿‡æˆæƒçš„å®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚<br>
åå‘ä»£ç†å¯¹å¤–éƒ½æ˜¯é€æ˜çš„ï¼Œè®¿é—®è€…å¹¶ä¸çŸ¥é“è‡ªå·±è®¿é—®çš„æ˜¯ä¸€ä¸ªä»£ç†ã€‚</p>
<h2 id="squidä¸»è¦ç»„æˆéƒ¨åˆ†">Squidä¸»è¦ç»„æˆéƒ¨åˆ†<a title="#squidä¸»è¦ç»„æˆéƒ¨åˆ†" href="#squidä¸»è¦ç»„æˆéƒ¨åˆ†"></a></h2>
<p>æœåŠ¡åï¼š<code>squid</code><br>
ä¸»ç¨‹åºï¼š<code>/usr/sbin/squid</code><br>
é…ç½®ç›®å½•ï¼š<code>/etc/squid</code><br>
ä¸»é…ç½®æ–‡ä»¶ï¼š<code>/etc/squid/squid.conf</code><br>
ç›‘å¬tcpç«¯å£å·ï¼š<code>3128</code><br>
é»˜è®¤è®¿é—®æ—¥å¿—æ–‡ä»¶ï¼š<code>/var/log/squid/access.log</code></p>
<h2 id="squidå¸¸ç”¨é…ç½®é€‰é¡¹">squidå¸¸ç”¨é…ç½®é€‰é¡¹<a title="#squidå¸¸ç”¨é…ç½®é€‰é¡¹" href="#squidå¸¸ç”¨é…ç½®é€‰é¡¹"></a></h2>
<p><code>/etc/squid/squid.conf</code></p>
<figure class="highlight glsl"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">http_port <span class="number">3128</span>  (è¿˜å¯ä»¥åªç›‘å¬ä¸€ä¸ªIP http_port <span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">3128</span>)</span><br><span class="line">cache_mem <span class="number">64</span>MB  <span class="meta">#ç¼“å­˜å å†…å­˜å¤§å°</span></span><br><span class="line">maximum_object_size <span class="number">4096</span>KB  <span class="meta">#æœ€å¤§ç¼“å­˜å—</span></span><br><span class="line">reply_body_max_size  <span class="number">1024000</span> allow <span class="built_in">all</span>      <span class="meta">#é™å®šä¸‹è½½æ–‡ä»¶å¤§å°</span></span><br><span class="line">access_log /var/<span class="built_in">log</span>/squid/access.<span class="built_in">log</span>    <span class="meta">#è®¿é—®æ—¥å¿—å­˜æ”¾çš„åœ°æ–¹</span></span><br><span class="line">visible_hostname    proxy.test.xom  <span class="meta">#å¯è§çš„ä¸»æœºå</span></span><br><span class="line">cache_dir ufs /var/spool/squid  <span class="number">100</span> <span class="number">16</span> <span class="number">256</span> </span><br><span class="line"><span class="meta">#ufs:ç¼“å­˜æ•°æ®çš„å­˜å‚¨æ ¼å¼</span></span><br><span class="line"><span class="meta">#/var/spool/squid    ç¼“å­˜ç›®å½•</span></span><br><span class="line"><span class="meta">#100ï¼šç¼“å­˜ç›®å½•å ç£ç›˜ç©ºé—´å¤§å°ï¼ˆMï¼‰</span></span><br><span class="line"><span class="meta">#16ï¼šç¼“å­˜ç©ºé—´ä¸€çº§å­ç›®å½•ä¸ªæ•°</span></span><br><span class="line"><span class="meta">#256ï¼šç¼“å­˜ç©ºé—´äºŒçº§å­ç›®å½•ä¸ªæ•°</span></span><br><span class="line">cache_mgr webmaster@test.com    <span class="meta">#å®šä¹‰ç®¡ç†å‘˜é‚®ç®±</span></span><br><span class="line">http_access deny <span class="built_in">all</span>    <span class="meta">#è®¿é—®æ§åˆ¶</span></span><br></pre></td></tr></table></figure>
<h2 id="squidä¸­çš„è®¿é—®æ§åˆ¶">squidä¸­çš„è®¿é—®æ§åˆ¶<a title="#squidä¸­çš„è®¿é—®æ§åˆ¶" href="#squidä¸­çš„è®¿é—®æ§åˆ¶"></a></h2>
<p>ä½¿ç”¨è®¿é—®æ§åˆ¶ç‰¹æ€§ï¼Œå¯ä»¥æ§åˆ¶åœ¨è®¿é—®æ—¶æ ¹æ®ç‰¹å®šçš„æ—¶é—´é—´éš”è¿›è¡Œç¼“å­˜ã€è®¿é—®ç‰¹å®šç«™ç‚¹æˆ–ä¸€ç»„ç«™ç‚¹ç­‰ç­‰ã€‚squidè®¿é—®æ§åˆ¶æœ‰ä¸¤ä¸ªè¦ç´ ï¼šACLå…ƒç´ å’Œè®¿é—®åˆ—è¡¨ã€‚è®¿é—®åˆ—è¡¨å¯ä»¥å…è®¸æˆ–æ‹’ç»æŸäº›ç”¨æˆ·å¯¹æ­¤æœåŠ¡çš„è®¿é—®ã€‚</p>
<h3 id="aclå…ƒç´ ç±»å‹">ACLå…ƒç´ ç±»å‹<a title="#aclå…ƒç´ ç±»å‹" href="#aclå…ƒç´ ç±»å‹"></a></h3>
<ul>
<li>srcï¼šæºåœ°å€ï¼ˆå³å®¢æˆ·æœºIPåœ°å€ï¼‰</li>
<li>dstï¼šç›®æ ‡åœ°å€ï¼ˆå³æœåŠ¡å™¨IPåœ°å€ï¼‰</li>
<li>srcdomainï¼šæºåç§°ï¼ˆå³å®¢æˆ·æœºåç§°ï¼‰</li>
<li>dstdomainï¼šç›®æ ‡åç§°ï¼ˆå³æœåŠ¡å™¨åç§°ï¼‰</li>
<li>timeï¼šä¸€å¤©ä¸­çš„æ—¶åˆ»å’Œä¸€å‘¨å†…çš„ä¸€å¤©</li>
<li>url_regexï¼šURLè§„åˆ™è¡¨è¾¾å¼åŒ¹é…</li>
<li>urlpath_regexï¼šURL-pathè§„åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œç•¥å»åè®®å’Œä¸»æœºå</li>
<li>proxy_authï¼šé€šè¿‡å¤–éƒ¨ç¨‹åºè¿›è¡Œç”¨æˆ·éªŒè¯</li>
<li>maxconnï¼šå•ä¸€IPçš„æœ€å¤§è¿æ¥æ•°</li>
</ul>
<h3 id="aclæ ¼å¼">ACLæ ¼å¼<a title="#aclæ ¼å¼" href="#aclæ ¼å¼"></a></h3>
<pre><code>ä¸ºäº†ä½¿ç”¨æ§åˆ¶åŠŸèƒ½ï¼Œå¿…é¡»å…ˆè®¾ç½®ACLè§„åˆ™å¹¶åº”ç”¨ã€‚ACLå£°æ˜çš„æ ¼å¼å¦‚ä¸‹ï¼š
</code></pre>
<p>æ³¨ï¼š</p>
<ul>
<li>acl_element_name å¯ä»¥æ˜¯ä»»ä¸€ä¸ªåœ¨ACLä¸­å®šä¹‰çš„åç§°</li>
<li>ä»»ä½•ä¸¤ä¸ªACLå…ƒç´ ä¸èƒ½ç”¨ç›¸åŒçš„åå­—</li>
<li>æ¯ä¸ªACLç”±åˆ—è¡¨å€¼ç»„æˆã€‚å½“è¿›è¡ŒåŒ¹é…æ£€æµ‹çš„æ—¶å€™ï¼Œå¤šä¸ªå€¼ç”±é€»è¾‘æˆ–è¿ç®—è¿æ¥ï¼›æ¢è¨€ä¹‹ï¼Œå³ä»»ä¸€ACLå…ƒç´ çš„å€¼è¢«åŒ¹é…ï¼Œåˆ™è¿™ä¸ªACLå…ƒç´ å³è¢«åŒ¹é…ã€‚</li>
<li>å¹¶ä¸æ˜¯æ‰€æœ‰ACLå…ƒç´ éƒ½èƒ½ä½¿ç”¨è®¿é—®åˆ—è¡¨ä¸­çš„å…¨éƒ¨ç±»å‹</li>
<li>ä¸åŒçš„ACLå…ƒç´ å†™åœ¨ä¸åŒè¡Œä¸­ï¼Œsquidå°†æŠŠä»–ä»¬ç»„åˆåœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­</li>
</ul>
<h3 id="è®¿é—®æ¡ç›®">è®¿é—®æ¡ç›®<a title="#è®¿é—®æ¡ç›®" href="#è®¿é—®æ¡ç›®"></a></h3>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®¸å¤šä¸åŒçš„è®¿é—®æ¡ç›®ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„å‡ ä¸ªï¼š</p>
<ul>
<li>http_access:å…è®¸HTTPè®¿é—®</li>
<li>no_cache:å®šä¹‰å¯¹ç¼“å­˜è¯·æ±‚çš„å“åº”ã€‚<br>
è®¿é—®åˆ—è¡¨çš„è§„åˆ™ç”±ä¸€äº›ç±»ä¼¼â€™allowâ€™æˆ–â€˜denyâ€™çš„å…³é”®å­—æ„æˆï¼Œç”¨ä»¥å…è®¸æˆ–æ‹’ç»å‘ç‰¹å®šæˆ–ä¸€ç»„ACLå…ƒç´ æä¾›æœåŠ¡ã€‚</li>
</ul>
<ol>
<li>ä¸€ä¸ªè®¿é—®åˆ—è¡¨å¯ä»¥ç”±å¤šæ¡è§„åˆ™ç»„æˆ</li>
<li>å¦‚æœæ²¡æœ‰ä»»ä½•è§„åˆ™ä¸è®¿é—®è¯·æ±‚åŒ¹é…ï¼Œé»˜è®¤åŠ¨ä½œå°†ä¸åˆ—è¡¨ä¸­æœ€åä¸€æ¡è§„åˆ™å¯¹åº”ã€‚</li>
<li>ä¸€ä¸ªè®¿é—®æ¡ç›®ä¸­æ‰€æœ‰å…ƒç´ å°†ç”¨é€»è¾‘ä¸è¿ç®—è¿æ¥<br>
http_access Action å£°æ˜1 AND å£°æ˜2 AND å£°æ˜ OR.<br>
http_access Action å£°æ˜3<br>
å¤šä¸ªhttp_accessså£°æ˜é—´ç”¨æˆ–è¿ç®—è¿æ¥ï¼Œä½†æ¯ä¸ªè®¿é—®æ¡ç›®çš„å…ƒç´ é—´ç”¨ä¸è¿ç®—è¿æ¥ã€‚</li>
<li>åˆ—è¡¨ä¸­çš„è§„åˆ™æ€»æ˜¯éµå¾ªç”±ä¸Šè€Œä¸‹çš„é¡ºåº</li>
<li>è¿™äº›è§„åˆ™æŒ‰ç…§ä»–ä»¬çš„æ’åˆ—é¡ºåºè¿›è¡ŒåŒ¹é…æ£€æµ‹ï¼Œä¸€æ—¦æ£€æµ‹åˆ°åŒ¹é…çš„è§„åˆ™ï¼ŒåŒ¹é…å°±ç«‹å³ç»“æŸã€‚</li>
</ol>
<h2 id="squid.confé…ç½®æ–‡ä»¶è¯¦è§£">Squid.confé…ç½®æ–‡ä»¶è¯¦è§£<a title="#squid.confé…ç½®æ–‡ä»¶è¯¦è§£" href="#squid.confé…ç½®æ–‡ä»¶è¯¦è§£"></a></h2>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">#acl all src 0.0.0.0/0.0.0.0 and http_access allow allé€‰é¡¹å®šä¹‰äº†ä¸€ä¸ªè®¿é—®æ§åˆ¶åˆ—è¡¨ã€‚è¯¦ç»†æƒ…å†µå‚è§å’ŒSquidè½¯ä»¶</span></span><br><span class="line"><span class="comment">#æºå¸¦çš„æ–‡æ¡£ã€‚è¿™é‡Œçš„è®¿é—®æ§åˆ¶åˆ—è¡¨å…è®¸æ‰€æœ‰å¯¹ä»£ç†æœåŠ¡çš„è®¿é—®ï¼Œå› ä¸ºè¿™é‡Œè¯¥ä»£ç†æ˜¯åŠ é€ŸwebæœåŠ¡å™¨ã€‚</span></span><br><span class="line">acl all src 0.0.0.0/0.0.0.0                 <span class="comment">#å…è®¸æ‰€æœ‰IPè®¿é—®</span></span><br><span class="line">acl manager proto http                 <span class="comment">#manager urlåè®®ä¸ºhttp</span></span><br><span class="line">acl localhost src 127.0.0.1/255.255.255.255  <span class="comment">#å…åˆæœ¬æœºIP</span></span><br><span class="line">acl to_localhost dst 127.0.0.1                 <span class="comment">#å…åˆç›®çš„åœ°å€ä¸ºæœ¬æœºIP</span></span><br><span class="line">acl Safe_ports port 80                <span class="comment"># å…è®¸å®‰å…¨æ›´æ–°çš„ç«¯å£ä¸º80</span></span><br><span class="line">acl CONNECT method CONNECT        <span class="comment">#è¯·æ±‚æ–¹æ³•ä»¥CONNECT</span></span><br><span class="line">http_access allow all                <span class="comment">#å…è®¸æ‰€æœ‰äººä½¿ç”¨è¯¥ä»£ç†.å› ä¸ºè¿™é‡Œæ˜¯ä»£ç†åŠ é€ŸwebæœåŠ¡å™¨</span></span><br><span class="line">http_reply_access allow all                <span class="comment">#å…è®¸æ‰€æœ‰å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†</span></span><br><span class="line"></span><br><span class="line">acl OverConnLimit maxconn 16        <span class="comment">#é™åˆ¶æ¯ä¸ªIPæœ€å¤§å…è®¸16ä¸ªè¿æ¥ï¼Œé˜²æ­¢æ”»å‡»</span></span><br><span class="line">http_access deny OverConnLimit</span><br><span class="line"></span><br><span class="line">icp_access deny all                        <span class="comment">#ç¦æ­¢ä»é‚»å±…æœåŠ¡å™¨ç¼“å†²å†…å‘é€å’Œæ¥æ”¶ICPè¯·æ±‚.</span></span><br><span class="line">miss_access allow all                <span class="comment">#å…è®¸ç›´æ¥æ›´æ–°è¯·æ±‚</span></span><br><span class="line">ident_lookup_access deny all                                <span class="comment">#ç¦æ­¢lookupæ£€æŸ¥DNS</span></span><br><span class="line">http_port 8080 transparent                                <span class="comment">#æŒ‡å®šSquidç›‘å¬æµè§ˆå™¨å®¢æˆ·è¯·æ±‚çš„ç«¯å£å·ã€‚</span></span><br><span class="line"></span><br><span class="line">hierarchy_stoplist cgi-bin ?                <span class="comment">#ç”¨æ¥å¼ºåˆ¶æŸäº›ç‰¹å®šçš„å¯¹è±¡ä¸è¢«ç¼“å­˜ï¼Œä¸»è¦æ˜¯å¤„äºå®‰å…¨çš„ç›®çš„ã€‚</span></span><br><span class="line">acl QUERY urlpath_regex cgi-bin \?</span><br><span class="line"><span class="keyword">cache</span> deny <span class="keyword">QUERY</span></span><br><span class="line"></span><br><span class="line">cache_mem <span class="number">1</span> GB        <span class="comment">#è¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–é€‰é¡¹ï¼Œå¢åŠ è¯¥å†…å­˜å€¼æœ‰åˆ©äºç¼“å­˜ã€‚åº”è¯¥æ³¨æ„çš„æ˜¯ï¼š</span></span><br><span class="line">                     <span class="comment">#ä¸€èˆ¬æ¥è¯´å¦‚æœç³»ç»Ÿæœ‰å†…å­˜ï¼Œè®¾ç½®è¯¥å€¼ä¸º(n/)3Mã€‚ç°åœ¨æ˜¯3G æ‰€ä»¥è¿™é‡Œ1G</span></span><br><span class="line">fqdncache_size <span class="number">1024</span>        <span class="comment">#FQDN é«˜é€Ÿç¼“å­˜å¤§å°</span></span><br><span class="line">maximum_object_size_in_memory <span class="number">2</span> MB        <span class="comment">#å…è®¸æœ€å¤§çš„æ–‡ä»¶è½½å…¥å†…å­˜</span></span><br><span class="line"></span><br><span class="line">memory_replacement_policy <span class="keyword">heap</span> LFUDA  <span class="comment">#åŠ¨æ€ä½¿ç”¨æœ€å°çš„ï¼Œç§»å‡ºå†…å­˜cache</span></span><br><span class="line">cache_replacement_policy <span class="keyword">heap</span> LFUDA         <span class="comment">#åŠ¨æ€ä½¿ç”¨æœ€å°çš„ï¼Œç§»å‡ºç¡¬ç›˜cache</span></span><br><span class="line"></span><br><span class="line">cache_dir ufs /home/<span class="keyword">cache</span> <span class="number">5000</span> <span class="number">32</span> <span class="number">512</span>  <span class="comment">#é«˜é€Ÿç¼“å­˜ç›®å½• ufs ç±»å‹ ä½¿ç”¨çš„ç¼“å†²å€¼æœ€å¤§å…åˆ1000MBç©ºé—´ï¼Œ</span></span><br><span class="line"><span class="comment">#32ä¸ªä¸€çº§ç›®å½•ï¼Œ512ä¸ªäºŒçº§ç›®å½•</span></span><br><span class="line"></span><br><span class="line">max_open_disk_fds <span class="number">0</span>                                 <span class="comment">#å…è®¸æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°é‡,0 æ— é™åˆ¶</span></span><br><span class="line">minimum_object_size <span class="number">1</span> KB                         <span class="comment">#å…åˆæœ€å°æ–‡ä»¶è¯·æ±‚ä½“å¤§å°</span></span><br><span class="line">maximum_object_size <span class="number">20</span> MB                 <span class="comment">#å…åˆæœ€å¤§æ–‡ä»¶è¯·æ±‚ä½“å¤§å°</span></span><br><span class="line"></span><br><span class="line">cache_swap_low <span class="number">90</span>                            <span class="comment">#æœ€å°å…è®¸ä½¿ç”¨swap 90%</span></span><br><span class="line">cache_swap_high <span class="number">95</span>                            <span class="comment">#æœ€å¤šå…è®¸ä½¿ç”¨swap 95%</span></span><br><span class="line"></span><br><span class="line">ipcache_size <span class="number">2048</span>                                <span class="comment"># IP åœ°å€é«˜é€Ÿç¼“å­˜å¤§å° 2M</span></span><br><span class="line">ipcache_low <span class="number">90</span>                                <span class="comment">#æœ€å°å…è®¸ipcacheä½¿ç”¨swap 90%</span></span><br><span class="line">ipcache_high <span class="number">95</span>                                  <span class="comment">#æœ€å¤§å…è®¸ipcacheä½¿ç”¨swap 90%</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">access_log /<span class="keyword">var</span>/<span class="keyword">log</span>/squid/access.log squid        <span class="comment">#å®šä¹‰æ—¥å¿—å­˜æ”¾è®°å½•</span></span><br><span class="line">cache_log /<span class="keyword">var</span>/<span class="keyword">log</span>/squid/cache.log squid</span><br><span class="line">cache_store_log <span class="keyword">none</span>                        <span class="comment">#ç¦æ­¢storeæ—¥å¿—</span></span><br><span class="line"></span><br><span class="line">emulate_httpd_log <span class="keyword">on</span>        <span class="comment">#å°†ä½¿Squidä»¿ç…§WebæœåŠ¡å™¨çš„æ ¼å¼åˆ›å»ºè®¿é—®è®°å½•ã€‚å¦‚æœå¸Œæœ›ä½¿ç”¨</span></span><br><span class="line">                                <span class="comment">#Webè®¿é—®è®°å½•åˆ†æç¨‹åºï¼Œå°±éœ€è¦è®¾ç½®è¿™ä¸ªå‚æ•°ã€‚</span></span><br><span class="line"></span><br><span class="line">refresh_pattern . <span class="number">0</span> <span class="number">20</span>% <span class="number">4320</span> override-<span class="keyword">expire</span> override-lastmod reload-<span class="keyword">into</span>-ims <span class="keyword">ignore</span>-reload   <span class="comment">#æ›´æ–°cacheè§„åˆ™</span></span><br><span class="line"></span><br><span class="line">acl buggy_server url_regex ^<span class="keyword">http</span>://.... <span class="keyword">http</span>://          <span class="comment">#åªå…è®¸httpçš„è¯·æ±‚</span></span><br><span class="line">broken_posts <span class="keyword">allow</span> buggy_server</span><br><span class="line"></span><br><span class="line">acl apache rep_header <span class="keyword">Server</span> ^Apache                 <span class="comment">#å…è®¸apacheçš„ç¼–ç </span></span><br><span class="line">broken_vary_encoding <span class="keyword">allow</span> apache</span><br><span class="line"></span><br><span class="line">request_entities <span class="keyword">off</span>                                        <span class="comment">#ç¦æ­¢éhttpçš„æ ‡åˆ†å‡†è¯·æ±‚ï¼Œé˜²æ­¢æ”»å‡»</span></span><br><span class="line">header_access header <span class="keyword">allow</span> all                        <span class="comment">#å…è®¸æ‰€æœ‰çš„httpæŠ¥å¤´</span></span><br><span class="line">relaxed_header_parser <span class="keyword">on</span>                                <span class="comment">#ä¸ä¸¥æ ¼åˆ†æhttpæŠ¥å¤´.</span></span><br><span class="line">client_lifetime <span class="number">120</span> <span class="keyword">minute</span>                                <span class="comment">#æœ€å¤§å®¢æˆ·è¿æ¥æ—¶é—´ 120åˆ†é’Ÿ</span></span><br><span class="line"></span><br><span class="line">cache_mgr sky@test.com                        <span class="comment">#æŒ‡å®šå½“ç¼“å†²å‡ºç°é—®é¢˜æ—¶å‘ç¼“å†²ç®¡ç†è€…å‘é€å‘Šè­¦ä¿¡æ¯çš„åœ°å€ä¿¡æ¯ã€‚</span></span><br><span class="line"></span><br><span class="line">cache_effective_user squid                        <span class="comment">#è¿™é‡Œä»¥ç”¨æˆ·squidçš„èº«ä»½SquidæœåŠ¡å™¨</span></span><br><span class="line">cache_effective_group squid</span><br><span class="line"></span><br><span class="line">icp_port <span class="number">0</span>                       <span class="comment">#æŒ‡å®šSquidä»é‚»å±…æœåŠ¡å™¨ç¼“å†²å†…å‘é€å’Œæ¥æ”¶ICPè¯·æ±‚çš„ç«¯å£å·ã€‚</span></span><br><span class="line">                     <span class="comment">#è¿™é‡Œè®¾ç½®ä¸º0æ˜¯å› ä¸ºè¿™é‡Œé…ç½®Squidä¸ºå†…éƒ¨WebæœåŠ¡å™¨çš„åŠ é€Ÿå™¨ï¼Œ</span></span><br><span class="line">                     <span class="comment">#æ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨é‚»å±…æœåŠ¡å™¨çš„ç¼“å†²ã€‚0æ˜¯ç¦ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cache_peer è®¾ç½®å…è®¸æ›´æ–°ç¼“å­˜çš„ä¸»æœºï¼Œå› æ˜¯æœ¬æœºæ‰€ä»¥127.0.0.1</span></span><br><span class="line">cache_peer <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="keyword">parent</span> <span class="number">80</span> <span class="number">0</span> <span class="keyword">no</span>-<span class="keyword">query</span> <span class="keyword">default</span> multicast-responder <span class="keyword">no</span>-netdb-<span class="keyword">exchange</span></span><br><span class="line">cache_peer_domain <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>                                 </span><br><span class="line">hostname_aliases <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"></span><br><span class="line">error_directory /usr/<span class="keyword">share</span>/squid/<span class="keyword">errors</span>/Simplify_Chinese        <span class="comment">#å®šä¹‰é”™è¯¯è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">always_direct <span class="keyword">allow</span> all                <span class="comment"># cacheä¸¢å¤±æˆ–ä¸å­˜åœ¨æ˜¯å…è®¸æ‰€æœ‰è¯·æ±‚ç›´æ¥è½¬å‘åˆ°åŸå§‹æœåŠ¡å™¨</span></span><br><span class="line">ignore_unknown_nameservers <span class="keyword">on</span>        <span class="comment">#å¼€åDNSæŸ¥è¯¢ï¼Œå½“åŸŸååœ°å€ä¸ç›¸åŒæ—¶å€™ï¼Œç¦æ­¢è®¿é—®</span></span><br><span class="line">coredump_dir  /<span class="keyword">var</span>/<span class="keyword">log</span>/squid                 <span class="comment">#å®šä¹‰dumpçš„ç›®å½•</span></span><br><span class="line"></span><br><span class="line">max_filedesc <span class="number">2048</span>                <span class="comment">#æœ€å¤§æ‰“å¼€çš„æ–‡ä»¶æè¿°</span></span><br><span class="line"></span><br><span class="line">half_closed_clients <span class="keyword">off</span>        <span class="comment">#ä½¿Squidåœ¨å½“readä¸å†è¿”å›æ•°æ®æ—¶ç«‹å³å…³é—­å®¢æˆ·ç«¯çš„è¿æ¥ã€‚</span></span><br><span class="line">                                <span class="comment">#æœ‰æ—¶readä¸å†è¿”å›æ•°æ®æ˜¯ç”±äºæŸäº›å®¢æˆ·å…³é—­TCPçš„å‘é€æ•°æ®</span></span><br><span class="line">                                <span class="comment">#è€Œä»ç„¶ä¿æŒæ¥æ”¶æ•°æ®ã€‚è€ŒSquidåˆ†è¾¨ä¸å‡ºTCPåŠå…³é—­å’Œå®Œå…¨å…³é—­ã€‚</span></span><br><span class="line"></span><br><span class="line">buffered_logs <span class="keyword">on</span> <span class="comment">#è‹¥æ‰“å¼€é€‰é¡¹â€œbuffered_logsâ€å¯ä»¥ç¨ç¨æé«˜åŠ é€ŸæŸäº›å¯¹æ—¥å¿—æ–‡ä»¶çš„å†™å…¥ï¼Œè¯¥é€‰é¡¹ä¸»è¦æ˜¯å®ç°ä¼˜åŒ–ç‰¹æ€§ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é˜²æ­¢å¤©æ¶¯ç›—é“¾ï¼Œè½¬å«ç»™ç™¾åº¦</span></span><br><span class="line">acl tianya referer_regex -i tianya</span><br><span class="line">http_access deny tianya</span><br><span class="line">deny_info  tianya</span><br><span class="line"><span class="comment">#é˜»æ­¢baiduèœ˜è››</span></span><br><span class="line">acl baidu req_header <span class="keyword">User</span>-<span class="keyword">Agent</span> Baiduspider</span><br><span class="line">http_access deny baidu</span><br><span class="line"><span class="comment">#é™åˆ¶åŒä¸€IPå®¢æˆ·ç«¯çš„æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">acl OverConnLimit maxconn <span class="number">128</span></span><br><span class="line">http_access deny OverConnLimit</span><br><span class="line"></span><br><span class="line"><span class="comment">#é˜²æ­¢è¢«äººåˆ©ç”¨ä¸ºHTTPä»£ç†ï¼Œè®¾ç½®å…è®¸è®¿é—®çš„IPåœ°å€</span></span><br><span class="line">acl myip dst <span class="number">222.18</span><span class="number">.63</span><span class="number">.37</span></span><br><span class="line">http_access deny !myip</span><br><span class="line"></span><br><span class="line"><span class="comment">#å…è®¸æœ¬åœ°ç®¡ç†</span></span><br><span class="line">acl Manager proto cache_object</span><br><span class="line">acl Localhost src <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">222.18</span><span class="number">.63</span><span class="number">.37</span></span><br><span class="line">http_access <span class="keyword">allow</span> Manager Localhost</span><br><span class="line">cachemgr_passwd <span class="number">53034338</span> all</span><br><span class="line">http_access deny Manager</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»…ä»…å…è®¸80ç«¯å£çš„ä»£ç†</span></span><br><span class="line">acl all src <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>/<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">acl Safe_ports port <span class="number">80</span> <span class="comment"># http</span></span><br><span class="line">http_access deny !Safe_ports</span><br><span class="line">http_access <span class="keyword">allow</span> all</span><br><span class="line"></span><br><span class="line"><span class="comment">#Squidä¿¡æ¯è®¾ç½®</span></span><br><span class="line">visible_hostname happy.swjtu.edu.cn</span><br><span class="line">cache_mgr  ooopic2008@qq.com</span><br><span class="line"></span><br><span class="line"><span class="comment">#åŸºæœ¬è®¾ç½®</span></span><br><span class="line">cache_effective_user squid</span><br><span class="line">cache_effective_group squid</span><br><span class="line">tcp_recv_bufsize <span class="number">65535</span> <span class="keyword">bytes</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#2.6çš„åå‘ä»£ç†åŠ é€Ÿé…ç½®</span></span><br><span class="line">cache_peer <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="keyword">parent</span> <span class="number">80</span> <span class="number">0</span> <span class="keyword">no</span>-<span class="keyword">query</span> originserver</span><br><span class="line"></span><br><span class="line"><span class="comment">#é”™è¯¯æ–‡æ¡£</span></span><br><span class="line">error_directory /usr/<span class="keyword">local</span>/squid/<span class="keyword">share</span>/<span class="keyword">errors</span>/Simplify_Chinese</span><br><span class="line"></span><br><span class="line"><span class="comment">#å•å°ä½¿ç”¨ï¼Œä¸ä½¿ç”¨è¯¥åŠŸèƒ½</span></span><br><span class="line">icp_port <span class="number">0</span></span><br><span class="line"></span><br><span class="line">hierarchy_stoplist cgi-<span class="keyword">bin</span> ?</span><br><span class="line"></span><br><span class="line">acl <span class="keyword">QUERY</span> urlpath_regex cgi-<span class="keyword">bin</span> \? .php .cgi .avi .wmv .rm .ram .mpg .mpeg .zip .exe</span><br><span class="line"><span class="keyword">cache</span> deny <span class="keyword">QUERY</span></span><br><span class="line"></span><br><span class="line">acl apache rep_header <span class="keyword">Server</span> ^Apache</span><br><span class="line">broken_vary_encoding <span class="keyword">allow</span> apache</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">refresh_pattern ^<span class="keyword">ftp</span>:           <span class="number">1440</span> <span class="number">20</span>%     <span class="number">10080</span></span><br><span class="line">refresh_pattern ^gopher:        <span class="number">1440</span> <span class="number">0</span>%    <span class="number">1440</span></span><br><span class="line">refresh_pattern .             <span class="number">0</span>    <span class="number">20</span>%     <span class="number">4320</span></span><br><span class="line"></span><br><span class="line">cache_store_log <span class="keyword">none</span></span><br><span class="line">pid_filename /usr/<span class="keyword">local</span>/squid/<span class="keyword">var</span>/<span class="keyword">logs</span>/squid.pid</span><br><span class="line">emulate_httpd_log <span class="keyword">on</span></span><br></pre></td></tr></table></figure>
<h2 id="squidå¸¸ç”¨å‘½ä»¤">Squidå¸¸ç”¨å‘½ä»¤<a title="#squidå¸¸ç”¨å‘½ä»¤" href="#squidå¸¸ç”¨å‘½ä»¤"></a></h2>
<ol>
<li>åˆå§‹åŒ–åœ¨squid.confé‡Œé…ç½®çš„cacheç›®å½•<br>
squid -z<br>
å¦‚æœæœ‰é”™è¯¯æç¤ºï¼Œè¯·æ£€æŸ¥cacheç›®å½•çš„æƒé™ï¼Œå¯ä»¥æ›´æ”¹ç›®å½•æƒé™<br>
chown -R squid:squid /cacheç›®å½•</li>
<li>å¯¹squid.confæ’é”™ï¼Œå³éªŒè¯squid.confçš„è¯­æ³•å’Œé…ç½®<br>
squid -k parse<br>
å¦‚æœåœ¨squid.confä¸­æœ‰è¯­æ³•æˆ–é…ç½®é”™è¯¯ï¼Œè¿™é‡Œä¼šè¿”å›æç¤ºï¼Œè‹¥æ— è¿”å›ï¼Œå°è¯•å¯åŠ¨squid</li>
<li>å‰å°å¯åŠ¨squidï¼Œå¹¶è¾“å‡ºå¯åŠ¨è¿‡ç¨‹<br>
/usr/local/squid/sbin/squid -N -d1<br>
å¦‚æœæœ‰ready to server requesç›¸å…³ä¿¡æ¯ï¼Œè¯´æ˜squidå¯åŠ¨æˆåŠŸ<br>
ç„¶åctrl+c ,åœæ­¢squid,å¹¶ä»¥åå°è¿è¡Œçš„æ–¹å¼å¯åŠ¨å®ƒ</li>
<li>å¯åŠ¨squidåœ¨åå°è¿è¡Œ<br>
squid -s<br>
å¯ä»¥ä½¿ç”¨ps -ax | grep squid æ¥æŸ¥çœ‹squidè¿›ç¨‹æ˜¯å¦å­˜åœ¨</li>
<li>åœæ­¢squid<br>
squid -k shutdown</li>
<li>é‡æ–°å¼•å¯¼ä¿®æ”¹è¿‡çš„squid.conf<br>
squid -k reconfigure -f /XXX/squid.conf<br>
å½“squidè¿›è¡Œé…ç½®æ›´æ”¹åï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤è¿›è¡Œsquidé…ç½®é‡è½½</li>
<li>æŠŠsquidæ·»åŠ åˆ°ç³»ç»Ÿå¯åŠ¨é¡¹<br>
vim /etc/rc.local<br>
/usr/local/squid/sbin/squid -s</li>
<li>ä¿®æ”¹cacheç¼“å­˜ç›®å½•çš„æƒé™<br>
chown -R squid.squid /cacheç›®å½•<br>
cacheç¼“å­˜ç›®å½•æ ¹æ®è‡ªå·±çš„é…ç½®æ›´æ”¹ï¼Œsquidç”¨æˆ·å’Œç»„æ˜¯squidï¼Œsquid</li>
<li>ä¿®æ”¹squidæ—¥å¿—ç›®å½•çš„æƒé™<br>
chown -R squid.squid å®šä¹‰çš„æ—¥å¿—æ–‡ä»¶æ‰€åœ¨ç›®å½•<br>
è¿™ä¸€æ­¥å¹¶ä¸æ˜¯é€‚åˆæ¯ä¸€ä¸ªä½¿ç”¨squidçš„ç”¨æˆ·ï¼Œæ„ä¸ºè®©squidæœ‰æƒé™åœ¨è¯¥ç›®å½•é‡Œè¿›è¡Œå†™æ“ä½œ</li>
<li>æŸ¥çœ‹ä½ çš„æ—¥å¿—æ–‡æ¡£<br>
more /usr/local/squid/var/logs/access.log | grep TCP_MEM_HIT<br>
è¯¥æŒ‡ä»¤å¯ä»¥çœ‹åˆ°åœ¨squidè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰é‚£äº›æ–‡ä»¶è¢«squidç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œå¹¶è¿”å›ç»™è®¿é—®ç”¨æˆ·ã€‚<br>
more /usr/local/squid/var/logs/access.log | grep TCP_HIT<br>
è¯¥æŒ‡ä»¤å¯ä»¥çœ‹åˆ°åœ¨squidè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰é‚£äº›æ–‡ä»¶è¢«squidç¼“å­˜åˆ°cacheç›®å½•ä¸­ï¼Œå¹¶è¿”å›ç»™è®¿é—®ç”¨æˆ·ã€‚<br>
more /usr/local/squid/var/logs/access.log | grep TCP_MISS<br>
è¯¥æŒ‡ä»¤å¯ä»¥çœ‹åˆ°åœ¨squidè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰é‚£äº›æ–‡ä»¶æ²¡æœ‰è¢«squidç¼“å­˜ï¼Œè€Œæ˜¯ä»åŸå§‹æœåŠ¡å™¨è·å–å¹¶è¿”å›ç»™è®¿é—®ç”¨æˆ·ã€‚</li>
</ol>
<h2 id="squidå‘½ä¸­ç‡åˆ†æ">Squidå‘½ä¸­ç‡åˆ†æ<a title="#squidå‘½ä¸­ç‡åˆ†æ" href="#squidå‘½ä¸­ç‡åˆ†æ"></a></h2>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/squid/</span>bin/squidclient -p <span class="number">80</span> <span class="string">mgr:</span>info</span><br><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/squid/</span>bin/squidclient -p <span class="number">80</span> <span class="string">mgr:</span><span class="number">5</span>min</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„æ€§èƒ½æƒ…å†µ,å…¶ä¸­PORTæ˜¯ä½ çš„proxyçš„ç«¯å£ï¼Œ5minå¯ä»¥æ˜¯60min<br>
å–å¾—squidè¿è¡ŒçŠ¶æ€ä¿¡æ¯ï¼š</p>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="attribute">squidclient</span> -p <span class="number">80</span> mgr:<span class="literal">info</span></span><br></pre></td></tr></table></figure>
<p>å–å¾—squidå†…å­˜ä½¿ç”¨æƒ…å†µï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">squidclient -<span class="selector-tag">p</span> <span class="number">80</span> mgr:mem</span><br></pre></td></tr></table></figure>
<p>å–å¾—squidå·²ç»ç¼“å­˜çš„åˆ—è¡¨ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">squidclient</span> -p <span class="number">80</span> mgr:<span class="keyword">bjects. </span>use <span class="keyword">it </span>carefully,<span class="keyword">it </span>may crash</span><br></pre></td></tr></table></figure>
<p>å–å¾—squidçš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">squidclient -<span class="selector-tag">p</span> <span class="number">80</span> mgr:diskd</span><br></pre></td></tr></table></figure>
<p>å¼ºåˆ¶æ›´æ–°æŸä¸ªurlï¼š</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">squidclient -<span class="selector-tag">p</span> <span class="number">80</span> -m PURGE http:<span class="comment">//www.xxx.com/xxx.php</span></span><br></pre></td></tr></table></figure>
<p>æ›´å¤šçš„è¯·æŸ¥çœ‹ï¼šsquidclient-h æˆ–è€… squidclient -p 80 mgr:<br>
æŸ¥å‘½ä¸­ç‡ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="code"><pre><span class="line"><span class="symbol">squidclient</span> -h <span class="built_in">IP</span>(å…·ä½“ä¾¦å¬<span class="built_in">IP</span>) -p <span class="number">80</span>(å…·ä½“ä¾¦å¬ç«¯å£) mgr:<span class="meta">info</span></span><br></pre></td></tr></table></figure>
<h2 id="å®šæœŸæ¸…ç†swap.stateå†…æ— æ•ˆæ•°æ®">å®šæœŸæ¸…ç†swap.stateå†…æ— æ•ˆæ•°æ®<a title="#å®šæœŸæ¸…ç†swap.stateå†…æ— æ•ˆæ•°æ®" href="#å®šæœŸæ¸…ç†swap.stateå†…æ— æ•ˆæ•°æ®"></a></h2>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="meta-keyword">/path/</span>to<span class="meta-keyword">/squid/</span>sbin/squid -k rotate -f <span class="meta-keyword">/path/</span>to<span class="meta-keyword">/squid/</span>conf_file</span><br><span class="line">vi <span class="meta-keyword">/etc/</span>crontab</span><br><span class="line"><span class="number">0</span>        <span class="number">0</span>       *       *       *       root    <span class="meta-keyword">/usr/</span>local<span class="meta-keyword">/sbin/</span>squid -k rotate -f <span class="meta-keyword">/usr/</span>local<span class="meta-keyword">/etc/</span>squid/squid1.conf</span><br></pre></td></tr></table></figure>
<p>å½“squidåº”ç”¨è¿è¡Œäº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œcache_dirå¯¹åº”çš„swap.stateæ–‡ä»¶å°±ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œé‡Œé¢çš„æ— æ•ˆæ¥å£æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œè¿™å¯èƒ½å½±å“squidçš„å“åº”æ—¶é—´ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨squidæ¸…ç†swap.stateé‡Œé¢çš„æ— æ•ˆæ•°æ®ï¼Œå‡å°‘swap.stateçš„å¤§å°ã€‚</p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>squid</tag>
        <tag>proxy</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»4è¡Œä»£ç çœ‹å³å€¼å¼•ç”¨</title>
    <url>/posts/%E5%8F%B3%E5%80%BC%E5%BC%95%E7%94%A8/</url>
    <content><![CDATA[<h2 id="æ¦‚è¿°">æ¦‚è¿°<a title="#æ¦‚è¿°" href="#æ¦‚è¿°"></a></h2>
<p>å³å€¼å¼•ç”¨çš„æ¦‚å¿µæœ‰äº›è¯»è€…å¯èƒ½ä¼šæ„Ÿåˆ°é™Œç”Ÿï¼Œå…¶å®ä»–å’ŒC<ins>98/03ä¸­çš„å·¦å€¼å¼•ç”¨æœ‰äº›ç±»ä¼¼ï¼Œä¾‹å¦‚ï¼Œc</ins>98/03ä¸­çš„å·¦å€¼å¼•ç”¨æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">int</span>&amp; j = i;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„int&amp;æ˜¯å¯¹å·¦å€¼è¿›è¡Œç»‘å®šï¼ˆä½†æ˜¯int&amp;å´ä¸èƒ½ç»‘å®šå³å€¼ï¼‰ï¼Œç›¸åº”çš„ï¼Œå¯¹å³å€¼è¿›è¡Œç»‘å®šçš„å¼•ç”¨å°±æ˜¯å³å€¼å¼•ç”¨ï¼Œä»–çš„è¯­æ³•æ˜¯è¿™æ ·çš„A&amp;&amp;ï¼Œé€šè¿‡åŒå¼•å·æ¥è¡¨ç¤ºç»‘å®šç±»å‹ä¸ºAçš„å³å€¼ã€‚é€šè¿‡&amp;&amp;æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»‘å®šå³å€¼äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç»‘å®šä¸€ä¸ªå³å€¼ï¼š</p>
<a id="more"></a>ã€€ã€€
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span>&amp;&amp; i = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬ç»‘å®šäº†ä¸€ä¸ªå³å€¼0ï¼Œå…³äºå³å€¼çš„æ¦‚å¿µä¼šåœ¨åé¢ä»‹ç»ã€‚å³å€¼å¼•ç”¨æ˜¯C<ins>11ä¸­æ–°å¢åŠ çš„ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§ï¼Œä»–ä¸»æ˜¯è¦ç”¨æ¥è§£å†³C</ins>98/03ä¸­é‡åˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸´æ—¶å¯¹è±¡éå¿…è¦çš„æ˜‚è´µçš„æ‹·è´æ“ä½œï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯åœ¨æ¨¡æ¿å‡½æ•°ä¸­å¦‚ä½•æŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹è¿›è¡Œè½¬å‘ã€‚é€šè¿‡å¼•å…¥å³å€¼å¼•ç”¨ï¼Œå¾ˆå¥½çš„è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ”¹è¿›äº†ç¨‹åºæ€§èƒ½ï¼Œåé¢å°†ä¼šè¯¦ç»†ä»‹ç»å³å€¼å¼•ç”¨æ˜¯å¦‚ä½•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„ã€‚</p>
<p>å’Œå³å€¼å¼•ç”¨ç›¸å…³çš„æ¦‚å¿µæ¯”è¾ƒå¤šï¼Œæ¯”å¦‚ï¼šå³å€¼ã€çº¯å³å€¼ã€å°†äº¡å€¼ã€universal referencesã€å¼•ç”¨æŠ˜å ã€ç§»åŠ¨è¯­ä¹‰ã€moveè¯­ä¹‰å’Œå®Œç¾è½¬å‘ç­‰ç­‰ã€‚å¾ˆå¤šéƒ½æ˜¯æ–°æ¦‚å¿µï¼Œå¯¹äºåˆšå­¦ä¹ C++11å³å€¼å¼•ç”¨çš„åˆå­¦è€…æ¥è¯´ï¼Œå¯èƒ½ä¼šè§‰å¾—å³å€¼å¼•ç”¨è¿‡äºå¤æ‚ï¼Œæ¦‚å¿µä¹‹é—´çš„å…³ç³»éš¾ä»¥ç†æ¸…ã€‚</p>
<p>å³å€¼å¼•ç”¨å®é™…ä¸Šå¹¶æ²¡æœ‰é‚£ä¹ˆå¤æ‚ï¼Œå…¶å®æ˜¯å…³äº4è¡Œä»£ç çš„æ•…äº‹ï¼Œé€šè¿‡ç®€å•çš„4è¡Œä»£ç æˆ‘ä»¬å°±èƒ½æ¸…æ™°çš„ç†è§£å³å€¼å¼•ç”¨ç›¸å…³çš„æ¦‚å¿µäº†ã€‚æœ¬æ–‡å¸Œæœ›å¸¦é¢†è¯»è€…é€šè¿‡4è¡Œä»£ç æ¥ç†è§£å³å€¼å¼•ç”¨ç›¸å…³çš„æ¦‚å¿µï¼Œç†æ¸…ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æœ€ç»ˆèƒ½é€å½»åœ°æŒæ¡C++11çš„æ–°ç‰¹æ€§â€“å³å€¼å¼•ç”¨ã€‚</p>
<h2 id="å››è¡Œä»£ç çš„æ•…äº‹">å››è¡Œä»£ç çš„æ•…äº‹<a title="#å››è¡Œä»£ç çš„æ•…äº‹" href="#å››è¡Œä»£ç çš„æ•…äº‹"></a></h2>
<h3 id="ç¬¬1è¡Œä»£ç çš„æ•…äº‹">ç¬¬1è¡Œä»£ç çš„æ•…äº‹<a title="#ç¬¬1è¡Œä»£ç çš„æ•…äº‹" href="#ç¬¬1è¡Œä»£ç çš„æ•…äº‹"></a></h3>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">int i</span> = getVar();</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¿™è¡Œä»£ç å¾ˆç®€å•ï¼Œä»getVar()å‡½æ•°è·å–ä¸€ä¸ªæ•´å½¢å€¼ï¼Œç„¶è€Œï¼Œè¿™è¡Œä»£ç ä¼šäº§ç”Ÿå‡ ç§ç±»å‹çš„å€¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¼šäº§ç”Ÿä¸¤ç§ç±»å‹çš„å€¼ï¼Œä¸€ç§æ˜¯å·¦å€¼iï¼Œä¸€ç§æ˜¯å‡½æ•°getVar()è¿”å›çš„ä¸´æ—¶å€¼ï¼Œè¿™ä¸ªä¸´æ—¶å€¼åœ¨è¡¨è¾¾å¼ç»“æŸåå°±é”€æ¯äº†ï¼Œè€Œå·¦å€¼iåœ¨è¡¨è¾¾å¼ç»“æŸåä»ç„¶å­˜åœ¨ï¼Œè¿™ä¸ªä¸´æ—¶å€¼å°±æ˜¯å³å€¼ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªçº¯å³å€¼ï¼Œå³å€¼æ˜¯ä¸å…·åçš„ã€‚åŒºåˆ†å·¦å€¼å’Œå³å€¼çš„ä¸€ä¸ªç®€å•åŠæ³•æ˜¯ï¼šçœ‹èƒ½ä¸èƒ½å¯¹è¡¨è¾¾å¼å–åœ°å€ï¼Œå¦‚æœèƒ½ï¼Œåˆ™ä¸ºå·¦å€¼ï¼Œå¦åˆ™ä¸ºå³å€¼ã€‚</p>
<p>æ‰€æœ‰çš„å…·åå˜é‡æˆ–å¯¹è±¡éƒ½æ˜¯å·¦å€¼ï¼Œè€ŒåŒ¿åå˜é‡åˆ™æ˜¯å³å€¼ï¼Œæ¯”å¦‚ï¼Œç®€å•çš„èµ‹å€¼è¯­å¥ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> i = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>åœ¨è¿™æ¡è¯­å¥ä¸­ï¼Œi æ˜¯å·¦å€¼ï¼Œ0 æ˜¯å­—é¢é‡ï¼Œå°±æ˜¯å³å€¼ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œi å¯ä»¥è¢«å¼•ç”¨ï¼Œ0 å°±ä¸å¯ä»¥äº†ã€‚å…·ä½“æ¥è¯´ä¸Šé¢çš„è¡¨è¾¾å¼ä¸­ç­‰å·å³è¾¹çš„0æ˜¯çº¯å³å€¼ï¼ˆprvalueï¼‰ï¼Œåœ¨C<ins>11ä¸­æ‰€æœ‰çš„å€¼å¿…å±äºå·¦å€¼ã€å°†äº¡å€¼ã€çº¯å³å€¼ä¸‰è€…ä¹‹ä¸€ã€‚æ¯”å¦‚ï¼Œéå¼•ç”¨è¿”å›çš„ä¸´æ—¶å˜é‡ã€è¿ç®—è¡¨è¾¾å¼äº§ç”Ÿçš„ä¸´æ—¶å˜é‡ã€åŸå§‹å­—é¢é‡å’Œlambdaè¡¨è¾¾å¼ç­‰éƒ½æ˜¯çº¯å³å€¼ã€‚è€Œå°†äº¡å€¼æ˜¯C</ins>11æ–°å¢çš„ã€ä¸å³å€¼å¼•ç”¨ç›¸å…³çš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼Œå°†è¦è¢«ç§»åŠ¨çš„å¯¹è±¡ã€T&amp;&amp;å‡½æ•°è¿”å›å€¼ã€std::moveè¿”å›å€¼å’Œè½¬æ¢ä¸ºT&amp;&amp;çš„ç±»å‹çš„è½¬æ¢å‡½æ•°çš„è¿”å›å€¼ç­‰ã€‚å…³äºå°†äº¡å€¼æˆ‘ä»¬ä¼šåœ¨åé¢ä»‹ç»ï¼Œå…ˆçœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> j = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">auto</span> f = []&#123;<span class="keyword">return</span> <span class="number">5</span>;&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¸­5æ˜¯ä¸€ä¸ªåŸå§‹å­—é¢é‡ï¼Œ []{return 5;}æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œéƒ½æ˜¯å±äºçº¯å³å€¼ï¼Œä»–ä»¬çš„ç‰¹ç‚¹æ˜¯åœ¨è¡¨è¾¾å¼ç»“æŸä¹‹åå°±é”€æ¯äº†ã€‚</p>
<p>é€šè¿‡åœ°è¡Œä»£ç æˆ‘ä»¬å¯¹å³å€¼æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ï¼ŒçŸ¥é“äº†ä»€ä¹ˆæ˜¯å³å€¼ï¼Œæ¥ä¸‹æ¥å†æ¥çœ‹çœ‹ç¬¬äºŒè¡Œä»£ç ã€‚</p>
<h3 id="ç¬¬2è¡Œä»£ç çš„æ•…äº‹">ç¬¬2è¡Œä»£ç çš„æ•…äº‹<a title="#ç¬¬2è¡Œä»£ç çš„æ•…äº‹" href="#ç¬¬2è¡Œä»£ç çš„æ•…äº‹"></a></h3>
<figure class="highlight sas"><table><tr><td class="code"><pre><span class="line">T<span class="variable">&amp;&amp;</span> k = ge<span class="meta">tVar(</span>);</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒè¡Œä»£ç å’Œç¬¬ä¸€è¡Œä»£ç å¾ˆåƒï¼Œåªæ˜¯ç›¸æ¯”ç¬¬ä¸€è¡Œä»£ç å¤šäº†â€œ&amp;&amp;â€ï¼Œä»–å°±æ˜¯å³å€¼å¼•ç”¨ï¼Œæˆ‘ä»¬çŸ¥é“å·¦å€¼å¼•ç”¨æ˜¯å¯¹å·¦å€¼çš„å¼•ç”¨ï¼Œé‚£ä¹ˆï¼Œå¯¹åº”çš„ï¼Œå¯¹å³å€¼çš„å¼•ç”¨å°±æ˜¯å³å€¼å¼•ç”¨ï¼Œè€Œä¸”å³å€¼æ˜¯åŒ¿åå˜é‡ï¼Œæˆ‘ä»¬ä¹Ÿåªèƒ½é€šè¿‡å¼•ç”¨çš„æ–¹å¼æ¥è·å–å³å€¼ã€‚è™½ç„¶ç¬¬äºŒè¡Œä»£ç å’Œç¬¬ä¸€è¡Œä»£ç çœ‹èµ·æ¥å·®åˆ«ä¸å¤§ï¼Œä½†æ˜¯å®é™…ä¸Šè¯­ä¹‰çš„å·®åˆ«å¾ˆå¤§ï¼Œè¿™é‡Œï¼ŒgetVar()äº§ç”Ÿçš„ä¸´æ—¶å€¼ä¸ä¼šåƒç¬¬ä¸€è¡Œä»£ç é‚£æ ·ï¼Œåœ¨è¡¨è¾¾å¼ç»“æŸä¹‹åå°±é”€æ¯äº†ï¼Œè€Œæ˜¯ä¼šè¢«â€œç»­å‘½â€ï¼Œä»–çš„ç”Ÿå‘½å‘¨æœŸå°†ä¼šé€šè¿‡å³å€¼å¼•ç”¨å¾—ä»¥å»¶ç»­ï¼Œå’Œå˜é‡kçš„å£°æ˜å‘¨æœŸä¸€æ ·é•¿ã€‚</p>
<p>å³å€¼å¼•ç”¨çš„ç¬¬ä¸€ä¸ªç‰¹ç‚¹<br>
ã€€ã€€é€šè¿‡å³å€¼å¼•ç”¨çš„å£°æ˜ï¼Œå³å€¼åˆâ€œé‡è·æ–°ç”Ÿâ€ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¸å³å€¼å¼•ç”¨ç±»å‹å˜é‡çš„ç”Ÿå‘½å‘¨æœŸä¸€æ ·é•¿ï¼Œåªè¦è¯¥å˜é‡è¿˜æ´»ç€ï¼Œè¯¥å³å€¼ä¸´æ—¶é‡å°†ä¼šä¸€ç›´å­˜æ´»ä¸‹å»ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹å³å€¼çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚ä»£ç æ¸…å•1-1æ‰€ç¤ºã€‚</p>
<p>ä»£ç æ¸…å•1-1</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> g_constructCount=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> g_copyConstructCount=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> g_destructCount=<span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    A()&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"construct: "</span>&lt;&lt;++g_constructCount&lt;&lt;<span class="built_in">endl</span>;    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    A(<span class="keyword">const</span> A&amp; a)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"copy construct: "</span>&lt;&lt;++g_copyConstructCount &lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ~A()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"destruct: "</span>&lt;&lt;++g_destructCount&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">A <span class="title">GetA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> A();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    A a = GetA();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºäº†æ¸…æ¥šçš„è§‚å¯Ÿä¸´æ—¶å€¼ï¼Œåœ¨ç¼–è¯‘æ—¶è®¾ç½®ç¼–è¯‘é€‰é¡¹-fno-elide-constructorsç”¨æ¥å…³é—­è¿”å›å€¼ä¼˜åŒ–æ•ˆæœã€‚</p>
<p>è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">construc<span class="variable">t:</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">copy</span> construc<span class="variable">t:</span> <span class="number">1</span></span><br><span class="line">destruc<span class="variable">t:</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">copy</span> construc<span class="variable">t:</span> <span class="number">2</span></span><br><span class="line">destruc<span class="variable">t:</span> <span class="number">2</span></span><br><span class="line">destruc<span class="variable">t:</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ²¡æœ‰è¿”å›å€¼ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæ‹·è´æ„é€ å‡½æ•°è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯GetA()å‡½æ•°å†…éƒ¨åˆ›å»ºçš„å¯¹è±¡è¿”å›å‡ºæ¥æ„é€ ä¸€ä¸ªä¸´æ—¶å¯¹è±¡äº§ç”Ÿçš„ï¼Œå¦ä¸€æ¬¡æ˜¯åœ¨mainå‡½æ•°ä¸­æ„é€ aå¯¹è±¡äº§ç”Ÿçš„ã€‚ç¬¬äºŒæ¬¡çš„destructæ˜¯å› ä¸ºä¸´æ—¶å¯¹è±¡åœ¨æ„é€ aå¯¹è±¡ä¹‹åå°±é”€æ¯äº†ã€‚å¦‚æœå¼€å¯è¿”å›å€¼ä¼˜åŒ–çš„è¯ï¼Œè¾“å‡ºç»“æœå°†æ˜¯ï¼š</p>
<p>construct: 1</p>
<p>destruct: 1</p>
<p>å¯ä»¥çœ‹åˆ°è¿”å›å€¼ä¼˜åŒ–å°†ä¼šæŠŠä¸´æ—¶å¯¹è±¡ä¼˜åŒ–æ‰ï¼Œä½†è¿™ä¸æ˜¯c++æ ‡å‡†ï¼Œæ˜¯å„ç¼–è¯‘å™¨çš„ä¼˜åŒ–è§„åˆ™ã€‚æˆ‘ä»¬åœ¨å›åˆ°ä¹‹å‰æåˆ°çš„å¯ä»¥é€šè¿‡å³å€¼å¼•ç”¨æ¥å»¶é•¿ä¸´æ—¶å³å€¼çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬é€šè¿‡å³å€¼å¼•ç”¨æ¥ç»‘å®šå‡½æ•°è¿”å›å€¼çš„è¯ï¼Œç»“æœåˆä¼šæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿåœ¨ç¼–è¯‘æ—¶è®¾ç½®ç¼–è¯‘é€‰é¡¹-fno-elide-constructorsã€‚</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">    A&amp;&amp; a = GetA();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºç»“æœï¼š</span><br><span class="line">construct: <span class="number">1</span></span><br><span class="line">copy construct: <span class="number">1</span></span><br><span class="line">destruct: <span class="number">1</span></span><br><span class="line">destruct: <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡å³å€¼å¼•ç”¨ï¼Œæ¯”ä¹‹å‰å°‘äº†ä¸€æ¬¡æ‹·è´æ„é€ å’Œä¸€æ¬¡ææ„ï¼ŒåŸå› åœ¨äºå³å€¼å¼•ç”¨ç»‘å®šäº†å³å€¼ï¼Œè®©ä¸´æ—¶å³å€¼çš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿äº†ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹åšä¸€äº›æ€§èƒ½ä¼˜åŒ–ï¼Œå³é¿å…ä¸´æ—¶å¯¹è±¡çš„æ‹·è´æ„é€ å’Œææ„ï¼Œäº‹å®ä¸Šï¼Œåœ¨c++98/03ä¸­ï¼Œé€šè¿‡å¸¸é‡å·¦å€¼å¼•ç”¨ä¹Ÿç»å¸¸ç”¨æ¥åšæ€§èƒ½ä¼˜åŒ–ã€‚ä¸Šé¢çš„ä»£ç æ”¹æˆï¼š</p>
<p>const A&amp; a = GetA();</p>
<p>è¾“å‡ºçš„ç»“æœå’Œå³å€¼å¼•ç”¨ä¸€æ ·ï¼Œå› ä¸ºå¸¸é‡å·¦å€¼å¼•ç”¨æ˜¯ä¸€ä¸ªâ€œä¸‡èƒ½â€çš„å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥æ¥å—å·¦å€¼ã€å³å€¼ã€å¸¸é‡å·¦å€¼å’Œå¸¸é‡å³å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ™®é€šçš„å·¦å€¼å¼•ç”¨ä¸èƒ½æ¥å—å³å€¼ï¼Œæ¯”å¦‚è¿™æ ·çš„å†™æ³•æ˜¯ä¸å¯¹çš„ï¼š</p>
<p>A&amp; a = GetA();</p>
<p>ä¸Šé¢çš„ä»£ç ä¼šæŠ¥ä¸€ä¸ªç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºéå¸¸é‡å·¦å€¼å¼•ç”¨åªèƒ½æ¥å—å·¦å€¼ã€‚</p>
<p>å³å€¼å¼•ç”¨çš„ç¬¬äºŒä¸ªç‰¹ç‚¹<br>
ã€€ã€€å³å€¼å¼•ç”¨ç‹¬ç«‹äºå·¦å€¼å’Œå³å€¼ã€‚æ„æ€æ˜¯å³å€¼å¼•ç”¨ç±»å‹çš„å˜é‡å¯èƒ½æ˜¯å·¦å€¼ä¹Ÿå¯èƒ½æ˜¯å³å€¼ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">int</span>&amp;&amp; var1 = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>var1ç±»å‹ä¸ºå³å€¼å¼•ç”¨ï¼Œä½†var1æœ¬èº«æ˜¯å·¦å€¼ï¼Œå› ä¸ºå…·åå˜é‡éƒ½æ˜¯å·¦å€¼ã€‚</p>
<p>å…³äºå³å€¼å¼•ç”¨ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜æ˜¯ï¼šT&amp;&amp;æ˜¯ä»€ä¹ˆï¼Œä¸€å®šæ˜¯å³å€¼å—ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(T&amp;&amp; t)</span></span>&#123;&#125;</span><br><span class="line">f(<span class="number">10</span>); <span class="comment">//tæ˜¯å³å€¼</span></span><br><span class="line"><span class="keyword">int</span> x = <span class="number">10</span>;</span><br><span class="line">f(x); <span class="comment">//tæ˜¯å·¦å€¼</span></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒT&amp;&amp;è¡¨ç¤ºçš„å€¼ç±»å‹ä¸ç¡®å®šï¼Œå¯èƒ½æ˜¯å·¦å€¼åˆå¯èƒ½æ˜¯å³å€¼ï¼Œè¿™ä¸€ç‚¹çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œè¿™å°±æ˜¯å³å€¼å¼•ç”¨çš„ä¸€ä¸ªç‰¹ç‚¹ã€‚</p>
<p>å³å€¼å¼•ç”¨çš„ç¬¬ä¸‰ä¸ªç‰¹ç‚¹<br>
ã€€ã€€T&amp;&amp; tåœ¨å‘ç”Ÿè‡ªåŠ¨ç±»å‹æ¨æ–­çš„æ—¶å€™ï¼Œå®ƒæ˜¯æœªå®šçš„å¼•ç”¨ç±»å‹ï¼ˆuniversal referencesï¼‰ï¼Œå¦‚æœè¢«ä¸€ä¸ªå·¦å€¼åˆå§‹åŒ–ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå·¦å€¼ï¼›å¦‚æœå®ƒè¢«ä¸€ä¸ªå³å€¼åˆå§‹åŒ–ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå³å€¼ï¼Œå®ƒæ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼å–å†³äºå®ƒçš„åˆå§‹åŒ–ã€‚</p>
<p>æˆ‘ä»¬å†å›è¿‡å¤´çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå¯¹äºå‡½æ•°template<typename T>void f(T&amp;&amp; t)ï¼Œå½“å‚æ•°ä¸ºå³å€¼10çš„æ—¶å€™ï¼Œæ ¹æ®universal referencesçš„ç‰¹ç‚¹ï¼Œtè¢«ä¸€ä¸ªå³å€¼åˆå§‹åŒ–ï¼Œé‚£ä¹ˆtå°±æ˜¯å³å€¼ï¼›å½“å‚æ•°ä¸ºå·¦å€¼xæ—¶ï¼Œtè¢«ä¸€ä¸ªå·¦å€¼å¼•ç”¨åˆå§‹åŒ–ï¼Œé‚£ä¹ˆtå°±æ˜¯ä¸€ä¸ªå·¦å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»…ä»…æ˜¯å½“å‘ç”Ÿè‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼ˆå¦‚å‡½æ•°æ¨¡æ¿çš„ç±»å‹è‡ªåŠ¨æ¨å¯¼ï¼Œæˆ–autoå…³é”®å­—ï¼‰çš„æ—¶å€™ï¼ŒT&amp;&amp;æ‰æ˜¯universal referencesã€‚å†çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(T&amp;&amp; param)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> &#123;</span></span><br><span class="line">    Test(Test&amp;&amp; rhs); </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œparamæ˜¯universal referenceï¼Œrhsæ˜¯Test&amp;&amp;å³å€¼å¼•ç”¨ï¼Œå› ä¸ºæ¨¡ç‰ˆå‡½æ•°få‘ç”Ÿäº†ç±»å‹æ¨æ–­ï¼Œè€ŒTest&amp;&amp;å¹¶æ²¡æœ‰å‘ç”Ÿç±»å‹æ¨å¯¼ï¼Œå› ä¸ºTest&amp;&amp;æ˜¯ç¡®å®šçš„ç±»å‹äº†ã€‚</p>
<p>æ­£æ˜¯å› ä¸ºå³å€¼å¼•ç”¨å¯èƒ½æ˜¯å·¦å€¼ä¹Ÿå¯èƒ½æ˜¯å³å€¼ï¼Œä¾èµ–äºåˆå§‹åŒ–ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸‹å­å°±ç¡®å®šçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹åšå¾ˆå¤šæ–‡ç« ï¼Œæ¯”å¦‚åé¢è¦ä»‹ç»çš„ç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ã€‚</p>
<p>è¿™é‡Œå†æä¸€ä¸‹å¼•ç”¨æŠ˜å ï¼Œæ­£æ˜¯å› ä¸ºå¼•å…¥äº†å³å€¼å¼•ç”¨ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨å·¦å€¼å¼•ç”¨ä¸å³å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨ä¸å³å€¼å¼•ç”¨çš„æŠ˜å ï¼ŒC++11ç¡®å®šäº†å¼•ç”¨æŠ˜å çš„è§„åˆ™ï¼Œè§„åˆ™æ˜¯è¿™æ ·çš„ï¼š</p>
<ul>
<li>æ‰€æœ‰çš„å³å€¼å¼•ç”¨å åŠ åˆ°å³å€¼å¼•ç”¨ä¸Šä»ç„¶è¿˜æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼›</li>
<li>æ‰€æœ‰çš„å…¶ä»–å¼•ç”¨ç±»å‹ä¹‹é—´çš„å åŠ éƒ½å°†å˜æˆå·¦å€¼å¼•ç”¨ã€‚</li>
</ul>
<h3 id="ç¬¬3è¡Œä»£ç çš„æ•…äº‹">ç¬¬3è¡Œä»£ç çš„æ•…äº‹<a title="#ç¬¬3è¡Œä»£ç çš„æ•…äº‹" href="#ç¬¬3è¡Œä»£ç çš„æ•…äº‹"></a></h3>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="constructor">T(T<span class="operator">&amp;&amp;</span> <span class="params">a</span>)</span> : m<span class="constructor">_val(<span class="params">val</span>)</span>&#123; a.m_val=nullptr; &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™è¡Œä»£ç å®é™…ä¸Šæ¥è‡ªäºä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°çš„ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼Œä¸ºä»€ä¹ˆå°†å³å€¼å¼•ç”¨ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°å‘¢ï¼Ÿåœ¨è§£ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ã€‚å¦‚ä»£ç æ¸…å•1-2æ‰€ç¤ºã€‚</p>
<p>ä»£ç æ¸…å•1-2</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    A():m_ptr(<span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">0</span>))&#123;<span class="built_in">cout</span> &lt;&lt; <span class="string">"construct"</span> &lt;&lt; <span class="built_in">endl</span>;&#125;</span><br><span class="line">    A(<span class="keyword">const</span> A&amp; a):m_ptr(<span class="keyword">new</span> <span class="keyword">int</span>(*a.m_ptr)) <span class="comment">//æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"copy construct"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ~A()&#123; <span class="keyword">delete</span> m_ptr;&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span>* m_ptr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    A a = GetA();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">    è¾“å‡ºï¼š</span><br><span class="line">construct</span><br><span class="line">copy construct</span><br><span class="line">copy construct</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼Œä¸€ä¸ªå¸¦æœ‰å †å†…å­˜çš„ç±»ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªæ·±æ‹·è´æ‹·è´æ„é€ å‡½æ•°ï¼Œå› ä¸ºé»˜è®¤çš„æ‹·è´æ„é€ å‡½æ•°æ˜¯æµ…æ‹·è´ï¼Œä¼šå‘ç”Ÿâ€œæŒ‡é’ˆæ‚¬æŒ‚â€çš„é—®é¢˜ã€‚å¦‚æœä¸æä¾›æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œä¸Šé¢çš„æµ‹è¯•ä»£ç å°†ä¼šå‘ç”Ÿé”™è¯¯ï¼ˆç¼–è¯‘é€‰é¡¹-fno-elide-constructorsï¼‰ï¼Œå†…éƒ¨çš„m_ptrå°†ä¼šè¢«åˆ é™¤ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯ä¸´æ—¶å³å€¼ææ„çš„æ—¶å€™åˆ é™¤ä¸€æ¬¡ï¼Œç¬¬äºŒæ¬¡å¤–é¢æ„é€ çš„aå¯¹è±¡é‡Šæ”¾æ—¶åˆ é™¤ä¸€æ¬¡ï¼Œè€Œè¿™ä¸¤ä¸ªå¯¹è±¡çš„m_ptræ˜¯åŒä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æŒ‡é’ˆæ‚¬æŒ‚é—®é¢˜ã€‚æä¾›æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°è™½ç„¶å¯ä»¥ä¿è¯æ­£ç¡®ï¼Œä½†æ˜¯åœ¨æœ‰äº›æ—¶å€™ä¼šé€ æˆé¢å¤–çš„æ€§èƒ½æŸè€—ï¼Œå› ä¸ºæœ‰æ—¶å€™è¿™ç§æ·±æ‹·è´æ˜¯ä¸å¿…è¦çš„ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š</p>
<p>ä¸Šé¢ä»£ç ä¸­çš„GetAå‡½æ•°ä¼šè¿”å›ä¸´æ—¶å˜é‡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªä¸´æ—¶å˜é‡æ‹·è´æ„é€ äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡aï¼Œä¸´æ—¶å˜é‡åœ¨æ‹·è´æ„é€ å®Œæˆä¹‹åå°±é”€æ¯äº†ï¼Œå¦‚æœå †å†…å­˜å¾ˆå¤§çš„è¯ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªæ‹·è´æ„é€ çš„ä»£ä»·ä¼šå¾ˆå¤§ï¼Œå¸¦æ¥äº†é¢å¤–çš„æ€§èƒ½æŸå¤±ã€‚æ¯æ¬¡éƒ½ä¼šäº§ç”Ÿä¸´æ—¶å˜é‡å¹¶é€ æˆé¢å¤–çš„æ€§èƒ½æŸå¤±ï¼Œæœ‰æ²¡æœ‰åŠæ³•é¿å…ä¸´æ—¶å˜é‡é€ æˆçš„æ€§èƒ½æŸå¤±å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼ŒC++11å·²ç»æœ‰äº†è§£å†³æ–¹æ³•ï¼Œçœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚å¦‚ä»£ç æ¸…å•1-3æ‰€ç¤ºã€‚</p>
<p>ä»£ç æ¸…å•1-3</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> A</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">    <span class="constructor">A()</span> :m<span class="constructor">_ptr(<span class="params">new</span> <span class="params">int</span>(0)</span>)&#123;&#125;</span><br><span class="line">    <span class="constructor">A(<span class="params">const</span> A&amp; <span class="params">a</span>)</span>:m<span class="constructor">_ptr(<span class="params">new</span> <span class="params">int</span>(<span class="operator">*</span><span class="params">a</span>.<span class="params">m_ptr</span>)</span>) <span class="comment">//æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°</span></span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">"copy construct"</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="constructor">A(A<span class="operator">&amp;&amp;</span> <span class="params">a</span>)</span> :m<span class="constructor">_ptr(<span class="params">a</span>.<span class="params">m_ptr</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        a.m_ptr = nullptr;</span><br><span class="line">        cout &lt;&lt; <span class="string">"move construct"</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    ~<span class="constructor">A()</span>&#123; delete m_ptr;&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">int</span>* m_ptr;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">int</span> main<span class="literal">()</span>&#123;</span><br><span class="line">    A a = <span class="constructor">Get(<span class="params">false</span>)</span>; </span><br><span class="line">&#125; </span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">construct</span><br><span class="line">move construct</span><br><span class="line">move construct</span><br></pre></td></tr></table></figure>
<p>ä»£ç æ¸…å•1-3å’Œ1-2ç›¸æ¯”åªå¤šäº†ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¾“å‡ºç»“æœè¡¨æ˜ï¼Œå¹¶æ²¡æœ‰è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œåªè°ƒç”¨äº†move constructå‡½æ•°ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªmove constructå‡½æ•°ï¼š</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="constructor">A(A<span class="operator">&amp;&amp;</span> <span class="params">a</span>)</span> :m<span class="constructor">_ptr(<span class="params">a</span>.<span class="params">m_ptr</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    a.m_ptr = nullptr;</span><br><span class="line">    cout &lt;&lt; <span class="string">"move construct"</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ„é€ å‡½æ•°å¹¶æ²¡æœ‰åšæ·±æ‹·è´ï¼Œä»…ä»…æ˜¯å°†æŒ‡é’ˆçš„æ‰€æœ‰è€…è½¬ç§»åˆ°äº†å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶ï¼Œå°†å‚æ•°å¯¹è±¡açš„æŒ‡é’ˆç½®ä¸ºç©ºï¼Œè¿™é‡Œä»…ä»…æ˜¯åšäº†æµ…æ‹·è´ï¼Œå› æ­¤ï¼Œè¿™ä¸ªæ„é€ å‡½æ•°é¿å…äº†ä¸´æ—¶å˜é‡çš„æ·±æ‹·è´é—®é¢˜ã€‚</p>
<p>ä¸Šé¢è¿™ä¸ªå‡½æ•°å…¶å®å°±æ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä»–çš„å‚æ•°æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ç±»å‹ï¼Œè¿™é‡Œçš„A&amp;&amp;è¡¨ç¤ºå³å€¼ï¼Œä¸ºä»€ä¹ˆï¼Ÿå‰é¢å·²ç»æåˆ°ï¼Œè¿™é‡Œæ²¡æœ‰å‘ç”Ÿç±»å‹æ¨æ–­ï¼Œæ˜¯ç¡®å®šçš„å³å€¼å¼•ç”¨ç±»å‹ã€‚ä¸ºä»€ä¹ˆä¼šåŒ¹é…åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ï¼Ÿå› ä¸ºè¿™ä¸ªæ„é€ å‡½æ•°åªèƒ½æ¥å—å³å€¼å‚æ•°ï¼Œè€Œå‡½æ•°è¿”å›å€¼æ˜¯å³å€¼ï¼Œæ‰€ä»¥å°±ä¼šåŒ¹é…åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ã€‚è¿™é‡Œçš„A&amp;&amp;å¯ä»¥çœ‹ä½œæ˜¯ä¸´æ—¶å€¼çš„æ ‡è¯†ï¼Œå¯¹äºä¸´æ—¶å€¼æˆ‘ä»¬ä»…ä»…éœ€è¦åšæµ…æ‹·è´å³å¯ï¼Œæ— éœ€å†åšæ·±æ‹·è´ï¼Œä»è€Œè§£å†³äº†å‰é¢æåˆ°çš„ä¸´æ—¶å˜é‡æ‹·è´æ„é€ äº§ç”Ÿçš„æ€§èƒ½æŸå¤±çš„é—®é¢˜ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç§»åŠ¨è¯­ä¹‰ï¼Œå³å€¼å¼•ç”¨çš„ä¸€ä¸ªé‡è¦ä½œç”¨æ˜¯ç”¨æ¥æ”¯æŒç§»åŠ¨è¯­ä¹‰çš„ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼Œæˆ‘ä»¬æä¾›ç§»åŠ¨æ„é€ å‡½æ•°çš„åŒæ—¶ä¹Ÿä¼šæä¾›ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œä»¥é˜²æ­¢ç§»åŠ¨ä¸æˆåŠŸçš„æ—¶å€™è¿˜èƒ½æ‹·è´æ„é€ ï¼Œä½¿æˆ‘ä»¬çš„ä»£ç æ›´å®‰å…¨ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ç§»åŠ¨è¯­ä¹‰æ˜¯é€šè¿‡å³å€¼å¼•ç”¨æ¥åŒ¹é…ä¸´æ—¶å€¼çš„ï¼Œé‚£ä¹ˆï¼Œæ™®é€šçš„å·¦å€¼æ˜¯å¦ä¹Ÿèƒ½å€ŸåŠ©ç§»åŠ¨è¯­ä¹‰æ¥ä¼˜åŒ–æ€§èƒ½å‘¢ï¼Œé‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿäº‹å®ä¸ŠC++11ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæä¾›äº†std::moveæ–¹æ³•æ¥å°†å·¦å€¼è½¬æ¢ä¸ºå³å€¼ï¼Œä»è€Œæ–¹ä¾¿åº”ç”¨ç§»åŠ¨è¯­ä¹‰ã€‚moveæ˜¯å°†å¯¹è±¡èµ„æºçš„æ‰€æœ‰æƒä»ä¸€ä¸ªå¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œåªæ˜¯è½¬ç§»ï¼Œæ²¡æœ‰å†…å­˜çš„æ‹·è´ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„moveè¯­ä¹‰ã€‚å¦‚å›¾1-1æ‰€ç¤ºæ˜¯æ·±æ‹·è´å’Œmoveçš„åŒºåˆ«ã€‚</p>
<p>å›¾1-1 æ·±æ‹·è´å’Œmoveçš„åŒºåˆ«</p>
<p>å†çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">list</span>&lt; <span class="built_in">std</span>::<span class="built_in">string</span>&gt; tokens;</span><br><span class="line">    <span class="comment">//çœç•¥åˆå§‹åŒ–...</span></span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">list</span>&lt; <span class="built_in">std</span>::<span class="built_in">string</span>&gt; t = tokens; <span class="comment">//è¿™é‡Œå­˜åœ¨æ‹·è´ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">list</span>&lt; <span class="built_in">std</span>::<span class="built_in">string</span>&gt; tokens;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">list</span>&lt; <span class="built_in">std</span>::<span class="built_in">string</span>&gt; t = <span class="built_in">std</span>::move(tokens);  <span class="comment">//è¿™é‡Œæ²¡æœ‰æ‹·è´</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä¸ç”¨std::moveï¼Œæ‹·è´çš„ä»£ä»·å¾ˆå¤§ï¼Œæ€§èƒ½è¾ƒä½ã€‚ä½¿ç”¨moveå‡ ä¹æ²¡æœ‰ä»»ä½•ä»£ä»·ï¼Œåªæ˜¯è½¬æ¢äº†èµ„æºçš„æ‰€æœ‰æƒã€‚ä»–å®é™…ä¸Šå°†å·¦å€¼å˜æˆå³å€¼å¼•ç”¨ï¼Œç„¶ååº”ç”¨ç§»åŠ¨è¯­ä¹‰ï¼Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œå°±é¿å…äº†æ‹·è´ï¼Œæé«˜äº†ç¨‹åºæ€§èƒ½ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å†…éƒ¨æœ‰è¾ƒå¤§çš„å¯¹å†…å­˜æˆ–è€…åŠ¨æ€æ•°ç»„æ—¶ï¼Œå¾ˆæœ‰å¿…è¦å†™moveè¯­ä¹‰çš„æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼å‡½æ•°ï¼Œé¿å…æ— è°“çš„æ·±æ‹·è´ï¼Œä»¥æé«˜æ€§èƒ½ã€‚äº‹å®ä¸Šï¼ŒC++11ä¸­æ‰€æœ‰çš„å®¹å™¨éƒ½å®ç°äº†ç§»åŠ¨è¯­ä¹‰ï¼Œæ–¹ä¾¿æˆ‘ä»¬åšæ€§èƒ½ä¼˜åŒ–ã€‚</p>
<p>è¿™é‡Œä¹Ÿè¦æ³¨æ„å¯¹moveè¯­ä¹‰çš„è¯¯è§£ï¼Œmoveå®é™…ä¸Šå®ƒå¹¶ä¸èƒ½ç§»åŠ¨ä»»ä½•ä¸œè¥¿ï¼Œå®ƒå”¯ä¸€çš„åŠŸèƒ½æ˜¯å°†ä¸€ä¸ªå·¦å€¼å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚å¦‚æœæ˜¯ä¸€äº›åŸºæœ¬ç±»å‹æ¯”å¦‚intå’Œchar[10]å®šé•¿æ•°ç»„ç­‰ç±»å‹ï¼Œä½¿ç”¨moveçš„è¯ä»ç„¶ä¼šå‘ç”Ÿæ‹·è´ï¼ˆå› ä¸ºæ²¡æœ‰å¯¹åº”çš„ç§»åŠ¨æ„é€ å‡½æ•°ï¼‰ã€‚æ‰€ä»¥ï¼Œmoveå¯¹äºå«èµ„æºï¼ˆå †å†…å­˜æˆ–å¥æŸ„ï¼‰çš„å¯¹è±¡æ¥è¯´æ›´æœ‰æ„ä¹‰ã€‚</p>
<h3 id="ç¬¬4è¡Œä»£ç æ•…äº‹">ç¬¬4è¡Œä»£ç æ•…äº‹<a title="#ç¬¬4è¡Œä»£ç æ•…äº‹" href="#ç¬¬4è¡Œä»£ç æ•…äº‹"></a></h3>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;<span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(T&amp;&amp; val)</span></span>&#123; foo(<span class="built_in">std</span>::forward&lt;T&gt;(val)); &#125;</span><br></pre></td></tr></table></figure>
<p>C++11ä¹‹å‰è°ƒç”¨æ¨¡æ¿å‡½æ•°æ—¶ï¼Œå­˜åœ¨ä¸€ä¸ªæ¯”è¾ƒå¤´ç–¼çš„é—®é¢˜ï¼Œå¦‚ä½•æ­£ç¡®çš„ä¼ é€’å‚æ•°ã€‚æ¯”å¦‚ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">forwardValue</span><span class="params">(T&amp; val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    processValue(val); <span class="comment">//å³å€¼å‚æ•°ä¼šå˜æˆå·¦å€¼ </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">forwardValue</span><span class="params">(<span class="keyword">const</span> T&amp; val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    processValue(val); <span class="comment">//å‚æ•°éƒ½å˜æˆå¸¸é‡å·¦å€¼å¼•ç”¨äº† </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>éƒ½ä¸èƒ½æŒ‰ç…§å‚æ•°çš„æœ¬æ¥çš„ç±»å‹è¿›è¡Œè½¬å‘ã€‚</p>
<p>C<ins>11å¼•å…¥äº†å®Œç¾è½¬å‘ï¼šåœ¨å‡½æ•°æ¨¡æ¿ä¸­ï¼Œå®Œå…¨ä¾ç…§æ¨¡æ¿çš„å‚æ•°çš„ç±»å‹ï¼ˆå³ä¿æŒå‚æ•°çš„å·¦å€¼ã€å³å€¼ç‰¹å¾ï¼‰ï¼Œå°†å‚æ•°ä¼ é€’ç»™å‡½æ•°æ¨¡æ¿ä¸­è°ƒç”¨çš„å¦å¤–ä¸€ä¸ªå‡½æ•°ã€‚C</ins>11ä¸­çš„std::forwardæ­£æ˜¯åšè¿™ä¸ªäº‹æƒ…çš„ï¼Œä»–ä¼šæŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹è¿›è¡Œè½¬å‘ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processValue</span><span class="params">(<span class="keyword">int</span>&amp; a)</span></span>&#123; <span class="built_in">cout</span> &lt;&lt; <span class="string">"lvalue"</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">processValue</span><span class="params">(<span class="keyword">int</span>&amp;&amp; a)</span></span>&#123; <span class="built_in">cout</span> &lt;&lt; <span class="string">"rvalue"</span> &lt;&lt; <span class="built_in">endl</span>; &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">forwardValue</span><span class="params">(T&amp;&amp; val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    processValue(<span class="built_in">std</span>::forward&lt;T&gt;(val)); <span class="comment">//ç…§å‚æ•°æœ¬æ¥çš„ç±»å‹è¿›è¡Œè½¬å‘ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Testdelcl</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    forwardValue(i); <span class="comment">//ä¼ å…¥å·¦å€¼ </span></span><br><span class="line">    forwardValue(<span class="number">0</span>);<span class="comment">//ä¼ å…¥å³å€¼ </span></span><br><span class="line">&#125;</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">lvaue </span><br><span class="line">rvalue</span><br></pre></td></tr></table></figure>
<p>å³å€¼å¼•ç”¨T&amp;&amp;æ˜¯ä¸€ä¸ªuniversal referencesï¼Œå¯ä»¥æ¥å—å·¦å€¼æˆ–è€…å³å€¼ï¼Œæ­£æ˜¯è¿™ä¸ªç‰¹æ€§è®©ä»–é€‚åˆä½œä¸ºä¸€ä¸ªå‚æ•°çš„è·¯ç”±ï¼Œç„¶åå†é€šè¿‡std::forwardæŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹å»åŒ¹é…å¯¹åº”çš„é‡è½½å‡½æ•°ï¼Œæœ€ç»ˆå®ç°å®Œç¾è½¬å‘ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç»“åˆå®Œç¾è½¬å‘å’Œç§»åŠ¨è¯­ä¹‰æ¥å®ç°ä¸€ä¸ªæ³›å‹çš„å·¥å‚å‡½æ•°ï¼Œè¿™ä¸ªå·¥å‚å‡½æ•°å¯ä»¥åˆ›å»ºæ‰€æœ‰ç±»å‹çš„å¯¹è±¡ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">template&lt;typenameâ€¦  Args&gt;</span><br><span class="line">T* <span class="constructor">Instance(Args<span class="operator">&amp;&amp;</span>â€¦ <span class="params">args</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    return <span class="keyword">new</span> <span class="constructor">T(<span class="params">std</span>::<span class="params">forward</span>&lt;Args &gt;(<span class="params">args</span>)</span>â€¦);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå·¥å‚å‡½æ•°çš„å‚æ•°æ˜¯å³å€¼å¼•ç”¨ç±»å‹ï¼Œå†…éƒ¨ä½¿ç”¨std::forwardæŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹è¿›è¡Œè½¬å‘ï¼Œå¦‚æœå‚æ•°çš„å®é™…ç±»å‹æ˜¯å³å€¼ï¼Œé‚£ä¹ˆåˆ›å»ºçš„æ—¶å€™ä¼šè‡ªåŠ¨åŒ¹é…ç§»åŠ¨æ„é€ ï¼Œå¦‚æœæ˜¯å·¦å€¼åˆ™ä¼šåŒ¹é…æ‹·è´æ„é€ ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“<a title="#æ€»ç»“" href="#æ€»ç»“"></a></h2>
<p>é€šè¿‡4è¡Œä»£ç æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯å³å€¼å’Œå³å€¼å¼•ç”¨ï¼Œä»¥åŠå³å€¼å¼•ç”¨çš„ä¸€äº›ç‰¹ç‚¹ï¼Œåˆ©ç”¨è¿™äº›ç‰¹ç‚¹æˆ‘ä»¬æ‰æ–¹ä¾¿å®ç°ç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ã€‚C++11æ­£æ˜¯é€šè¿‡å¼•å…¥å³å€¼å¼•ç”¨æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œå…·ä½“æ¥è¯´æ˜¯é€šè¿‡ç§»åŠ¨è¯­ä¹‰æ¥é¿å…æ— è°“æ‹·è´çš„é—®é¢˜ï¼Œé€šè¿‡moveè¯­ä¹‰æ¥å°†ä¸´æ—¶ç”Ÿæˆçš„å·¦å€¼ä¸­çš„èµ„æºæ— ä»£ä»·çš„è½¬ç§»åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡ä¸­å»ï¼Œé€šè¿‡å®Œç¾è½¬å‘æ¥è§£å†³ä¸èƒ½æŒ‰ç…§å‚æ•°å®é™…ç±»å‹æ¥è½¬å‘çš„é—®é¢˜ï¼ˆåŒæ—¶ï¼Œå®Œç¾è½¬å‘è·å¾—çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å®ç°ç§»åŠ¨è¯­ä¹‰ï¼‰ã€‚</p>
<p><em>æœ¬æ–‡æ›¾å‘è¡¨äºã€Šç¨‹åºå‘˜ã€‹2015å¹´1æœˆåˆŠã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</em></p>
<p>*åè®°ï¼š*æœ¬æ–‡çš„å†…å®¹ä¸»è¦æ¥è‡ªäºæˆ‘åœ¨å…¬å¸å†…éƒ¨åŸ¹è®­çš„ä¸€æ¬¡è¯¾ç¨‹ï¼Œå› ä¸ºå¾ˆå¤šäººå¯¹C++11å³å€¼å¼•ç”¨æä¸æ¸…æˆ–è€…ç†è§£å¾—ä¸æ·±å…¥ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—æœ‰å¿…è¦æ‹¿å‡ºæ¥åˆ†äº«ä¸€ä¸‹ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ°ï¼Œå°±æ•´ç†äº†ä¸€ä¸‹å‘åˆ°ç¨‹åºå‘˜æ‚å¿—äº†ï¼Œæˆ‘ç›¸ä¿¡è¯»è€…çœ‹å®Œä¹‹åå¯¹å³å€¼å¼•ç”¨ä¼šæœ‰å…¨é¢æ·±å…¥çš„äº†è§£ã€‚</p>
<p>ä¸€ç‚¹æ¢¦æƒ³ï¼šå°½è‡ªå·±ä¸€ä»½åŠ›ï¼Œè®©c++çš„ä¸–ç•Œå˜å¾—æ›´ç¾å¥½ï¼</p>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¨¡ç‰ˆå…ƒç¼–ç¨‹åº”ç”¨</title>
    <url>/posts/%E6%A8%A1%E7%89%88%E5%85%83%E7%BC%96%E7%A8%8B%E5%BA%94%E7%94%A8/</url>
    <content><![CDATA[<h3 id="1.æ¦‚è¿°">1.æ¦‚è¿°<a title="#1.æ¦‚è¿°" href="#1.æ¦‚è¿°"></a></h3>
<p>å…³äºC<ins>11æ¨¡æ¿å…ƒçš„åŸºæœ¬ç”¨æ³•å’Œå¸¸ç”¨æŠ€å·§ï¼Œåœ¨å¸¸è§„ç¼–ç¨‹ä¸­å¯èƒ½å¾ˆå°‘é‡åˆ°ï¼Œé‚£ä¹ˆC</ins>11æ¨¡ç‰ˆå…ƒç¼–ç¨‹ç”¨æ¥è§£å†³ä»€ä¹ˆå®é™…é—®é¢˜å‘¢ï¼Œåœ¨å®é™…å·¥ç¨‹ä¸­åˆè¯¥å¦‚ä½•åº”ç”¨å‘¢ï¼Ÿæœ¬æ–‡å°†ä¾§é‡ä»‹ç»C++11æ¨¡æ¿çš„ä¸€äº›å…·ä½“åº”ç”¨ï¼Œå‘è¯»è€…å±•ç¤ºæ¨¡ç‰ˆå…ƒç¼–ç¨‹çš„å…·ä½“åº”ç”¨ã€‚</p>
<a id="more"></a>
<p>æˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•é€šè¿‡C++11æ¨¡ç‰ˆå…ƒæ¥å®ç°function_traitsã€Vairantç±»å‹å’Œæ³›å‹bindç»‘å®šå™¨ã€‚function_traitsä¾§é‡äºå¦‚ä½•èƒå–å¯è°ƒç”¨å¯¹è±¡çš„ä¸€äº›å…ƒä¿¡æ¯ï¼ŒVariantåˆ™æ˜¯ä¸€ç§èƒ½æ¥å—å¤šç§ç±»å‹æ•°æ®çš„â€œä¸‡èƒ½â€ç±»å‹ï¼Œbindåˆ™æ˜¯ä¸€ä¸ªæ³›åŒ–çš„ç»‘å®šå™¨ï¼Œä¸‹é¢æ¥çœ‹çœ‹è¿™äº›å…·ä½“çš„ä¾‹å­ã€‚</p>
<h4 id="ç±»å‹èƒå–">ç±»å‹èƒå–<a title="#ç±»å‹èƒå–" href="#ç±»å‹èƒå–"></a></h4>
<p>C<ins>æ¨¡æ¿ä¸­çš„ç±»å‹å‚æ•°Tæ˜¯æŠ½è±¡çš„ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨æ¨¡æ¿å†…éƒ¨ç›´æ¥è·å¾—å®ƒçš„å…·ä½“ç‰¹å¾ã€‚ç±»å‹èƒå–ï¼ˆæŠ½å–ï¼‰æŠ€æœ¯å°±æ˜¯è¦æŠ½å–ç±»å‹çš„ä¸€äº›å…·ä½“ç‰¹å¾(trait)ï¼Œæ¯”å¦‚å®ƒæ˜¯å“ªç§å…·ä½“ç±»å‹ï¼Œå®ƒæ˜¯å¼•ç”¨ç±»å‹ï¼Œå†…å»ºç±»å‹ï¼Œè¿˜æ˜¯ç±»ç±»å‹ç­‰ã€‚å¯è§ï¼Œç±»å‹èƒå–æŠ€æœ¯å…¶å®å°±æ˜¯traitæ¨¡æ¿æŠ€æœ¯çš„å…·ä½“ä½“ç°ã€‚è·å–ç±»å‹çš„å…·ä½“ç‰¹å¾åœ¨Javaã€C#ç­‰è¯­è¨€ä¸­ä¹Ÿç§°ä¸ºåå°„(reflection)ï¼ŒC</ins>ä¸­é€šè¿‡æ¨¡æ¿æŠ€æœ¯ä¹Ÿå¯ä»¥å®ç°ä¸€å®šçš„åå°„è¡Œä¸ºã€‚<br>
ã€€ã€€ç±»å‹ä¿¡æ¯æ˜¯ç¼–è¯‘æœŸçš„å®ä½“ï¼Œç°åœ¨è¦é’ˆå¯¹ç±»å‹æ¥è¿›è¡Œç¼–ç¨‹ï¼Œè¿™å…¶å®å°±æ˜¯æ¨¡æ¿å…ƒç¼–ç¨‹çš„ä¸€ä¸ªæ–¹é¢ã€‚æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„if/elseï¼Œwhileï¼Œforç­‰åŸºæœ¬çš„é€»è¾‘ç»“æ„éƒ½æ˜¯è¿è¡ŒæœŸçš„è¡Œä¸ºï¼Œåœ¨é¢å‘ç±»å‹çš„ç¼–ç¨‹ä¸­å¹¶ä¸èƒ½ä½¿ç”¨ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°ä¸€äº›ç‰¹æ®Šçš„æ¨¡æ¿æŠ€æœ¯ã€‚å®ç°ç±»å‹èƒå–è¦ç”¨åˆ°çš„åŸºæœ¬æ€æƒ³ä¸€ä¸ªæ˜¯ç‰¹åŒ–ï¼Œä¸€ä¸ªå°±æ˜¯ç”¨typedefæ¥æºå¸¦ç±»å‹ä¿¡æ¯ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨ç”¨æ¨¡æ¿åšè®¾è®¡æ—¶ï¼Œä¸€èˆ¬å»ºè®®åœ¨æ¨¡æ¿å®šä¹‰å†…éƒ¨ï¼Œä¸ºæ¨¡æ¿çš„æ¯ä¸ªç±»å‹å‚æ•°æä¾›typedefå®šä¹‰ï¼Œè¿™æ ·åœ¨æ³›å‹ä»£ç ä¸­å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¿é—®æˆ–æŠ½å–è¿™äº›ç±»å‹ã€‚<br>
ã€€ã€€åœ¨Cå’ŒC++ä¸­ï¼Œæ™®é€šçš„å‡½æ•°å¯ä»¥ç§°ä¸ºå€¼å‡½æ•°ï¼Œå®ƒä»¬æ¥å—çš„å‚æ•°æ˜¯æŸäº›å€¼ï¼Œè¿”å›çš„ç»“æœä¹Ÿæ˜¯å€¼ã€‚è€Œæ‰€è°“çš„ç±»å‹å‡½æ•°æ¥å—çš„å®å‚æ˜¯ç±»å‹ï¼Œè¿”å›çš„æ˜¯è¢«æŠ½å–å‡ºæ¥çš„ç±»å‹æˆ–å¸¸é‡å€¼ç­‰ï¼ˆå³ç”¨typedefå®šä¹‰çš„ç±»å‹åˆ«åï¼Œä¸€èˆ¬ä¸åŒçš„å…·ä½“ç±»å‹éƒ½å®šä¹‰ç»Ÿä¸€çš„åˆ«åï¼‰ã€‚å¦‚ç±»æ¨¡æ¿å°±æ˜¯ç±»å‹å‡½æ•°ï¼Œsizeofæ˜¯å†…å»ºçš„ç±»å‹å‡½æ•°ï¼Œè¿”å›ç»™å®šç±»å‹å®å‚çš„å¤§å°ã€‚åœ¨ç±»å‹ç¼–ç¨‹ä¸­ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½è¦ç”¨åˆ°sizeofã€‚<br>
//ä¸‹é¢æ¼”ç¤ºä¸€äº›æœ‰ç”¨çš„ç±»å‹èƒå–å®ç°ï¼Œè¿™äº›éƒ½æ˜¯ç±»å‹å‡½æ•°ã€‚</p>
<h3 id="2.function_traits">2.function_traits<a title="#2.function_traits" href="#2.function_traits"></a></h3>
<p>function_traitsç”¨æ¥è·å–å‡½æ•°è¯­ä¹‰çš„å¯è°ƒç”¨å¯¹è±¡çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚å‡½æ•°ç±»å‹ã€è¿”å›ç±»å‹ã€å‡½æ•°æŒ‡é’ˆç±»å‹å’Œå‚æ•°ç±»å‹ç­‰ã€‚ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•å®ç°function_traitsã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™®é€šå‡½æ•°èƒå–</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Ret, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span>&lt;Ret(Args...)&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">enum</span> &#123; arity = <span class="keyword">sizeof</span>...(Args) &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> Ret <span class="title">function_type</span><span class="params">(Args...)</span></span>;</span><br><span class="line">    <span class="keyword">typedef</span> Ret return_type;</span><br><span class="line">    <span class="keyword">using</span> stl_function_type = <span class="built_in">std</span>::function&lt;function_type&gt;;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">Ret</span><span class="params">(*pointer)</span><span class="params">(Args...)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">size_t</span> I&gt;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">args</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">static_assert</span>(I &lt; arity, <span class="string">"index is out of range, index must less than sizeof Args"</span>);</span><br><span class="line">        <span class="keyword">using</span> type = <span class="keyword">typename</span> <span class="built_in">std</span>::tuple_element&lt;I, <span class="built_in">std</span>::tuple&lt;Args...&gt;&gt;::type;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç±»å‡½æ•°èƒå–</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Ret, <span class="keyword">typename</span> Class, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span>&lt;Ret(Class::*) (Args...)&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">enum</span> &#123; arity = <span class="keyword">sizeof</span>...(Args) &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> Ret <span class="title">function_type</span><span class="params">(Args...)</span></span>;</span><br><span class="line">    <span class="keyword">typedef</span> Ret return_type;</span><br><span class="line">    <span class="keyword">using</span> stl_function_type = <span class="built_in">std</span>::function&lt;function_type&gt;;</span><br><span class="line">    <span class="function"><span class="keyword">typedef</span> <span class="title">Ret</span><span class="params">(Class::* pointer)</span><span class="params">(Args...)</span></span>;</span><br><span class="line">    <span class="keyword">typedef</span> Class class_type;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">size_t</span> I&gt;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">args</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">static_assert</span>(I &lt; arity, <span class="string">"index is out of range, index must less than sizeof Args"</span>);</span><br><span class="line">        <span class="keyword">using</span> type = <span class="keyword">typename</span> <span class="built_in">std</span>::tuple_element&lt;I, <span class="built_in">std</span>::tuple&lt;Args...&gt;&gt;::type;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°æŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Ret, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span>&lt;Ret(*)(Args...)&gt; :</span> function_traits&lt;Ret(Args...)&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//std::function</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Ret, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span>&lt;std::function&lt;Ret(Args...)&gt;&gt; :</span> function_traits&lt;Ret(Args...)&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//member function</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> ReturnType, <span class="keyword">typename</span> ClassType, <span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span>&lt;ReturnType(ClassType::*)(Args...) const&gt; :</span> function_traits&lt;ReturnType(ClassType::*)(Args...)&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°å¯¹è±¡</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Callable&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">function_traits</span> :</span> function_traits&lt;<span class="keyword">decltype</span>(&amp;Callable::<span class="keyword">operator</span>())&gt; &#123;&#125;;</span><br></pre></td></tr></table></figure>
<p>ç”±äºå¯è°ƒç”¨å¯¹è±¡å¯èƒ½æ˜¯æ™®é€šçš„å‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€lambdaã€std::functionå’Œæˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é’ˆå¯¹è¿™äº›ç±»å‹åˆ†åˆ«åšåç‰¹åŒ–ï¼Œç„¶åèƒå–å‡ºå¯è°ƒç”¨å¯¹è±¡çš„å…ƒä¿¡æ¯ã€‚å…¶ä¸­ï¼Œæˆå‘˜å‡½æ•°çš„åç‰¹åŒ–ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå› ä¸ºæ¶‰åŠåˆ°cvç¬¦çš„å¤„ç†ï¼Œè¿™é‡Œé€šè¿‡å®šä¹‰ä¸€ä¸ªå®æ¥æ¶ˆé™¤é‡å¤çš„æ¨¡æ¿ç±»å®šä¹‰ã€‚å‚æ•°ç±»å‹çš„è·å–æˆ‘ä»¬æ˜¯å€ŸåŠ©äºtupleï¼Œå°†å‚æ•°è½¬æ¢ä¸ºtupleç±»å‹ï¼Œç„¶åæ ¹æ®ç´¢å¼•æ¥è·å–å¯¹åº”ç±»å‹ã€‚å®ƒçš„ç”¨æ³•æ¯”è¾ƒç®€å•ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//ç±»å‡½æ•°</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">S</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fun</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>*)</span> </span>&#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ™®é€šå‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">fun</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">0.1</span>; &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintType</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">cout</span> &lt;&lt; <span class="keyword">typeid</span>(T).name() &lt;&lt; <span class="built_in">std</span>::<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">		<span class="keyword">void</span> (S::* cfptr)(<span class="keyword">const</span> <span class="keyword">char</span>*) = &amp;S::fun; <span class="comment">// class fnptr</span></span><br><span class="line">    <span class="keyword">double</span> (*fptr)() = fun; <span class="comment">//fnptr</span></span><br><span class="line">    <span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">int</span>)&gt; f = [](<span class="keyword">int</span> a) &#123;<span class="keyword">return</span> a; &#125;;  <span class="comment">//function</span></span><br><span class="line">    <span class="keyword">auto</span> lambda = [](<span class="keyword">int</span> a) &#123;<span class="keyword">return</span> a; &#125;; <span class="comment">// lambda</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°å‡½æ•°ç±»å‹</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="keyword">decltype</span>(fptr)&gt;::function_type&gt;(); <span class="comment">//å°†è¾“å‡ºdouble __cdecl&lt;void&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="comment">//æ‰“å°ç±»å‡½æ•°æŒ‡é’ˆç±»å‹</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="keyword">decltype</span>(&amp;cfptr)&gt;::pointer&gt;(); <span class="comment">//å°†è¾“å‡ºvoid &lt;__thiscall S::*&gt;&lt;char const *&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="built_in">std</span>::function&lt;<span class="keyword">int</span>(<span class="keyword">bool</span>)&gt;&gt;::args&lt;<span class="number">0</span>&gt;::type&gt;();<span class="comment">//å°†è¾“å‡ºbool</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°å‡½æ•°çš„è¿”å›ç±»å‹</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="keyword">decltype</span>(f)&gt;::return_type&gt;(); <span class="comment">//å°†è¾“å‡ºint</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°å‡½æ•°æŒ‡é’ˆç±»å‹</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="keyword">decltype</span>(f)&gt;::pointer&gt;(); <span class="comment">//å°†è¾“å‡ºint &lt;__cdecl*&gt;&lt;int&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰“å°functionå‡½æ•°ç±»å‹</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="keyword">decltype</span>(f)&gt;::stl_function_type&gt;(); <span class="comment">//å°†è¾“å‡ºclass std::function&lt;int __cdecl&lt;int&gt;&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//lambda =&gt; éšå¼è½¬åŒ–ä¸ºäº†åŒ¿åç±»å¯¹è±¡</span></span><br><span class="line">    PrintType&lt;function_traits&lt;<span class="keyword">decltype</span>(lambda)&gt;::class_type&gt;(); <span class="comment">//å°†è¾“å‡ºclass &lt;lambda_13vr3tgewf32rt23rfgt435g41239da&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gun gccä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">FdvE</span><br><span class="line">b</span><br><span class="line">i</span><br><span class="line">PFiiE</span><br><span class="line">St8functionIFiiEE</span><br><span class="line">Z4mainEUliE0_</span><br><span class="line">M1SFvPKcE</span><br></pre></td></tr></table></figure>
<p>Visual studioä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">double</span> __cdecl(<span class="keyword">void</span>)</span><br><span class="line"><span class="keyword">void</span> (__thiscall S::*)(<span class="keyword">char</span> <span class="keyword">const</span> *)</span><br><span class="line"><span class="keyword">bool</span></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line"><span class="keyword">int</span> (__cdecl*)(<span class="keyword">int</span>)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">std</span>:</span>:function&lt;<span class="keyword">int</span> __cdecl(<span class="keyword">int</span>)&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> &lt;lambda_173ed6f42b6e4df55bf9ec2e4778d93a&gt;</span></span><br></pre></td></tr></table></figure>
<p>å…¶å®ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥å‚è€ƒ<a href="http://www.cppblog.com/smagle/archive/2010/05/14/115286.html" target="_blank">è¿™é‡Œ</a></p>
<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªfunction_traitsé€šè¿‡ç±»å‹èƒå–ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è·å–å¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡ã€std::functionå’Œlambdaè¡¨è¾¾å¼ï¼‰çš„ä¸€äº›å…ƒä¿¡æ¯ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œè¿™ä¸ªfunction_traitsç»å¸¸ä¼šç”¨åˆ°æ˜¯æ›´é«˜å±‚æ¨¡ç‰ˆå…ƒç¨‹åºçš„åŸºç¡€ã€‚æ¯”å¦‚Variantç±»å‹çš„å®ç°å°±è¦ç”¨åˆ°è¿™ä¸ªfunction_traitsï¼Œä¸‹é¢æ¥çœ‹çœ‹Variantçš„å®ç°ã€‚</p>
<h3 id="3.variant">3.Variant<a title="#3.variant" href="#3.variant"></a></h3>
<p>å€ŸåŠ©ä¸Šé¢çš„function_traitså’Œå‰æ–‡å®ç°çš„ä¸€äº›å…ƒå‡½æ•°ï¼Œæˆ‘ä»¬å°±èƒ½æ–¹ä¾¿çš„å®ç°ä¸€ä¸ªâ€œä¸‡èƒ½ç±»å‹â€â€”Variantï¼ŒVariantå®é™…ä¸Šä¸€ä¸ªæ³›åŒ–çš„ç±»å‹ï¼Œè¿™ä¸ªVariantå’Œboost.variantçš„ç”¨æ³•ç±»ä¼¼ï¼Œéœ€è¦é¢„å®šä¹‰ä¸€äº›ç±»å‹ä½œä¸ºå¯æ¥å—çš„ç±»å‹ã€‚boost.variantçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> variant&lt;<span class="keyword">int</span>,<span class="keyword">char</span>, <span class="keyword">double</span>&gt; vt;</span><br><span class="line">vt v = <span class="number">1</span>;</span><br><span class="line">v = <span class="string">'a'</span>;</span><br><span class="line">v = <span class="number">12.32</span>;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªvariantå¯ä»¥æ¥å—å·²ç»å®šä¹‰çš„é‚£äº›ç±»å‹ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹ç±»ä¼¼äºc#å’Œjavaä¸­çš„objectç±»å‹ï¼Œå®é™…ä¸Švariantæ˜¯æ“¦é™¤äº†ç±»å‹ï¼Œè¦è·å–å®ƒçš„å®é™…ç±»å‹çš„æ—¶å€™å°±ç¨æ˜¾éº»çƒ¦ï¼Œéœ€è¦é€šè¿‡boost.visitoræ¥è®¿é—®ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">VariantVisitor</span> :</span> <span class="keyword">public</span> boost::static_visitor&lt;<span class="keyword">void</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"int"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">short</span> val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"short"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">double</span> val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"double"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="built_in">std</span>::<span class="built_in">string</span> val)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"string"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">boost::variant&lt;<span class="keyword">int</span>,<span class="keyword">short</span>,<span class="keyword">double</span>,<span class="built_in">std</span>::<span class="built_in">string</span>&gt; v = <span class="number">1</span>;</span><br><span class="line">boost::apply_visitor(visitor, v); <span class="comment">//å°†è¾“å‡ºint</span></span><br></pre></td></tr></table></figure>
<p>â€‹	ã€€é€šè¿‡C++11æ¨¡ç‰ˆå…ƒå®ç°çš„Variantå°†æ”¹è¿›å€¼çš„è·å–ï¼Œå°†è·å–å®é™…å€¼çš„æ–¹å¼æ”¹ä¸ºå†…ç½®çš„ï¼Œå³é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥è®¿é—®ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> Variant&lt;<span class="keyword">int</span>, <span class="keyword">double</span>, <span class="built_in">string</span>, <span class="keyword">int</span>&gt; cv;</span><br><span class="line">cv v = <span class="number">10</span>;</span><br><span class="line">v.Visit([&amp;](<span class="keyword">double</span> i)&#123;<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>; &#125;, [](<span class="keyword">short</span> i)&#123;<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>; &#125;, [=](<span class="keyword">int</span> i)&#123;<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>; &#125;,[](<span class="keyword">const</span> <span class="built_in">string</span>&amp; i)&#123;<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>; &#125;);<span class="comment">//ç»“æœå°†è¾“å‡º10</span></span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹å¼æ›´æ–¹ä¾¿ç›´è§‚ã€‚Variantçš„å®ç°éœ€è¦å€ŸåŠ©å‰æ–‡ä¸­å®ç°çš„ä¸€äº›å…ƒå‡½æ•°MaxIntegerã€MaxAlignã€Containså’ŒAtç­‰ç­‰ã€‚å¯ä»¥åœ¨ä¸‹é¢çš„tabä¸­å±•å¼€è§‚çœ‹ï¼Œä¸‹é¢æ¥çœ‹çœ‹Variantå®ç°çš„å…³é”®ä»£ç ã€‚<br>
IntegerMaxä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** è·å–æ•´æ•°åˆ—è¡¨ä¸­æœ€å¤§çš„æ•´æ•° */</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="built_in">std</span>::<span class="keyword">size_t</span> arg, <span class="built_in">std</span>::<span class="keyword">size_t</span>... rest&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IntegerMax</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="built_in">std</span>::<span class="keyword">size_t</span> arg&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IntegerMax</span>&lt;arg&gt; :</span> <span class="built_in">std</span>::integral_constant&lt;<span class="built_in">std</span>::<span class="keyword">size_t</span>, arg&gt;</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="built_in">std</span>::<span class="keyword">size_t</span> arg1, <span class="built_in">std</span>::<span class="keyword">size_t</span> arg2, <span class="built_in">std</span>::<span class="keyword">size_t</span>... rest&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IntegerMax</span>&lt;arg1, arg2, rest...&gt; :</span> <span class="built_in">std</span>::integral_constant&lt;<span class="built_in">std</span>::<span class="keyword">size_t</span>, arg1 &gt;= arg2 ? IntegerMax&lt;arg1, rest...&gt;::value</span><br><span class="line">    : IntegerMax&lt;arg2, rest...&gt;::value&gt;</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>MaxAlignä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** è·å–æœ€å¤§çš„align */</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Args&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MaxAlign</span> :</span> <span class="built_in">std</span>::integral_constant&lt;<span class="keyword">int</span>, IntegerMax&lt;<span class="built_in">std</span>::alignment_of&lt;Args&gt;::value...&gt;::value&gt;</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Containsä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** æ˜¯å¦åŒ…å«æŸä¸ªç±»å‹ */</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... List&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Contains</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Head, <span class="keyword">typename</span>... Rest&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Contains</span>&lt;T, Head, Rest...&gt;</span></span><br><span class="line"><span class="class">    :</span> <span class="built_in">std</span>::conditional&lt;<span class="built_in">std</span>::is_same&lt;T, Head&gt;::value, <span class="built_in">std</span>::true_type, Contains&lt;T, Rest... &gt;&gt; ::type</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Contains</span>&lt;T&gt; :</span> <span class="built_in">std</span>::false_type</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>IndexOfä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... List&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IndexOf</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Head, <span class="keyword">typename</span>... Rest&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IndexOf</span>&lt;T, Head, Rest...&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">enum</span> &#123; value = IndexOf&lt;T, Rest...&gt;::value + <span class="number">1</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Rest&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IndexOf</span>&lt;T, T, Rest...&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">enum</span> &#123; value = <span class="number">0</span> &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">IndexOf</span>&lt;T&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">enum</span>&#123;value = <span class="number">-1</span>&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Atä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">int</span> index, <span class="keyword">typename</span>... Types&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">At</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">int</span> index, <span class="keyword">typename</span> First, <span class="keyword">typename</span>... Types&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">At</span>&lt;index, First, Types...&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">using</span> type = <span class="keyword">typename</span> At&lt;index - <span class="number">1</span>, Types...&gt;::type;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Types&gt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">At</span>&lt;0, T, Types...&gt;</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">using</span> type = T;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Variantå…³é”®ä»£ç ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Types&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Variant</span>&#123;</span></span><br><span class="line">    <span class="keyword">enum</span>&#123;</span><br><span class="line">        data_size = IntegerMax&lt;<span class="keyword">sizeof</span>(Types)...&gt;::value, <span class="comment">//å‚æ•°ä¸ªæ•°</span></span><br><span class="line">        align_size = MaxAlign&lt;Types...&gt;::value	<span class="comment">//å‚æ•°æœ€å¤§å­—èŠ‚æ•°</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">data_t</span> = <span class="keyword">typename</span> <span class="built_in">std</span>::aligned_storage&lt;data_size, align_size&gt;::type;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">int</span> index&gt;</span><br><span class="line">    <span class="keyword">using</span> IndexType = <span class="keyword">typename</span> At&lt;index, Types...&gt;::type;</span><br><span class="line"></span><br><span class="line">    Variant(<span class="keyword">void</span>) :m_typeIndex(<span class="keyword">typeid</span>(<span class="keyword">void</span>))&#123;&#125;</span><br><span class="line">    ~Variant()&#123; Destroy(m_typeIndex, &amp;m_data); &#125;</span><br><span class="line"></span><br><span class="line">    Variant(Variant&lt;Types...&gt;&amp;&amp; old) : m_typeIndex(old.m_typeIndex)&#123;</span><br><span class="line">        Move(old.m_typeIndex, &amp;old.m_data, &amp;m_data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Variant(<span class="keyword">const</span> Variant&lt;Types...&gt;&amp; old) : m_typeIndex(old.m_typeIndex)&#123;</span><br><span class="line">        Copy(old.m_typeIndex, &amp;old.m_data, &amp;m_data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> = <span class="title">typename</span> <span class="title">std</span>:</span>:enable_if&lt;Contains&lt;<span class="keyword">typename</span> <span class="built_in">std</span>::remove_reference&lt;T&gt;::type, Types...&gt;::value&gt;::type&gt; Variant(T&amp;&amp; value) : m_typeIndex(<span class="keyword">typeid</span>(<span class="keyword">void</span>))&#123;</span><br><span class="line">            Destroy(m_typeIndex, &amp;m_data);</span><br><span class="line">            <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="built_in">std</span>::remove_reference&lt;T&gt;::type U;</span><br><span class="line">            <span class="keyword">new</span>(&amp;m_data) U(<span class="built_in">std</span>::forward&lt;T&gt;(value));</span><br><span class="line">            m_typeIndex = type_index(<span class="keyword">typeid</span>(U));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">Is</span><span class="params">()</span> <span class="keyword">const</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (m_typeIndex == type_index(<span class="keyword">typeid</span>(T)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="keyword">typename</span> <span class="built_in">std</span>::decay&lt;T&gt;::<span class="function">type&amp; <span class="title">Get</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">using</span> U = <span class="keyword">typename</span> <span class="built_in">std</span>::decay&lt;T&gt;::type;</span><br><span class="line">        <span class="keyword">if</span> (!Is&lt;U&gt;())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="keyword">typeid</span>(U).name() &lt;&lt; <span class="string">" is not defined. "</span> &lt;&lt; <span class="string">"current type is "</span> &lt;&lt;</span><br><span class="line">                m_typeIndex.name() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="built_in">std</span>::bad_cast();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> *(U*)(&amp;m_data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> F&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Visit</span><span class="params">(F&amp;&amp; f)</span></span>&#123;</span><br><span class="line">        <span class="keyword">using</span> T = <span class="keyword">typename</span> Function_Traits&lt;F&gt;::<span class="keyword">template</span> arg&lt;<span class="number">0</span>&gt;::type;</span><br><span class="line">        <span class="keyword">if</span> (Is&lt;T&gt;())</span><br><span class="line">            f(Get&lt;T&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> F, <span class="keyword">typename</span>... Rest&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Visit</span><span class="params">(F&amp;&amp; f, Rest&amp;&amp;... rest)</span></span>&#123;</span><br><span class="line">        <span class="keyword">using</span> T = <span class="keyword">typename</span> Function_Traits&lt;F&gt;::<span class="keyword">template</span> arg&lt;<span class="number">0</span>&gt;::type;</span><br><span class="line">        <span class="keyword">if</span> (Is&lt;T&gt;())</span><br><span class="line">            Visit(<span class="built_in">std</span>::forward&lt;F&gt;(f));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            Visit(<span class="built_in">std</span>::forward&lt;Rest&gt;(rest)...);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Destroy</span><span class="params">(<span class="keyword">const</span> type_index&amp; index, <span class="keyword">void</span> * buf)</span></span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt;&#123;(Destroy0&lt;Types&gt;(index, buf), <span class="number">0</span>)...&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Destroy0</span><span class="params">(<span class="keyword">const</span> type_index&amp; id, <span class="keyword">void</span>* data)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (id == type_index(<span class="keyword">typeid</span>(T)))</span><br><span class="line">            <span class="keyword">reinterpret_cast</span>&lt;T*&gt;(data)-&gt;~T();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Move</span><span class="params">(<span class="keyword">const</span> type_index&amp; <span class="keyword">old_t</span>, <span class="keyword">void</span>* old_v, <span class="keyword">void</span>* new_v)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt;&#123;(Move0&lt;Types&gt;(<span class="keyword">old_t</span>, old_v, new_v), <span class="number">0</span>)...&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Move0</span><span class="params">(<span class="keyword">const</span> type_index&amp; <span class="keyword">old_t</span>, <span class="keyword">void</span>* old_v, <span class="keyword">void</span>* new_v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">old_t</span> == type_index(<span class="keyword">typeid</span>(T)))</span><br><span class="line">            <span class="keyword">new</span> (new_v)T(<span class="built_in">std</span>::move(*<span class="keyword">reinterpret_cast</span>&lt;T*&gt;(old_v)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Copy</span><span class="params">(<span class="keyword">const</span> type_index&amp; <span class="keyword">old_t</span>, <span class="keyword">void</span>* old_v, <span class="keyword">void</span>* new_v)</span></span>&#123;</span><br><span class="line">        <span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt;&#123;(Copy0&lt;Types&gt;(<span class="keyword">old_t</span>, old_v, new_v), <span class="number">0</span>)...&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Copy0</span><span class="params">(<span class="keyword">const</span> type_index&amp; <span class="keyword">old_t</span>, <span class="keyword">void</span>* old_v, <span class="keyword">void</span>* new_v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">old_t</span> == type_index(<span class="keyword">typeid</span>(T)))</span><br><span class="line">            <span class="keyword">new</span> (new_v)T(*<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">const</span> T*&gt;(old_v));</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">data_t</span> m_data;</span><br><span class="line">    <span class="built_in">std</span>::type_index m_typeIndex;<span class="comment">//ç±»å‹ID</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å®ç°Varianté¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒºç”¨æ¥å­˜æ”¾ä¸åŒçš„ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªç¼“ç±»å‹å†²åŒºå®é™…ä¸Šå°±æ˜¯ç”¨æ¥æ“¦é™¤ç±»å‹ï¼Œä¸åŒçš„ç±»å‹éƒ½é€šè¿‡placement newåœ¨è¿™ä¸ªç¼“å†²åŒºä¸Šåˆ›å»ºå¯¹è±¡ï¼Œå› ä¸ºç±»å‹é•¿åº¦ä¸åŒï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘å†…å­˜å¯¹é½ï¼ŒC++11åˆšå¥½æä¾›äº†å†…å­˜å¯¹é½çš„ç¼“å†²åŒºaligned_storageï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt; <span class="built_in">std</span>::<span class="keyword">size_t</span> Len, <span class="built_in">std</span>::<span class="keyword">size_t</span> Align = <span class="comment">/*default-alignment*/</span> &gt;</span><br><span class="line">struct aligned_storage;</span><br></pre></td></tr></table></figure>
<p>å®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç¼“å†²åŒºçš„é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¼“å†²åŒºå†…å­˜å¯¹é½çš„å¤§å°ï¼Œç”±äºVaraintå¯ä»¥æ¥å—å¤šç§ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–æœ€å¤§çš„ç±»å‹é•¿åº¦ï¼Œä¿è¯ç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œç„¶åè¿˜è¦è·å–æœ€å¤§çš„å†…å­˜å¯¹é½å¤§å°ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡å‰é¢å®ç°çš„MaxIntegerå’ŒMaxAlignå°±å¯ä»¥äº†ï¼ŒVaraintä¸­å†…å­˜å¯¹é½çš„ç¼“å†²åŒºå®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">enum</span></span><br><span class="line">&#123;</span><br><span class="line">        data_size = IntegerMax&lt;<span class="keyword">sizeof</span>(Types)...&gt;::value,</span><br><span class="line">        align_size = MaxAlign&lt;Types...&gt;::value</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">data_t</span> = <span class="keyword">typename</span> <span class="built_in">std</span>::aligned_storage&lt;data_size, align_size&gt;::type; <span class="comment">//å†…å­˜å¯¹é½çš„ç¼“å†²åŒºç±»å‹</span></span><br></pre></td></tr></table></figure>
<p>å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜è¦å®ç°å¯¹ç¼“å†²åŒºçš„æ„é€ ã€æ‹·è´ã€ææ„å’Œç§»åŠ¨ï¼Œå› ä¸ºVarianté‡æ–°èµ‹å€¼çš„æ—¶å€™éœ€è¦å°†ç¼“å†²åŒºä¸­åŸæ¥çš„ç±»å‹ææ„æ‰ï¼Œæ‹·è´æ„é€ å’Œç§»åŠ¨æ„é€ æ—¶åˆ™éœ€è¦æ‹·è´å’Œç§»åŠ¨ã€‚è¿™é‡Œä»¥ææ„ä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å½“å‰çš„type_indexæ¥éå†Variantçš„æ‰€æœ‰ç±»å‹ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç±»å‹ç„¶åè°ƒç”¨è¯¥ç±»å‹çš„ææ„å‡½æ•°ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">ã€€ã€€ <span class="function"><span class="keyword">void</span> <span class="title">Destroy</span><span class="params">(<span class="keyword">const</span> type_index&amp; index, <span class="keyword">void</span> * buf)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">std</span>::<span class="built_in">initializer_list</span>&lt;<span class="keyword">int</span>&gt;&#123;(Destroy0&lt;Types&gt;(index, buf), <span class="number">0</span>)...&#125;;</span><br><span class="line"> <span class="comment">//è¿™é‡Œé€šè¿‡ä¸€ä¸ªåˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ–ä¸€ä¸ªå˜é•¿æ•°ç»„ï¼Œintæ•°ç»„çš„ç›®çš„å°±æ˜¯ä¸ºäº†åœ¨æ•°ç»„æ„é€ çš„è¿‡ç¨‹å±•å¼€å‚æ•°åŒ…</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Destroy0</span><span class="params">(<span class="keyword">const</span> type_index&amp; id, <span class="keyword">void</span>* data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (id == type_index(<span class="keyword">typeid</span>(T)))</span><br><span class="line">        <span class="keyword">reinterpret_cast</span>&lt;T*&gt;(data)-&gt;~T();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨å’Œé€—å·è¡¨è¾¾å¼æ¥å±•å¼€å¯å˜æ¨¡æ¿å‚æ•°ï¼Œåœ¨å±•å¼€çš„è¿‡ç¨‹ä¸­æŸ¥æ‰¾å¯¹åº”çš„ç±»å‹ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™ææ„ã€‚åœ¨Variantæ„é€ æ—¶è¿˜éœ€è¦æ³¨æ„ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼ŒVariantä¸èƒ½æ¥å—æ²¡æœ‰é¢„å…ˆå®šä¹‰çš„ç±»å‹ï¼Œæ‰€ä»¥åœ¨æ„é€ Variantæ—¶ï¼Œéœ€è¦é™å®šç±»å‹å¿…é¡»åœ¨é¢„å®šä¹‰çš„ç±»å‹èŒƒå›´å½“ä¸­ï¼Œè¿™é‡Œé€šè¿‡type_traitsçš„enable_ifæ¥é™å®šæ¨¡æ¿å‚æ•°çš„ç±»å‹ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>,</span></span><br><span class="line"><span class="class">    <span class="title">class</span> = <span class="title">typename</span> <span class="title">std</span>:</span>:enable_if&lt;Contains&lt;<span class="keyword">typename</span> <span class="built_in">std</span>::remove_reference&lt;T&gt;::type, Types...&gt;::value&gt;::type&gt; Variant(T&amp;&amp; value) : m_typeIndex(<span class="keyword">typeid</span>(<span class="keyword">void</span>))&#123;</span><br><span class="line">            Destroy(m_typeIndex, &amp;m_data);</span><br><span class="line">            <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="built_in">std</span>::remove_reference&lt;T&gt;::type U;</span><br><span class="line">            <span class="keyword">new</span>(&amp;m_data) U(<span class="built_in">std</span>::forward&lt;T&gt;(value));</span><br><span class="line">            m_typeIndex = type_index(<span class="keyword">typeid</span>(U));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œenbale_ifçš„æ¡ä»¶å°±æ˜¯å‰é¢å®ç°çš„å…ƒå‡½æ•°Containsçš„å€¼ï¼Œå½“æ²¡æœ‰åœ¨é¢„å®šä¹‰çš„ç±»å‹ä¸­æ‰¾åˆ°å¯¹åº”çš„ç±»å‹æ—¶ï¼Œå³Containsè¿”å›falseæ—¶ï¼Œç¼–è¯‘æœŸä¼šæŠ¥ä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚</p>
<p>æœ€åè¿˜éœ€è¦å®ç°å†…ç½®çš„VistitåŠŸèƒ½ï¼ŒVisitçš„å®ç°éœ€è¦å…ˆé€šè¿‡å®šä¹‰ä¸€ç³»åˆ—çš„è®¿é—®å‡½æ•°ï¼Œç„¶åå†éå†è¿™äº›å‡½æ•°ï¼Œéå†è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹çš„type_indexæ˜¯å¦ä¸å½“å‰çš„type_indexç›¸åŒï¼Œå¦‚æœç›¸åŒåˆ™è·å–å½“å‰ç±»å‹çš„å€¼ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> F&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Visit</span><span class="params">(F&amp;&amp; f)</span></span>&#123;</span><br><span class="line">        <span class="keyword">using</span> T = <span class="keyword">typename</span> Function_Traits&lt;F&gt;::<span class="keyword">template</span> arg&lt;<span class="number">0</span>&gt;::type;</span><br><span class="line">        <span class="keyword">if</span> (Is&lt;T&gt;())</span><br><span class="line">            f(Get&lt;T&gt;());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> F, <span class="keyword">typename</span>... Rest&gt;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Visit</span><span class="params">(F&amp;&amp; f, Rest&amp;&amp;... rest)</span></span>&#123;</span><br><span class="line">        <span class="keyword">using</span> T = <span class="keyword">typename</span> Function_Traits&lt;F&gt;::<span class="keyword">template</span> arg&lt;<span class="number">0</span>&gt;::type;</span><br><span class="line">        <span class="keyword">if</span> (Is&lt;T&gt;())</span><br><span class="line">            Visit(<span class="built_in">std</span>::forward&lt;F&gt;(f));</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            Visit(<span class="built_in">std</span>::forward&lt;Rest&gt;(rest)...);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>VisitåŠŸèƒ½çš„å®ç°åˆ©ç”¨äº†å¯å˜æ¨¡æ¿å‚æ•°å’Œfunction_traitsï¼Œé€šè¿‡å¯å˜æ¨¡æ¿å‚æ•°æ¥éå†ä¸€ç³»åˆ—çš„è®¿é—®å‡½æ•°ï¼Œéå†è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡function_traitsæ¥è·å–ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹ï¼Œå’ŒVariantå½“å‰çš„type_indexç›¸åŒæ—¶åˆ™å–å€¼ã€‚ä¸ºä»€ä¹ˆè¦è·å–è®¿é—®å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹å‘¢ï¼Ÿå› ä¸ºVariantçš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥è·å–çš„è®¿é—®å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹å°±æ˜¯Variantä¸­å­˜å‚¨çš„å¯¹è±¡çš„å®é™…ç±»å‹ã€‚</p>
<p>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>C++</tag>
      </tags>
  </entry>
  <entry>
    <title>æºç è§£è¯»Linuxçš„limits.confæ–‡ä»¶</title>
    <url>/posts/%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BBLinux%E7%9A%84limits-conf%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<h1 id="å‰è¨€">å‰è¨€<a title="#å‰è¨€" href="#å‰è¨€"></a></h1>
<p>æœ¬æ–‡ä¸ä¸€å®šé€‚åˆæ¯”è¾ƒè€ç‰ˆæœ¬çš„Linuxï¼Œå¦‚æœåªå…³å¿ƒä½¿ç”¨ï¼Œè¯·ç›´æ¥çœ‹â€œæ€»ç»“â€ï¼Œæœ¬æ–‡ä¸»è¦é’ˆå¯¹CentOSï¼Œå…¶å®ƒLinuxå‘è¡Œç‰ˆæœ¬ç±»ä¼¼ï¼Œä½†ç»†èŠ‚å¯èƒ½æœ‰å‡ºå…¥ï¼Œæ¯”å¦‚é‡å¯æœåŠ¡å¯èƒ½ä¸æ˜¯ç”¨systemctlï¼Œè€Œæ˜¯serviceç­‰ã€‚</p>
<p>å½“éœ€è¦è°ƒæ•´ä¸€ä¸ªè¿›ç¨‹å¯æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æ•°æˆ–SOCKETè¿æ¥æ•°ç­‰ï¼Œä»¥CentOSä¸ºä¾‹ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ä¿®æ”¹æ–‡ä»¶/etc/security/limits.confï¼Œæ¯”å¦‚å°†æœ€å¤šå¯æ‰“å¼€æ•°è°ƒæ•´ä¸º10ä¸‡ï¼š</p>
 <a id="more"></a>
<h2 id="vi-/etc/security/limits.conf">vi /etc/security/limits.conf<a title="#vi-/etc/security/limits.conf" href="#vi-/etc/security/limits.conf"></a></h2>
<ul>
<li>soft nofile 100000</li>
<li>hard nofile 100000</li>
</ul>
<p>è¯»å–limit.confæ–‡ä»¶çš„å¹¶ä¸æ˜¯Linuxå†…æ ¸ï¼Œè€Œæ˜¯ä¸€ä¸ªå†…æ ¸æ¨¡å—PAMï¼Œå¯¹åº”çš„æ¨¡å—æ–‡ä»¶ä¸ºï¼š</p>
<p>/usr/lib64/security/pam_limits.so<br>
/usr/lib/security/pam_limits.so</p>
<p>è€Œ/etc/pam.dç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œåˆ™ç”±libpam.soè¯»å–ï¼Œå®é™…ä¸Šæ‰€æœ‰çš„æ¨¡å—å‡ç”±libpam.soåŠ è½½ï¼Œå¯å°†libpam.soçœ‹æˆæ˜¯æ‰€æœ‰PAMæ¨¡å—çš„æ¡†æ¶æˆ–å®¹å™¨ï¼Œè€Œä¸”libpam.soæœ¬èº«ä¹Ÿä¸æ˜¯å†…æ ¸çš„ç»„æˆéƒ¨åˆ†ã€‚</p>
<p>å¤šä¸ªä¸åŒLinuxç‰ˆæœ¬ä¸ŠæŸ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å«libpam.soçš„æ–‡ä»¶åï¼Œå‡æ˜¯libpam.so.0ï¼ˆä¸æ¸…æ¥šæ˜¯å¦æ‰€æœ‰éƒ½è¿™æ ·ï¼‰ï¼Œä½†æ˜¯ç¼–è¯‘Linux-PAM-1.3.1æºä»£ç æœ‰åä¸ºlibpam.soè½¯é“¾æ¥ï¼ŒæŒ‡å‘libpam.so.0.84.2ã€‚</p>
<p>/usr/lib64/libpam.so.0 -&gt; libpam.so.0.83.1<br>
/usr/lib64/libpam.so.0.83.1<br>
/usr/lib64/libpam_misc.so.0.82.0</p>
<p>/usr/lib/libpam.so.0 -&gt; libpam.so.0.83.1<br>
/usr/lib/libpam.so.0.83.1<br>
/usr/lib/libpam_misc.so.0.82.0</p>
<p>libpam.soä¼šè¢«åŠ è½½åˆ°crondç­‰è¿›ç¨‹ç©ºé—´ï¼ˆé‚£å½“ç„¶ä¹Ÿå¯ä»¥ä¸åŠ è½½ï¼‰ï¼Œ<a href="http://xn--libpam-2e4jv86bru3a8gb403az35h.so" target="_blank" rel="noopener">å¦‚æœæ²¡æœ‰åŠ è½½libpam.so</a>ï¼Œåˆ™limits.confä¸ä¼šç”Ÿæ•ˆã€‚<a href="http://xn--crondlibpam-5q8qwsr1hvztwdv051fb91c.so" target="_blank" rel="noopener">crondç­‰ä¸ä¼šä¸»åŠ¨åŠ è½½libpam.so</a>ï¼Œé‚£ä¹ˆæ˜¯è°è®©libpam.soè¿›å…¥crondç­‰è¿›ç¨‹ç©ºé—´çš„äº†ï¼Ÿï¼ˆæ‰§è¡Œâ€œgrep libpam /proc/<code>pidof crond</code>/mapsâ€å¯æŸ¥çœ‹libpamæ˜¯å¦åœ¨crondçš„è¿›ç¨‹ç©ºé—´ï¼‰ã€‚</p>
<p>åœ¨CentOSï¼Œå¯ç”¨serviceæ¥å¯åŠ¨æˆ–é‡å¯crondï¼Œæ‰€ä»¥è·Ÿå®ƒåº”å½“æ˜¯ç›¸å…³çš„ï¼Œè€Œserviceå®é™…è°ƒç”¨çš„æ˜¯systemctlè¿™ä¸€ç³»ç»Ÿå·¥å…·ï¼ˆéShellè„šæœ¬ï¼Œserviceä¸ºè€ç‰ˆæœ¬ä½¿ç”¨æ–¹å¼ï¼Œä½¿ç”¨systemctlå¯åŠ¨å’Œé‡å¯æœåŠ¡ï¼Œä½¿ç”¨æ–¹å¼å’Œserviceç›¸åŒï¼‰ã€‚</p>
<h2 id="service-crond-restart">service crond restart<a title="#service-crond-restart" href="#service-crond-restart"></a></h2>
<p>Redirecting to /bin/systemctl restart  crond.service</p>
<h2 id="file-/bin/systemctl">file /bin/systemctl<a title="#file-/bin/systemctl" href="#file-/bin/systemctl"></a></h2>
<p>/bin/systemctl: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV)</p>
<h2 id="systemctl-crond-restart-#-é‡å¯crontabæœåŠ¡è¿›ç¨‹crond">systemctl crond restart # é‡å¯crontabæœåŠ¡è¿›ç¨‹crond<a title="#systemctl-crond-restart-#-é‡å¯crontabæœåŠ¡è¿›ç¨‹crond" href="#systemctl-crond-restart-#-é‡å¯crontabæœåŠ¡è¿›ç¨‹crond"></a></h2>
<h1 id="pam">PAM<a title="#pam" href="#pam"></a></h1>
<p>PAMçš„å…¨ç§°ä¸ºâ€œPluggable Authentication Modulesâ€ï¼Œå³å¯æ’å…¥è®¤è¯æ¨¡å—ã€‚æœ€åˆç”±å¤ªé˜³å¾®ç³»ç»Ÿå…¬å¸ï¼ˆSun Microsystemsï¼Œå·²äº2009å¹´è¢«ç”²éª¨æ–‡æ”¶è´­ï¼‰äº1995å¹´åœ¨Solariså¼€å‘ã€‚PAMä»£ç ä¸åŒ…å«åœ¨Linuxå†…æ ¸ä¸­ï¼Œå¹¶æœ‰ä¸“é—¨çš„ç½‘ç«™ï¼š<a href="http://linux-pam.org/%EF%BC%8C%E6%BA%90%E4%BB%A3%E7%A0%81%E6%89%98%E7%AE%A1%E5%9C%A8Github%E4%B8%8A%EF%BC%88https://github.com/linux-pam/linux-pam/releases%EF%BC%89%E3%80%82" target="_blank" rel="noopener">http://linux-pam.org/ï¼Œæºä»£ç æ‰˜ç®¡åœ¨Githubä¸Šï¼ˆhttps://github.com/linux-pam/linux-pam/releasesï¼‰ã€‚</a></p>
<h1 id="pam_limits">pam_limits<a title="#pam_limits" href="#pam_limits"></a></h1>
<p>pam_limitsæ˜¯PAMå…¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼ˆæ¨¡å—æ–‡ä»¶åä¸ºpam_limits.soï¼‰ï¼Œä¹Ÿæ˜¯ç¨‹åºå‘˜æ¥è§¦è¾ƒå¤šçš„æ¨¡å‹ä¹‹ä¸€ï¼Œå¯¹åº”çš„æºä»£ç æ–‡ä»¶ä¸ºpam_limits.cï¼Œä»£ç è§„æ¨¡ä¸ºå‡ ç™¾è¡Œï¼ŒåŠ ä¸Šæ‰€æœ‰æ³¨é‡Šå’Œç©ºæ ¼æœ‰1100å¤šè¡Œï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">if</span> !defined(linux) &amp;&amp; !defined(__linux)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">warning</span> THIS CODE IS KNOWN TO WORK ONLY ON LINUX !!!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>æºä»£ç æä¾›autoconfç¼–è¯‘ï¼Œå°è¯•åœ¨Linux-3.10ä¸Šå¯ç¼–è¯‘æˆåŠŸï¼š</p>
<p>~/Linux-PAM-1.3.1]$ ./configure --prefix=/usr/local/Linux-PAM-1.3.1<br>
make</p>
<h1 id="limits.confçš„ç”±æ¥">limits.confçš„ç”±æ¥<a title="#limits.confçš„ç”±æ¥" href="#limits.confçš„ç”±æ¥"></a></h1>
<p>ç¡®å®šæ¨¡å—pam_limitsçš„é…ç½®æ–‡ä»¶ï¼Œç”±å®CONF_FILEå†³å®šï¼š</p>
<p>// pam_limits.c<br>
#define CONF_FILE (pl-&gt;conf_file != NULL)?pl-&gt;conf_file:LIMITS_FILE</p>
<p>ä½¿ç”¨çš„åœ°æ–¹ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pam_limits.c</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span></span><br><span class="line">parse_config_file(<span class="keyword">pam_handle_t</span> *pamh, <span class="keyword">const</span> <span class="keyword">char</span> *uname, <span class="keyword">uid_t</span> uid, <span class="keyword">gid_t</span> gid,</span><br><span class="line">     <span class="keyword">int</span> ctrl, struct pam_limit_s *pl)</span><br><span class="line">&#123;</span><br><span class="line">    FILE *fil;</span><br><span class="line">    <span class="keyword">char</span> buf[LINE_LENGTH];</span><br><span class="line"><span class="comment">/* check for the LIMITS_FILE */</span></span><br><span class="line"><span class="keyword">if</span> (ctrl &amp; PAM_DEBUG_ARG)</span><br><span class="line">    pam_syslog(pamh, LOG_DEBUG, <span class="string">"reading settings from '%s'"</span>, CONF_FILE);</span><br><span class="line">fil = fopen(CONF_FILE, <span class="string">"r"</span>); <span class="comment">// æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œè·Ÿå‚æ•°â€œplâ€æœ‰å…³ç³»</span></span><br><span class="line"><span class="keyword">if</span> (fil == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    pam_syslog (pamh, LOG_WARNING,</span><br><span class="line"><span class="string">"cannot read settings from %s: %m"</span>, CONF_FILE);</span><br><span class="line">    <span class="keyword">return</span> PAM_SERVICE_ERR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå‡½æ•°parse_config_fileçš„å‚æ•°â€œplâ€å€¼ä¸ºNULLï¼Œåˆ™é…ç½®æ–‡ä»¶ååœ¨ç¼–è¯‘æ—¶å†³å®šï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶åè¢«å›ºå®šä¸ºlimits.confï¼š</p>
<h2 id="makefile.am"><a href="http://Makefile.am" target="_blank" rel="noopener">Makefile.am</a><a title="#makefile.am" href="#makefile.am"></a></h2>
<p>modules/pam_limits/Makefile.am: -DLIMITS_FILE_DIR=&quot;$(limits_conf_dir)/*.conf&quot; <br>
modules/pam_limits/Makefile.am: -DLIMITS_FILE=&quot;$(SCONFIGDIR)/limits.conf&quot;</p>
<p>åªæ˜¯limits.confæ‰€åœ¨ç›®å½•å¯ç”±ç¼–è¯‘æ—¶å†³å®šï¼Œä¹Ÿå°±æ˜¯çœ‹SCONFIGDIRï¼Œå†³å®šåœ¨automakeçš„configure.acæ–‡ä»¶ï¼š</p>
<h2 id="configure.ac"><a href="http://configure.ac" target="_blank" rel="noopener">configure.ac</a><a title="#configure.ac" href="#configure.ac"></a></h2>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">AC_ARG_ENABLE(sconfigdir,</span><br><span class="line">        AS_HELP_STRING([--enable-sconfigdir=DIR],[path to <span class="keyword">module</span> conf files @&lt;:@<span class="keyword">default</span>=$sysconfdir/security@:&gt;@]),</span><br><span class="line">        SCONFIGDIR=$enableval, SCONFIGDIR=$sysconfdir/security)</span><br><span class="line">AC_SUBST(SCONFIGDIR)</span><br><span class="line"></span><br><span class="line">dnl <span class="keyword">and</span> some hacks to use /etc <span class="keyword">and</span> /lib</span><br><span class="line">test <span class="string">"$&#123;prefix&#125;"</span> = <span class="string">"NONE"</span> &amp;&amp; prefix=<span class="string">"/usr"</span></span><br><span class="line">if test $&#123;prefix&#125; = '/usr'</span><br><span class="line">then</span><br><span class="line">dnl If we use /usr as prefix, use /etc <span class="keyword">for</span> config files</span><br><span class="line">        if test $&#123;sysconfdir&#125; = '$&#123;prefix&#125;/etc'</span><br><span class="line">        then</span><br><span class="line">                sysconfdir=<span class="string">"/etc"</span></span><br><span class="line">        fi</span><br></pre></td></tr></table></figure>
<p>æ¨å¯¼å‡ºé»˜è®¤ä¸ºâ€œ/etc/security/limits.confâ€ï¼Œä½†ä»å‰é¢çš„åˆ†æï¼Œå¯çœ‹åˆ°å®é™…è¿˜å¯å‚æ•°åŠ¨æ€æŒ‡å®šï¼Œè¿™ä¸ªå‚æ•°æ€ä¹ˆæ¥ï¼Ÿå¯è¿›å…¥Linuxçš„/etc/pam.dç›®å½•ï¼Œæ‰¾ä¸€ä¸ªçœ‹ä¸€çœ‹ï¼š</p>
<h2 id="vi-/etc/pam.d/login">vi /etc/pam.d/login<a title="#vi-/etc/pam.d/login" href="#vi-/etc/pam.d/login"></a></h2>
<p>session    required     pam_selinux.so close<br>
session    required     pam_selinux.so open</p>
<p>ä¸Šè¿°æœ€åä¸€ä¸ªé…ç½®é¡¹å³ä¸ºæ¨¡å‹çš„å‚æ•°å€¼ï¼Œå‚æ•°å€¼å¯æœ‰0ã€ä¸€ä¸ªæˆ–å¤šä¸ªã€‚é€šå¸¸pam_limits.soä½¿ç”¨é»˜è®¤å‚æ•°å€¼ï¼Œå› æ­¤å®ƒçš„é…ç½®æ–‡ä»¶limits.confå®Œæ•´è·¯å¾„ä¸ºï¼š/etc/security/limits.confã€‚</p>
<h1 id="æ¨¡å—å…¥å£å‡½æ•°">æ¨¡å—å…¥å£å‡½æ•°<a title="#æ¨¡å—å…¥å£å‡½æ•°" href="#æ¨¡å—å…¥å£å‡½æ•°"></a></h1>
<p>ä¼šè¯ï¼ˆSessionï¼‰ç±»çš„PAMæ¨¡å—çš„å…¥å£å‡½æ•°å‡ä¸ºpam_sm_open_sessionï¼ˆæˆæƒç±»çš„ä¸ºpam_sm_authenticateï¼Œå¯†ç ç±»çš„ä¸ºpam_sm_chauthtokï¼‰ï¼Œæ„ä¸ºåˆ›å»ºï¼ˆæ‰“å¼€ï¼‰ä¸€ä¸ªä¼šè¯ï¼š</p>
<p>int<br>
pam_sm_open_session (pam_handle_t *pamh, int flags UNUSED, int argc, const char **argv);<br>
// libpam/pam_handlers.c:  sym = â€œpam_sm_open_sessionâ€;</p>
<p>åŠ è½½æ¨¡å—åœ¨pam_handlers.cä¸­å®Œæˆï¼Œå®é™…ä¸Šä¸€ä¸ªæ¨¡å—å¯åŠ è½½å¤šæ¬¡ï¼ˆå¯åœ¨/etc/securityä¸‹çœ‹åˆ°æœ‰äº›é…ç½®æ–‡ä»¶ä¸­åŒä¸€æ¨¡å‹æœ‰å¤šè¡Œï¼‰ã€‚ç±»ä¼¼äºiptablesï¼Œæ¯åŠ è½½ä¸€æ¬¡åˆ›å»ºä¸€ä¸ªhandlerï¼Œä¾æ¬¡ç»„æˆä¸€ä¸ªhandlerè°ƒç”¨é“¾ï¼ˆå®é™…ç”±é…ç½®æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œé…ç½®ç»„æˆé“¾ï¼‰ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pam_handlers.c</span></span><br><span class="line"><span class="comment">// è¢«_pam_parse_conf_fileç›´æ¥è°ƒç”¨ï¼Œ</span></span><br><span class="line"><span class="comment">// å’Œè¢«_pam_init_handlersã€_pam_load_conf_fileä¸€çº§é—´æ¥è°ƒç”¨</span></span><br><span class="line"><span class="keyword">int</span> _pam_add_handler(<span class="keyword">pam_handle_t</span> *pamh</span><br><span class="line">     , <span class="keyword">int</span> handler_type, <span class="keyword">int</span> other, <span class="keyword">int</span> stack_level, <span class="keyword">int</span> type</span><br><span class="line">     , <span class="keyword">int</span> *actions, <span class="keyword">const</span> <span class="keyword">char</span> *mod_path</span><br><span class="line">     , <span class="keyword">int</span> argc, <span class="keyword">char</span> **argv, <span class="keyword">int</span> argvlen)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">loaded_module</span> *<span class="title">mod</span> = <span class="title">NULL</span>;</span></span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="keyword">if</span> ((handler_type == PAM_HT_MODULE ||</span><br><span class="line">         handler_type == PAM_HT_SILENT_MODULE) &amp;&amp;</span><br><span class="line">        mod_path != <span class="literal">NULL</span>) &#123;</span><br><span class="line"><span class="keyword">if</span> (mod_path[<span class="number">0</span>] == <span class="string">'/'</span>) &#123;</span><br><span class="line">    mod = _pam_load_module(pamh, mod_path, handler_type);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (asprintf(&amp;mod_full_path, <span class="string">"%s%s"</span>,</span><br><span class="line">     DEFAULT_MODULE_PATH, mod_path) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">    mod = _pam_load_module(pamh, mod_full_path, handler_type);</span><br><span class="line">    _pam_drop(mod_full_path);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    pam_syslog(pamh, LOG_CRIT, <span class="string">"cannot malloc full mod path"</span>);</span><br><span class="line">    <span class="keyword">return</span> PAM_ABORT;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (mod == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    <span class="comment">/* if we get here with NULL it means allocation error */</span></span><br><span class="line">    <span class="keyword">return</span> PAM_ABORT;</span><br><span class="line">&#125;</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">        <span class="comment">/* point handler_p's at the root addresses of the function stacks */</span></span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">        <span class="keyword">case</span> PAM_T_SESS:</span><br><span class="line">            handler_p = &amp;the_handlers-&gt;open_session;</span><br><span class="line">            sym = <span class="string">"pam_sm_open_session"</span>;</span><br><span class="line">            handler_p2 = &amp;the_handlers-&gt;close_session;</span><br><span class="line">            sym2 = <span class="string">"pam_sm_close_session"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">if</span> ((mod_type == PAM_MT_DYNAMIC_MOD) &amp;&amp;</span><br><span class="line">    !(func = _pam_dlsym(mod-&gt;dl_handle, sym)) ) &#123;</span><br><span class="line">    pam_syslog(pamh, LOG_ERR, <span class="string">"unable to resolve symbol: %s"</span>, sym);</span><br><span class="line">&#125;</span><br><span class="line">ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯ä¸ªæ¨¡å—çš„ç»“æœå¯èƒ½æ˜¯æˆåŠŸPAM_SUCCESS(0)ï¼Œå…¨å®šä¹‰åœ¨æ–‡ä»¶libpam/include/security/_pam_types.hä¸­ï¼Œä¸‹åˆ—å±•ç¤ºå°éƒ¨åˆ†ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* ----------------- The Linux-PAM return values ------------------ */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAM_SUCCESS 0 <span class="comment">/* Successful function return */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAM_OPEN_ERR 1 <span class="comment">/* dlopen() failure when dynamically */</span></span></span><br><span class="line"><span class="comment">/* loading a service module */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAM_SYMBOL_ERR 2 <span class="comment">/* Symbol not found */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAM_SERVICE_ERR 3 <span class="comment">/* Error in service module */</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PAM_SYSTEM_ERR 4 <span class="comment">/* System error */</span></span></span><br></pre></td></tr></table></figure>
<h1 id="è§£ælimits.conf">è§£ælimits.conf<a title="#è§£ælimits.conf" href="#è§£ælimits.conf"></a></h1>
<p>é‡èšç„¦åˆ°pam_limitsæ¨¡å—ï¼Œçœ‹çœ‹å®ƒçš„é…ç½®æ–‡ä»¶è§£æï¼Œè¿™å‘ç”Ÿåœ¨å‡½æ•°pam_limits.cä¸­çš„parse_config_fileå‡½æ•°ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pam_limits.c</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">int</span></span><br><span class="line">parse_config_file(<span class="keyword">pam_handle_t</span> *pamh, <span class="keyword">const</span> <span class="keyword">char</span> *uname, <span class="keyword">uid_t</span> uid, <span class="keyword">gid_t</span> gid,</span><br><span class="line">     <span class="keyword">int</span> ctrl, struct pam_limit_s *pl)</span><br><span class="line">&#123;</span><br><span class="line">    FILE *fil;</span><br><span class="line">    <span class="keyword">char</span> buf[LINE_LENGTH]; <span class="comment">// #define LINE_LENGTH 1024</span></span><br><span class="line">    <span class="comment">// ä»¥åªè¯»æ–¹å¼æ‰“å¼€limits.conf</span></span><br><span class="line">		fil = fopen(CONF_FILE, <span class="string">"r"</span>);</span><br><span class="line">		<span class="keyword">if</span> (fil == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    pam_syslog (pamh, LOG_WARNING,</span><br><span class="line"><span class="string">"cannot read settings from %s: %m"</span>, CONF_FILE);</span><br><span class="line">    <span class="keyword">return</span> PAM_SERVICE_ERR;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* start the show */</span></span><br><span class="line"><span class="comment">// ä¸€è¡Œè¡Œéå†limits.conf</span></span><br><span class="line"><span class="keyword">while</span> (fgets(buf, LINE_LENGTH, fil) != <span class="literal">NULL</span>) &#123;</span><br><span class="line">    line = buf;</span><br><span class="line">    <span class="comment">/* skip the leading white space */</span></span><br><span class="line">    <span class="keyword">while</span> (*line &amp;&amp; <span class="built_in">isspace</span>(*line)) <span class="comment">// è·³è¿‡ç©ºè¡Œ</span></span><br><span class="line">        line++;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">/* Rip off the comments */</span></span><br><span class="line">    tptr = <span class="built_in">strchr</span>(line,<span class="string">'#'</span>); <span class="comment">// å»æ‰æ³¨é‡Š</span></span><br><span class="line">    <span class="keyword">if</span> (tptr)</span><br><span class="line">        *tptr = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="comment">/* Rip off the newline char */</span></span><br><span class="line">    tptr = <span class="built_in">strchr</span>(line,<span class="string">'\n'</span>); <span class="comment">// åˆ é™¤æ¢è¡Œç¬¦ï¼Œæ³¨æ„å¹¶ä¸åŒ…æ‹¬å›è½¦ç¬¦</span></span><br><span class="line">    <span class="keyword">if</span> (tptr)</span><br><span class="line">        *tptr = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="comment">/* Anything left ? */</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">strlen</span>(line)) <span class="comment">// ç»è¿‡ä¸Šé¢å‡ æ­¥æŠ˜è…¾ï¼Œå¯èƒ½æˆäº†ç©ºè¡Œ</span></span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ç›´æ¥è°ƒç”¨sscanfè§£æé…ç½®é¡¹</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// é…ç½®è¡Œç¤ºä¾‹ï¼š</span></span><br><span class="line">    <span class="comment">// * soft nofile 100000</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// domainï¼šä½œç”¨åŸŸåï¼Œâ€œ*â€è¡¨ç¤ºå¯¹æ‰€æœ‰ç”¨æˆ·æœ‰æ•ˆ</span></span><br><span class="line">    i = <span class="built_in">sscanf</span>(line,<span class="string">"%s%s%s%s"</span>, domain, ltype, item, value);</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="comment">// ä¸‹é¢åªçœ‹ä¸¤ä¸ªå¸¸ç”¨é…ç½®ï¼šdomainé…ç½®ä¸ºâ€œ*â€æˆ–æŒ‡å®šçš„ç”¨æˆ·å</span></span><br><span class="line">    <span class="comment">// å¯ä»¥çœ‹åˆ°åœ¨åŠ è½½limits.confï¼Œä¸»è¦æ˜¯è®¾ç½®è¾“å‡ºå‚æ•°plçš„å€¼ã€‚</span></span><br><span class="line">    <span class="comment">// è€Œparse_config_fileç”±pam_sm_open_sessionè°ƒç”¨ï¼Œäº¦å³æ¨¡å—è¢«åŠ è½½æ—¶è¢«è°ƒç”¨ã€‚</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// ä¹Ÿå› æ­¤ä¿®æ”¹limits.confæ˜¯ä¸èƒ½ç«‹å³ç”Ÿæ•ˆçš„ï¼Œ</span></span><br><span class="line">    <span class="comment">// é™¤éé‡å¯è¯¥è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹åˆç»§æ‰¿çˆ¶è¿›ç¨‹çš„è®¾ç½®ã€‚</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// å‡è®¾ç¨‹åºè·‘åœ¨crontabä¸­ï¼Œåˆ™åº”é‡å¯crondè¿›ç¨‹ï¼Œ</span></span><br><span class="line">    <span class="comment">// æ¯”å¦‚CentOSä¸­é‡å¯crondï¼šservice crond restart</span></span><br><span class="line">    <span class="comment">// è™½ç„¶crontabä¸­çš„è¿›ç¨‹æ˜¯ç”±crondæ‹‰èµ·æ¥çš„ï¼Œä½†å®ƒå¹¶åŠ è½½PAMæ¨¡å—ï¼Œ</span></span><br><span class="line">    <span class="comment">// åŸå› æ˜¯crondåœ¨æ‹‰èµ·å­è¿›ç¨‹æ—¶ï¼Œå¯¹å­è¿›ç¨‹å…³é—­äº†æ‰€æœ‰æè¿°ç¬¦ã€‚</span></span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="comment">// process_limité’ˆå¯¹å½“å‰è°ƒç”¨è¿›ç¨‹è¿›è¡Œlimitè®¾ç½®</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(domain, <span class="string">"*"</span>) == <span class="number">0</span>)</span><br><span class="line">        <span class="comment">// limit was set by a default entry</span></span><br><span class="line">        process_limit(pamh, LIMITS_DEF_DEFAULT, ltype, item, value, ctrl, pl);</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚        </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(uname, domain) == <span class="number">0</span>) <span class="comment">/* this user have a limit */</span></span><br><span class="line">        <span class="comment">// limit was set by an user entry</span></span><br><span class="line">        process_limit(pamh, LIMITS_DEF_USER, ltype, item, value, ctrl, pl);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="ç”Ÿæ•ˆlimits.conf">ç”Ÿæ•ˆlimits.conf<a title="#ç”Ÿæ•ˆlimits.conf" href="#ç”Ÿæ•ˆlimits.conf"></a></h1>
<p>åŠ è½½PAMæ¨¡å—æ—¶ï¼Œå³ä¼šç”Ÿæ•ˆlimits.confï¼Œå› ä¸ºè¿™ä¸ªåœ¨pam_sm_open_sessionå°±å·²æ‰§è¡Œäº†ï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* now the session stuff */</span></span><br><span class="line"><span class="keyword">int</span></span><br><span class="line">pam_sm_open_session (<span class="keyword">pam_handle_t</span> *pamh, <span class="keyword">int</span> flags UNUSED,</span><br><span class="line">     <span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">pam_limit_s</span> <span class="title">plstruct</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">pam_limit_s</span> *<span class="title">pl</span> = &amp;<span class="title">plstruct</span>;</span></span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="comment">// è°ƒç”¨parse_config_fileè§£ælimits.confï¼Œ</span></span><br><span class="line">    <span class="comment">// é…ç½®è¡Œè§£æç»“æœå­˜å‚¨åœ¨plä¸­ï¼ˆäº¦å³plstructï¼‰</span></span><br><span class="line">    retval = parse_config_file(pamh, pwd-&gt;pw_name, pwd-&gt;pw_uid, pwd-&gt;pw_gid, ctrl, pl);</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="comment">// ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆï¼ˆsetup_limitsè°ƒç”¨ç³»ç»Ÿå‡½æ•°setrlimitï¼‰</span></span><br><span class="line">    retval = setup_limits(pamh, pwd-&gt;pw_name, pwd-&gt;pw_uid, ctrl, pl);</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="keyword">return</span> PAM_SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¨¡å—pam_limits.soæ˜¯ç”±PAMæ¨¡å—libpam.soåŠ è½½çš„ï¼Œ<a href="http://xn--crondlibpam-n79r87k2w8f2gvcrr1e.so" target="_blank" rel="noopener">crondåŠ è½½çš„åªæ˜¯libpam.so</a>ã€‚â€œ/etc/pam.dâ€ç›®å½•ä¸‹çš„æ–‡ä»¶ä»€ä¹ˆæ—¶å€™ç”Ÿæ•ˆï¼ŸåŠ è½½libpam.soæ—¶ç”Ÿæ•ˆï¼š</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// pam_start.c</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">pam_start</span> <span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> <span class="keyword">char</span> *service_name,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> <span class="keyword">char</span> *user,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> struct pam_conv *pam_conversation,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">pam_handle_t</span> **pamh)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="keyword">if</span> ( _pam_init_handlers(*pamh) != PAM_SUCCESS ) &#123;</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pam_handlers.c</span></span><br><span class="line"><span class="keyword">int</span> _pam_init_handlers(<span class="keyword">pam_handle_t</span> *pamh)</span><br><span class="line">&#123;</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">    <span class="comment">// å‡½æ•°_pam_parse_conf_fileè´Ÿè´£è§£ælibpam.soçš„é…ç½®æ–‡ä»¶ï¼Œ</span></span><br><span class="line">    <span class="comment">// è¿™äº›é…ç½®æ–‡ä»¶ä¸€èˆ¬ä½äºç›®å½•/etc/pam.dä¸‹ï¼Œå¦‚ï¼š</span></span><br><span class="line">    <span class="comment">// # ls -l /etc/pam.d/pass*</span></span><br><span class="line">    <span class="comment">// -rw-r--r-- 1 root root 188 6æœˆ  10 2014 /etc/pam.d/passwd</span></span><br><span class="line">    <span class="comment">// -rw-r--r-- 1 root root 974 12æœˆ 29 2016 /etc/pam.d/password-auth</span></span><br><span class="line">    retval = _pam_parse_conf_file(pamh, f, <span class="literal">NULL</span>, PAM_T_ANY, <span class="number">0</span>);</span><br><span class="line">    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="systemctlå’Œsystemd">systemctlå’Œsystemd<a title="#systemctlå’Œsystemd" href="#systemctlå’Œsystemd"></a></h1>
<p>CentOSä¸Šçš„systemctlï¼ˆCentOS-7.Xä¹‹å‰ä¸ºserviceè„šæœ¬ï¼‰ç±»ä¼¼äºWindowså¹³å°çš„æœåŠ¡ç®¡ç†å™¨ï¼Œæ›¿ä»£è€ç‰ˆæœ¬ä¸­çš„serviceè„šæœ¬æ¥ç®¡ç†æœåŠ¡ã€‚SystemctlåŠŸèƒ½éå¸¸å¤šï¼Œæœ‰å…³systemctlçš„åŠŸèƒ½ä¸åœ¨æœ¬æ–‡è¿‡å¤šæè¿°ã€‚</p>
<p>sytemctlçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡ä¸æœåŠ¡systemdäº¤äº’ï¼Œæ¥å®Œæˆå„é¡¹å·¥ä½œï¼Œæ¯”å¦‚é‡å¯crondè¿›ç¨‹ã€‚åœ¨CentOSï¼Œsystemctlæ›¿ä»£äº†inittabã€‚</p>
<p>å¯ä»¥çœ‹åˆ°æ­£æ˜¯systemdåŠ è½½äº†pamï¼Œä»lddç»“æœå¯ä»¥çœ‹å‡ºsystemdä¹Ÿä¸æ˜¯åŠ¨æ€åŠ è½½pamæ¨¡å—ï¼Œè€Œæ˜¯ç¼–è¯‘æ—¶å°±ç»‘å®šäº†ï¼Œå› æ­¤libpam.soæˆäº†ç³»ç»Ÿçš„å¿…é¡»éƒ¨åˆ†ï¼ˆä½†pam_limits.soä»ç„¶ä¸æ˜¯ï¼Œæ€»æ˜¯å¯æ’æ‹”ï¼‰ï¼š</p>
<h2 id="ldd-/usr/lib/systemd/systemd">ldd /usr/lib/systemd/systemd<a title="#ldd-/usr/lib/systemd/systemd" href="#ldd-/usr/lib/systemd/systemd"></a></h2>
<pre><code>    linux-vdso.so.1 =&gt;  (0x00007ffce5b72000)
    /$LIB/libonion.so =&gt; /lib64/libonion.so (0x00007f2430f56000)
    libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007f2430d31000)
    libcap.so.2 =&gt; /lib64/libcap.so.2 (0x00007f2430b2c000)
    libpam.so.0 =&gt; /lib64/libpam.so.0 (0x00007f243091d000)
    libaudit.so.1 =&gt; /lib64/libaudit.so.1 (0x00007f24306f5000)
    libkmod.so.2 =&gt; /lib64/libkmod.so.2 (0x00007f24304df000)
    libmount.so.1 =&gt; /lib64/libmount.so.1 (0x00007f24302a0000)
    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007f2430098000)
    libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007f242fe82000)
    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f242fc66000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f242f8a2000)
    /lib64/ld-linux-x86-64.so.2 (0x00007f243105c000)
    libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007f242f69e000)
    libpcre.so.1 =&gt; /lib64/libpcre.so.1 (0x00007f242f43d000)
    liblzma.so.5 =&gt; /lib64/liblzma.so.5 (0x00007f242f218000)
    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f242f013000)
    libcap-ng.so.0 =&gt; /lib64/libcap-ng.so.0 (0x00007f242ee0d000)
    libz.so.1 =&gt; /lib64/libz.so.1 (0x00007f242ebf7000)
    libblkid.so.1 =&gt; /lib64/libblkid.so.1 (0x00007f242e9ba000)
    libuuid.so.1 =&gt; /lib64/libuuid.so.1 (0x00007f242e7b5000)
</code></pre>
<h2 id="ldd-/usr/sbin/crond">ldd /usr/sbin/crond<a title="#ldd-/usr/sbin/crond" href="#ldd-/usr/sbin/crond"></a></h2>
<pre><code>    linux-vdso.so.1 =&gt;  (0x00007ffef31a5000)
    /$LIB/libonion.so =&gt; /lib64/libonion.so (0x00007f87b89e5000)
    libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007f87b8416000)
    libpam.so.0 =&gt; /lib64/libpam.so.0 (0x00007f87b8207000)
    libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007f87b8003000)
    libaudit.so.1 =&gt; /lib64/libaudit.so.1 (0x00007f87b7ddb000)
    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f87b7a17000)
    libpcre.so.1 =&gt; /lib64/libpcre.so.1 (0x00007f87b77b6000)
    liblzma.so.5 =&gt; /lib64/liblzma.so.5 (0x00007f87b7591000)
    /lib64/ld-linux-x86-64.so.2 (0x00007f87b88cc000)
    libcap-ng.so.0 =&gt; /lib64/libcap-ng.so.0 (0x00007f87b738b000)
    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f87b716f000)
</code></pre>
<p>å®é™…ä¸Šï¼Œsystemdä¸ºLinuxç³»ç»Ÿï¼ˆCentOSå¦‚æ­¤ï¼ŒåƒUbuntuæœªå¿…ï¼‰çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œå–ä»£äº†ä»¥å‰çš„initè¿›ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°systemdè¿›ç¨‹å’Œinitè¿›ç¨‹ä¸ä¼šåŒæ—¶å­˜åœ¨ï¼Œä½ç‰ˆæœ¬ä¸ºinitï¼Œé«˜ç‰ˆæœ¬ä¸ºsystemdã€‚Ubuntuä½¿ç”¨çš„æ˜¯upstartï¼Œä½†ä¹Ÿå¯èƒ½ç”¨systemdæ›¿ä»£upstartã€‚</p>
<p>åœ¨systemdæºä»£ç çš„ç¼–è¯‘æ–‡ä»¶meson.buildï¼ˆç±»ä¼¼äºCMakeçš„CMakeLists.txtæ–‡ä»¶ï¼Œæˆ–bazelçš„BUILDæ–‡ä»¶ï¼‰ä¸­å¯ä»¥çœ‹åˆ°systemdå¯¹libpamçš„ä¾èµ–ã€‚</p>
<p>systemctléƒ¨åˆ†ç”¨æ³•ï¼š</p>
<ol>
<li>é‡å¯crond</li>
</ol>
<h2 id="systemctl-restart-crond">systemctl restart crond<a title="#systemctl-restart-crond" href="#systemctl-restart-crond"></a></h2>
<ol start="2">
<li>æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€</li>
</ol>
<h2 id="systemctl-status">systemctl status<a title="#systemctl-status" href="#systemctl-status"></a></h2>
<p>â— Jian.mooon<br>
State: degraded<br>
Jobs: 0 queued<br>
Failed: 2 units<br>
Since: äºŒ 2017-10-24 02:38:50 CST; 1 years 3 months ago<br>
CGroup: /<br>
ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<ol start="3">
<li>é‡å¯ç³»ç»Ÿ</li>
</ol>
<h2 id="systemctl-reboot">systemctl reboot<a title="#systemctl-reboot" href="#systemctl-reboot"></a></h2>
<ol start="4">
<li>å…³é—­ç”µæº</li>
</ol>
<h2 id="systemctl-poweroff">systemctl poweroff<a title="#systemctl-poweroff" href="#systemctl-poweroff"></a></h2>
<ol start="5">
<li>å¾…æœº</li>
</ol>
<h2 id="systemctl-suspend">systemctl suspend<a title="#systemctl-suspend" href="#systemctl-suspend"></a></h2>
<ol start="6">
<li>ä¼‘çœ </li>
</ol>
<h2 id="systemctl-hibernate">systemctl hibernate<a title="#systemctl-hibernate" href="#systemctl-hibernate"></a></h2>
<p>æœ‰å…³systemctlçš„æ›´å¤šä¿¡æ¯ï¼Œå¯æµè§ˆï¼š</p>
<p><a href="https://wiki.archlinux.org/index.php/systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)%E3%80%82" target="_blank" rel="noopener">https://wiki.archlinux.org/index.php/systemd_(ç®€ä½“ä¸­æ–‡)ã€‚</a></p>
<h1 id="æ€»ç»“">æ€»ç»“<a title="#æ€»ç»“" href="#æ€»ç»“"></a></h1>
<p>ä¿®æ”¹limits.confä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œé™¤éé‡å¯ç›¸å…³çš„çˆ¶è¿›ç¨‹ï¼Œæ¯”å¦‚crontabçš„crondï¼Œè€Œæœ‰äº›è€ç‰ˆæœ¬çš„Linuxå¯èƒ½åªèƒ½é‡å¯ä»¥ç”Ÿæ•ˆã€‚</p>
<ol>
<li>
<p>ç³»ç»Ÿå¯åŠ¨ -&gt; å¯åŠ¨åˆå§‹åŒ–è¿›ç¨‹systemd -&gt; è¿›ç¨‹sytemdåŠ è½½libpam.soæ¨¡å—</p>
</li>
<li>
<p>libpam.soæ ¹æ®/etc/pam.då†³å®šæ˜¯å¦åŠ è½½pam_limits.soç­‰</p>
</li>
<li>
<p>åœ¨åŠ è½½pam_limits.soæ—¶ï¼Œä¼šè¯»å–/etc/security/limits.conf</p>
</li>
<li>
<p>é‡å¯crondç­‰ï¼Œå®é™…æ˜¯å‘systemdå‘é‡å¯æŒ‡ä»¤</p>
</li>
<li>
<p>ä¸€å¥è¯ï¼šå¦‚æœè¦ä½¿ç”¨limits.confç”Ÿæ•ˆï¼Œä¸€å®šè¦æœ‰åŠ è½½pam_limits.soï¼Œå¦‚æœä¿®æ”¹limits.confï¼Œè‡³å°‘è¦è®©pam_limits.soé‡è¯»limits.confã€‚<br>
é™„1ï¼šèµ„æº</p>
</li>
<li>
<p>PAMå®˜æ–¹</p>
</li>
</ol>
<p><a href="http://linux-pam.org/" target="_blank" rel="noopener">http://linux-pam.org/</a></p>
<ol start="2">
<li>PAMæºä»£ç </li>
</ol>
<p><a href="https://github.com/linux-pam/linux-pam/releases" target="_blank" rel="noopener">https://github.com/linux-pam/linux-pam/releases</a></p>
<ol start="3">
<li>systemdæºä»£ç </li>
</ol>
<p><a href="https://github.com/systemd/systemd%EF%BC%88%E4%BD%BF%E7%94%A8meson%E7%BC%96%E8%AF%91%EF%BC%8CMeson" target="_blank" rel="noopener">https://github.com/systemd/systemdï¼ˆä½¿ç”¨mesonç¼–è¯‘ï¼ŒMeson</a> is an open source build systemï¼Œä¾èµ–ninjaï¼‰</p>
<ol start="4">
<li>Vixie-cronæºä»£ç </li>
</ol>
<p><a href="http://ftp.isc.org/isc/cron/" target="_blank" rel="noopener">http://ftp.isc.org/isc/cron/</a></p>
<p><a href="https://github.com/svagner/vixie-cron" target="_blank" rel="noopener">https://github.com/svagner/vixie-cron</a></p>
<p><a href="ftp://ftp.riken.jp/Linux/cern/updates/slc52/SRPMS/repoview/vixie-cron.html">ftp://ftp.riken.jp/Linux/cern/updates/slc52/SRPMS/repoview/vixie-cron.html</a></p>
<p>é™„2ï¼šç¼–è¯‘ninja</p>
<p>ninjaç±»ä¼¼äºmakeï¼Œä½¿ç”¨mesonä¹‹å‰å¿…é¡»å…ˆå‡†å¤‡å¥½ninjaã€‚</p>
<ol>
<li>
<p>ä»https://github.com/ninja-build/ninjaä¸‹è½½ninjaæºä»£ç </p>
</li>
<li>
<p>è§£å‹æºä»£ç åŒ…ï¼Œç„¶åè¿›å…¥è§£å‹åçš„ç›®å½•</p>
</li>
<li>
<p>æ‰§è¡Œâ€œ./configure.py --bootstrapâ€</p>
</li>
<li>
<p>æˆåŠŸåä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆåä¸ºninjaçš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶</p>
</li>
<li>
<p>å°†å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶å¤åˆ¶åˆ°PATHç›®å½•ä¸‹ï¼Œæ¯”å¦‚ï¼š/usr/local/binæˆ–/usr/binç­‰ç›®å½•</p>
</li>
<li>
<p>å®Œæˆã€‚</p>
</li>
</ol>
<p>é™„3ï¼šä½¿ç”¨mesonç¼–è¯‘systemd</p>
<p>Meson-0.49.1è¦æ±‚3.5æˆ–æ›´é«˜ç‰ˆæœ¬çš„Pythonï¼ˆ<a href="https://www.python.org/%EF%BC%89%EF%BC%8C%E5%92%8C1.5%E6%88%96%E6%9B%B4%E9%AB%98%E7%89%88%E6%9C%AC%E7%9A%84Ninja%EF%BC%8C%E8%BF%98%E4%BE%9D%E8%B5%96gperf%EF%BC%88%E7%AE%80%E5%8D%95%E5%AE%89%E8%A3%85%EF%BC%9Ayum" target="_blank" rel="noopener">https://www.python.org/ï¼‰ï¼Œå’Œ1.5æˆ–æ›´é«˜ç‰ˆæœ¬çš„Ninjaï¼Œè¿˜ä¾èµ–gperfï¼ˆç®€å•å®‰è£…ï¼šyum</a> install -y gperfï¼‰ï¼Œè¿˜ä¾èµ–libcap-devï¼ˆæ‰§è¡Œyum install -y libcapå®‰è£…ï¼Œå¦‚æœä»ç„¶ä¸è¡Œï¼Œä»https://git.kernel.org/pub/scm/linux/kernel/git/morgan/libcap.git/ä¸‹è½½æºä»£ç å®‰è£…ï¼‰ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„ä¾èµ–ï¼Œéœ€é€ä¸ªè§£å†³ã€‚</p>
<ol>
<li>
<p>ä»https://github.com/mesonbuild/mesonä¸‹è½½mesonæºä»£ç </p>
</li>
<li>
<p>è§£å‹åï¼Œå°†mesonç›®å½•æ·»åŠ åˆ°PATHä¸­ï¼Œæ¯”å¦‚ï¼šexport PATH=/root/X/meson-0.49.1:$PATH</p>
</li>
<li>
<p>è¿›å…¥systemdæºä»£ç ç›®å½•</p>
</li>
<li>
<p>æ‰§è¡Œâ€œ<a href="http://meson.py" target="_blank" rel="noopener">meson.py</a> buildâ€ï¼ˆå¦‚æœå‡ºé”™ï¼Œå¯èƒ½æ˜¯Pythonç‰ˆæœ¬ä¸å¤Ÿï¼‰</p>
</li>
<li>
<p>æˆåŠŸåä¼šç”Ÿæˆbuildå­ç›®å½•</p>
</li>
<li>
<p>è¿›å…¥buildç›®å½•ï¼Œæ‰§è¡Œninjaå¼€å§‹ç¼–è¯‘ï¼ˆninjaç±»ä¼¼äºmakeï¼‰</p>
</li>
</ol>
<p>é™„4ï¼šå®‰è£…Python-3.7.2</p>
<p>Python-3.7.2é‡‡ç”¨automakeç¼–è¯‘ï¼š</p>
<ol>
<li>
<p>æ‰§è¡Œconfigureç”ŸæˆMakefileæ–‡ä»¶ï¼š./configure --prefix=/usr/local/Python-3.7.2</p>
</li>
<li>
<p>æ‰§è¡Œmakeå¼€å§‹ç¼–è¯‘Pythonï¼ˆç¼–è¯‘æ—¶é—´ä¼šæœ‰ç‚¹é•¿ï¼‰</p>
</li>
<li>
<p>æ‰§è¡Œmake installï¼Œå®‰è£…Pythonï¼ˆå®‰è£…æ—¶é—´ç¨æœ‰ç‚¹é•¿ï¼‰</p>
</li>
<li>
<p>å°†Pythonçš„binç›®å½•åŠ å…¥åˆ°PATHä¸­ï¼Œå¦‚ï¼šexport PATH=/usr/local/Python-3.7.2/bin:$PATH</p>
</li>
<li>
<p>å¯ä»¥å¼€å§‹ä½¿ç”¨Python-3.7.2äº†ã€‚</p>
</li>
</ol>
<p>å¦‚æœé‡åˆ°é”™è¯¯â€œModuleNotFoundError: No module named â€˜_ctypesâ€™â€ï¼Œæ˜¯å› ä¸ºä¾èµ–çš„libffi-develç‰ˆæœ¬ä¸å¤Ÿï¼ˆå¯æ‰§è¡Œâ€œyum install -y libffi-develâ€å®‰è£…libffiï¼Œæˆ–æºç æ–¹å¼å®‰è£…libffiï¼‰ã€‚</p>
<p>é™„5ï¼šå®‰è£…libcap</p>
<ol>
<li>
<p>ä»https://git.kernel.org/pub/scm/linux/kernel/git/morgan/libcap.git/ä¸‹è½½æºä»£ç åŒ…</p>
</li>
<li>
<p>è§£å‹åè¿›å…¥è§£å‹ç›®å½•</p>
</li>
<li>
<p>æ‰§è¡Œmakeç¼–è¯‘</p>
</li>
<li>
<p>æ‰§è¡Œmake installå®‰è£…</p>
</li>
<li>
<p>å®Œæˆã€‚</p>
</li>
</ol>
<hr>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œä¸€è§ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>
åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/Aquester/article/details/86694644" target="_blank" rel="noopener">https://blog.csdn.net/Aquester/article/details/86694644</a></p>
]]></content>
      <categories>
        <category>Linux</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title>Tag Plugins</title>
    <url>/posts/Tag%20Plugins/</url>
    <content><![CDATA[<div class="note info">
            <h3 id="faq">FAQ<a title="#faq" href="#faq"></a></h3><p><strong>Welcome</strong> to <a href="https://theme-next.org/docs/tag-plugins/" target="_blank">tag-plugins</a></p>
          </div>
<p>Tag Plugin is a way to make special style contents supported by Hexo. For example, we cannot show a image with custom size in standard Markdown. And then we can use tag plugins to solve it. <a href="https://hexo.io/docs/tag-plugins" target="_blank">Hexo has a lot of tags</a> which can help user. And Hexo also have interfaces to themes which make themes able to create their own tags. Following tags is provided by NexT:</p>
<a id="more"></a>
<ul>
<li><a href="#Centered-Quote">Centered Quote</a></li>
<li><a href="#Include-Raw">Include Raw</a></li>
<li><a href="#Button">Button</a></li>
<li><a href="#Group-Pictures">Group Pictures</a></li>
<li><a href="#Label">Label</a></li>
<li><a href="#Mermaid">Mermaid</a></li>
<li><a href="#Note">Note</a></li>
<li><a href="#Pdf">PDF</a></li>
<li><a href="#Tabs">Tabs</a></li>
<li><a href="#Video">Video</a></li>
</ul>
<h3 id="centered-quote">Centered Quote<a title="#centered-quote" href="#centered-quote"></a></h3>
<p>This tag will make a quote with two lines before and after it, and text quoted will be centered. When using centered quote, if we have multi-line text, and each line has a different length, the quote wonâ€™t be symmetrical, so itâ€™s recommended to use when only have single line text. For example before article all after article to make a summary.</p>
<h4 id="usage">Usage<a title="#usage" href="#usage"></a></h4>
<figure class="highlight html"><figcaption><span>center-quote.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% centerquote %&#125;Something&#123;% endcenterquote %&#125;</span><br><span class="line"><span class="comment">&lt;!-- Tag Alias --&gt;</span></span><br><span class="line">&#123;% cq %&#125;Something&#123;% endcq %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="example">Example<a title="#example" href="#example"></a></h4>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">&#123;% cq %&#125;Elegant in code, simple in core&#123;% endcq %&#125;</span><br></pre></td></tr></table></figure>
<blockquote class="blockquote-center"><p>Elegant in code, simple in core</p>
</blockquote>
<h3 id="include-raw">Include Raw<a title="#include-raw" href="#include-raw"></a></h3>
<p>This tag include any raw content into your posts. Path is relative to your site source directory.</p>
<h4 id="usage-1">Usage<a title="#usage-1" href="#usage-1"></a></h4>
<figure class="highlight html"><figcaption><span>include-raw.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% include_raw '_data/path/to/file.html' %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="example-1">Example<a title="#example-1" href="#example-1"></a></h4>
<p>Letâ€™s create <code>include-raw.html</code> file in <code>_data</code> directory under <span class="label info">site root directory</span> with following content:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">Any <span class="tag">&lt;<span class="name">strong</span>&gt;</span>raw content<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> may be included with this tag.</span><br></pre></td></tr></table></figure>
<p>Then in any post we can use this content with <code>include_raw</code> tag:</p>
<figure class="highlight md"><table><tr><td class="code"><pre><span class="line">&#123;% include<span class="emphasis">_raw '_</span>data/path/to/include-raw.html' %&#125;</span><br></pre></td></tr></table></figure>
<h3 id="button">Button<a title="#button" href="#button"></a></h3>
<h4 id="usage-2">Usage<a title="#usage-2" href="#usage-2"></a></h4>
<figure class="highlight html"><figcaption><span>button.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% button url, text, icon [class], [title] %&#125;</span><br><span class="line"><span class="comment">&lt;!-- Tag Alias --&gt;</span></span><br><span class="line">&#123;% btn url, text, icon [class], [title] %&#125;</span><br><span class="line"></span><br><span class="line">url     : Absolute or relative path to URL.</span><br><span class="line">text    : Button text. Required if no icon specified.</span><br><span class="line">icon    : FontAwesome icon name (without 'fa-' at the begining). Required if no text specified.</span><br><span class="line">[class] : FontAwesome class(es): fa-fw | fa-lg | fa-2x | fa-3x | fa-4x | fa-5x</span><br><span class="line">          Optional parameter.</span><br><span class="line">[title] : Tooltip at mouseover.</span><br><span class="line">          Optional parameter.</span><br></pre></td></tr></table></figure>
<h4 id="examples">Examples<a title="#examples" href="#examples"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">button</span> #, Text %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<a class="btn" href="#">Text</a>
<h4 id="button-with-text-&amp;-title">Button with text &amp; title<a title="#button-with-text-&amp;-title" href="#button-with-text-&amp;-title"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Title,, Title %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<a class="btn" href="#">Text</a><a class="btn" href="#" title="Title">Text & Title</a>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Title,, Title %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<a class="btn" href="#">Text</a> <a class="btn" href="#" title="Title">Text & Title</a>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Title,, Title %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<a class="btn" href="#">Text</a>
<a class="btn" href="#" title="Title">Text & Title</a>
<h4 id="button-with-icon">Button with icon<a title="#button-with-icon" href="#button-with-icon"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-5x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-5x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-5x %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-4x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-4x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-4x %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-3x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-3x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-3x %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-2x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-2x %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-2x %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-lg %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-lg %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home fa-lg %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, home %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<div><a class="btn" href="#"><i class="fa fa-home fa-5x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-5x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-5x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-4x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-4x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-4x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-3x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-3x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-3x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-2x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-2x"></i></a><a class="btn" href="#"><i class="fa fa-home fa-2x"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home fa-lg"></i></a><a class="btn" href="#"><i class="fa fa-home fa-lg"></i></a><a class="btn" href="#"><i class="fa fa-home fa-lg"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-home"></i></a><a class="btn" href="#"><i class="fa fa-home"></i></a><a class="btn" href="#"><i class="fa fa-home"></i></a></div>
<h4 id="button-with-text-&amp;-icon">Button with text &amp; icon<a title="#button-with-text-&amp;-icon" href="#button-with-text-&amp;-icon"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Icon (buggy), home %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Icon (fixed width), home fa-fw %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><a class="btn" href="#"><i class="fa fa-home"></i>Text & Icon (buggy)</a>
<a class="btn" href="#"><i class="fa fa-home fa-fw"></i>Text & Icon (fixed width)</a></p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Large Icon, home fa-fw fa-lg %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Text &amp; Large Icon &amp; Title, home fa-fw fa-lg, Title %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p><a class="btn" href="#"><i class="fa fa-home fa-fw fa-lg"></i>Text & Large Icon</a>
<a class="btn" href="#" title="Title"><i class="fa fa-home fa-fw fa-lg"></i>Text & Large Icon & Title</a></p>
<h4 id="button-inside-text">Button inside text<a title="#button-inside-text" href="#button-inside-text"></a></h4>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line">Lorem &#123;% btn #, Lorem, home fa-fw fa-lg %&#125; ipsum dolor sit amet, consectetur adipiscing elit, sed <span class="keyword">do</span> eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip <span class="keyword">ex</span> ea commodo consequat. Duis aute irure dolor <span class="keyword">in</span> reprehenderit <span class="keyword">in</span> voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt <span class="keyword">in</span> culpa <span class="keyword">qui</span> officia deserunt mollit anim id <span class="keyword">est</span> laborum.</span><br><span class="line"></span><br><span class="line">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed <span class="keyword">do</span> eiusmod tempor incididu</span><br></pre></td></tr></table></figure>
<h4 id="button-inside-other-tag">Button inside other tag<a title="#button-inside-other-tag" href="#button-inside-other-tag"></a></h4>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123;%<span class="built_in"> note </span><span class="builtin-name">info</span> %&#125;</span><br><span class="line">&#123;% btn #, Text &amp; Icon, home fa-fw %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% btn #,, home, Title %&#125;&#123;% btn #, Text %&#125;</span><br><span class="line">[Link](#)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note info">
            <h4 id="button">button<a title="#button" href="#button"></a></h4><p><a class="btn" href="#"><i class="fa fa-home fa-fw"></i>Text &amp; Icon</a></p><p><a class="btn" href="#" title="Title"><i class="fa fa-home"></i></a><a class="btn" href="#">Text</a><br><a href="#">Link</a></p>
          </div>
<h4 id="button-margin">Button margin<a title="#button-margin" href="#button-margin"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, header %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, edge %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, times %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, circle-o %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, italic %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, scribd %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, google %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, chrome %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, opera %&#125;</span><span class="xml"></span><span class="template-tag">&#123;% <span class="name">btn</span> #,, diamond fa-rotate-270 %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<div class="text-center"><div><a class="btn" href="#"><i class="fa fa-header"></i></a><a class="btn" href="#"><i class="fa fa-edge"></i></a><a class="btn" href="#"><i class="fa fa-times"></i></a><a class="btn" href="#"><i class="fa fa-circle-o"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-italic"></i></a><a class="btn" href="#"><i class="fa fa-scribd"></i></a></div>
<div><a class="btn" href="#"><i class="fa fa-google"></i></a><a class="btn" href="#"><i class="fa fa-chrome"></i></a><a class="btn" href="#"><i class="fa fa-opera"></i></a><a class="btn" href="#"><i class="fa fa-diamond fa-rotate-270"></i></a></div></div>
<h4 id="button-with-relative-url">Button with relative URL<a title="#button-with-relative-url" href="#button-with-relative-url"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span></span><span class="template-tag">&#123;% <span class="name">btn</span> #, Previous Chapter, arrow-left fa-fw fa-lg, Previous Chapter (Full Image) %&#125;</span><span class="xml"> </span><span class="template-tag">&#123;% <span class="name">btn</span> #, Next Chapter, arrow-right fa-fw fa-lg, Next Chapter (Label) %&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<div class="text-center"><a class="btn" href="#" title="Previous Chapter (Full Image)"><i class="fa fa-arrow-left fa-fw fa-lg"></i>Previous Chapter</a> <a class="btn" href="#" title="Next Chapter (Label)"><i class="fa fa-arrow-right fa-fw fa-lg"></i>Next Chapter</a></div>
<h4 id="button-with-absolute-url">Button with absolute URL<a title="#button-with-absolute-url" href="#button-with-absolute-url"></a></h4>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">&lt;div class=<span class="string">"text-center"</span>&gt;&#123;% btn http<span class="variable">s:</span>//github.<span class="keyword">com</span>/theme-<span class="keyword">next</span>/hexo-theme-<span class="keyword">next</span>, NexT, github fa-fw fa-<span class="keyword">lg</span>, NexT <span class="keyword">source</span> code %&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<div class="text-center"><a class="btn" href="https://github.com/theme-next/hexo-theme-next" target="_blank" rel="noopener" title="NexT source code"><i class="fa fa-github fa-fw fa-lg"></i>NexT</a></div>
<h3 id="group-pictures">Group Pictures<a title="#group-pictures" href="#group-pictures"></a></h3>
<h4 id="usage-3">Usage<a title="#usage-3" href="#usage-3"></a></h4>
<figure class="highlight html"><figcaption><span>group-pictures.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% grouppicture [group]-[layout] %&#125;&#123;% endgrouppicture %&#125;</span><br><span class="line">&#123;% gp [group]-[layout] %&#125;&#123;% endgp %&#125;</span><br><span class="line"></span><br><span class="line">[group]  : Total number of pictures to add in the group.</span><br><span class="line">[layout] : Default picture under the group to show.</span><br></pre></td></tr></table></figure>
<h4 id="examples-1">Examples<a title="#examples-1" href="#examples-1"></a></h4>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line">&#123;% <span class="selector-tag">grouppicture</span> <span class="selector-tag">6-3</span> %&#125;</span><br><span class="line">  !<span class="selector-attr">[]</span>(/images/docs/github.png)</span><br><span class="line">  !<span class="selector-attr">[]</span>(/images/docs/github.png)</span><br><span class="line">  !<span class="selector-attr">[]</span>(/images/docs/github.png)</span><br><span class="line">  !<span class="selector-attr">[]</span>(/images/docs/github.png)</span><br><span class="line">  !<span class="selector-attr">[]</span>(/images/docs/github.png)</span><br><span class="line">  !<span class="selector-attr">[]</span>(/images/docs/github.png)</span><br><span class="line">&#123;% <span class="selector-tag">endgrouppicture</span> %&#125;</span><br></pre></td></tr></table></figure>
<div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://res.smzdm.com/images/emotions/137.png" alt=""></div><div class="group-picture-column" style="width: 50%;"><img src="https://res.smzdm.com/images/emotions/137.png" alt=""></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 100%;"><img src="https://res.smzdm.com/images/emotions/137.png" alt=""></div></div><div class="group-picture-row"><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://res.smzdm.com/images/emotions/137.png" alt=""></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://res.smzdm.com/images/emotions/137.png" alt=""></div><div class="group-picture-column" style="width: 33.333333333333336%;"><img src="https://res.smzdm.com/images/emotions/137.png" alt=""></div></div></div></div>
<h3 id="label">Label<a title="#label" href="#label"></a></h3>
<h4 id="usage-4">Usage<a title="#usage-4" href="#usage-4"></a></h4>
<figure class="highlight html"><figcaption><span>label.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% label [class]@Text %&#125;</span><br><span class="line"></span><br><span class="line">[class] : default | primary | success | info | warning | danger.</span><br><span class="line">          '@Text' can be specified with or without space</span><br><span class="line">          E.g. 'success @text' similar to 'success@text'.</span><br><span class="line">          If not specified, default class will be selected.</span><br></pre></td></tr></table></figure>
<h4 id="examples-2">Examples<a title="#examples-2" href="#examples-2"></a></h4>
<p>Lorem <span class="label default">ipsum</span> <span class="label primary">dolor sit</span> amet, consectetur <span class="label success">adipiscing elit,</span> sed <span class="label info">do eiusmod</span> tempor incididunt ut labore et dolore magna aliqua.</p>
<p>Ut enim <em><span class="label warning">ad</span></em> minim veniam, quis <strong><span class="label danger">nostrud</span></strong> exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
<p>Duis aute irure dolor in reprehenderit in voluptate <s><span class="label default">velit</span></s> <mark>esse</mark> cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
<p>Ut enim <em>ad</em> minim veniam, quis <strong>nostrud</strong> exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
<p>Duis aute irure dolor in reprehenderit in voluptate <s>velit</s> esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<h3 id="mermaid">Mermaid<a title="#mermaid" href="#mermaid"></a></h3>
<h4 id="settings">Settings<a title="#settings" href="#settings"></a></h4>
<figure class="highlight html"><figcaption><span>next/_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"># Mermaid tag</span><br><span class="line">mermaid:</span><br><span class="line">  enable: true</span><br><span class="line">  # Available themes: default | dark | forest | neutral</span><br><span class="line">  theme: forest</span><br></pre></td></tr></table></figure>
<h4 id="usage-5">Usage<a title="#usage-5" href="#usage-5"></a></h4>
<figure class="highlight html"><figcaption><span>mermaid.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% mermaid type %&#125;</span><br><span class="line">&#123;% endmermaid %&#125;</span><br><span class="line"></span><br><span class="line">type : type of the mermaid chart, visit https://github.com/knsv/mermaid for more information.</span><br></pre></td></tr></table></figure>
<h4 id="examples-3">Examples<a title="#examples-3" href="#examples-3"></a></h4>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line">&#123;% mermaid graph TD %&#125;</span><br><span class="line">A[Christmas] --&gt;|<span class="type">Get</span> money| <span class="type">B</span>(Go shopping)</span><br><span class="line">B --&gt; C&#123;<span class="keyword">Let</span> me thinksssss&lt;br&gt;ssssssssssssssssssssss&lt;br&gt;sssssssssssssssssssssssssss&#125;</span><br><span class="line">C --&gt;|<span class="type">One</span>| <span class="type">D</span>[Laptop]</span><br><span class="line">C --&gt;|<span class="type">Two</span>| <span class="type">E</span>[iPhone]</span><br><span class="line">C --&gt;|<span class="type">Three</span>| <span class="type">F</span>[Car]</span><br><span class="line">&#123;% endmermaid %&#125;</span><br></pre></td></tr></table></figure>
<pre class="mermaid" style="text-align: center;">
            graph TD
            A[Christmas] -->|Get money| B(Go shopping)
B --> C{Let me thinksssss<br>ssssssssssssssssssssss<br>sssssssssssssssssssssssssss}
C -->|One| D[Laptop]
C -->|Two| E[iPhone]
C -->|Three| F[Car]
          </pre>
<h3 id="note">Note<a title="#note" href="#note"></a></h3>
<h4 id="settings-1">Settings<a title="#settings-1" href="#settings-1"></a></h4>
<figure class="highlight html"><figcaption><span>next/_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span><br><span class="line">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span><br><span class="line">  light_bg_offset: 0</span><br></pre></td></tr></table></figure>
<h4 id="usage-6">Usage<a title="#usage-6" href="#usage-6"></a></h4>
<figure class="highlight html"><figcaption><span>note.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% note [class] [no-icon] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">[class]   : default | primary | success | info | warning | danger.</span><br><span class="line">[no-icon] : Disable icon in note.</span><br><span class="line"></span><br><span class="line">All parameters are optional.</span><br></pre></td></tr></table></figure>
<div class="note danger">
            <h4 id="known-issues">Known Issues<a title="#known-issues" href="#known-issues"></a></h4><p>Itâ€™s wrong to write this tag with 1 line if you donâ€™t want to see possible bugs.</p><p>For example, here is wrong syntax to write content like that:</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123; %<span class="built_in"> note </span>danger % &#125;note text,<span class="built_in"> note </span>text,<span class="built_in"> note </span>text&#123; % endnote % &#125;</span><br></pre></td></tr></table></figure><p>Or like that:</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123; %<span class="built_in"> note </span>danger % &#125;note text</span><br><span class="line">note text</span><br><span class="line">note text</span><br><span class="line">&#123; % endnote % &#125;</span><br></pre></td></tr></table></figure><p>Need to write content at new line, like this:</p><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123; %<span class="built_in"> note </span>danger % &#125;</span><br><span class="line">note text,<span class="built_in"> note </span>text,<span class="built_in"> note </span>text</span><br><span class="line">note text,<span class="built_in"> note </span>text,<span class="built_in"> note </span>text</span><br><span class="line">note text,<span class="built_in"> note </span>text,<span class="built_in"> note </span>text</span><br><span class="line">&#123; % endnote % &#125;</span><br></pre></td></tr></table></figure>
          </div>
<h4 id="examples-4">Examples<a title="#examples-4" href="#examples-4"></a></h4>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123;%<span class="built_in"> note </span>%&#125;</span><br><span class="line"><span class="comment">#### Header</span></span><br><span class="line">(without define class style)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note ">
            <h4 id="header">Header<a title="#header" href="#header"></a></h4><p>(without define class style)</p>
          </div>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note default %&#125;</span><br><span class="line"><span class="section">#### Default Header</span></span><br><span class="line">Welcome to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note default">
            <h4 id="default-header">Default Header<a title="#default-header" href="#default-header"></a></h4><p>Welcome to <a href="https://hexo.io" target="_blank">Hexo!</a></p>
          </div>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note primary %&#125;</span><br><span class="line"><span class="section">#### Primary Header</span></span><br><span class="line"><span class="strong">**Welcome**</span> to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note primary">
            <h4 id="primary-header">Primary Header<a title="#primary-header" href="#primary-header"></a></h4><p><strong>Welcome</strong> to <a href="https://hexo.io" target="_blank">Hexo!</a></p>
          </div>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note info %&#125;</span><br><span class="line"><span class="section">### Info Header</span></span><br><span class="line"><span class="strong">**Welcome**</span> to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note info">
            <h4 id="info-header">Info Header<a title="#info-header" href="#info-header"></a></h4><p><strong>Welcome</strong> to <a href="https://hexo.io" target="_blank">Hexo!</a></p>
          </div>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note success %&#125;</span><br><span class="line"><span class="section">#### Success Header</span></span><br><span class="line"><span class="strong">**Welcome**</span> to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note success">
            <h4 id="success-header">Success Header<a title="#success-header" href="#success-header"></a></h4><p><strong>Welcome</strong> to <a href="https://hexo.io" target="_blank">Hexo!</a></p>
          </div>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note warning %&#125;</span><br><span class="line"><span class="section">#### Warning Header</span></span><br><span class="line"><span class="strong">**Welcome**</span> to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note warning">
            <h4 id="warning-header">Warning Header<a title="#warning-header" href="#warning-header"></a></h4><p><strong>Welcome</strong> to <a href="https://hexo.io" target="_blank">Hexo!</a></p>
          </div>
<figure class="highlight markdown"><table><tr><td class="code"><pre><span class="line">&#123;% note danger %&#125;</span><br><span class="line"><span class="section">#### Danger Header</span></span><br><span class="line"><span class="strong">**Welcome**</span> to [<span class="string">Hexo!</span>](<span class="link">https://hexo.io</span>)</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note danger">
            <h4 id="danger-header">Danger Header<a title="#danger-header" href="#danger-header"></a></h4><p><strong>Welcome</strong> to <a href="https://hexo.io" target="_blank">Hexo!</a></p>
          </div>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123;%<span class="built_in"> note </span><span class="builtin-name">info</span> no-icon %&#125;</span><br><span class="line"><span class="comment">#### No icon note</span></span><br><span class="line">Note **without** icon: `note <span class="builtin-name">info</span> no-icon`</span><br><span class="line"></span><br><span class="line">note info,<span class="built_in"> note </span>info,<span class="built_in"> note </span>info</span><br><span class="line">note info,<span class="built_in"> note </span>info,<span class="built_in"> note </span>info</span><br><span class="line">note info,<span class="built_in"> note </span>info,<span class="built_in"> note </span>info</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note info no-icon">
            <h4 id="no-icon-note">No icon note<a title="#no-icon-note" href="#no-icon-note"></a></h4><p>Note <strong>without</strong> icon: <code>note info no-icon</code></p><p>note info, note info, note info<br>note info, note info, note info<br>note info, note info, note info</p>
          </div>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123;%<span class="built_in"> note </span>success %&#125;</span><br><span class="line"><span class="comment">#### Codeblock in note</span></span><br><span class="line">&#123;% code %&#125;</span><br><span class="line">code block <span class="keyword">in</span><span class="built_in"> note </span>tag</span><br><span class="line">code block <span class="keyword">in</span><span class="built_in"> note </span>tag</span><br><span class="line">code block <span class="keyword">in</span><span class="built_in"> note </span>tag</span><br><span class="line">&#123;% endcode %&#125;</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<div class="note success">
            <h4 id="codeblock-in-note">Codeblock in note<a title="#codeblock-in-note" href="#codeblock-in-note"></a></h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">code block <span class="keyword">in</span><span class="built_in"> note </span>tag</span><br><span class="line">code block <span class="keyword">in</span><span class="built_in"> note </span>tag</span><br><span class="line">code block <span class="keyword">in</span><span class="built_in"> note </span>tag</span><br></pre></td></tr></table></figure>
          </div>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&#123;%<span class="built_in"> note default </span>%&#125;</span><br><span class="line"><span class="comment">#### Lists in note</span></span><br><span class="line">* ul</span><br><span class="line">* ul</span><br><span class="line">  * ul</span><br><span class="line">  * ul</span><br><span class="line">* ul</span><br><span class="line"></span><br><span class="line">1. ol</span><br><span class="line">2. ol</span><br><span class="line">  1. ol</span><br><span class="line">  2. ol</span><br><span class="line">3. ol</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="lists-in-note">Lists in note<a title="#lists-in-note" href="#lists-in-note"></a></h4>
<div class="note default">
            <h4 id="lists-in-note">Lists in note<a title="#lists-in-note" href="#lists-in-note"></a></h4><ul><li>ul</li><li>ul<ul><li>ul</li><li>ul</li></ul></li><li>ul</li></ul><ol><li>ol</li><li>ol</li><li>ol</li><li>ol</li><li>ol</li></ol>
          </div>
<figure class="highlight gherkin"><table><tr><td class="code"><pre><span class="line"><span class="comment">#### Table in Note</span></span><br><span class="line">&#123;% note default %&#125;</span><br><span class="line">|<span class="string"> 1 </span>|<span class="string"> 2 </span>|</span><br><span class="line">|<span class="string"> - </span>|<span class="string"> - </span>|</span><br><span class="line">|<span class="string"> 3 </span>|<span class="string"> 4 </span>|</span><br><span class="line">|<span class="string"> 5 </span>|<span class="string"> 6 </span>|</span><br><span class="line">|<span class="string"> 7 </span>|<span class="string"> 8 </span>|</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="table-in-note">Table in note<a title="#table-in-note" href="#table-in-note"></a></h4>
<div class="note default">
            <h4 id="table-in-note">Table in Note<a title="#table-in-note" href="#table-in-note"></a></h4><div class="Ï†cy"><div class="Ï†da"><table><thead><tr><th>1</th><th>2</th></tr></thead><tbody><tr><td>3</td><td>4</td></tr><tr><td>5</td><td>6</td></tr><tr><td>7</td><td>8</td></tr></tbody></table></div></div>
          </div>
<h3 id="pdf">Pdf<a title="#pdf" href="#pdf"></a></h3>
<h4 id="settings-2">Settings<a title="#settings-2" href="#settings-2"></a></h4>
<figure class="highlight html"><figcaption><span>next/_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line">pdf:</span><br><span class="line">  enable: true</span><br><span class="line">  # Default height</span><br><span class="line">  height: 500px</span><br></pre></td></tr></table></figure>
<h4 id="usage-7">Usage<a title="#usage-7" href="#usage-7"></a></h4>
<figure class="highlight html"><figcaption><span>pdf.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% pdf url [height] %&#125;</span><br><span class="line"></span><br><span class="line">[url]    : Relative path to PDF file.</span><br><span class="line">[height] : Optional. Height of the PDF display element, e.g. 800px.</span><br></pre></td></tr></table></figure>
<h4 id="examples-5">Examples<a title="#examples-5" href="#examples-5"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">pdf</span> https://example.com/sample.pdf %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line">&#123;% pdf <span class="regexp">/path/</span>to<span class="regexp">/your/</span><span class="keyword">file</span>.pdf <span class="number">600</span>px %&#125;</span><br></pre></td></tr></table></figure>
<h3 id="tabs">Tabs<a title="#tabs" href="#tabs"></a></h3>
<h4 id="settings-3">Settings<a title="#settings-3" href="#settings-3"></a></h4>
<figure class="highlight html"><figcaption><span>next/_config.yml</span></figcaption><table><tr><td class="code"><pre><span class="line">tabs:</span><br><span class="line">  transition:</span><br><span class="line">    tabs: false</span><br><span class="line">    labels: true</span><br></pre></td></tr></table></figure>
<h4 id="usage-8">Usage<a title="#usage-8" href="#usage-8"></a></h4>
<figure class="highlight html"><figcaption><span>tabs.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line"><span class="comment">&lt;!-- tab [Tab caption] [@icon] --&gt;</span></span><br><span class="line">Any content (support inline tags too).</span><br><span class="line"><span class="comment">&lt;!-- endtab --&gt;</span></span><br><span class="line">&#123;% endtabs %&#125;</span><br><span class="line"></span><br><span class="line">Unique name   : Unique name of tabs block tag without comma.</span><br><span class="line">                Will be used in #id's as prefix for each tab with their index numbers.</span><br><span class="line">                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.</span><br><span class="line">                Only for current url of post/page must be unique!</span><br><span class="line">[index]       : Index number of active tab.</span><br><span class="line">                If not specified, first tab (1) will be selected.</span><br><span class="line">                If index is -1, no tab will be selected. It's will be something like spoiler.</span><br><span class="line">                Optional parameter.</span><br><span class="line">[Tab caption] : Caption of current tab.</span><br><span class="line">                If not caption specified, unique name with tab index suffix will be used as caption of tab.</span><br><span class="line">                If not caption specified, but specified icon, caption will empty.</span><br><span class="line">                Optional parameter.</span><br><span class="line">[@icon]       : FontAwesome icon name (without 'fa-' at the begining).</span><br><span class="line">                Can be specified with or without space; e.g. 'Tab caption @icon' similar to 'Tab caption@icon'.</span><br><span class="line">                Optional parameter.</span><br></pre></td></tr></table></figure>
<h4 id="examples-6">Examples<a title="#examples-6" href="#examples-6"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> First unique name %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="first-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#first-unique-name-1" data-toggle="tab">First unique name 1</a></li><li class="tab"><a href="#first-unique-name-2" data-toggle="tab">First unique name 2</a></li><li class="tab"><a href="#first-unique-name-3" data-toggle="tab">First unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="first-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="first-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="first-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-with-3rd-tab-selected">Tabs with 3rd tab selected<a title="#tabs-with-3rd-tab-selected" href="#tabs-with-3rd-tab-selected"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Second unique name, 3 %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="second-unique-name"><ul class="nav-tabs"><li class="tab"><a href="#second-unique-name-1" data-toggle="tab">Second unique name 1</a></li><li class="tab"><a href="#second-unique-name-2" data-toggle="tab">Second unique name 2</a></li><li class="tab active"><a href="#second-unique-name-3" data-toggle="tab">Second unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane" id="second-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="second-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane active" id="second-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-with-no-tab-selected">Tabs with no tab selected<a title="#tabs-with-no-tab-selected" href="#tabs-with-no-tab-selected"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Third unique name, -1 %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="third-unique-name"><ul class="nav-tabs"><li class="tab"><a href="#third-unique-name-1" data-toggle="tab">Third unique name 1</a></li><li class="tab"><a href="#third-unique-name-2" data-toggle="tab">Third unique name 2</a></li><li class="tab"><a href="#third-unique-name-3" data-toggle="tab">Third unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane" id="third-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="third-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="third-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-with-custom-labels">Tabs with custom labels<a title="#tabs-with-custom-labels" href="#tabs-with-custom-labels"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Fourth unique name %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab Solution 1 --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab Solution 2 --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab Solution 3 --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="fourth-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#fourth-unique-name-1" data-toggle="tab">Solution 1</a></li><li class="tab"><a href="#fourth-unique-name-2" data-toggle="tab">Solution 2</a></li><li class="tab"><a href="#fourth-unique-name-3" data-toggle="tab">Solution 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="fourth-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="fourth-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="fourth-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-with-icons-only">Tabs with icons only<a title="#tabs-with-icons-only" href="#tabs-with-icons-only"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Fifth unique name %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab @text-width --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab @amazon --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab @bold --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="fifth-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#fifth-unique-name-1" data-toggle="tab"><i class="fa fa-text-width" style="text-align: center;"></i></a></li><li class="tab"><a href="#fifth-unique-name-2" data-toggle="tab"><i class="fa fa-amazon" style="text-align: center;"></i></a></li><li class="tab"><a href="#fifth-unique-name-3" data-toggle="tab"><i class="fa fa-bold" style="text-align: center;"></i></a></li></ul><div class="tab-content"><div class="tab-pane active" id="fifth-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="fifth-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="fifth-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-with-icons-and-labels">Tabs with icons and labels<a title="#tabs-with-icons-and-labels" href="#tabs-with-icons-and-labels"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Sixth unique name %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab Solution 1@text-width --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab Solution 2 @amazon --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab Solution 3@bold --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="sixth-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#sixth-unique-name-1" data-toggle="tab"><i class="fa fa-text-width"></i>Solution 1</a></li><li class="tab"><a href="#sixth-unique-name-2" data-toggle="tab"><i class="fa fa-amazon"></i>Solution 2</a></li><li class="tab"><a href="#sixth-unique-name-3" data-toggle="tab"><i class="fa fa-bold"></i>Solution 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="sixth-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="sixth-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="sixth-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-permalinks-test">Tabs permalinks test<a title="#tabs-permalinks-test" href="#tabs-permalinks-test"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml">Permalink for &gt; [Tab one](#tab-one).</span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab one 1](#tab-one-1).</span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab one 2](#tab-one-2).</span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab one 3](#tab-one-3).</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab two](#tab-two).</span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab two 1](#tab-two-1).</span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab two 2](#tab-two-2).</span></span><br><span class="line"><span class="xml">Permalink for &gt; [Tab two 3](#tab-two-3).</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Tab one %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Tab two %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<p>Permalink for &gt; <a href="#tab-one">Tab one</a>.<br>
Permalink for &gt; <a href="#tab-one-1">Tab one 1</a>.<br>
Permalink for &gt; <a href="#tab-one-2">Tab one 2</a>.<br>
Permalink for &gt; <a href="#tab-one-3">Tab one 3</a>.</p>
<p>Permalink for &gt; <a href="#tab-two">Tab two</a>.<br>
Permalink for &gt; <a href="#tab-two-1">Tab two 1</a>.<br>
Permalink for &gt; <a href="#tab-two-2">Tab two 2</a>.<br>
Permalink for &gt; <a href="#tab-two-3">Tab two 3</a>.</p>
<div class="tabs" id="tab-one"><ul class="nav-tabs"><li class="tab active"><a href="#tab-one-1" data-toggle="tab">Tab one 1</a></li><li class="tab"><a href="#tab-one-2" data-toggle="tab">Tab one 2</a></li><li class="tab"><a href="#tab-one-3" data-toggle="tab">Tab one 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-one-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="tab-one-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="tab-one-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<div class="tabs" id="tab-two"><ul class="nav-tabs"><li class="tab active"><a href="#tab-two-1" data-toggle="tab">Tab two 1</a></li><li class="tab"><a href="#tab-two-2" data-toggle="tab">Tab two 2</a></li><li class="tab"><a href="#tab-two-3" data-toggle="tab">Tab two 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tab-two-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="tab-two-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="tab-two-3"><p><strong>This is Tab 3.</strong></p></div></div></div>
<h4 id="tabs-with-other-tags">Tabs with other tags<a title="#tabs-with-other-tags" href="#tabs-with-other-tags"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">tabs</span> Tags %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 1.**</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">1. One</span></span><br><span class="line"><span class="xml">2. Two</span></span><br><span class="line"><span class="xml">3. Three</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">4-spaces code block:</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">    nano /etc</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Tagged code block:</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">code</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">code tag</span></span><br><span class="line"><span class="xml">code tag</span></span><br><span class="line"><span class="xml">code tag</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endcode</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> default %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Note default tag.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 2.**</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">* Five</span></span><br><span class="line"><span class="xml">* Six</span></span><br><span class="line"><span class="xml">* Seven</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> primary %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">youtube</span> Kt7u5kr_P5o %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Tab 3.**</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">subtabs</span> Sub Tabs %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Sub Tab 1.**</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> success %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> warning %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Sub Tab 2.**</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> success %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> danger %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Sub Tab 3.**</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">subtabs</span> Sub-Sub Tabs %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Sub-Sub Tab 1 of Sub Tab 3.**</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> success %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Sub-Sub Tab 2 of Sub Tab 3.**</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> success %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> warning %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- tab --&gt;</span></span></span><br><span class="line"><span class="xml">**This is Sub-Sub Tab 3 of Sub Tab 3.**</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> success %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> warning %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">note</span> danger %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endnote</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endsubtabs</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endsubtabs</span> %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"><span class="comment">&lt;!-- endtab --&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endtabs</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<div class="tabs" id="tags"><ul class="nav-tabs"><li class="tab active"><a href="#tags-1" data-toggle="tab">Tags 1</a></li><li class="tab"><a href="#tags-2" data-toggle="tab">Tags 2</a></li><li class="tab"><a href="#tags-3" data-toggle="tab">Tags 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="tags-1"><p><strong>This is Tab 1.</strong></p>
<ol>
<li>One</li>
<li>Two</li>
<li>Three</li>
</ol>
<p>4-spaces code block:</p>
<pre><code>nano /etc
</code></pre>
<p>Tagged code block:</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">code <span class="keyword">tag</span></span><br><span class="line">code <span class="keyword">tag</span></span><br><span class="line">code <span class="keyword">tag</span></span><br></pre></td></tr></table></figure>
<div class="note default">
            <p>Note default tag.</p>
          </div></div><div class="tab-pane" id="tags-2"><p><strong>This is Tab 2.</strong></p>
<ul>
<li>Five</li>
<li>Six</li>
<li>Seven</li>
</ul>
<div class="note primary">
            <div class="video-container"><iframe src="https://www.youtube.com/embed/Kt7u5kr_P5o" frameborder="0" loading="lazy" allowfullscreen></iframe></div>
          </div></div><div class="tab-pane" id="tags-3"><p><strong>This is Tab 3.</strong></p>
<div class="tabs" id="sub-tabs"><ul class="nav-tabs"><li class="tab active"><a href="#sub-tabs-1" data-toggle="tab">Sub Tabs 1</a></li><li class="tab"><a href="#sub-tabs-2" data-toggle="tab">Sub Tabs 2</a></li><li class="tab"><a href="#sub-tabs-3" data-toggle="tab">Sub Tabs 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="sub-tabs-1"><p><strong>This is Sub Tab 1.</strong></p>
<div class="note success">
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</p><div class="note warning">            <p>Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</p>          </div><p>Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</p>
          </div></div><div class="tab-pane" id="sub-tabs-2"><p><strong>This is Sub Tab 2.</strong></p>
<div class="note success">
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</p><p>Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</p><div class="note danger">            <p>Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</p>          </div>
          </div></div><div class="tab-pane" id="sub-tabs-3"><p><strong>This is Sub Tab 3.</strong></p>
<div class="tabs" id="sub-sub-tabs"><ul class="nav-tabs"><li class="tab active"><a href="#sub-sub-tabs-1" data-toggle="tab">Sub-Sub Tabs 1</a></li><li class="tab"><a href="#sub-sub-tabs-2" data-toggle="tab">Sub-Sub Tabs 2</a></li><li class="tab"><a href="#sub-sub-tabs-3" data-toggle="tab">Sub-Sub Tabs 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="sub-sub-tabs-1"><p><strong>This is Sub-Sub Tab 1 of Sub Tab 3.</strong></p>
<div class="note success">
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</p><p>Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</p><p>Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</p>
          </div></div><div class="tab-pane" id="sub-sub-tabs-2"><p><strong>This is Sub-Sub Tab 2 of Sub Tab 3.</strong></p>
<div class="note success">
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</p><div class="note warning">            <p>Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</p><p>Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</p>          </div>
          </div></div><div class="tab-pane" id="sub-sub-tabs-3"><p><strong>This is Sub-Sub Tab 3 of Sub Tab 3.</strong></p>
<div class="note success">
            <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.</p><div class="note warning">            <p>Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.</p><div class="note danger">            <p>Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.</p>          </div>          </div>
          </div></div></div></div></div></div></div></div></div></div>
<h3 id="viedo">Viedo<a title="#viedo" href="#viedo"></a></h3>
<h4 id="usage-9">Usage<a title="#usage-9" href="#usage-9"></a></h4>
<figure class="highlight html"><figcaption><span>video.js</span></figcaption><table><tr><td class="code"><pre><span class="line">&#123;% video url %&#125;</span><br></pre></td></tr></table></figure>
<h4 id="examples-7">Examples<a title="#examples-7" href="#examples-7"></a></h4>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">video</span> https://example.com/sample.mp4 %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">video</span> /path/to/your/video.mp4 %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<video src="https://vdept.bdstatic.com/73344478426c326e6764593274586637/516d695a50766e6e/3a779caacfcc4bba1c11f88d0868957a08c9f9405b40f6261883918d415914532c5703b315a3d367d50185d526aff8e1.mp4?auth_key=1579772495-0-0-588f70a6294de7454e42c575076c39a0" preload="metadata" controls playsinline poster="">Sorry, your browser does not support the video tag.</video>
<hr>
<h3 id="inline-image">Inline image<a title="#inline-image" href="#inline-image"></a></h3>
<p>Not bad.<img src="https://res.smzdm.com/images/emotions/138.png" alt="yes"></p>
<h3 id="with-link">With link<a title="#with-link" href="#with-link"></a></h3>
<ul>
<li>Travis CI build status: <a href="https://github.com/ikeq/hexo-theme-inside" target="_blank"><img src="https://img.shields.io/travis/ikeq/hexo-theme-inside.svg?longCache=true&amp;style=flat-square" alt="build-img"></a></li>
<li>Lastest release: <a href="https://github.com/ikeq/hexo-theme-inside/releases" target="_blank"><img src="https://img.shields.io/github/release/ikeq/hexo-theme-inside.svg?longCache=true&amp;style=flat-square" alt="release-img"></a></li>
<li>License: <a href="https://blog.oniuo.com/LICENSE" target="_blank"><img src="https://img.shields.io/github/license/ikeq/hexo-theme-inside.svg?longCache=true&amp;style=flat-square" alt="license-img"></a></li>
</ul>
<h3 id="hr">hr<a title="#hr" href="#hr"></a></h3>
<p>Below is a <code>&lt;hr&gt;</code>, I guess.</p>
<hr>
<p>Above is a <a href="https://blog.oniuo.com/post/inside-theme-showcase#hr" target="_blank"><code>&lt;hr&gt;</code></a>, I guess.</p>
<h3 id="list">List<a title="#list" href="#list"></a></h3>
<h4 id="unordered-list">Unordered list<a title="#unordered-list" href="#unordered-list"></a></h4>
<ul>
<li>list item</li>
<li>list item
<ul>
<li>list item</li>
<li>list item
<ul>
<li>list item</li>
<li>list item</li>
</ul>
</li>
</ul>
</li>
<li>list item</li>
</ul>
<h4 id="ordered-list">Ordered list<a title="#ordered-list" href="#ordered-list"></a></h4>
<ol>
<li>list item</li>
<li>list item
<ol>
<li>list item</li>
<li>list item
<ol>
<li>list item</li>
<li>list item</li>
</ol>
</li>
</ol>
</li>
<li>list item</li>
</ol>
<h4 id="checklist">Checklist<a title="#checklist" href="#checklist"></a></h4>
<ul class="Ï†cz" class="Ï†cz" class="Ï†cz">
<li><input type="checkbox" disabled=""><i></i>Get up at 7:00 AM</li>
<li><input type="checkbox" disabled=""><i></i>Eat breakfast</li>
<li><input type="checkbox" disabled=""><i></i>Go to bet before 11:00 PM</li>
</ul>
<h3 id="table">Table<a title="#table" href="#table"></a></h3>
<div class="Ï†cy"><div class="Ï†da"><table><thead>
<tr>
<th>Hear no evil</th>
<th>Speak no evil</th>
<th>See no evil</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ™‰</td>
<td>ğŸ™Š</td>
<td>ğŸ™ˆ</td>
</tr>
</tbody>
</table></div></div><h4 id="text-align">Text align<a title="#text-align" href="#text-align"></a></h4>
<div class="Ï†cy"><div class="Ï†da"><table><thead>
<tr>
<th>Hear no evil</th>
<th style="text-align:center">Speak no evil</th>
<th style="text-align:right">See no evil</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸ™‰</td>
<td style="text-align:center">ğŸ™Š</td>
<td style="text-align:right">ğŸ™ˆ</td>
</tr>
</tbody>
</table></div></div><h4 id="headless">Headless<a title="#headless" href="#headless"></a></h4>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">&amp;nbsp; <span class="params">| &amp;nbsp; |</span> &amp;nbsp;</span><br><span class="line"><span class="symbol">:-----</span><span class="symbol">:|</span><span class="symbol">:------</span><span class="symbol">:|</span><span class="symbol">:-</span><span class="symbol">:</span></span><br><span class="line">A      <span class="params">| B      |</span> ğŸ™ˆ</span><br></pre></td></tr></table></figure>
<div class="Ï†cy"><div class="Ï†da"><table><thead>
<tr>
<th style="padding:0"></th>
<th style="padding:0"></th>
<th style="padding:0"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">A</td>
<td style="text-align:center">B</td>
<td style="text-align:center">ğŸ™ˆ</td>
</tr>
</tbody>
</table></div></div><h4 id="long-table">Long table<a title="#long-table" href="#long-table"></a></h4>
<div class="Ï†cy"><div class="Ï†da"><table><thead>
<tr>
<th>Sun With Face</th>
<th>Grinning Face</th>
<th>Smiling Face</th>
<th>Grinning Face With Big Eyes</th>
<th>Smiling Face With Smiling Eyes</th>
<th>Full Moon Face</th>
<th>Grinning Face With Smiling Eyes</th>
<th>Face With Monocle</th>
<th>Cowboy Hat Face</th>
<th>Thinking Face</th>
<th>Face Vomiting</th>
</tr>
</thead>
<tbody>
<tr>
<td>ğŸŒ</td>
<td>ğŸ˜€</td>
<td>â˜ºï¸</td>
<td>ğŸ˜ƒ</td>
<td>ğŸ˜Š</td>
<td>ğŸŒ</td>
<td>ğŸ˜„</td>
<td>ğŸ§</td>
<td>ğŸ¤ </td>
<td>ğŸ¤”</td>
<td>ğŸ¤®</td>
</tr>
</tbody>
</table></div></div><h3 id="blockquote">Blockquote<a title="#blockquote" href="#blockquote"></a></h3>
<p>(<a href="https://hexo.io/docs/tag-plugins#Block-Quote" target="_blank" rel="noopener">https://hexo.io/docs/tag-plugins#Block-Quote</a>)</p>
<blockquote>
<p>Every interaction is both precious and an opportunity to delight.</p>
<p><strong>Seth Godin</strong><a href="http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html" target="_blank">Welcome to Island Marketing</a></p>
</blockquote>
<blockquote>
<p>NEW: DevDocs now comes with syntax highlighting. <a href="http://devdocs.io/" target="_blank">http://devdocs.io</a></p>
<p><strong>@DevDocs</strong><a href="https://twitter.com/devdocs/status/356095192085962752" target="_blank">twitter.com/devdocs/status/356095192085962752</a></p>
</blockquote>
<h3 id="code-block">Code Block<a title="#code-block" href="#code-block"></a></h3>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">class Utils &#123;</span><br><span class="line">  animate(element: Element, attr: string, change: &#123; <span class="keyword">from</span>: number, <span class="keyword">to</span>: number, duration?: number &#125;, onEnd?: () =&gt; void) &#123;</span><br><span class="line">    <span class="keyword">if</span> (change.<span class="keyword">from</span> === change.<span class="keyword">to</span>) return;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!change.duration)</span><br><span class="line">      element[attr] = change.<span class="keyword">to</span>;</span><br><span class="line"></span><br><span class="line">    const easing = (t, b, c, d) =&gt; c * ((t = t / d - 1) * t * t + 1) + b,</span><br><span class="line">      &#123; <span class="keyword">from</span>, <span class="keyword">to</span> &#125; = change,</span><br><span class="line">      during = Math.ceil((change.duration || 300) / 17) || 1;</span><br><span class="line"></span><br><span class="line">    let start = 0,</span><br><span class="line">     <span class="built_in"> instance </span>= <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">step</span>();</span><br><span class="line"></span><br><span class="line">    function <span class="keyword">step</span>() &#123;</span><br><span class="line">      const value = Math.ceil(easing(start, <span class="keyword">from</span>, <span class="keyword">to</span> - <span class="keyword">from</span>, during));</span><br><span class="line"></span><br><span class="line">      start++;</span><br><span class="line">      <span class="keyword">if</span> (start &lt;= during) &#123;</span><br><span class="line">        element[attr] = value;</span><br><span class="line">       <span class="built_in"> instance </span>= requestAnimationFrame(<span class="keyword">step</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (onEnd) onEnd();</span><br><span class="line">        cancelAnimationFrame(instance);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="with-caption">With caption<a title="#with-caption" href="#with-caption"></a></h3>
<p>(<a href="https://hexo.io/docs/tag-plugins#Code-Block" target="_blank" rel="noopener">https://hexo.io/docs/tag-plugins#Code-Block</a>)</p>
<figure class="highlight angelscript"><figcaption><span>_.compact</span><a href="http://underscorejs.org/#compact" target="_blank" rel="noopener">Underscore.js</a></figcaption><table><tr><td class="code"><pre><span class="line">_.compact([<span class="number">0</span>, <span class="number">1</span>, <span class="literal">false</span>, <span class="number">2</span>, <span class="string">''</span>, <span class="number">3</span>]);=&gt; [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h3 id="gist">Gist<a title="#gist" href="#gist"></a></h3>
<p>(<a href="https://hexo.io/docs/tag-plugins#Gist" target="_blank" rel="noopener">https://hexo.io/docs/tag-plugins#Gist</a>)</p>
<h3 id="jsfiddle">JSFiddle<a title="#jsfiddle" href="#jsfiddle"></a></h3>
<p>(<a href="https://hexo.io/docs/tag-plugins#jsFiddle" target="_blank" rel="noopener">https://hexo.io/docs/tag-plugins#jsFiddle</a>)</p>
<h3 id="script">Script<a title="#script" href="#script"></a></h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">stars: <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"stargazers_count"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">fetch(<span class="string">'https://api.github.com/repos/ikeq/hexo-theme-inside'</span>)</span></span><br><span class="line"><span class="actionscript">  .then(<span class="function"><span class="keyword">function</span><span class="params">(res)</span> </span>&#123; <span class="keyword">return</span> res.json() &#125;)</span></span><br><span class="line"><span class="actionscript">  .then(<span class="function"><span class="keyword">function</span><span class="params">(json)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">document</span>.getElementById(<span class="string">'stargazers_count'</span>).innerHTML = json.stargazers_count;</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>stars: 309</p>
<p>For the lastest ES grammar and code minification.<br>
Run the following command in the root directory of Hexo (not <code>themes/inside</code>):</p>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install </span><span class="keyword">babel-core </span><span class="keyword">babel-preset-env </span>html-minifier uglify-<span class="keyword">js </span>--save</span><br></pre></td></tr></table></figure>
<h3 id="canvas">Canvas<a title="#canvas" href="#canvas"></a></h3>
<p>Syntaxï¼š</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">canvas</span> [width] [height] %&#125;</span><span class="xml"></span></span><br><span class="line"><span class="xml">ctx.fillStyle = 'red';</span></span><br><span class="line"><span class="xml">ctx.fillRect(0, 0, w, h);</span></span><br><span class="line"><span class="xml"></span><span class="template-tag">&#123;% <span class="name">endcanvas</span> %&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<p>width is default to <code>300</code>, height is default to <code>150</code>ï¼Œalso the following constants are available in the scope:</p>
<div class="Ï†cy"><div class="Ï†da"><table><thead>
<tr>
<th>constant</th>
<th style="padding:0"></th>
</tr>
</thead>
<tbody>
<tr>
<td>ctx</td>
<td>CanvasRenderingContext2D</td>
</tr>
<tr>
<td>w</td>
<td>Canvas width</td>
</tr>
<tr>
<td>h</td>
<td>Canvas height</td>
</tr>
</tbody>
</table></div></div><p>For example:</p>
<p><canvas id="canvas-0" width="100" height="100"></canvas></p><script>(function(){var canvas = document.getElementById('canvas-0'), ctx = canvas.getContext('2d'), w = 100, h = 100; const r = w / 2;
ctx.fillStyle = 'antiquewhite';
ctx.arc(r, r, r, 0, Math.PI * 2);
ctx.fill();})();</script>
<h3 id="mathjax-(ssr)">MathJax (SSR)<a title="#mathjax-(ssr)" href="#mathjax-(ssr)"></a></h3>
<p>When <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.491ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 2364.1 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">a \ne 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
<path stroke-width="1" id="E1-MJMAIN-2260" d="M166 -215T159 -215T147 -212T141 -204T139 -197Q139 -190 144 -183L306 133H70Q56 140 56 153Q56 168 72 173H327L406 327H72Q56 332 56 347Q56 360 70 367H426Q597 702 602 707Q605 716 618 716Q625 716 630 712T636 703T638 696Q638 692 471 367H707Q722 359 722 347Q722 336 708 328L451 327L371 173H708Q722 163 722 153Q722 140 707 133H351Q175 -210 170 -212Q166 -215 159 -215Z"></path>
<path stroke-width="1" id="E1-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
 <use xlink:href="#E1-MJMAIN-2260" x="807" y="0"></use>
 <use xlink:href="#E1-MJMAIN-30" x="1863" y="0"></use>
</g>
</svg>, there are two solutions to <svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.89ex" height="2.843ex" style="vertical-align: -0.505ex;" viewBox="0 -1006.6 7271.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">ax^2 + bx + c = 0</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
<path stroke-width="1" id="E1-MJMATHI-78" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path>
<path stroke-width="1" id="E1-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path>
<path stroke-width="1" id="E1-MJMAIN-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path>
<path stroke-width="1" id="E1-MJMATHI-62" d="M73 647Q73 657 77 670T89 683Q90 683 161 688T234 694Q246 694 246 685T212 542Q204 508 195 472T180 418L176 399Q176 396 182 402Q231 442 283 442Q345 442 383 396T422 280Q422 169 343 79T173 -11Q123 -11 82 27T40 150V159Q40 180 48 217T97 414Q147 611 147 623T109 637Q104 637 101 637H96Q86 637 83 637T76 640T73 647ZM336 325V331Q336 405 275 405Q258 405 240 397T207 376T181 352T163 330L157 322L136 236Q114 150 114 114Q114 66 138 42Q154 26 178 26Q211 26 245 58Q270 81 285 114T318 219Q336 291 336 325Z"></path>
<path stroke-width="1" id="E1-MJMATHI-63" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path>
<path stroke-width="1" id="E1-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
<path stroke-width="1" id="E1-MJMAIN-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,0)">
 <use xlink:href="#E1-MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32" x="809" y="583"></use>
</g>
 <use xlink:href="#E1-MJMAIN-2B" x="1778" y="0"></use>
 <use xlink:href="#E1-MJMATHI-62" x="2778" y="0"></use>
 <use xlink:href="#E1-MJMATHI-78" x="3208" y="0"></use>
 <use xlink:href="#E1-MJMAIN-2B" x="4003" y="0"></use>
 <use xlink:href="#E1-MJMATHI-63" x="5003" y="0"></use>
 <use xlink:href="#E1-MJMAIN-3D" x="5715" y="0"></use>
 <use xlink:href="#E1-MJMAIN-30" x="6771" y="0"></use>
</g>
</svg> and they are<br>
MATHJAX-SSR-0</p>
<p style="text-align:center"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.985ex" height="14.176ex" style="vertical-align: -6.505ex;" viewBox="0 -3302.9 12910.1 6103.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title">A= \begin{bmatrix}
{a_{11}}&amp;{a_{12}}&amp;{\cdots}&amp;{a_{1n}}\\
{a_{21}}&amp;{a_{22}}&amp;{\cdots}&amp;{a_{2n}}\\
{\vdots}&amp;{\vdots}&amp;{\ddots}&amp;{\vdots}\\
{a_{m1}}&amp;{a_{m2}}&amp;{\cdots}&amp;{a_{mn}}\\
\end{bmatrix}</title>
<defs aria-hidden="true">
<path stroke-width="1" id="E1-MJMATHI-41" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path>
<path stroke-width="1" id="E1-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path>
<path stroke-width="1" id="E1-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path>
<path stroke-width="1" id="E1-MJMATHI-61" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path>
<path stroke-width="1" id="E1-MJMAIN-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path>
<path stroke-width="1" id="E1-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path>
<path stroke-width="1" id="E1-MJMAIN-22EF" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250ZM525 250Q525 274 542 292T585 310Q609 310 627 294T646 251Q646 226 629 208T586 190T543 207T525 250ZM972 250Q972 274 989 292T1032 310Q1056 310 1074 294T1093 251Q1093 226 1076 208T1033 190T990 207T972 250Z"></path>
<path stroke-width="1" id="E1-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path>
<path stroke-width="1" id="E1-MJMAIN-22EE" d="M78 30Q78 54 95 72T138 90Q162 90 180 74T199 31Q199 6 182 -12T139 -30T96 -13T78 30ZM78 440Q78 464 95 482T138 500Q162 500 180 484T199 441Q199 416 182 398T139 380T96 397T78 440ZM78 840Q78 864 95 882T138 900Q162 900 180 884T199 841Q199 816 182 798T139 780T96 797T78 840Z"></path>
<path stroke-width="1" id="E1-MJMAIN-22F1" d="M133 760Q133 784 150 802T193 820Q217 820 235 804T254 761Q254 736 237 718T194 700T151 717T133 760ZM580 460Q580 484 597 502T640 520Q664 520 682 504T701 461Q701 436 684 418T641 400T598 417T580 460ZM1027 160Q1027 184 1044 202T1087 220Q1111 220 1129 204T1148 161Q1148 136 1131 118T1088 100T1045 117T1027 160Z"></path>
<path stroke-width="1" id="E1-MJMATHI-6D" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path>
<path stroke-width="1" id="E1-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path>
<path stroke-width="1" id="E1-MJSZ4-23A1" d="M319 -645V1154H666V1070H403V-645H319Z"></path>
<path stroke-width="1" id="E1-MJSZ4-23A3" d="M319 -644V1155H403V-560H666V-644H319Z"></path>
<path stroke-width="1" id="E1-MJSZ4-23A2" d="M319 0V602H403V0H319Z"></path>
<path stroke-width="1" id="E1-MJSZ4-23A4" d="M0 1070V1154H347V-645H263V1070H0Z"></path>
<path stroke-width="1" id="E1-MJSZ4-23A6" d="M263 -560V1155H347V-644H0V-560H263Z"></path>
<path stroke-width="1" id="E1-MJSZ4-23A5" d="M263 0V602H347V0H263Z"></path>
</defs>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#E1-MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#E1-MJMAIN-3D" x="1028" y="0"></use>
<g transform="translate(2084,0)">
<g transform="translate(0,3210)">
 <use xlink:href="#E1-MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-4165.995033112583) scale(1,4.004966887417218)">
 <use xlink:href="#E1-MJSZ4-23A2"></use>
</g>
 <use xlink:href="#E1-MJSZ4-23A3" x="0" y="-5276"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(133,2410)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-31" x="500" y="0"></use>
</g>
</g>
<g transform="translate(133,1010)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-31" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-MJMAIN-22EE" x="663" y="-1111"></use>
<g transform="translate(0,-2511)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-31" x="878" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2594,0)">
<g transform="translate(133,2410)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32" x="500" y="0"></use>
</g>
</g>
<g transform="translate(133,1010)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-MJMAIN-22EE" x="663" y="-1111"></use>
<g transform="translate(0,-2511)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32" x="878" y="0"></use>
</g>
</g>
</g>
<g transform="translate(5198,0)">
 <use xlink:href="#E1-MJMAIN-22EF" x="55" y="2410"></use>
 <use xlink:href="#E1-MJMAIN-22EF" x="55" y="1010"></use>
 <use xlink:href="#E1-MJMAIN-22F1" x="0" y="-1111"></use>
 <use xlink:href="#E1-MJMAIN-22EF" x="55" y="-2511"></use>
</g>
<g transform="translate(7481,0)">
<g transform="translate(133,2410)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6E" x="500" y="0"></use>
</g>
</g>
<g transform="translate(133,1010)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6E" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#E1-MJMAIN-22EE" x="698" y="-1111"></use>
<g transform="translate(0,-2511)">
 <use xlink:href="#E1-MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,-150)">
 <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6E" x="878" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(10158,3210)">
 <use xlink:href="#E1-MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-4165.995033112583) scale(1,4.004966887417218)">
 <use xlink:href="#E1-MJSZ4-23A5"></use>
</g>
 <use xlink:href="#E1-MJSZ4-23A6" x="0" y="-5276"></use>
</g>
</g>
</g>
</svg></p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
        <tag>Next</tag>
      </tags>
  </entry>
</search>
