[{"title":"ç†è§£ Go defer","date":"2020-04-23T14:57:34.000Z","date_formatted":{"ll":"Apr 23, 2020","L":"04/23/2020","MM-DD":"04-23"},"updated":"2020-04-23T15:12:54.701Z","content":"defer çš„ä½œç”¨å’Œæ‰§è¡Œæ—¶æœº\ngo çš„ defer è¯­å¥æ˜¯ç”¨æ¥å»¶è¿Ÿæ‰§è¡Œå‡½æ•°çš„ï¼Œè€Œä¸”å»¶è¿Ÿå‘ç”Ÿåœ¨è°ƒç”¨å‡½æ•° return ä¹‹åï¼Œæ¯”å¦‚\n1234func a() int &#123;  defer b()  return 0&#125;\nb çš„æ‰§è¡Œæ˜¯å‘ç”Ÿåœ¨ return 0 ä¹‹åï¼Œæ³¨æ„ defer çš„è¯­æ³•ï¼Œå…³é”®å­— defer ä¹‹åæ˜¯å‡½æ•°çš„è°ƒç”¨ã€‚\n\ndefer çš„é‡è¦ç”¨é€”ä¸€ï¼šæ¸…ç†é‡Šæ”¾èµ„æº\nç”±äº defer çš„å»¶è¿Ÿç‰¹æ€§ï¼Œdefer å¸¸ç”¨åœ¨å‡½æ•°è°ƒç”¨ç»“æŸä¹‹åæ¸…ç†ç›¸å…³çš„èµ„æºï¼Œæ¯”å¦‚\n12f, _ := os.Open(filename)defer f.Close()\næ–‡ä»¶èµ„æºçš„é‡Šæ”¾ä¼šåœ¨å‡½æ•°è°ƒç”¨ç»“æŸä¹‹åå€ŸåŠ© defer è‡ªåŠ¨æ‰§è¡Œï¼Œä¸éœ€è¦æ—¶åˆ»è®°ä½å“ªé‡Œçš„èµ„æºéœ€è¦é‡Šæ”¾ï¼Œæ‰“å¼€å’Œé‡Šæ”¾å¿…é¡»ç›¸å¯¹åº”ã€‚\nç”¨ä¸€ä¸ªä¾‹å­æ·±åˆ»è¯ é‡Šä¸€ä¸‹ defer å¸¦æ¥çš„ä¾¿åˆ©å’Œç®€æ´ã€‚\nä»£ç çš„ä¸»è¦ç›®çš„æ˜¯æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åå¤åˆ¶å†…å®¹åˆ°å¦ä¸€ä¸ªæ–°çš„æ–‡ä»¶ä¸­ï¼Œæ²¡æœ‰ defer æ—¶è¿™æ ·å†™ï¼š\n12345678910111213141516func CopyFile(dstName, srcName string) (written int64, err error) &#123;    src, err := os.Open(srcName)    if err != nil &#123;        return    &#125;    dst, err := os.Create(dstName)    if err != nil &#123; //1        return    &#125;    written, err = io.Copy(dst, src)    dst.Close()    src.Close()    return&#125;\nä»£ç åœ¨ #1 å¤„è¿”å›ä¹‹åï¼Œsrc æ–‡ä»¶æ²¡æœ‰æ‰§è¡Œå…³é—­æ“ä½œï¼Œå¯èƒ½ä¼šå¯¼è‡´èµ„æºä¸èƒ½æ­£ç¡®é‡Šæ”¾ï¼Œæ”¹ç”¨ defer å®ç°ï¼š\n123456789101112131415func CopyFile(dstName, srcName string) (written int64, err error) &#123;    src, err := os.Open(srcName)    if err != nil &#123;        return    &#125;    defer src.Close()    dst, err := os.Create(dstName)    if err != nil &#123;        return    &#125;    defer dst.Close()    return io.Copy(dst, src)&#125;\nsrc å’Œ dst éƒ½èƒ½åŠæ—¶æ¸…ç†å’Œé‡Šæ”¾ï¼Œæ— è®º return åœ¨ä»€ä¹ˆåœ°æ–¹æ‰§è¡Œã€‚\né‰´äº defer çš„è¿™ç§ä½œç”¨ï¼Œdefer å¸¸ç”¨æ¥é‡Šæ”¾æ•°æ®åº“è¿æ¥ï¼Œæ–‡ä»¶æ‰“å¼€å¥æŸ„ç­‰é‡Šæ”¾èµ„æºçš„æ“ä½œã€‚\ndefer çš„é‡è¦ç”¨é€”äºŒï¼šæ‰§è¡Œ recover\nè¢« defer çš„å‡½æ•°åœ¨ return ä¹‹åæ‰§è¡Œï¼Œè¿™ä¸ªæ—¶æœºç‚¹æ­£å¥½å¯ä»¥æ•è·å‡½æ•°æŠ›å‡ºçš„ panicï¼Œå› è€Œ defer çš„å¦ä¸€ä¸ªé‡è¦ç”¨é€”å°±æ˜¯æ‰§è¡Œ recoverã€‚\nrecover åªæœ‰åœ¨ defer ä¸­ä½¿ç”¨æ‰æ›´æœ‰æ„ä¹‰ï¼Œå¦‚æœåœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼Œç”±äº program å·²ç»è°ƒç”¨ç»“æŸè€Œæå‰è¿”å›è€Œæ— æ³•æœ‰æ•ˆæ•æ‰é”™è¯¯ã€‚\n12345678910111213141516package mainimport (    \"fmt\")func main() &#123;    defer func() &#123;        if ok := recover(); ok != nil &#123;            fmt.Println(\"recover\")        &#125;    &#125;()    panic(\"error\")&#125;\nè®°ä½ defer è¦æ”¾åœ¨ panic æ‰§è¡Œä¹‹å‰ã€‚\nå¤šä¸ª defer çš„æ‰§è¡Œé¡ºåº\ndefer çš„ä½œç”¨å°±æ˜¯æŠŠå…³é”®å­—ä¹‹åçš„å‡½æ•°æ‰§è¡Œå‹å…¥ä¸€ä¸ªæ ˆä¸­å»¶è¿Ÿæ‰§è¡Œï¼Œå¤šä¸ª defer çš„æ‰§è¡Œé¡ºåºæ˜¯åè¿›å…ˆå‡º LIFO ï¼š\n123defer func() &#123; fmt.Println(\"1\") &#125;()defer func() &#123; fmt.Println(\"2\") &#125;()defer func() &#123; fmt.Println(\"3\") &#125;()\nè¾“å‡ºé¡ºåºæ˜¯ 321ã€‚\nè¿™ä¸ªç‰¹æ€§å¯ä»¥å¯¹ä¸€ä¸ª array å®ç°é€†åºæ“ä½œã€‚\nè¢« deferred å‡½æ•°çš„å‚æ•°åœ¨ defer æ—¶ç¡®å®š\nè¿™æ˜¯ defer çš„ç‰¹ç‚¹ï¼Œä¸€ä¸ªå‡½æ•°è¢« defer æ—¶ï¼Œå®ƒçš„å‚æ•°åœ¨ defer æ—¶è¿›è¡Œè®¡ç®—ç¡®å®šï¼Œå³ä½¿ defer ä¹‹åå‚æ•°å‘ç”Ÿä¿®æ”¹ï¼Œå¯¹å·²ç» defer çš„å‡½æ•°æ²¡æœ‰å½±å“ï¼Œä»€ä¹ˆæ„æ€ï¼Ÿçœ‹ä¾‹å­ï¼š\n123456func a() &#123;    i := 0    defer fmt.Println(i)    i++    return&#125;\na æ‰§è¡Œè¾“å‡ºçš„æ˜¯ 0 è€Œä¸æ˜¯ 1ï¼Œå› ä¸º defer æ—¶ï¼Œi çš„å€¼æ˜¯ 0ï¼Œæ­¤æ—¶è¢« defer çš„å‡½æ•°å‚æ•°å·²ç»è¿›è¡Œæ‰§è¡Œè®¡ç®—å¹¶ç¡®å®šäº†ã€‚\nå†çœ‹ä¸€ä¸ªä¾‹å­ï¼š\n12345678910111213func calc(index string, a, b int) int &#123;    ret := a + b    fmt.Println(index, a, b, ret)    return ret&#125;func main() &#123;    a := 1    b := 2    defer calc(\"1\", a, calc(\"10\", a, b))    a = 0    return&#125;\næ‰§è¡Œä»£ç è¾“å‡º\n1210 1 2 3 1 1 3 4\ndefer å‡½æ•°çš„å‚æ•° ç¬¬ä¸‰ä¸ªå‚æ•°åœ¨ defer æ—¶å°±å·²ç»è®¡ç®—å®Œæˆå¹¶ç¡®å®šï¼Œç¬¬äºŒä¸ªå‚æ•° a ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ— è®ºä¹‹å a å˜é‡æ˜¯å¦ä¿®æ”¹éƒ½ä¸å½±å“ã€‚\nè¢« defer çš„å‡½æ•°å¯ä»¥è¯»å–å’Œä¿®æ”¹å¸¦åç§°çš„è¿”å›å€¼\n1234func c() (i int) &#123;    defer func() &#123; i++ &#125;()    return 1&#125;\nè¢« defer çš„å‡½æ•°æ˜¯åœ¨ return ä¹‹åæ‰§è¡Œï¼Œå¯ä»¥ä¿®æ”¹å¸¦åç§°çš„è¿”å›å€¼ï¼Œä¸Šé¢çš„å‡½æ•° c è¿”å›çš„æ˜¯ 2ã€‚\nGoè¯­è¨€ å¼‚å¸¸panicå’Œæ¢å¤recoverç”¨æ³•\nèƒŒæ™¯ï¼šGoè¯­è¨€è¿½æ±‚ç®€æ´ä¼˜é›…ï¼Œæ‰€ä»¥ï¼ŒGoè¯­è¨€ä¸æ”¯æŒä¼ ç»Ÿçš„ tryâ€¦catchâ€¦finally è¿™ç§å¼‚å¸¸ï¼Œå› ä¸ºGoè¯­è¨€çš„è®¾è®¡è€…ä»¬è®¤ä¸ºï¼Œå°†å¼‚å¸¸ä¸æ§åˆ¶ç»“æ„æ··åœ¨ä¸€èµ·ä¼šå¾ˆå®¹æ˜“ä½¿å¾—ä»£ç å˜å¾—æ··ä¹±ã€‚å› ä¸ºå¼€å‘è€…å¾ˆå®¹æ˜“æ»¥ç”¨å¼‚å¸¸ï¼Œç”šè‡³ä¸€ä¸ªå°å°çš„é”™è¯¯éƒ½æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚åœ¨Goè¯­è¨€ä¸­ï¼Œä½¿ç”¨å¤šå€¼è¿”å›æ¥è¿”å›é”™è¯¯ã€‚ä¸è¦ç”¨å¼‚å¸¸ä»£æ›¿é”™è¯¯ï¼Œæ›´ä¸è¦ç”¨æ¥æ§åˆ¶æµç¨‹ã€‚åœ¨æä¸ªåˆ«çš„æƒ…å†µä¸‹ï¼Œæ‰ä½¿ç”¨Goä¸­å¼•å…¥çš„Exceptionå¤„ç†ï¼šdefer, panic, recoverã€‚\npanicï¼š\n1ã€å†…å»ºå‡½æ•°\n2ã€å‡å¦‚å‡½æ•°Fä¸­ä¹¦å†™äº†panicè¯­å¥ï¼Œä¼šç»ˆæ­¢å…¶åè¦æ‰§è¡Œçš„ä»£ç ï¼Œåœ¨panicæ‰€åœ¨å‡½æ•°Få†…å¦‚æœå­˜åœ¨è¦æ‰§è¡Œçš„deferå‡½æ•°åˆ—è¡¨ï¼ŒæŒ‰ç…§deferçš„é€†åºæ‰§è¡Œ\næ¯”å¦‚panicå‡½æ•°å†…æœ‰ï¼š\n\ndefer  å‡½æ•°1\ndefer  å‡½æ•°2\ndefer  å‡½æ•°3\né‚£ä¹ˆæ‰§è¡Œé¡ºåºå°±æ˜¯ï¼š\nå‡½æ•°3\nå‡½æ•°2\nå‡½æ•°1\n\n3ã€è¿”å›å‡½æ•°Fçš„è°ƒç”¨è€…Gï¼Œåœ¨Gä¸­ï¼Œè°ƒç”¨å‡½æ•°Fè¯­å¥ä¹‹åçš„ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œå‡å¦‚å‡½æ•°Gä¸­å­˜åœ¨è¦æ‰§è¡Œçš„deferå‡½æ•°åˆ—è¡¨ï¼ŒæŒ‰ç…§deferçš„é€†åºæ‰§è¡Œï¼Œè¿™é‡Œçš„defer æœ‰ç‚¹ç±»ä¼¼ try-catch-finally ä¸­çš„ finally\n4ã€ç›´åˆ°goroutineæ•´ä¸ªé€€å‡ºï¼Œå¹¶æŠ¥å‘Šé”™è¯¯\nrecoverï¼š\n1ã€å†…å»ºå‡½æ•°\n2ã€ç”¨æ¥æ§åˆ¶ä¸€ä¸ªgoroutineçš„panickingè¡Œä¸ºï¼Œæ•è·panicï¼Œä»è€Œå½±å“åº”ç”¨çš„è¡Œä¸º\n3ã€ä¸€èˆ¬çš„è°ƒç”¨å»ºè®®\na). åœ¨deferå‡½æ•°ä¸­ï¼Œé€šè¿‡receveræ¥ç»ˆæ­¢ä¸€ä¸ªgojroutineçš„panickingè¿‡ç¨‹ï¼Œä»è€Œæ¢å¤æ­£å¸¸ä»£ç çš„æ‰§è¡Œ\nb). å¯ä»¥è·å–é€šè¿‡panicä¼ é€’çš„error\nç®€å•æ¥è®²ï¼šgoä¸­å¯ä»¥æŠ›å‡ºä¸€ä¸ªpanicçš„å¼‚å¸¸ï¼Œç„¶ååœ¨deferä¸­é€šè¿‡recoveræ•è·è¿™ä¸ªå¼‚å¸¸ï¼Œç„¶åæ­£å¸¸å¤„ç†ã€‚\nç¤ºä¾‹ä»£ç  mainå‡½æ•°ç›¸å½“äºè°ƒç”¨è€…Gï¼Œfå‡½æ•°ç›¸å½“äºå‡½æ•°F\n123456789101112131415161718192021222324func main() &#123;      fmt.Println(\"c\")   defer func() &#123; // å¿…é¡»è¦å…ˆå£°æ˜deferï¼Œå¦åˆ™ä¸èƒ½æ•è·åˆ°panicå¼‚å¸¸      fmt.Println(\"d\")      if err := recover(); err != nil &#123;         fmt.Println(err) // è¿™é‡Œçš„errå…¶å®å°±æ˜¯panicä¼ å…¥çš„å†…å®¹      &#125;      fmt.Println(\"e\")   &#125;()   f() //å¼€å§‹è°ƒç”¨f   fmt.Println(\"f\") //è¿™é‡Œå¼€å§‹ä¸‹é¢ä»£ç ä¸ä¼šå†æ‰§è¡Œ&#125;  func f() &#123;   fmt.Println(\"a\")   panic(\"å¼‚å¸¸ä¿¡æ¯\")   fmt.Println(\"b\") //è¿™é‡Œå¼€å§‹ä¸‹é¢ä»£ç ä¸ä¼šå†æ‰§è¡Œ&#125;-------output-------cadå¼‚å¸¸ä¿¡æ¯e\næ³¨æ„ï¼šåˆ©ç”¨recoverå¤„ç†panicæŒ‡ä»¤ï¼Œdeferå¿…é¡»åœ¨panicä¹‹å‰å£°æ˜ï¼Œå¦åˆ™å½“panicæ—¶ï¼Œrecoveræ— æ³•æ•è·åˆ°panicï¼\nå‚è€ƒèµ„æ–™\nhttps://blog.golang.org/defer-panic-and-recover\n","thumbnail":"/posts/go-defer/go-defer.png","plink":"https://shuntan.github.io/posts/go-defer/"},{"title":"Hexo + inside åšå®¢ä¸ªæ€§åŒ–å®šåˆ¶","date":"2020-04-22T11:24:28.000Z","date_formatted":{"ll":"Apr 22, 2020","L":"04/22/2020","MM-DD":"04-22"},"updated":"2020-04-22T11:29:22.617Z","content":"æˆ‘çš„åšå®¢é‡‡ç”¨çš„æ˜¯ Hexo å®˜æ–¹ç½‘ç«™ä¸Šç›¸ä¸­çš„ hexo+theme+inside ä¸»é¢˜ã€‚è™½ç„¶å¼€å‘è€…å·²ç»æä¾›äº†ä¸»é¢˜çš„ä½¿ç”¨æ–‡æ¡£ï¼Œä½†æ˜¯ä½œä¸ºä¸€æ¬¾å°ä¼—çš„ä¸»é¢˜ï¼Œä¸€äº›å¸¸ç”¨åŠŸèƒ½çš„å®šåˆ¶å¹¶ä¸æ˜¯é‚£ä¹ˆå®Œå–„ï¼Œä¸è¿‡è´´å¿ƒçš„å¼€å‘è€…æä¾›äº† plugins é…ç½®æ–¹æ¡ˆã€‚\n\nä¸‹æ–‡æ€»ç»“äº†éƒ¨åˆ†åŠŸèƒ½çš„æ‹“å±•æ–¹æ¡ˆï¼Œå¯ä¾›éœ€è¦çš„æœ‹å‹å‚è€ƒã€‚\n\næ³¨æ„ï¼šinside v2.6.3 ä¹‹å‰ä¼šå‡ºç°æ–‡ç« ä¸­ç‚¹å‡»ä¸Š/ä¸‹ä¸€ç¯‡æ—¶ï¼Œæ’ä»¶æ— æ³•ç”Ÿæ•ˆçš„æƒ…å†µã€‚\nå…¶åŸå› æ˜¯ä¸»é¢˜æ’ä»¶æ¨¡å—å­˜åœ¨ç»„ä»¶ç¼“å­˜é—®é¢˜ï¼Œå¯¼è‡´åˆ‡æ¢é¡µé¢æ—¶ js æ‰§è¡Œå¤±è´¥ï¼Œä¸ºäº†ä¿éšœåŠŸèƒ½æ­£å¸¸ä½¿ç”¨ï¼Œè¯·åŠ¡å¿…å°†ä¸»é¢˜å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚ï¼ˆ2020.03.14 æ›´æ–°ï¼‰\n\nplugin å‰ç½®å‡†å¤‡\nthemes/inside/_config.yml ä¸­çš„ plugins æ”¯æŒäºç‰¹å®šä½ç½®åŠ¨æ€æ’å…¥å¯æ‰§è¡Œçš„ä»£ç ç‰‡æ®µï¼Œæˆ–å…¨å±€åŠ è½½è„šæœ¬/æ ·å¼ã€‚\næ”¯æŒé€šè¿‡å®‰è£… html-minifierã€babel å’Œ uglify-js æ¥å®ç°ä»£ç å‹ç¼©ã€‚ åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼ˆHexo æ ¹ç›®å½•ï¼Œé themes/insideï¼‰ï¼š\n1npm install babel-core babel-preset-env html-minifier uglify-js --save\nFont Awesome\næŒ‰ç…§ plugin é…ç½®æè¿°çš„ï¼Œè¦æ”¯æŒ Font Awesome çš„ CSSï¼Œåªéœ€è¦è¿™æ ·è®¾ç½®ï¼š\n12_config.ymlplugins:  - //netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\nä¹Ÿå°±æ˜¯åœ¨å…¨å±€åŠ è½½æ ·å¼ï¼Œä¸è¿‡ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ²¡æœ‰æ­£å¸¸ç”Ÿæ•ˆğŸ¤”ï¼ˆinside-v2.6.1 å·²ç»ä¿®å¤äº†è¿™ä¸ªé—®é¢˜ï¼Œå»ºè®®ä½ å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼‰ã€‚\n\nå¦‚æœä½ æ˜¯ v2.6.0 åŠä»¥ä¸‹ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ¡ˆè§£å†³ï¼š\nåœ¨ themes/inside/layout/index.swig çš„ `` æ ‡ç­¾å†…åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š\n1index.swig&lt;link href=\"//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\" rel=\"stylesheet\"&gt;\nè¿™æ—¶ï¼Œè™½ç„¶å›¾æ ‡æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œä½†æ˜¯æ ·å¼è¿˜æ˜¯æœ‰ç‚¹é—®é¢˜ï¼Œå¯èƒ½å’Œä¸»é¢˜æœ¬èº«çš„ CSS æœ‰å…³ç³»ï¼Œæ‰¾åˆ° source ç›®å½•ä¸‹çš„ styles.e4da61f53c7bc99becf4.cssï¼ˆä¹Ÿå¯èƒ½å«åˆ«çš„ï¼‰ é‡Œçš„ .faï¼Œåˆ é™¤é‡Œé¢çš„ margin:10rem 0 3rem; ã€‚\n\n\nä¸è¿‡ä¸ªäººè§‰å¾—æ”¾åœ¨ CDN ä¸Šè®¿é—®é€Ÿåº¦è¿˜æ˜¯æœ‰ç‚¹æ…¢ï¼Œæ‰€ä»¥ä»å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæ”¾åœ¨ä¸»é¢˜çš„ source/lib ç›®å½•ä¸‹ï¼Œå…¨å±€å¼•ç”¨ï¼š\n12_config.ymlplugins:  - lib/font-awesome/css/font-awesome.min.css\næˆ–è€…åœ¨éœ€è¦çš„ä½ç½®å¼•ç”¨ CSS èµ„æºï¼š\n1&lt;link href=\"lib/font-awesome/css/font-awesome.min.css\" rel=\"stylesheet\"&gt;\nè®¿é—®é‡ç»Ÿè®¡\nå¾ˆå¤šäººéƒ½æœ‰ç«™ç‚¹è®¿é—®é‡ç»Ÿè®¡çš„éœ€æ±‚ï¼Œåƒè¿™æ ·ï¼š\n\næˆ‘é‡‡ç”¨çš„æ˜¯è½»é‡çš„ä¸è’œå­ç»Ÿè®¡æ¥åšè®¿é—®é‡ç»Ÿè®¡ã€‚\nå…ˆå®‰è£…è„šæœ¬ï¼Œåœ¨ä½¿ç”¨ä¸è’œå­çš„é¡µé¢ï¼Œä¹Ÿå°±æ˜¯ sidebar æ¨¡å—æ’å…¥ busuanzi.jsã€‚\n1234_config.ymlplugins:  - position: sidebar    template: |      &lt;script async src=\"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js\"&gt;&lt;/script&gt;\nå†å®‰è£…æ ‡ç­¾ï¼Œå®˜æ–¹ç»™å‡ºäº†ç«™ç‚¹ PV/UV çš„ç»Ÿè®¡ä»£ç ï¼š\n12&lt;span id=\"busuanzi_container_site_pv\"&gt;æœ¬ç«™æ€»è®¿é—®é‡&lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;æ¬¡&lt;/span&gt;&lt;span id=\"busuanzi_container_site_uv\"&gt;æœ¬ç«™è®¿å®¢æ•°&lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;äººæ¬¡&lt;/span&gt;\nä½ ä¹Ÿå¯ä»¥ç”¨è¿™ä¸¤ä¸ª id æ¥æ˜¾ç¤ºè®¿é—®æ•°ï¼š\n\nbusuanzi_value_site_pvï¼šå¼‚æ­¥å›å¡«è®¿é—®æ•°\nbusuanzi_container_site_pvï¼šä¸ºé˜²æ­¢è®¡æ•°æœåŠ¡è®¿é—®å‡ºé”™æˆ–è¶…æ—¶ï¼ˆ3 ç§’ï¼‰çš„æƒ…å†µä¸‹ï¼Œä½¿æ•´ä¸ªæ ‡ç­¾è‡ªåŠ¨éšè—æ˜¾ç¤º\n\nåœ¨ _config.yml æ–‡ä»¶é‡Œæ‰¾åˆ° footer ä¸‹çš„ customï¼Œå†™å…¥ç›¸å…³çš„ html ä»£ç ã€‚æ¯”å¦‚ï¼š\n12_config.yml# Custom textcustom: &lt;span id=\"busuanzi_container_site_uv\" style='display:none'&gt;Total &lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt; visitors. &lt;/span&gt;&lt;span id=\"busuanzi_container_site_pv\" style='display:none'&gt;&lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt; Views&lt;/span&gt;\næˆ–è€…ä½¿ç”¨ font-awesome å­—ä½“ï¼š\n12_config.yml# Custom textcustom: &lt;span id=\"busuanzi_container_site_pv\" style='display:none'&gt;&lt;i class=\"fa fa-eye\"&gt;&lt;/i&gt; &lt;span id=\"busuanzi_value_site_pv\"&gt;&lt;/span&gt;&lt;/span&gt; ï½œ &lt;span id=\"busuanzi_container_site_uv\" style='display:none'&gt;&lt;i class=\"fa fa-user\"&gt;&lt;/i&gt; &lt;span id=\"busuanzi_value_site_uv\"&gt;&lt;/span&gt;&lt;/span&gt;\nä»£ç å¤åˆ¶\nä¸ºäº†æ–¹ä¾¿åšå®¢çš„è¯»è€…å¼•ç”¨ä»£ç ï¼Œå¯ä»¥åœ¨æ–‡ç« ä¸­ä»£ç å—çš„å³ä¸Šè§’åŠ ä¸€ä¸ªå¤åˆ¶æŒ‰é’®ï¼Œå¦‚ï¼š\n\nå®ƒçš„å®ç°æ˜¯åœ¨é¡µé¢åŠ è½½å®Œæ¯•åï¼Œä½¿ç”¨ js åŠ¨æ€ä¸ºæ¯ä¸ªä»£ç å—æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œå½“é¼ æ ‡æ»‘åŠ¨åˆ°ä»£ç å—ä¸Šæ—¶æ˜¾ç¤ºæŒ‰é’®ï¼Œç‚¹å‡»æŒ‰é’®æ—¶å¤åˆ¶ä»£ç å—é‡Œçš„å†…å®¹ã€‚å› æ­¤éœ€è¦ä¸‰ä¸ªæ–‡ä»¶ï¼š\n\nå®ç°å¤åˆ¶ä»£ç å—åŠŸèƒ½çš„æ–‡ä»¶ clipboard.jsï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¼•ç”¨è¿™ä¸ªæ–‡ä»¶ï¼š https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.jsã€‚\næ”¯æŒåŠ¨æ€åˆ›å»ºå¤åˆ¶æŒ‰é’®çš„æ–‡ä»¶ clipboard-use.js\nå¤åˆ¶æŒ‰é’®çš„æ ·å¼æ–‡ä»¶ clipboard.css\n\né¡µé¢è½½å…¥å®Œæˆåï¼Œåˆ›å»ºä¸€ä¸ªå¤åˆ¶æŒ‰é’®ï¼Œä¸Šé¢ç”¨ font-awesome çš„ clipboard å›¾æ ‡ï¼Œå®ç°å¦‚ä¸‹ï¼š\n12345678910111213clipboard-use.js!function (e, t, a) &#123;  /* code */  var initCopyCode = function () &#123;    var copyHtml = '&lt;button class=\"btn-copy\" data-clipboard-snippet=\"\"&gt;&lt;i class=\"fa fa-clipboard\"&gt;&lt;/i&gt;&lt;/button&gt;';    $(\".highlight .code pre\").before(copyHtml);    new ClipboardJS('.btn-copy', &#123;      target: function (trigger) &#123;        return trigger.nextElementSibling;      &#125;    &#125;);  &#125;  initCopyCode();&#125;(window, document);\nè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œ clipboard-use.js ä¸­éœ€è¦ç”¨åˆ° jQueryï¼Œè€Œ inside é‡Œæ²¡æœ‰å¼•å…¥ï¼Œæ•…éœ€è¦æ‰‹åŠ¨å¼•å…¥ã€‚\nå¤åˆ¶æŒ‰é’®çš„æ ·å¼å¦‚ä¸‹ï¼š\n1234567891011121314151617181920212223242526clipboard.css.highlight &#123;    /* æ–¹ä¾¿ copy ä»£ç æŒ‰é’®ï¼ˆbtn-copyï¼‰çš„å®šä½ */    position: relative;&#125;.btn-copy &#123;    border-radius: 3px;    border-width: 0px;    font-size: 13px;    line-height: 20px;    padding: 2px 6px;    position: absolute;    right: 5px;    top: 5px;    background: none;    color: black;    opacity: 0;    outline: none;    -webkit-tap-highlight-color: transparent;    -webkit-appearance: none;&#125;.btn-copy span &#123;    margin-left: 5px;&#125;.highlight:hover .btn-copy &#123;    opacity: 1;&#125;\nå¤åˆ¶æŒ‰é’®å¯ä»¥æŒ‰ç…§è‡ªå·±çš„å–œå¥½è®¾ç½®ï¼Œå¦‚æœæƒ³ç®€å•ä¸€ç‚¹ï¼Œç›´æ¥ç”¨æˆ‘çš„æ ·å¼ï¼Œå¯ä»¥è¿™æ ·é…ç½®ï¼š\n12345678910_config.ymlplugins:  # inside ä¸»é¢˜æ²¡æœ‰å¼•å…¥ jQuery æ¡†æ¶ï¼Œéœ€è¦æ‰‹åŠ¨å¼•å…¥  - //cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js  # æ’ä»¶ç”Ÿæ•ˆèŒƒå›´ï¼špost å’Œ page  - position: [post, page]    template: |      &lt;script type=\"text/javascript\" src=\"//cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.js\"&gt;&lt;/script&gt;      &lt;script type=\"text/javascript\" src=\"//cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/clipboard-use.js\"&gt;&lt;/script&gt;      &lt;link href=\"//cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.1/clipboard.css\" rel=\"stylesheet\"&gt;      &lt;link href=\"lib/font-awesome/css/font-awesome.min.css\" rel=\"stylesheet\"&gt;\nå¦‚æœå·²ç»å…¨å±€å¼•ç”¨è¿‡ font-awesomeï¼Œå¯ä»¥æŠŠæœ€åä¸€æ¡å¼•ç”¨åˆ é™¤ã€‚\nè¯„è®ºç³»ç»Ÿ - Valine\nä¸»é¢˜çš„å†…ç½®è¯„è®ºï¼Œæ”¯æŒ Disqus å’Œ LiveReã€‚ä½†ä¸ªäººè®¤ä¸ºè¿™ä¸¤æ¬¾è¯„è®ºç³»ç»Ÿçš„ UI é£æ ¼ä¸»é¢˜ä¸æ˜¯å¾ˆæ­é…ï¼Œæœ€åè¿˜æ˜¯å†³å®šé‡‡ç”¨ Valineâ€”â€”ä¸€æ¬¾åŸºäº LeanCloud çš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿã€‚\nè™½ç„¶æ–‡æ¡£ä¸­ä¹Ÿæœ‰æä¾› Valine çš„é…ç½®æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘å®è·µåå‘ç°æ ·å¼è²Œä¼¼å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼Œè¿™æ¡ issue ä¹Ÿè¯å®äº†è¿™ä¸€ç‚¹ï¼ˆinside-2.6.1 å·²ä¿®å¤ï¼‰ã€‚æ‰€ä»¥æˆ‘å¦æ‰¾äº†ä¸€ä¸ª js æ–‡ä»¶ï¼Œå¹¶åšäº†ä¸€ç‚¹å°æ”¹åŠ¨ã€‚ä½ å¯ä»¥å¼•ç”¨æˆ‘æ”¾åœ¨ CDN ä¸Šçš„èµ„æº https://cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/valine.jsï¼Œæˆ–è€…ç›´æ¥æŠŠ valine.js æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ”¾åœ¨ inside/source/libè·¯å¾„ä¸‹ã€‚ç„¶åå†™å…¥ä»¥ä¸‹ä»£ç ï¼š\n1234567891011121314151617181920212223_config.ymlplugins:  # inside ä¸»é¢˜æ²¡æœ‰å¼•å…¥ jQuery æ¡†æ¶ï¼Œéœ€è¦æ‰‹åŠ¨å¼•å…¥  - //cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js  - //cdn1.lncld.net/static/js/3.0.4/av-min.js  # å¼•ç”¨æœ¬åœ° source/lib è·¯å¾„ä¸‹çš„ valine.js æ–‡ä»¶  # - lib/valine.js  # å¼•ç”¨ CDN ä¸Šçš„ valine.js æ–‡ä»¶  - //cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/valine.js  - position: comments    template: |      &lt;div id=\"vcomment\"&gt;&lt;/div&gt;      &lt;script&gt;        new Valine(&#123;          el: '#vcomment',          lang: 'en',          admin_email: 'Your EMAIL',          appId: 'Your APP ID',          appKey: 'Your APP KEY',          placeholder: 'Write a Comment',          emoticon_url:'https://cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@0.1.0/alu',          emoticon_list:[\"å.png\",\"å–·è¡€.png\",\"ç‹‚æ±—.png\",\"ä¸è¯´è¯.png\",\"æ±—.png\",\"åç­‰.png\",\"çŒ®èŠ±.png\",\"ä¸é«˜å…´.png\",\"ä¸­åˆ€.png\",\"å®³ç¾.png\",\"çš±çœ‰.png\",\"å°çœ¼ç›.png\",\"ä¸­æŒ‡.png\",\"å°´å°¬.png\",\"ç…ä½ .png\",\"æƒ³ä¸€æƒ³.png\",\"ä¸­æª.png\",\"å¾—æ„.png\",\"è‚¿åŒ….png\",\"æ‰‡è€³å…‰.png\",\"äº²äº².png\",\"æƒŠå–œ.png\",\"è„¸çº¢.png\",\"æ— æ‰€è°“.png\",\"ä¾¿ä¾¿.png\",\"æ„¤æ€’.png\",\"èœ¡çƒ›.png\",\"çŒ®é»„ç“œ.png\",\"å†…ä¼¤.png\",\"æŠ•é™.png\",\"è§‚å¯Ÿ.png\",\"çœ‹ä¸è§.png\",\"å‡»æŒ.png\",\"æŠ é¼».png\",\"é‚ªæ¶.png\",\"çœ‹çƒ­é—¹.png\",\"å£æ°´.png\",\"æŠ½çƒŸ.png\",\"é”çœ‰.png\",\"è£…å¤§æ¬¾.png\",\"åèˆŒ.png\",\"æ— å¥ˆ.png\",\"é•¿è‰.png\",\"èµä¸€ä¸ª.png\",\"å‘²ç‰™.png\",\"æ— è¯­.png\",\"é˜´æš—.png\",\"ä¸å‡ºæ‰€æ–™.png\",\"å’½æ°”.png\",\"æœŸå¾….png\",\"é«˜å…´.png\",\"åè¡€å€’åœ°.png\",\"å“­æ³£.png\",\"æ¬¢å‘¼.png\",\"é»‘çº¿.png\",\"å–œæè€Œæ³£.png\",\"å–·æ°´.png\",\"æ·±æ€.png\",\"é¼“æŒ.png\",\"æš—åœ°è§‚å¯Ÿ.png\"],        &#125;)      &lt;/script&gt;\nå…³äºä¸Šé¢çš„å‚æ•°ä»‹ç»ï¼š\n\nlangï¼šé€‰å¡«ï¼Œç›®å‰æ”¯æŒè‹±æ–‡ç‰ˆ en å’Œä¸­æ–‡ç‰ˆ zh-cn ä¸¤ç§ï¼Œé»˜è®¤æ˜¯ zh-cnã€‚\nadmin_emailï¼šé€‰å¡«ï¼Œè®¾ç½®ä½œè€…é‚®ç®±ï¼Œä½¿ç”¨è¯¥é‚®ç®±è´¦å·è¯„è®ºæˆ–å›å¤ï¼Œè¯„è®ºè€…åå­—å³ä¾§ä¼šå‡ºç°ä¸€ä¸ªäººå½¢å°å›¾æ ‡æ ‡è¯†ä½œè€…ã€‚\nappId&amp;appKeyï¼šå¿…å¡«ï¼ŒLeanCloud ä¸­åˆ›å»ºåº”ç”¨å¾—åˆ°çš„ APP ID å’Œ APP KEYï¼Œåˆ›å»ºæ–¹å¼å‚ç…§æ­¤æ–‡ã€‚\nemoticon_urlï¼šå¿…å¡«ï¼Œè¿™é‡Œè®¾ç½®ä¸€ä¸ªè¡¨æƒ…åŒ… CDN è·¯å¾„ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å–œæ¬¢çš„è¡¨æƒ…åŒ…ã€‚\nemoticon_listï¼šå¿…å¡«ï¼Œemoticon_urlé‡ŒåŒ…å«çš„è¡¨æƒ…åŒ…ä¸­éœ€è¦æ˜¾ç¤ºåœ¨è¯„è®ºåŒºçš„è¡¨æƒ…åŒ…åç§°åˆ—è¡¨ã€‚\n\n\nè¿™å°±æ˜¯é…ç½®æˆåŠŸåçš„è¯„è®ºæ¡†æ•ˆæœã€‚\nç›®å‰å·²ç»æœ‰ Valine è¯„è®ºç³»ç»Ÿçš„æ‹“å±•å’Œå¢å¼ºç‰ˆ Valine+Adminï¼Œä¸»è¦å®ç°è¯„è®ºé‚®ä»¶é€šçŸ¥ã€è¯„è®ºç®¡ç†ã€åƒåœ¾è¯„è®ºè¿‡æ»¤ç­‰åŠŸèƒ½ï¼Œè¿˜æ”¯æŒè‡ªå®šä¹‰ä¿®æ”¹é‚®ä»¶é€šçŸ¥æ¨¡æ¿ã€æ¼å‘é‚®ä»¶è‡ªåŠ¨è¡¥å‘ç­‰ã€‚å…·ä½“æ­¥éª¤è¿™ç¯‡é…ç½®æ‰‹å†Œå·²ç»æ¯”è¾ƒæ¸…æ™°äº†ï¼Œç…§ç€ä¸Šé¢çš„æ­¥éª¤æ“ä½œå³å¯ï¼Œæœ¬æ–‡å°±ä¸å¤åˆ¶ç²˜è´´äº†ã€‚\næ³¨æ„ï¼šæƒ³è¦åœ¨è¯„è®ºåŒºæ˜¾ç¤ºè‡ªå®šä¹‰å¤´åƒï¼Œå…ˆå‰å¾€Gravatar å®˜ç½‘æ³¨å†Œè´¦å·ï¼Œæ³¨å†Œçš„é‚®ç®±éœ€è¦å’Œä½ è¯„è®ºæ—¶å¡«å†™çš„é‚®ç®±ä¸€è‡´ã€‚å¦‚æœæ³¨å†ŒæˆåŠŸåï¼Œå¤´åƒä»æ²¡æœ‰æ˜¾ç¤ºï¼Œä¸è¦ç€æ€¥ï¼Œ gravatar.cat.net æœ‰ä¸ƒå¤©çš„ç¼“å­˜æœŸï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚\nä¸‹é¢å†åˆ†äº«å‡ ä¸ªå°åŠŸèƒ½ç‚¹çš„é…ç½®ï¼š\nåšå®¢èƒŒæ™¯\nä¿®æ”¹åšå®¢èƒŒæ™¯å¾ˆç®€å•ï¼Œåªéœ€ä¿®æ”¹ themes/inside/_config.yml ä¸­ appearance.background é…ç½®å³å¯ã€‚\nè¿™é‡Œåˆ†äº«ä¸€ä¸ªç½‘ç«™â€”â€”Subtle Patternsï¼Œæ”¯æŒè¶…è¿‡ 500 ç§ PNG é«˜å“è´¨å…è´¹èƒŒæ™¯çº¹ç†ç´ æï¼Œæ— é¡»æ³¨å†Œç™»å½•ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½ã€‚\nåšå®¢å­—ä½“\nä½ å¯èƒ½ä¼šå‘ç°éƒ¨ç½²å¥½çš„åšå®¢é¦–æ¬¡åŠ è½½æ—¶çš„å­—ä½“æ•ˆæœç”Ÿæ•ˆæ¯”è¾ƒæ…¢ï¼Œè¿™æ˜¯å› ä¸ºä¸»é¢˜ä¸­é»˜è®¤é…ç½®çš„å­—ä½“æ ·å¼ç”¨çš„æ˜¯è°·æ­Œçš„æœåŠ¡ï¼š\n123_config.ymlappearance:  font:    url: //fonts.googleapis.com/css?family=Baloo+Bhaijaan|Inconsolata|Josefin+Sans|Montserrat\nå¦‚æœè¢«å¢™äº†å°±æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸ªè®¿é—®æ›´å¿«çš„åœ°å€ï¼Œå¦‚ï¼š\n123_config.ymlappearance:  font:    url: //cdn.jsdelivr.net/gh/fiteen/fiteen.github.io@v0.1.0/font.css\nåˆ†äº« QQ é“¾æ¥\næˆ‘ä»¬å¯ä»¥åœ¨ sns.qq é‡Œé…ç½®è‡ªå·±æƒ³è¦é“¾æ¥çš„ QQ ID ä¿¡æ¯ï¼Œç›´æ¥å†™ QQ å·å½“ç„¶æ˜¯ä¸å¯è¡Œçš„ã€‚éœ€è¦å…ˆå¼€é€š QQ æ¨å¹¿ã€‚\n\nÂ æ ‡ç­¾é‡Œçš„Â hrefÂ å°±æ˜¯ä½ çš„Â QQ å·åˆ†äº«é“¾æ¥ï¼Œå½¢å¦‚ï¼šhttps://wpa.qq.com/msgrd?v=3&amp;uin=${YOUR-QQ-ID}&amp;site=qq&amp;menu=yesã€‚\nå¦‚æœä½ è¦åˆ†äº«ç¾¤å·ï¼Œé€šè¿‡åŠ ç¾¤ç»„ä»¶ï¼Œæ‹¿åˆ°å½¢å¦‚ï¼šhttps://shang.qq.com/wpa/qunwpa?idkey=${YOUR-GROUP-ID-KEY} çš„é“¾æ¥ã€‚\né…ç½® RSS\næ¯”è¾ƒç®€å•ï¼Œæ–‡æ¡£ä¸­æœ‰æåˆ°ï¼š\n\nè‹¥ä½¿ç”¨ hexo-generator-feedï¼Œsns.feed å¯ç•™ç©ºï¼Œä¸»é¢˜ä¼šå°è¯•å– hexo.config.feed.pathã€‚å¯é€šè¿‡æ”¹å˜é¡¹çš„å…ˆåé¡ºåºæ¥è‡ªå®šä¹‰æ’åºã€‚\n\nå› æ­¤ç›´æ¥åœ¨ç«™ç‚¹æ ¹ç›®å½•ï¼ˆä¸æ˜¯ä¸»é¢˜æ ¹ç›®å½•ï¼‰ä¸‹æ‰§è¡Œå‘½ä»¤å³å¯ï¼š\n1npm install hexo-generator-feed --save\nQ &amp; A\né—®é¢˜ 1ï¼šä¸ºä»€ä¹ˆæˆ‘æŒ‰ç…§æ–‡æ¡£è®¾ç½®äº†ï¼ŒåŠ äº†æ’ä»¶è®¾ç½®åï¼Œä¸ä½†æ²¡æœ‰ç”Ÿæ•ˆï¼Œå…¶å®ƒåŠŸèƒ½è¿˜å‡ºäº†é—®é¢˜æˆ–è€…å·¥ç¨‹éƒ½è·‘ä¸èµ·æ¥äº†ï¼Ÿ\n\næ£€æŸ¥ä¸€ä¸‹é…ç½®ä»£ç çš„ç©ºæ ¼ï¼Œyml æ–‡ä»¶å¯¹ä»£ç æ ¼å¼çš„è¦æ±‚æ¯”è¾ƒä¸¥æ ¼ã€‚\næ£€æŸ¥æ˜¯å¦é‡å¤æ·»åŠ äº† plugins:ï¼Œæ·»åŠ å¤šä¸ªæ’ä»¶ä¹Ÿåªéœ€è¦å£°æ˜ä¸€æ¬¡ã€‚\n\né—®é¢˜ 2ï¼šèƒ½å¦å‡ºä¸€ä¸ªå°ç™½æ•™ç¨‹ï¼Ÿ\nå¯ä»¥åœ¨è¯„è®ºåŒºæè¿°ä½ çš„é—®é¢˜ï¼Œæˆ‘ä¼šæŠ½ç©ºæ•´ç†åˆ°ä¸€èµ·ï¼Œè¡¥å……åœ¨åšå®¢ä¸­ã€‚\né—®é¢˜ 3ï¼šæˆ‘å¸Œæœ›åšå®¢å¯ä»¥æ”¯æŒæŸæŸåŠŸèƒ½ï¼Œä½†æ˜¯ä¸çŸ¥é“è¯¥æ€ä¹ˆåšï¼Œèƒ½å¦å¸®å¿™å®ç°ä¸€ä¸‹ï¼Ÿ\nå¯ä»¥æ issue ç»™æˆ‘ã€‚\n","thumbnail":"/posts/Hexo-insideä¸ªæ€§åŒ–å®šåˆ¶/hexo.png","plink":"https://shuntan.github.io/posts/Hexo-insideä¸ªæ€§åŒ–å®šåˆ¶/"},{"title":"RetroArchä¸Šæ‰‹æ•™ç¨‹","date":"2020-02-07T12:27:34.000Z","date_formatted":{"ll":"Feb 7, 2020","L":"02/07/2020","MM-DD":"02-07"},"updated":"2020-04-22T12:04:40.660Z","content":"ç®€ä»‹\n\nRetroArchå¯ä»¥åœ¨Windowsï¼ŒMac OS Xå’ŒLinuxç­‰å¸¸ç”¨å¹³å°ä¸Šè¿è¡Œï¼Œä½†å®ƒå¯ä»¥å•ç‹¬æ”¯æŒå®ƒï¼Œå› æ­¤å¯ä»¥æ”¯æŒæ›´å¤šå¹³å°ã€‚\næˆ‘ä»¬æ”¯æŒç”šè‡³Microsoftå’ŒAppleæœ¬èº«éƒ½ä¸æ”¯æŒçš„æ“ä½œç³»ç»Ÿï¼Œä¾‹å¦‚PowerPC Macä¸Šçš„macOS Xï¼Œä»¥åŠæ—©äºWindows 95çš„Windows OSä¸Šéƒ½å¯ä»¥ä½¿ç”¨RetroArchã€‚\næœ€é‡è¦çš„æ˜¯ï¼ŒRetroArchè¿˜å¯ä»¥åœ¨é€‚ç”¨äºå¹³æ¿ç”µè„‘å’Œæ‰‹æœºçš„iOSå’ŒAndroidä»¥åŠPS2ï¼ŒPS3ï¼ŒPSPï¼ŒPS Vitaï¼ŒWiiï¼ŒWii Uï¼Œ2DSï¼Œ3DSï¼ŒSwitchç­‰æ¸¸æˆæœºä¸Šè¿è¡Œï¼\n\n\næˆªå›¾\n\n\n\n\nä¸‹è½½\næ¨¡æ‹Ÿå™¨ä¸‹è½½\n\n            RetroArchä¸‹è½½åœ°å€:  (https://retroarch.com/?page=platforms)å½“å‰çš„ç¨³å®šç‰ˆæœ¬æ˜¯ï¼š1.8.4Windows MacOS\n          \næ¸¸æˆä¸‹è½½åœ°å€\nç™¾åº¦äº‘ï¼š(https://pan.baidu.com/s/1WCy6pePZgu86YbCaLPuwmw)\nåŒ…å«ä»¥ä¸‹æ¸¸æˆï¼š\n\n\nâ€“è‹±æ–‡â€“\nâ€“ä¸­æ–‡â€“\n\n\n\n\nSFC ROMï¼ˆä¸­æ–‡ï¼‰\nFC ROMï¼ˆè‹±æ–‡ï¼‰\n\n\nPEC ROM ï¼ˆä¸­æ–‡ï¼‰\nMAME ï¼ˆè‹±æ–‡ï¼‰\n\n\nCPS1 ï¼ŒCPS2ï¼ŒCPS3 ROMï¼ˆä¸­æ–‡ï¼‰\nNeoGeo ï¼ˆè‹±æ–‡ï¼‰\n\n\nGBA ROMï¼ˆä¸­æ–‡ï¼‰\nMD ROMï¼ˆè‹±æ–‡ï¼‰\n\n\næ¨¡æ‹Ÿå™¨é…ç½®\nä¸­æ–‡è®¾ç½®\n\nç”±äºæœ¬è½¯ä»¶æœªå¯¹ä¸­æ–‡é…ç½®ä¼˜åŒ–ï¼Œè¯­è¨€é€‰æ‹©â€œä¸­æ–‡â€æˆ–â€œç¹ä½“ä¸­æ–‡â€æ—¶ä¼šå‡ºç°???çš„æƒ…å†µéœ€è¦è‡ªå·±ä¸‹è½½ä¸­æ–‡å­—ä½“ï¼Œèœå•æ ·å¼ä¸€èˆ¬ä¸ºxmbï¼Œæ ·å¼çš®è‚¤ä¸€èˆ¬ä¸ºmonochromeã€‚å¯ä»¥æ‰‹åŠ¨ä¿®æ”¹æ›¿æ¢ä¸ºè‡ªå·±å–œæ¬¢çš„æ ·å¼å’Œçš®è‚¤ã€‚\n\n\n            è®¾ç½®ä¸­æ–‡æ–¹æ³•å°†ä¸‹è½½æ¥çš„&quot;å¾®è½¯é›…é»‘&quot;å­—ä½“æ‹·å‡ºæ¥å¹¶æ”¹åä¸ºfont.ttfï¼Œæ‹·åˆ°å†…å­˜å¡:\\RetroArch\\assets\\xmb\\monochrome&lt;/span&gt;ç›®å½•ä¸‹æ›¿æ¢ä¸»èœå• Settings --&gt; Onscreen Display --&gt; Onscreen Notifications --&gt; Notification FontUser Interface --&gt; Appearance --&gt; Menu Fontï¼Œé€‰æ‹©åˆšæ‰æ‹·çš„font.ttfä¸»èœå• Settings --&gt; User --&gt; Language é€‰æ‹©ç®€ä½“ä¸­æ–‡\n          \n\n            XMBç•Œé¢å¯åŠ¨æ–¹æ³•è®¾ç½®é‡Œé¢-èœå•é©±åŠ¨-é€‰xmbï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹User Interface --&gt; Appearance --&gt; Menu Icon Themeåˆ‡æ¢çš®è‚¤ä¸»é¢˜\n          \næ ¸å¿ƒè®¾ç½®\n\nç”±äºåˆšåˆšä¸‹è½½çš„æ¨¡æ‹Ÿå™¨æœ¬ä½“æ˜¯ä¸å¸¦æ ¸å¿ƒçš„ï¼Œéœ€è¦è‡ªå·±ä¸‹è½½æ ¸å¿ƒæ‰èƒ½åŠ è½½å’Œæ¨¡æ‹Ÿå¯¹åº”çš„æ¸¸æˆ\n\n\n            æ ¸å¿ƒå®‰è£…æ ¸å¿ƒå®‰è£…æ–¹æ³•ç›®å‰æœ‰ä¸¤ç§ï¼šå¤–éƒ¨ä¸‹è½½å¯¼å…¥ï¼šWindows: (http://buildbot.libretro.com/nightly/windows/x86_64/latest/)MacOS: (http://buildbot.libretro.com/nightly/apple/osx/x86/latest)ä¸‹è½½å¥½å¯¹åº”çš„æ ¸å¿ƒä¹‹åå¯¼å…¥coresæ–‡ä»¶å¤¹ä¸­å†…éƒ¨ä¸‹è½½å®‰è£…ï¼šå¯ä»¥é€šè¿‡è®¾ç½®è·¯å¾„Main Menu -&gt; Load Core -&gt;Download a Coreæ¥ä¸‹è½½æƒ³è¦çš„æ ¸å¿ƒã€‚\n          \næ¸¸æˆæ‰«æ\n\n            å¯¼å…¥æ¸¸æˆæ–‡ä»¶å¤¹é€šè¿‡è®¾ç½®Import content -&gt; Scan Directoryæ¥è®¾ç½®ä½ è¦æ‰«æçš„æ¸¸æˆè·¯å¾„ï¼Œèƒ½å¤Ÿé€šè¿‡æ ¸å¿ƒè¯†åˆ«å‡ºæ¥çš„æ¸¸æˆä¼šè¢«è‡ªåŠ¨åŠ å…¥æ’­æ”¾åˆ—è¡¨ä¸­ï¼Œæˆ–è€…é€šè¿‡Import content -&gt; Manual Scanæ¥ä¸»åŠ¨å®šåˆ¶è¯†åˆ«è§„åˆ™ï¼Œæ‰«ææˆåŠŸåç”Ÿæˆplaylistså’Œdatabaseåç§°\n          \næ¸¸æˆå°é¢\n\n            æ¸¸æˆæˆªå›¾é…ç½®é¦–å…ˆè¿›å…¥èœå•è®¾ç½®ï¼Œå°†ç¼©ç•¥å›¾é€‰é¡¹è®¾ç½®æˆæˆªå±ï¼Œæ‰¾åˆ°Settings -&gt; Directory -&gt; Thumbnailsæ–‡ä»¶å¤¹çš„è·¯å¾„ï¼Œå°†ä¸RomåŒåçš„ç•¥ç¼©å›¾æ–‡ä»¶å¤¹å¯¼å…¥å…¶ä¸­ï¼Œä¾‹å¦‚ï¼šRetroArch\\thumbnails\\Sega - Dreamcast\\Named_Snapsï¼Œå…¶ä¸­Sega - Dreamcastä¸ºdatabaseåç§°ä¸€èˆ¬ä¹Ÿä¸ºæ ¸å¿ƒåç§°ï¼Œå…¶ä¸­ç•¥ç¼©å›¾æ–‡ä»¶åå’Œæ¸¸æˆæ–‡ä»¶åç›¸åŒä¸”åç¼€æ ¼å¼ä¸º.pngæ ¼å¼ï¼Œæ ¹æ–‡ä»¶å¤¹åç§°å’Œdatabaseåç§°ä¸€è‡´å³å¯ã€‚\n          \n","thumbnail":"/posts/RetroArchä¸Šæ‰‹æ•™ç¨‹/retroarch.png","plink":"https://shuntan.github.io/posts/RetroArchä¸Šæ‰‹æ•™ç¨‹/"},{"title":"å·«å¸ˆä¸‰å¹²è´§æ”¶è—","date":"2020-01-23T14:35:55.000Z","date_formatted":{"ll":"Jan 23, 2020","L":"01/23/2020","MM-DD":"01-23"},"updated":"2020-04-22T12:10:39.131Z","content":"The wither 3ï¼šèåœæ˜¯ç‹©é­”çŒäººä¸–ç•Œä¸­æœ€å¼ºå¤§çš„ç”Ÿç‰©ã€‚å®ƒå¯ä»¥ç¬é—´ç§»åŠ¨åˆ°æ°æ´›ç‰¹çš„èº«è¾¹ï¼Œå¹¶ä¸”ä¸å—ä»»ä½•é­”æ³•çš„å½±å“ã€‚æ²¡æœ‰äººèƒ½ä¼¤åˆ°èåœï¼Œå½“èåœå—åˆ°æ”»å‡»æ—¶ï¼Œå®ƒä¼šæ„¤æ€’çš„æŠ¬èµ·å®ƒé‚£ç²—å£®çš„åè…¿è¿›è¡Œåå‡»ã€‚åœ¨å •å…¥æ‚¬å´–æ—¶ï¼Œèåœä¼šä½¿ç”¨ç¬é—´ç§»åŠ¨é€ƒè„±ï¼Œå¹¶ä¸”åœ¨ä¸–ç•Œä¸Šæ¶ˆå¤±ï¼Œæ ¹æœ¬æ‰¾ä¸åˆ°ä¸€ä¸è¸ªè¿¹ã€‚è€Œå½“æ°æ´›ç‰¹å†æ¬¡å¬å”¤èåœæ—¶ èåœä¼šä»æŸä¸ªåœ°æ–¹çªç„¶è¹¿å‡ºæ¥ æ…¢æ…¢æ‚ æ‚ çš„èµ°å‘æ°æ´›ç‰¹ã€‚ã€‚\nã€€ã€€â€œè¦è¯´èåœæœ‰ä»€ä¹ˆä¸è¶³çš„è¯ï¼Œå¤§æ¦‚æ˜¯å®ƒä¸ä¼šæ‰“æ˜†ç‰¹ç‰Œå§â€â€”â€”åˆ©ç»´äºšçš„æ°æ´›ç‰¹\n\n\n\n            ã€Šå¼€åœº-CGã€‹å¯»æ‰¾å¶å¥ˆæ³•\n          \n\n\n            ã€ŠPresent-CGã€‹æ€ªç‰©çŒäºº\n          \n\n\n            ã€Šéš¾å¿˜ä¹‹å¤œ-CGã€‹è¡€ä¸é…’\n          \n\n\n            ã€ŠE3-CGã€‹E3æ¸¸æˆä¼šå±•\n          \n\n\n            ã€ŠMarcin PrzybyÅ‚owiczã€‹50é¦–ç»å…¸å•æ›²\n          \n\n\n            ã€ŠThe Sansretourã€‹12é¦–ç»å…¸å•æ›²\n          \n","thumbnail":"/posts/å·«å¸ˆä¸‰å¹²è´§æ”¶è—/cdprojekt.png","plink":"https://shuntan.github.io/posts/å·«å¸ˆä¸‰å¹²è´§æ”¶è—/"},{"title":"newå’Œmallocçš„åŒºåˆ«","date":"2019-09-19T06:58:35.000Z","date_formatted":{"ll":"Sep 19, 2019","L":"09/19/2019","MM-DD":"09-19"},"updated":"2020-04-22T12:23:24.908Z","content":"1. ç”³è¯·çš„å†…å­˜æ‰€åœ¨ä½ç½®\nnewæ“ä½œç¬¦ä»è‡ªç”±å­˜å‚¨åŒºï¼ˆfree storeï¼‰ä¸Šä¸ºå¯¹è±¡åŠ¨æ€åˆ†é…å†…å­˜ç©ºé—´ï¼Œè€Œmallocå‡½æ•°ä»å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ã€‚\nè‡ªç”±å­˜å‚¨åŒºæ˜¯C++åŸºäºnewæ“ä½œç¬¦çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå‡¡æ˜¯é€šè¿‡newæ“ä½œç¬¦è¿›è¡Œå†…å­˜ç”³è¯·ï¼Œè¯¥å†…å­˜å³ä¸ºè‡ªç”±å­˜å‚¨åŒºã€‚è€Œå †æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„æœ¯è¯­ï¼Œæ˜¯æ“ä½œç³»ç»Ÿæ‰€ç»´æŠ¤çš„ä¸€å—ç‰¹æ®Šå†…å­˜ï¼Œç”¨äºç¨‹åºçš„å†…å­˜åŠ¨æ€åˆ†é…ï¼ŒCè¯­è¨€ä½¿ç”¨mallocä»å †ä¸Šåˆ†é…å†…å­˜ï¼Œä½¿ç”¨freeé‡Šæ”¾å·²åˆ†é…çš„å¯¹åº”å†…å­˜ã€‚\né‚£ä¹ˆè‡ªç”±å­˜å‚¨åŒºæ˜¯å¦èƒ½å¤Ÿæ˜¯å †ï¼ˆé—®é¢˜ç­‰ä»·äºnewæ˜¯å¦èƒ½åœ¨å †ä¸ŠåŠ¨æ€åˆ†é…å†…å­˜ï¼‰ï¼Œè¿™å–å†³äºoperator new çš„å®ç°ç»†èŠ‚ã€‚è‡ªç”±å­˜å‚¨åŒºä¸ä»…å¯ä»¥æ˜¯å †ï¼Œè¿˜å¯ä»¥æ˜¯é™æ€å­˜å‚¨åŒºï¼Œè¿™éƒ½çœ‹operator newåœ¨å“ªé‡Œä¸ºå¯¹è±¡åˆ†é…å†…å­˜ã€‚\n\nç‰¹åˆ«çš„ï¼Œnewç”šè‡³å¯ä»¥ä¸ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼å®šä½newçš„åŠŸèƒ½å¯ä»¥åŠåˆ°è¿™ä¸€ç‚¹ï¼š\n1new (place_address) type\nplace_addressä¸ºä¸€ä¸ªæŒ‡é’ˆï¼Œä»£è¡¨ä¸€å—å†…å­˜çš„åœ°å€ã€‚å½“ä½¿ç”¨ä¸Šé¢è¿™ç§ä»…ä»¥ä¸€ä¸ªåœ°å€è°ƒç”¨newæ“ä½œç¬¦æ—¶ï¼Œnewæ“ä½œç¬¦è°ƒç”¨ç‰¹æ®Šçš„operator newï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™ä¸ªç‰ˆæœ¬ï¼š\n1void * operator new (size_t,void *) //ä¸å…è®¸é‡å®šä¹‰è¿™ä¸ªç‰ˆæœ¬çš„operator new\nè¿™ä¸ªoperator newä¸åˆ†é…ä»»ä½•çš„å†…å­˜ï¼Œå®ƒåªæ˜¯ç®€å•åœ°è¿”å›æŒ‡é’ˆå®å‚ï¼Œç„¶åå³newè¡¨è¾¾å¼è´Ÿè´£åœ¨place_addressæŒ‡å®šçš„åœ°å€è¿›è¡Œå¯¹è±¡çš„åˆå§‹åŒ–å·¥ä½œã€‚\nâ€‹\t\tæ‰€ä»¥ä»¥è¿™ç§æ–¹å¼newçš„æŒ‡é’ˆæ— éœ€deleteï¼Œåªéœ€è¦å…³æ³¨place_addressçš„å†…å­˜çš„é‡Šæ”¾ä¸å¦ã€‚ä¾‹å¦‚ï¼š\n1234567891011121314tempalete &lt;typename U&gt;static inline U* create_array(size_t count)&#123;\tassert(count &gt; 0);\tauto p = static_cast&lt;U*&gt;((malloc)(sizeof(U) * count)) //åˆ›å»ºä¸€å—å†…å­˜\tif (nullptr == p)&#123;\t\treturn nullptr;\t&#125;\t\tfor (size_t i = 0; i != count; ++i)&#123;\t\tnew (p + i) U();  //åœ¨æŒ‡å®šçš„å†…å­˜åœ°å€åˆ›å»ºå¯¹è±¡\t&#125;\treturn p;&#125;\n1234567891011tempalete &lt;typename U&gt;static inline void destory_array(U* p, size_t count)&#123;\tif(p != nullptr)&#123;\t\tassert(count &gt; 0);\t\tfor (size_t i = count; i !- 0; )&#123;\t\t\t(p + --i)-&gt;~U();  //ææ„æŒ‡å®šå†…å­˜ä½ç½®çš„å¯¹è±¡\t\t&#125;\t\t(free)(p);  //é‡Šæ”¾å†…å­˜\t&#125;&#125;\n2.è¿”å›ç±»å‹å®‰å…¨æ€§\nnewæ“ä½œç¬¦å†…å­˜åˆ†é…æˆåŠŸæ—¶ï¼Œè¿”å›çš„æ˜¯å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆï¼Œç±»å‹ä¸¥æ ¼ä¸å¯¹è±¡åŒ¹é…ï¼Œæ— é¡»è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ•…newæ˜¯ç¬¦åˆç±»å‹å®‰å…¨æ€§çš„æ“ä½œç¬¦ã€‚è€Œmallocå†…å­˜åˆ†é…æˆåŠŸåˆ™æ˜¯è¿”å›void * ï¼Œéœ€è¦é€šè¿‡å¼ºåˆ¶ç±»å‹è½¬æ¢å°†void*æŒ‡é’ˆè½¬æ¢æˆæˆ‘ä»¬éœ€è¦çš„ç±»å‹ã€‚\nç±»å‹å®‰å…¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥ç­‰ä»·äºå†…å­˜å®‰å…¨ï¼Œç±»å‹å®‰å…¨çš„ä»£ç ä¸ä¼šè¯•å›¾åˆ†é…è‡ªå·±æ²¡è¢«æˆæƒçš„å†…å­˜åŒºåŸŸã€‚å…³äºC++çš„ç±»å‹å®‰å…¨æ€§å¯è¯´çš„åˆæœ‰å¾ˆå¤šäº†ã€‚\n3.å†…å­˜åˆ†é…å¤±è´¥æ—¶çš„è¿”å›å€¼\nnewå†…å­˜åˆ†é…å¤±è´¥æ—¶ï¼Œä¼šæŠ›å‡ºbac_allocå¼‚å¸¸ï¼Œå®ƒä¸ä¼šè¿”å›NULLï¼›mallocåˆ†é…å†…å­˜å¤±è´¥æ—¶è¿”å›NULLã€‚\nåœ¨ä½¿ç”¨Cè¯­è¨€æ—¶ï¼Œæˆ‘ä»¬ä¹ æƒ¯åœ¨mallocåˆ†é…å†…å­˜ååˆ¤æ–­åˆ†é…æ˜¯å¦æˆåŠŸï¼š\n123456789int *a  = (int *)malloc ( sizeof (int ));if(NULL == a)&#123;    ...&#125;else &#123;    ...&#125;\nä»Cè¯­è¨€èµ°å…¥Cé˜µè¥çš„æ–°æ‰‹å¯èƒ½ä¼šæŠŠè¿™ä¸ªä¹ æƒ¯å¸¦å…¥Cï¼š\n123456789int * a = new int();if(NULL == a)&#123;    ...&#125;else&#123;       ...&#125;\nå®é™…ä¸Šè¿™æ ·åšä¸€ç‚¹æ„ä¹‰ä¹Ÿæ²¡æœ‰ï¼Œå› ä¸ºnewæ ¹æœ¬ä¸ä¼šè¿”å›NULLï¼Œè€Œä¸”ç¨‹åºèƒ½å¤Ÿæ‰§è¡Œåˆ°ifè¯­å¥å·²ç»è¯´æ˜å†…å­˜åˆ†é…æˆåŠŸäº†ï¼Œå¦‚æœå¤±è´¥æ—©å°±æŠ›å¼‚å¸¸äº†ã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯ä½¿ç”¨å¼‚å¸¸æœºåˆ¶ï¼š\n12345678try&#123;    int *a = new int();&#125;catch (bad_alloc)&#123;    ...&#125;\nå¦‚æœä½ æƒ³é¡ºä¾¿äº†è§£ä¸‹å¼‚å¸¸åŸºç¡€ï¼Œå¯ä»¥çœ‹http://www.cnblogs.com/QG-whz/p/5136883.htmlC++ å¼‚å¸¸æœºåˆ¶åˆ†æã€‚\n4.æ˜¯å¦éœ€è¦æŒ‡å®šå†…å­˜å¤§å°\nä½¿ç”¨newæ“ä½œç¬¦ç”³è¯·å†…å­˜åˆ†é…æ—¶æ— é¡»æŒ‡å®šå†…å­˜å—çš„å¤§å°ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»å‹ä¿¡æ¯è‡ªè¡Œè®¡ç®—ï¼Œè€Œmallocåˆ™éœ€è¦æ˜¾å¼åœ°æŒ‡å‡ºæ‰€éœ€å†…å­˜çš„å°ºå¯¸ã€‚\n123class A&#123;...&#125;A * ptr = new A;A * ptr = (A *)malloc(sizeof(A)); //éœ€è¦æ˜¾å¼æŒ‡å®šæ‰€éœ€å†…å­˜å¤§å°sizeof(A);\nå½“ç„¶äº†ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨mallocæ¥ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰ç±»å‹åˆ†é…å†…å­˜æ˜¯ä¸æ€ä¹ˆåˆé€‚çš„ï¼Œè¯·çœ‹ä¸‹ä¸€æ¡ã€‚\n5.æ˜¯å¦è°ƒç”¨æ„é€ å‡½æ•°/ææ„å‡½æ•°\nä½¿ç”¨newæ“ä½œç¬¦æ¥åˆ†é…å¯¹è±¡å†…å­˜æ—¶ä¼šç»å†ä¸‰ä¸ªæ­¥éª¤ï¼š\nç¬¬ä¸€æ­¥ï¼šè°ƒç”¨operator new å‡½æ•°ï¼ˆå¯¹äºæ•°ç»„æ˜¯operator new[]ï¼‰åˆ†é…ä¸€å—è¶³å¤Ÿå¤§çš„ï¼ŒåŸå§‹çš„ï¼Œæœªå‘½åçš„å†…å­˜ç©ºé—´ä»¥ä¾¿å­˜å‚¨ç‰¹å®šç±»å‹çš„å¯¹è±¡ã€‚\nç¬¬äºŒæ­¥ï¼šç¼–è¯‘å™¨è¿è¡Œç›¸åº”çš„æ„é€ å‡½æ•°ä»¥æ„é€ å¯¹è±¡ï¼Œå¹¶ä¸ºå…¶ä¼ å…¥åˆå€¼ã€‚\nç¬¬ä¸‰éƒ¨ï¼šå¯¹è±¡æ„é€ å®Œæˆåï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆã€‚\nä½¿ç”¨deleteæ“ä½œç¬¦æ¥é‡Šæ”¾å¯¹è±¡å†…å­˜æ—¶ä¼šç»å†ä¸¤ä¸ªæ­¥éª¤ï¼š\nç¬¬ä¸€æ­¥ï¼šè°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°ã€‚\nç¬¬äºŒæ­¥ï¼šç¼–è¯‘å™¨è°ƒç”¨operator delete(æˆ–operator delete[])å‡½æ•°é‡Šæ”¾å†…å­˜ç©ºé—´ã€‚\næ€»ä¹‹æ¥è¯´ï¼Œnew/deleteä¼šè°ƒç”¨å¯¹è±¡çš„æ„é€ å‡½æ•°/ææ„å‡½æ•°ä»¥å®Œæˆå¯¹è±¡çš„æ„é€ /ææ„ã€‚è€Œmallocåˆ™ä¸ä¼šã€‚å¦‚æœä½ ä¸å«Œå•°å—¦å¯ä»¥çœ‹ä¸‹æˆ‘çš„ä¾‹å­ï¼š\n12345678910111213 class A&#123;public:    A() :a(1), b(1.11)&#123;&#125;private:    int a;    double b;&#125;;int main()&#123;    A * ptr = (A*)malloc(sizeof(A));    return 0;&#125;\nåœ¨returnå¤„è®¾ç½®æ–­ç‚¹ï¼Œè§‚çœ‹ptræ‰€æŒ‡å†…å­˜çš„å†…å®¹ï¼š\n\nå¯ä»¥çœ‹å‡ºAçš„é»˜è®¤æ„é€ å‡½æ•°å¹¶æ²¡æœ‰è¢«è°ƒç”¨ï¼Œå› ä¸ºæ•°æ®æˆå‘˜a,bçš„å€¼å¹¶æ²¡æœ‰å¾—åˆ°åˆå§‹åŒ–ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢æˆ‘ä¸ºä»€ä¹ˆè¯´ä½¿ç”¨malloc/freeæ¥å¤„ç†C++çš„è‡ªå®šä¹‰ç±»å‹ä¸åˆé€‚ï¼Œå…¶å®ä¸æ­¢è‡ªå®šä¹‰ç±»å‹ï¼Œæ ‡å‡†åº“ä¸­å‡¡æ˜¯éœ€è¦æ„é€ /ææ„çš„ç±»å‹é€šé€šä¸åˆé€‚ã€‚\nè€Œä½¿ç”¨newæ¥åˆ†é…å¯¹è±¡æ—¶ï¼š\n1234int main()&#123;    A * ptr = new A;&#125;\næŸ¥çœ‹ç¨‹åºç”Ÿæˆçš„æ±‡ç¼–ä»£ç å¯ä»¥å‘ç°ï¼ŒAçš„é»˜è®¤æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ï¼š\n\n6.å¯¹æ•°ç»„çš„å¤„ç†\nC++æä¾›äº†new[]ä¸delete[]æ¥ä¸“é—¨å¤„ç†æ•°ç»„ç±»å‹:\n1A * ptr = new A[10];//åˆ†é…10ä¸ªAå¯¹è±¡\nä½¿ç”¨new[]åˆ†é…çš„å†…å­˜å¿…é¡»ä½¿ç”¨delete[]è¿›è¡Œé‡Šæ”¾ï¼š\n1delete [] ptr;\nnewå¯¹æ•°ç»„çš„æ”¯æŒä½“ç°åœ¨å®ƒä¼šåˆ†åˆ«è°ƒç”¨æ„é€ å‡½æ•°å‡½æ•°åˆå§‹åŒ–æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ ï¼Œé‡Šæ”¾å¯¹è±¡æ—¶ä¸ºæ¯ä¸ªå¯¹è±¡è°ƒç”¨ææ„å‡½æ•°ã€‚æ³¨æ„delete[]è¦ä¸new[]é…å¥—ä½¿ç”¨ï¼Œä¸ç„¶ä¼šæ‰¾å‡ºæ•°ç»„å¯¹è±¡éƒ¨åˆ†é‡Šæ”¾çš„ç°è±¡ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚\nè‡³äºmallocï¼Œå®ƒå¹¶çŸ¥é“ä½ åœ¨è¿™å—å†…å­˜ä¸Šè¦æ”¾çš„æ•°ç»„è¿˜æ˜¯å•¥åˆ«çš„ä¸œè¥¿ï¼Œåæ­£å®ƒå°±ç»™ä½ ä¸€å—åŸå§‹çš„å†…å­˜ï¼Œåœ¨ç»™ä½ ä¸ªå†…å­˜çš„åœ°å€å°±å®Œäº‹ã€‚æ‰€ä»¥å¦‚æœè¦åŠ¨æ€åˆ†é…ä¸€ä¸ªæ•°ç»„çš„å†…å­˜ï¼Œè¿˜éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨è‡ªå®šæ•°ç»„çš„å¤§å°ï¼š\n1int * ptr = (int *) malloc( sizeof(int)* 10 );//åˆ†é…ä¸€ä¸ª10ä¸ªintå…ƒç´ çš„æ•°ç»„\n7.newä¸mallocæ˜¯å¦å¯ä»¥ç›¸äº’è°ƒç”¨\noperator new /operator deleteçš„å®ç°å¯ä»¥åŸºäºmallocï¼Œè€Œmallocçš„å®ç°ä¸å¯ä»¥å»è°ƒç”¨newã€‚ä¸‹é¢æ˜¯ç¼–å†™operator new /operator delete çš„ä¸€ç§ç®€å•æ–¹å¼ï¼Œå…¶ä»–ç‰ˆæœ¬ä¹Ÿä¸ä¹‹ç±»ä¼¼ï¼š\n1234567891011void * operator new (sieze_t size)&#123;    if(void * mem = malloc(size)        return mem;    else        throw bad_alloc();&#125;void operator delete(void *mem) noexcept&#123;    free(mem);&#125;\n8.æ˜¯å¦å¯ä»¥è¢«é‡è½½\nopeartor new /operator deleteå¯ä»¥è¢«é‡è½½ã€‚æ ‡å‡†åº“æ˜¯å®šä¹‰äº†operator newå‡½æ•°å’Œoperator deleteå‡½æ•°çš„8ä¸ªé‡è½½ç‰ˆæœ¬ï¼š\n12345678910 1 //è¿™äº›ç‰ˆæœ¬å¯èƒ½æŠ›å‡ºå¼‚å¸¸ 2 void * operator new(size_t); 3 void * operator new[](size_t); 4 void * operator delete (void * )noexcept; 5 void * operator delete[](void *0ï¼‰noexcept; 6 //è¿™äº›ç‰ˆæœ¬æ‰¿è¯ºä¸æŠ›å‡ºå¼‚å¸¸ 7 void * operator new(size_t ,nothrow_t&amp;) noexcept; 8 void * operator new[](size_t, nothrow_t&amp; ); 9 void * operator delete (void *,nothrow_t&amp; )noexcept;10 void * operator delete[](void *0,nothrow_t&amp; ï¼‰noexcept;\næˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸Šé¢å‡½æ•°ç‰ˆæœ¬ä¸­çš„ä»»æ„ä¸€ä¸ªï¼Œå‰ææ˜¯è‡ªå®šä¹‰ç‰ˆæœ¬å¿…é¡»ä½äºå…¨å±€ä½œç”¨åŸŸæˆ–è€…ç±»ä½œç”¨åŸŸä¸­ã€‚å¤ªç»†èŠ‚çš„ä¸œè¥¿ä¸åœ¨è¿™é‡Œè®²è¿°ï¼Œæ€»ä¹‹ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„è‡ªç”±å»é‡è½½operator new /operator delete ,ä»¥å†³å®šæˆ‘ä»¬çš„newä¸deleteå¦‚ä½•ä¸ºå¯¹è±¡åˆ†é…å†…å­˜ï¼Œå¦‚ä½•å›æ”¶å¯¹è±¡ã€‚\nè€Œmalloc/freeå¹¶ä¸å…è®¸é‡è½½ã€‚\n9. èƒ½å¤Ÿç›´è§‚åœ°é‡æ–°åˆ†é…å†…å­˜\nä½¿ç”¨mallocåˆ†é…çš„å†…å­˜åï¼Œå¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å‘ç°å†…å­˜ä¸è¶³ï¼Œå¯ä»¥ä½¿ç”¨reallocå‡½æ•°è¿›è¡Œå†…å­˜é‡æ–°åˆ†é…å®ç°å†…å­˜çš„æ‰©å……ã€‚reallocå…ˆåˆ¤æ–­å½“å‰çš„æŒ‡é’ˆæ‰€æŒ‡å†…å­˜æ˜¯å¦æœ‰è¶³å¤Ÿçš„è¿ç»­ç©ºé—´ï¼Œå¦‚æœæœ‰ï¼ŒåŸåœ°æ‰©å¤§å¯åˆ†é…çš„å†…å­˜åœ°å€ï¼Œå¹¶ä¸”è¿”å›åŸæ¥çš„åœ°å€æŒ‡é’ˆï¼›å¦‚æœç©ºé—´ä¸å¤Ÿï¼Œå…ˆæŒ‰ç…§æ–°æŒ‡å®šçš„å¤§å°åˆ†é…ç©ºé—´ï¼Œå°†åŸæœ‰æ•°æ®ä»å¤´åˆ°å°¾æ‹·è´åˆ°æ–°åˆ†é…çš„å†…å­˜åŒºåŸŸï¼Œè€Œåé‡Šæ”¾åŸæ¥çš„å†…å­˜åŒºåŸŸã€‚\nnewæ²¡æœ‰è¿™æ ·ç›´è§‚çš„é…å¥—è®¾æ–½æ¥æ‰©å……å†…å­˜ã€‚\n10. å®¢æˆ·å¤„ç†å†…å­˜åˆ†é…ä¸è¶³\nåœ¨operator newæŠ›å‡ºå¼‚å¸¸ä»¥åæ˜ ä¸€ä¸ªæœªè·å¾—æ»¡è¶³çš„éœ€æ±‚ä¹‹å‰ï¼Œå®ƒä¼šå…ˆè°ƒç”¨ä¸€ä¸ªç”¨æˆ·æŒ‡å®šçš„é”™è¯¯å¤„ç†å‡½æ•°ï¼Œè¿™å°±æ˜¯new-handlerã€‚new_handleræ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼š\n1234namespace std&#123;    typedef void (*new_handler)();&#125;\næŒ‡å‘äº†ä¸€ä¸ªæ²¡æœ‰å‚æ•°æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°,å³ä¸ºé”™è¯¯å¤„ç†å‡½æ•°ã€‚ä¸ºäº†æŒ‡å®šé”™è¯¯å¤„ç†å‡½æ•°ï¼Œå®¢æˆ·éœ€è¦è°ƒç”¨set_new_handlerï¼Œè¿™æ˜¯ä¸€ä¸ªå£°æ˜äºçš„ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°:\n1234namespace std&#123;    new_handler set_new_handler(new_handler p ) throw();&#125;\nset_new_handlerçš„å‚æ•°ä¸ºnew_handleræŒ‡é’ˆï¼ŒæŒ‡å‘äº†operator new æ— æ³•åˆ†é…è¶³å¤Ÿå†…å­˜æ—¶è¯¥è°ƒç”¨çš„å‡½æ•°ã€‚å…¶è¿”å›å€¼ä¹Ÿæ˜¯ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘set_new_handlerè¢«è°ƒç”¨å‰æ­£åœ¨æ‰§è¡Œï¼ˆä½†é©¬ä¸Šå°±è¦å‘ç”Ÿæ›¿æ¢ï¼‰çš„é‚£ä¸ªnew_handlerå‡½æ•°ã€‚\nå¯¹äºmallocï¼Œå®¢æˆ·å¹¶ä¸èƒ½å¤Ÿå»ç¼–ç¨‹å†³å®šå†…å­˜ä¸è¶³ä»¥åˆ†é…æ—¶è¦å¹²ä»€ä¹ˆäº‹ï¼Œåªèƒ½çœ‹ç€mallocè¿”å›NULLã€‚\næ€»ç»“\nå°†ä¸Šé¢æ‰€è¿°çš„10ç‚¹å·®åˆ«æ•´ç†æˆè¡¨æ ¼ï¼š\n\nå¦‚æœ‰ä¸å¯¹çš„åœ°æ–¹ï¼Œéå¸¸æ¬¢è¿ç»™äºˆæŒ‡å¯¼ï¼\nå¦‚æœ‰ç–‘é—®ï¼Œå¯ä»¥ç»™æˆ‘ç•™è¨€\nã€æ„Ÿè°¢ã€‘èµ„æ–™æ¥æºäº\nâ€”â€”http://blog.jobbole.com/102002/\n","thumbnail":"/posts/newå’Œmallocçš„åŒºåˆ«/malloc.png","plink":"https://shuntan.github.io/posts/newå’Œmallocçš„åŒºåˆ«/"},{"title":"Linux--awkå‘½ä»¤","date":"2019-09-18T12:00:37.000Z","date_formatted":{"ll":"Sep 18, 2019","L":"09/18/2019","MM-DD":"09-18"},"updated":"2020-04-22T11:58:04.960Z","content":"ä¸€ï¼šawkç®€ä»‹\nâ€‹        awkå…¶åç§°å¾—è‡ªäºå®ƒçš„åˆ›å§‹äºº Alfred Aho ã€Peter Weinberger å’Œ Brian Kernighan å§“æ°çš„é¦–ä¸ªå­—æ¯ã€‚å®é™…ä¸Š AWK çš„ç¡®æ‹¥æœ‰è‡ªå·±çš„è¯­è¨€ï¼š AWK ç¨‹åºè®¾è®¡è¯­è¨€ ï¼Œ ä¸‰ä½åˆ›å»ºè€…å·²å°†å®ƒæ­£å¼å®šä¹‰ä¸ºâ€œæ ·å¼æ‰«æå’Œå¤„ç†è¯­è¨€â€ã€‚å®ƒå…è®¸æ‚¨åˆ›å»ºç®€çŸ­çš„ç¨‹åºï¼Œè¿™äº›ç¨‹åºè¯»å–è¾“å…¥æ–‡ä»¶ã€ä¸ºæ•°æ®æ’åºã€å¤„ç†æ•°æ®ã€å¯¹è¾“å…¥æ‰§è¡Œè®¡ç®—ä»¥åŠç”ŸæˆæŠ¥è¡¨ï¼Œè¿˜æœ‰æ— æ•°å…¶ä»–çš„åŠŸèƒ½ã€‚\nâ€‹       awk æ˜¯ä¸€ç§å¾ˆæ£’çš„è¯­è¨€ï¼Œå®ƒé€‚åˆæ–‡æœ¬å¤„ç†å’ŒæŠ¥è¡¨ç”Ÿæˆï¼Œå…¶è¯­æ³•è¾ƒä¸ºå¸¸è§ï¼Œå€Ÿé‰´äº†æŸäº›è¯­è¨€çš„ä¸€äº›ç²¾åï¼Œå¦‚ C è¯­è¨€ç­‰ã€‚åœ¨ linux ç³»ç»Ÿæ—¥å¸¸å¤„ç†å·¥ä½œä¸­ï¼Œå‘æŒ¥å¾ˆé‡è¦çš„ä½œç”¨ï¼ŒæŒæ¡äº† awkå°†ä¼šä½¿ä½ çš„å·¥ä½œå˜çš„é«˜å¤§ä¸Šã€‚ awk æ˜¯ä¸‰å‰‘å®¢çš„è€å¤§ï¼Œåˆ©å‰‘å‡ºé˜ï¼Œå¿…ä¼šä¸åŒå‡¡å“ã€‚\n\nå›åˆ°é¡¶éƒ¨\näºŒï¼šä½¿ç”¨æ–¹æ³•\n1`awk ``'&#123;pattern + action&#125;'` `&#123;filenames&#125;`\nâ€‹        å°½ç®¡æ“ä½œå¯èƒ½ä¼šå¾ˆå¤æ‚ï¼Œä½†è¯­æ³•æ€»æ˜¯è¿™æ ·ï¼Œå…¶ä¸­ pattern è¡¨ç¤º AWK åœ¨æ•°æ®ä¸­æŸ¥æ‰¾çš„å†…å®¹ï¼Œè€Œ action æ˜¯åœ¨æ‰¾åˆ°åŒ¹é…å†…å®¹æ—¶æ‰€æ‰§è¡Œçš„ä¸€ç³»åˆ—å‘½ä»¤ã€‚èŠ±æ‹¬å·ï¼ˆ{}ï¼‰ä¸éœ€è¦åœ¨ç¨‹åºä¸­å§‹ç»ˆå‡ºç°ï¼Œä½†å®ƒä»¬ç”¨äºæ ¹æ®ç‰¹å®šçš„æ¨¡å¼å¯¹ä¸€ç³»åˆ—æŒ‡ä»¤è¿›è¡Œåˆ†ç»„ã€‚ patternå°±æ˜¯è¦è¡¨ç¤ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨æ–œæ æ‹¬èµ·æ¥ã€‚\nâ€‹        awkè¯­è¨€çš„æœ€åŸºæœ¬åŠŸèƒ½æ˜¯åœ¨æ–‡ä»¶æˆ–è€…å­—ç¬¦ä¸²ä¸­åŸºäºæŒ‡å®šè§„åˆ™æµè§ˆå’ŒæŠ½å–ä¿¡æ¯ï¼ŒawkæŠ½å–ä¿¡æ¯åï¼Œæ‰èƒ½è¿›è¡Œå…¶ä»–æ–‡æœ¬æ“ä½œã€‚å®Œæ•´çš„awkè„šæœ¬é€šå¸¸ç”¨æ¥æ ¼å¼åŒ–æ–‡æœ¬æ–‡ä»¶ä¸­çš„ä¿¡æ¯ã€‚\né€šå¸¸ï¼Œawkæ˜¯ä»¥æ–‡ä»¶çš„ä¸€è¡Œä¸ºå¤„ç†å•ä½çš„ã€‚awkæ¯æ¥æ”¶æ–‡ä»¶çš„ä¸€è¡Œï¼Œç„¶åæ‰§è¡Œç›¸åº”çš„å‘½ä»¤ï¼Œæ¥å¤„ç†æ–‡æœ¬ã€‚\nå›åˆ°é¡¶éƒ¨\nä¸‰ï¼šawk çš„åŸç†\né€šè¿‡ä¸€ä¸ªç®€çŸ­çš„å‘½ä»¤ï¼Œæˆ‘ä»¬æ¥äº†è§£å…¶å·¥ä½œåŸç†ã€‚\n1`[root@Gin scripts]# awk ``'&#123;print $0&#125;'` `/etc/passwd``root:x:0:0:root:/root:/bin/bash``bin:x:1:1:bin:/bin:/sbin/nologin``.....................................................`` ` `[root@Gin scripts]# echo hhh|awk ``'&#123;print \"hello,world\"&#125;'``hello,world`` ` `[root@Gin scripts]# awk ``'&#123;print \"hiya\"&#125;'` /etc/passwd``hiya``hiya``hiya``hiya``...............................................`\n\nâ€‹       ä½ å°†ä¼šè§åˆ°/etc/passwd æ–‡ä»¶çš„å†…å®¹å‡ºç°åœ¨çœ¼å‰ã€‚ç°åœ¨ï¼Œè§£é‡Š awk åšäº†äº›ä»€ä¹ˆã€‚è°ƒç”¨ awkæ—¶ï¼Œæˆ‘ä»¬æŒ‡å®š/etc/passwd ä½œä¸ºè¾“å…¥æ–‡ä»¶ã€‚æ‰§è¡Œ awk æ—¶ï¼Œå®ƒä¾æ¬¡å¯¹/etc/passwd ä¸­çš„æ¯ä¸€è¡Œæ‰§è¡Œ print å‘½ä»¤ã€‚\nâ€‹       æ‰€æœ‰è¾“å‡ºéƒ½å‘é€åˆ° stdoutï¼Œæ‰€å¾—åˆ°çš„ç»“æœä¸æ‰§è¡Œ cat /etc/passwd å®Œå…¨ç›¸åŒã€‚\nâ€‹       ç°åœ¨ï¼Œè§£é‡Š{ print }ä»£ç å—ã€‚åœ¨ awk ä¸­ï¼ŒèŠ±æ‹¬å·ç”¨äºå°†å‡ å—ä»£ç ç»„åˆåˆ°ä¸€èµ·ï¼Œè¿™ä¸€ç‚¹ç±»ä¼¼äº C è¯­è¨€ã€‚åœ¨ä»£ç å—ä¸­åªæœ‰ä¸€æ¡ print å‘½ä»¤ã€‚åœ¨ awk ä¸­ï¼Œå¦‚æœåªå‡ºç° print å‘½ä»¤ï¼Œé‚£ä¹ˆå°†æ‰“å°å½“å‰è¡Œçš„å…¨éƒ¨å†…å®¹ã€‚\nå†æ¬¡è¯´æ˜ï¼Œ awk å¯¹è¾“å…¥æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½æ‰§è¡Œè¿™ä¸ªè„šæœ¬ã€‚\n\n1`$ awk -F``\":\"` `'&#123; print $1 &#125;'` `/etc/passwd``$ awk -F``\":\"` `'&#123; print $1 $3 &#125;'` `/etc/passwd``$ awk -F``\":\"` `'&#123; print $1 \" \" $3 &#125;'` `/etc/passwd``$ awk -F``\":\"` `'&#123; print \"username: \" $1 \"\\t\\tuid:\" $3\" &#125;'` `/etc/passwd`\n-Få‚æ•°ï¼šæŒ‡å®šåˆ†éš”ç¬¦ï¼Œå¯æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª\nprint åé¢åšå­—ç¬¦ä¸²çš„æ‹¼æ¥\nä¸‹é¢é€šè¿‡å‡ å®ä¾‹æ¥äº†è§£ä¸‹awkçš„å·¥ä½œåŸç†ï¼š\nå®ä¾‹ä¸€ï¼šåªæŸ¥çœ‹test.txtæ–‡ä»¶ï¼ˆ100è¡Œï¼‰å†…ç¬¬20åˆ°ç¬¬30è¡Œçš„å†…å®¹ï¼ˆä¼ä¸šé¢è¯•ï¼‰\n1`#print $aå–åˆ—#NRå–è¡Œæ•°[root@Gin scripts]# awk '&#123;if(NR&gt;=20 &amp;&amp; NR&lt;=30) print $1&#125;' test.txt  ``20``21``22``23``24``25``26``27``28``29``30`\nå®ä¾‹äºŒï¼šå·²çŸ¥test.txtæ–‡ä»¶å†…å®¹ä¸ºï¼š\n1`[root@Gin scripts]# cat test.txt``I am Poe,my qq ``is` `33794712`\n\nè¯·ä»è¯¥æ–‡ä»¶ä¸­è¿‡æ»¤å‡ºâ€™Poeâ€™å­—ç¬¦ä¸²ä¸33794712ï¼Œæœ€åè¾“å‡ºçš„ç»“æœä¸ºï¼šPoe 33794712\n1`[root@Gin scripts]# awk -F ``'[ ,]+'` `'&#123;print $3\" \"$7&#125;'` `test.txt``Poe 33794712`\n\nBEGIN å’Œ END æ¨¡å—\né€šå¸¸ï¼Œå¯¹äºæ¯ä¸ªè¾“å…¥è¡Œï¼Œ awk éƒ½ä¼šæ‰§è¡Œæ¯ä¸ªè„šæœ¬ä»£ç å—ä¸€æ¬¡ã€‚ç„¶è€Œï¼Œåœ¨è®¸å¤šç¼–ç¨‹æƒ…å†µä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨ awk å¼€å§‹å¤„ç†è¾“å…¥æ–‡ä»¶ä¸­çš„æ–‡æœ¬ä¹‹å‰æ‰§è¡Œåˆå§‹åŒ–ä»£ç ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œ awk å…è®¸æ‚¨å®šä¹‰ä¸€ä¸ª BEGIN å—ã€‚\nå› ä¸º awk åœ¨å¼€å§‹å¤„ç†è¾“å…¥æ–‡ä»¶ä¹‹å‰ä¼šæ‰§è¡Œ BEGIN å—ï¼Œå› æ­¤å®ƒæ˜¯åˆå§‹åŒ– FSï¼ˆå­—æ®µåˆ†éš”ç¬¦ï¼‰å˜é‡ã€æ‰“å°é¡µçœ‰æˆ–åˆå§‹åŒ–å…¶å®ƒåœ¨ç¨‹åºä¸­ä»¥åä¼šå¼•ç”¨çš„å…¨å±€å˜é‡çš„æä½³ä½ç½®ã€‚\nawk è¿˜æä¾›äº†å¦ä¸€ä¸ªç‰¹æ®Šå—ï¼Œå«ä½œ END å—ã€‚ awk åœ¨å¤„ç†äº†è¾“å…¥æ–‡ä»¶ä¸­çš„æ‰€æœ‰è¡Œä¹‹åæ‰§è¡Œè¿™ä¸ªå—ã€‚é€šå¸¸ï¼Œ END å—ç”¨äºæ‰§è¡Œæœ€ç»ˆè®¡ç®—æˆ–æ‰“å°åº”è¯¥å‡ºç°åœ¨è¾“å‡ºæµç»“å°¾çš„æ‘˜è¦ä¿¡æ¯ã€‚\nå®ä¾‹ä¸€ï¼šç»Ÿè®¡/etc/passwdçš„è´¦æˆ·äººæ•°\n1`[root@Gin scripts]# awk ``'&#123;count++;print $0;&#125; END&#123;print \"user count is \",count&#125;'` `passwd``root:x:0:0:root:/root:/bin/bash``..............................................``user count ``is`  `27`\n\ncountæ˜¯è‡ªå®šä¹‰å˜é‡ã€‚ä¹‹å‰çš„action{}é‡Œéƒ½æ˜¯åªæœ‰ä¸€ä¸ªprint,å…¶å®printåªæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œè€Œaction{}å¯ä»¥æœ‰å¤šä¸ªè¯­å¥ï¼Œä»¥;å·éš”å¼€ã€‚è¿™é‡Œæ²¡æœ‰åˆå§‹åŒ–countï¼Œè™½ç„¶é»˜è®¤æ˜¯0ï¼Œä½†æ˜¯å¦¥å½“çš„åšæ³•è¿˜æ˜¯åˆå§‹åŒ–ä¸º0:\n1`[root@Gin scripts]# awk ``'BEGIN &#123;count=0;print \"[start] user count is \",count&#125; &#123;count=count+1;print $0&#125; END&#123;print \"[end] user count is \",count&#125;'` `passwd``[start] user count ``is`  `0``root:x:0:0:root:/root:/bin/bash``...................................................................``[end] user count ``is`  `27`\n\nå®ä¾‹äºŒï¼šç»Ÿè®¡æŸä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶å ç”¨çš„å­—èŠ‚æ•°\n1`[root@Gin scripts]# ll |awk ``'BEGIN &#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print \"[end]size is \",size&#125;'``[end]size ``is`  `1489`\n\nå¦‚æœä»¥Mä¸ºå•ä½æ˜¾ç¤º:\n1`[root@Gin scripts]# ll |awk ``'BEGIN&#123;size=0;&#125; &#123;size=size+$5;&#125; END&#123;print \"[end]size is \",size/1024/1024,\"M\"&#125;'`  `[end]size ``is`  `0.00142002 M`\n\nawkè¿ç®—ç¬¦\n\nawk èµ‹å€¼è¿ç®—ç¬¦ï¼ša+5;ç­‰ä»·äºï¼š a=a+5;å…¶ä»–åŒç±»\n1`[root@Gin scripts]# awk ``'BEGIN&#123;a=5;a+=5;print a&#125;'``10`\n\nawké€»è¾‘è¿ç®—ç¬¦ï¼š\n1`[root@Gin scripts]# awk ``'BEGIN&#123;a=1;b=2;print (a&gt;2&amp;&amp;b&gt;1,a=1||b&gt;1)&#125;'``0 1`\n\nåˆ¤æ–­è¡¨è¾¾å¼ a&gt;2&amp;&amp;b&gt;1ä¸ºçœŸè¿˜æ˜¯ä¸ºå‡ï¼Œåé¢çš„è¡¨è¾¾å¼åŒç†\nawkæ­£åˆ™è¿ç®—ç¬¦ï¼š\n1`[root@Gin scripts]# awk ``'BEGIN&#123;a=\"100testaa\";if(a~/100/) &#123;print \"ok\"&#125;&#125;'``ok`\n\n1`[root@Gin scripts]# echo|awk ``'BEGIN&#123;a=\"100testaaa\"&#125;a~/test/&#123;print \"ok\"&#125;'``ok`\n\nå…³ç³»è¿ç®—ç¬¦ï¼š\nå¦‚ï¼š &gt; &lt; å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥ç”¨ä½œæ•°å€¼æ¯”è¾ƒï¼Œå…³é”®çœ‹æ“ä½œæ•°å¦‚æœæ˜¯å­—ç¬¦ä¸²å°±ä¼šè½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¯”è¾ƒã€‚ä¸¤ä¸ªéƒ½ä¸ºæ•°å­— æ‰è½¬ä¸ºæ•°å€¼æ¯”è¾ƒã€‚å­—ç¬¦ä¸²æ¯”è¾ƒï¼šæŒ‰ç…§asciiç é¡ºåºæ¯”è¾ƒã€‚\n1`[root@Gin scripts]# awk ``'BEGIN&#123;a=\"11\";if(a&gt;=9)&#123;print \"ok\"&#125;&#125;'` `#æ— è¾“å‡º``[root@Gin scripts]# awk ``'BEGIN&#123;a=11;if(a&gt;=9)&#123;print \"ok\"&#125;&#125;'``ok``[root@Gin scripts]# awk ``'BEGIN&#123;a;if(a&gt;=b)&#123;print \"ok\"&#125;&#125;'``ok`\n\nawk ç®—æœ¯è¿ç®—ç¬¦ï¼š\nè¯´æ˜ï¼Œæ‰€æœ‰ç”¨ä½œç®—æœ¯è¿ç®—ç¬¦è¿›è¡Œæ“ä½œï¼Œæ“ä½œæ•°è‡ªåŠ¨è½¬ä¸ºæ•°å€¼ï¼Œæ‰€æœ‰éæ•°å€¼éƒ½å˜ä¸º0ã€‚\n1`[root@Gin scripts]# awk ``'BEGIN&#123;a=\"b\";print a++,++a&#125;'``0 2``[root@Gin scripts]# awk ``'BEGIN&#123;a=\"20b4\";print a++,++a&#125;'``20 22`\n\nè¿™é‡Œçš„a++ , aä¸javascriptè¯­è¨€ä¸€æ ·ï¼šaæ˜¯å…ˆèµ‹å€¼åŠ ++ï¼›aæ˜¯å…ˆå†èµ‹å€¼\nä¸‰ç›®è¿ç®—ç¬¦ ?:\n1`[root@Gin scripts]# awk ``'BEGIN&#123;a=\"b\";print a==\"b\"?\"ok\":\"err\"&#125;'``ok``[root@Gin scripts]# awk ``'BEGIN&#123;a=\"b\";print a==\"c\"?\"ok\":\"err\"&#125;'``err`\n\nå¸¸ç”¨ awk å†…ç½®å˜é‡\n\næ³¨ï¼šå†…ç½®å˜é‡å¾ˆå¤šï¼Œå‚é˜…ç›¸å…³èµ„æ–™\nå­—æ®µåˆ†éš”ç¬¦ FS\nFS=&quot;\\t&quot; ä¸€ä¸ªæˆ–å¤šä¸ª Tab åˆ†éš”\n1`[root@Gin scripts]# cat tab.txt``ww   CC        IDD``[root@Gin scripts]# awk ``'BEGIN&#123;FS=\"\\t+\"&#125;&#123;print $1,$2,$3&#125;'` `tab.txt``ww   CC        IDD`\n\nFS=&quot;[[:space:]+]&quot; ä¸€ä¸ªæˆ–å¤šä¸ªç©ºç™½ç©ºæ ¼ï¼Œé»˜è®¤çš„\n1`[root@Gin scripts]# cat space.txt``we are    studing awk now!``[root@Gin scripts]# awk -F [[:space:]+] ``'&#123;print $1,$2,$3,$4,$5&#125;'` `space.txt``we are ``[root@Gin scripts]# awk -F [[:space:]+] ``'&#123;print $1,$2&#125;'` `space.txt``we are`\n\nFS=&quot;[&quot; â€œ:]+â€ ä»¥ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼æˆ–ï¼šåˆ†éš”\n1`[root@Gin scripts]# cat hello.txt``root:x:0:0:root:/root:/bin/bash``[root@Gin scripts]# awk -F [``\" \"``:]+ ``'&#123;print $1,$2,$3&#125;'` `hello.txt``root x 0`\n\nå­—æ®µæ•°é‡ NF\n1`[root@Gin scripts]# cat hello.txt``root:x:0:0:root:/root:/bin/bash``bin:x:1:1:bin:/bin:/sbin/nologin:888``[root@Gin scripts]# awk -F ``\":\"` `'NF==8&#123;print $0&#125;'` `hello.txt``bin:x:1:1:bin:/bin:/sbin/nologin:888`\n\nè®°å½•æ•°é‡ NR\n1`[root@Gin scripts]# ifconfig eth0|awk -F [``\" \"``:]+ ``'NR==2&#123;print $4&#125;'`  `## NR==2ä¹Ÿå°±æ˜¯å–ç¬¬2è¡Œ``192.168.17.129`\n\nRS è®°å½•åˆ†éš”ç¬¦å˜é‡\nå°† FS è®¾ç½®æˆ&quot;\\n&quot;å‘Šè¯‰ awk æ¯ä¸ªå­—æ®µéƒ½å æ®ä¸€è¡Œã€‚é€šè¿‡å°† RS è®¾ç½®æˆ&quot;&quot;ï¼Œè¿˜ä¼šå‘Šè¯‰ awkæ¯ä¸ªåœ°å€è®°å½•éƒ½ç”±ç©ºç™½è¡Œåˆ†éš”ã€‚\n1`[root@Gin scripts]# cat recode.txt``Jimmy the Weasel``100 Pleasant Drive``San Francisco,CA 123456`` ` `Big Tony``200 Incognito Ave.``Suburbia,WA 64890``[root@Gin scripts]# cat awk.txt``#!/bin/awk``BEGIN &#123;``        ``FS=``\"\\n\"``        ``RS=``\"\"``&#125;``&#123;``        ``print $1``\",\"``$2``\",\"``$3``&#125;``[root@Gin scripts]# awk -f awk.txt recode.txt``Jimmy the Weasel,100 Pleasant Drive,San Francisco,CA 123456``Big Tony,200 Incognito Ave.,Suburbia,WA 64890`\n\nOFS è¾“å‡ºå­—æ®µåˆ†éš”ç¬¦\n1`[root@Gin scripts]# cat hello.txt``root:x:0:0:root:/root:/bin/bash``bin:x:1:1:bin:/bin:/sbin/nologin:888``[root@Gin scripts]# awk ``'BEGIN&#123;FS=\":\"&#125;&#123;print $1\",\"$2\",\"$3&#125;'` `hello.txt``root,x,0``bin,x,1``[root@Gin scripts]# awk ``'BEGIN&#123;FS=\":\";OFS=\"#\"&#125;&#123;print $1,$2,$3&#125;'` `hello.txt``root#x#0``bin#x#1`\n\nORS è¾“å‡ºè®°å½•åˆ†éš”ç¬¦\n1`[root@Gin scripts]# cat recode.txt``Jimmy the Weasel``100 Pleasant Drive``San Francisco,CA 123456`` ` `Big Tony``200 Incognito Ave.``Suburbia,WA 64890``[root@Gin scripts]# cat awk.txt``#!/bin/awk``BEGIN &#123;``        ``FS=``\"\\n\"``        ``RS=``\"\"``        ``ORS=``\"\\n\\n\"``&#125;``&#123;``        ``print $1``\",\"``$2``\",\"``$3``&#125;``[root@Gin scripts]# awk -f awk.txt recode.txt``Jimmy the Weasel,100 Pleasant Drive,San Francisco,CA 123456`` ` `Big Tony,200 Incognito Ave.,Suburbia,WA 64890`\n\nawk æ­£åˆ™\n\næ­£åˆ™åº”ç”¨\nè§„åˆ™è¡¨è¾¾å¼\nawk '/REG/{action} â€™ file,/REG/ä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥å°†$0 ä¸­ï¼Œæ»¡è¶³æ¡ä»¶çš„è®°å½•é€å…¥åˆ°ï¼šaction è¿›è¡Œå¤„ç†\n1`[root@Gin scripts]# awk ``'/root/&#123;print $0&#125;'` `passwd ##åŒ¹é…æ‰€æœ‰åŒ…å«rootçš„è¡Œ``root:x:0:0:root:/root:/bin/bash``operator``:x:11:0:``operator``:/root:/sbin/nologin`` ` `[root@Gin scripts]# awk -F: ``'$5~/root/&#123;print $0&#125;'` `passwd  ## ä»¥åˆ†å·ä½œä¸ºåˆ†éš”ç¬¦ï¼ŒåŒ¹é…ç¬¬5ä¸ªå­—æ®µæ˜¯rootçš„è¡Œ``root:x:0:0:root:/root:/bin/bash`` ` `[root@Gin scripts]# ifconfig eth0|awk ``'BEGIN&#123;FS=\"[[:space:]:]+\"&#125; NR==2&#123;print $4&#125;'``192.168.17.129`\n\nå¸ƒå°”è¡¨è¾¾å¼\nawk â€˜å¸ƒå°”è¡¨è¾¾å¼{action}â€™ file ä»…å½“å¯¹å‰é¢çš„å¸ƒå°”è¡¨è¾¾å¼æ±‚å€¼ä¸ºçœŸæ—¶ï¼Œ awk æ‰æ‰§è¡Œä»£ç å—ã€‚\n1`[root@Gin scripts]# awk -F: ``'$1==\"root\"&#123;print $0&#125;'` `passwd``root:x:0:0:root:/root:/bin/bash``[root@Gin scripts]# awk -F: ``'($1==\"root\")&amp;&amp;($5==\"root\") &#123;print $0&#125;'` `passwd``root:x:0:0:root:/root:/bin/bash`\n\nawk çš„ ifã€å¾ªç¯å’Œæ•°ç»„\næ¡ä»¶è¯­å¥\nawk æä¾›äº†éå¸¸å¥½çš„ç±»ä¼¼äº C è¯­è¨€çš„ if è¯­å¥ã€‚\n1`&#123;``        ``if` `($1==``\"foo\"``)&#123;``                ``if``($2==``\"foo\"``)&#123;``                        ``print ``\"uno\"``                ``&#125;``else``&#123;``                        ``print ``\"one\"``                ``&#125;``        ``&#125;elseif($1==``\"bar\"``)&#123;``                ``print ``\"two\"``        ``&#125;``else``&#123;``                ``print ``\"three\"``        ``&#125;``&#125;`\n\nä½¿ç”¨ if è¯­å¥è¿˜å¯ä»¥å°†ä»£ç ï¼š\n1`! /matchme/ &#123; print $1 $3 $4 &#125;`\n\nè½¬æ¢æˆï¼š\n1`&#123;``ã€€ã€€``if` `( $0 !~ /matchme/ ) &#123;``ã€€ã€€ã€€ã€€print $1 $3 $4``ã€€ã€€&#125;``&#125;`\n\nå¾ªç¯ç»“æ„\næˆ‘ä»¬å·²ç»çœ‹åˆ°äº† awk çš„ while å¾ªç¯ç»“æ„ï¼Œå®ƒç­‰åŒäºç›¸åº”çš„ C è¯­è¨€ while å¾ªç¯ã€‚ awk è¿˜æœ‰&quot;doâ€¦while&quot;å¾ªç¯ï¼Œå®ƒåœ¨ä»£ç å—ç»“å°¾å¤„å¯¹æ¡ä»¶æ±‚å€¼ï¼Œè€Œä¸åƒæ ‡å‡† while å¾ªç¯é‚£æ ·åœ¨å¼€å§‹å¤„æ±‚å€¼ã€‚\nå®ƒç±»ä¼¼äºå…¶å®ƒè¯­è¨€ä¸­çš„&quot;repeatâ€¦until&quot;å¾ªç¯ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š\ndoâ€¦while ç¤ºä¾‹\n1`&#123;``    ``count=1do &#123;``        ``print ``\"I get printed at least once no matter what\"``    ``&#125; ``while` `( count !=1 )``&#125;`\n\nä¸ä¸€èˆ¬çš„ while å¾ªç¯ä¸åŒï¼Œç”±äºåœ¨ä»£ç å—ä¹‹åå¯¹æ¡ä»¶æ±‚å€¼ï¼Œ &quot;doâ€¦while&quot;å¾ªç¯æ°¸è¿œéƒ½è‡³å°‘æ‰§è¡Œä¸€æ¬¡ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¬¬ä¸€æ¬¡é‡åˆ°æ™®é€š while å¾ªç¯æ—¶ï¼Œå¦‚æœæ¡ä»¶ä¸ºå‡ï¼Œå°†æ°¸è¿œä¸æ‰§è¡Œè¯¥å¾ªç¯ã€‚\nfor å¾ªç¯\nawk å…è®¸åˆ›å»º for å¾ªç¯ï¼Œå®ƒå°±è±¡ while å¾ªç¯ï¼Œä¹Ÿç­‰åŒäº C è¯­è¨€çš„ for å¾ªç¯ï¼š\n1`for` `( initial assignment; comparison; increment ) &#123;``    ``code block``&#125;`\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€çŸ­ç¤ºä¾‹ï¼š\n1`for` `( x=1;x&lt;=4;x++ ) &#123;``    ``print ``\"iteration\"``, x``&#125;`\n\næ­¤æ®µä»£ç å°†æ‰“å°ï¼š\n1`iteration1``iteration2``iteration3``iteration4`\n\nbreak å’Œ continue\næ­¤å¤–ï¼Œå¦‚åŒ C è¯­è¨€ä¸€æ ·ï¼Œ awk æä¾›äº† break å’Œ continue è¯­å¥ã€‚ä½¿ç”¨è¿™äº›è¯­å¥å¯ä»¥æ›´å¥½åœ°æ§åˆ¶ awk çš„å¾ªç¯ç»“æ„ã€‚ä»¥ä¸‹æ˜¯è¿«åˆ‡éœ€è¦ break è¯­å¥çš„ä»£ç ç‰‡æ–­ï¼š\n1`while` `æ­»å¾ªç¯``while` `(1) &#123;``print ``\"forever and ever...\"``&#125;``while` `æ­»å¾ªç¯ 1 æ°¸è¿œä»£è¡¨æ˜¯çœŸï¼Œè¿™ä¸ª ``while` `å¾ªç¯å°†æ°¸è¿œè¿è¡Œä¸‹å»ã€‚`\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªåªæ‰§è¡Œåæ¬¡çš„å¾ªç¯ï¼š\n1`#break è¯­å¥ç¤ºä¾‹``x=1``while``(1) &#123;``ã€€ã€€print ``\"iteration\"``, x``ã€€ã€€``if` `( x==10 ) &#123;``ã€€ã€€ã€€ã€€``break``ã€€ã€€&#125;``ã€€ã€€x++``&#125;`\n\nè¿™é‡Œï¼Œ break è¯­å¥ç”¨äºâ€œé€ƒå‡ºâ€æœ€æ·±å±‚çš„å¾ªç¯ã€‚ &quot;break&quot;ä½¿å¾ªç¯ç«‹å³ç»ˆæ­¢ï¼Œå¹¶ç»§ç»­æ‰§è¡Œå¾ªç¯ä»£ç å—åé¢çš„è¯­å¥ã€‚\ncontinue è¯­å¥è¡¥å……äº† breakï¼Œå…¶ä½œç”¨å¦‚ä¸‹ï¼š\n1`x=1while (1) &#123;``        ``if` `( x==4 ) &#123;``        ``x++``        ``continue``    ``&#125;``    ``print ``\"iteration\"``, x``    ``if` `( x&gt;20 ) &#123;``        ``break``    ``&#125;``    ``x++``&#125;`\n\nè¿™æ®µä»£ç æ‰“å°&quot;iteration1&quot;åˆ°&quot;iteration21&quot;ï¼Œ &quot;iteration4&quot;é™¤å¤–ã€‚å¦‚æœè¿­ä»£ç­‰äº 4ï¼Œåˆ™å¢åŠ  xå¹¶è°ƒç”¨ continue è¯­å¥ï¼Œè¯¥è¯­å¥ç«‹å³ä½¿ awk å¼€å§‹æ‰§è¡Œä¸‹ä¸€ä¸ªå¾ªç¯è¿­ä»£ï¼Œè€Œä¸æ‰§è¡Œä»£ç å—çš„å…¶ä½™éƒ¨åˆ†ã€‚å¦‚åŒ break ä¸€æ ·ï¼Œ\ncontinue è¯­å¥é€‚åˆå„ç§ awk è¿­ä»£å¾ªç¯ã€‚åœ¨ for å¾ªç¯ä¸»ä½“ä¸­ä½¿ç”¨æ—¶ï¼Œ continue å°†ä½¿å¾ªç¯æ§åˆ¶å˜é‡è‡ªåŠ¨å¢åŠ ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç­‰ä»·å¾ªç¯ï¼š\n1`for` `( x=1;x&lt;=21;x++ ) &#123;``    ``if` `( x==4 ) &#123;``        ``continue``    ``&#125;``    ``print ``\"iteration\"``, x``&#125;`\n\nåœ¨while å¾ªç¯ä¸­æ—¶ï¼Œåœ¨è°ƒç”¨ continue ä¹‹å‰æ²¡æœ‰å¿…è¦å¢åŠ  xï¼Œå› ä¸º for å¾ªç¯ä¼šè‡ªåŠ¨å¢åŠ  xã€‚\næ•°ç»„\nAWK ä¸­çš„æ•°ç»„éƒ½æ˜¯å…³è”æ•°ç»„,æ•°å­—ç´¢å¼•ä¹Ÿä¼šè½¬å˜ä¸ºå­—ç¬¦ä¸²ç´¢å¼•\n1`&#123;``    ``cities[1]=â€beijingâ€``    ``cities[2]=â€shanghaiâ€``    ``cities[â€œthreeâ€]=â€guangzhouâ€``    ``for``( c ``in` `cities) &#123;``        ``print cities[c]``    ``&#125;``    ``print cities[1]``    ``print cities[â€œ1â€]``    ``print cities[â€œthreeâ€]``&#125;`\n\nforâ€¦in è¾“å‡ºï¼Œå› ä¸ºæ•°ç»„æ˜¯å…³è”æ•°ç»„ï¼Œé»˜è®¤æ˜¯æ— åºçš„ã€‚æ‰€ä»¥é€šè¿‡ forâ€¦in å¾—åˆ°æ˜¯æ— åºçš„æ•°ç»„ã€‚å¦‚æœéœ€è¦å¾—åˆ°æœ‰åºæ•°ç»„ï¼Œéœ€è¦é€šè¿‡ä¸‹æ ‡è·å¾—ã€‚\næ•°ç»„çš„å…¸å‹åº”ç”¨\nç”¨ awk ä¸­æŸ¥çœ‹æœåŠ¡å™¨è¿æ¥çŠ¶æ€å¹¶æ±‡æ€»\n1`netstat -an|awk ``'/^tcp/&#123;++s[$NF]&#125;END&#123;for(a in s)print a,s[a]&#125;'``ESTABLISHED 1``LISTEN 20`\n\nç»Ÿè®¡ web æ—¥å¿—è®¿é—®æµé‡ï¼Œè¦æ±‚è¾“å‡ºè®¿é—®æ¬¡æ•°ï¼Œè¯·æ±‚é¡µé¢æˆ–å›¾ç‰‡ï¼Œæ¯ä¸ªè¯·æ±‚çš„æ€»å¤§å°ï¼Œæ€»è®¿é—®æµé‡çš„å¤§å°æ±‡æ€»\n1`awk '&#123;a[$7]+=$10;++b[$7];total+=$10&#125;END&#123;``for``(x ``in` `a)print b[x],x,a[x]|``\"sort -rn -k1\"``;print``\"total size is :\"``total&#125;' /app/log/access_log``total size ``is` `:172230``21 /icons/poweredby.png 83076``14 / 70546``8 /icons/apache_pb.gif 18608``a[$7]+=$10 è¡¨ç¤ºä»¥ç¬¬ 7 åˆ—ä¸ºä¸‹æ ‡çš„æ•°ç»„ï¼ˆ $10 åˆ—ä¸º$7 åˆ—çš„å¤§å°ï¼‰ï¼ŒæŠŠä»–ä»¬å¤§å°ç´¯åŠ å¾—åˆ°``$7 æ¯æ¬¡è®¿é—®çš„å¤§å°ï¼Œåé¢çš„ ``for` `å¾ªç¯æœ‰ä¸ªå–å·§çš„åœ°æ–¹ï¼Œ a å’Œ b æ•°ç»„çš„ä¸‹æ ‡ç›¸åŒï¼Œæ‰€ä»¥ä¸€``æ¡ ``for` `è¯­å¥è¶³çŸ£`\n\nå¸¸ç”¨å­—ç¬¦ä¸²å‡½æ•°\n\n\nå­—ç¬¦ä¸²å‡½æ•°çš„åº”ç”¨\næ›¿æ¢\n1`awk ``'BEGIN&#123;info=\"this is a test2010test!\";gsub(/[0-9]+/,\"!\",info);print info&#125;'` `this` `is` `a test!test!``åœ¨ info ä¸­æŸ¥æ‰¾æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼ï¼Œ /[0-9]+/ ç”¨â€!â€æ›¿æ¢ï¼Œå¹¶ä¸”æ›¿æ¢åçš„å€¼ï¼Œèµ‹å€¼ç»™ info æœª``ç»™ info å€¼ï¼Œé»˜è®¤æ˜¯$0`\n\næŸ¥æ‰¾\n1`awk ``'BEGIN&#123;info=\"this is a test2010test!\";print index(info,\"test\")?\"ok\":\"no found\";&#125;'``ok #æœªæ‰¾åˆ°ï¼Œè¿”å› 0`\n\nåŒ¹é…æŸ¥æ‰¾\n1`awk ``'BEGIN&#123;info=\"this is a test2010test!\";print match(info,/[0-9]+/)?\"ok\":\"no found\";&#125;'``ok #å¦‚æœæŸ¥æ‰¾åˆ°æ•°å­—åˆ™åŒ¹é…æˆåŠŸè¿”å› okï¼Œå¦åˆ™å¤±è´¥ï¼Œè¿”å›æœªæ‰¾åˆ°`\n\næˆªå–\n1`awk ``'BEGIN&#123;info=\"this is a test2010test!\";print substr(info,4,10);&#125;'``s ``is` `a tes #ä»ç¬¬ 4 ä¸ª å­—ç¬¦å¼€å§‹ï¼Œæˆªå– 10 ä¸ªé•¿åº¦å­—ç¬¦ä¸²`\n\nåˆ†å‰²\n1`awk ``'BEGIN&#123;info=\"this is a test\";split(info,tA,\" \");print length(tA);for(k in tA)&#123;print k,tA[k];&#125;&#125;'` `4``4 test 1 ``this` `2 ``is` `3 a``#åˆ†å‰² info,åŠ¨æ€åˆ›å»ºæ•°ç»„ tA,awk for â€¦in å¾ªç¯ï¼Œæ˜¯ä¸€ä¸ªæ— åºçš„å¾ªç¯ã€‚ å¹¶ä¸æ˜¯ä»æ•°ç»„ä¸‹æ ‡``1â€¦n å¼€å§‹`","thumbnail":"/posts/Linux-awkå‘½ä»¤/awk.png","plink":"https://shuntan.github.io/posts/Linux-awkå‘½ä»¤/"},{"title":"ç¼–è¯‘å™¨æ¶æ„çš„ç‹è€…LLVMâ€”â€”ä½¿ç”¨JITå¼•æ“","date":"2019-09-11T12:15:43.000Z","date_formatted":{"ll":"Sep 11, 2019","L":"09/11/2019","MM-DD":"09-11"},"updated":"2020-04-22T06:42:08.261Z","content":"ä½¿ç”¨JITå¼•æ“\nLLVMä»è®¾è®¡ä¹‹åˆå°±è€ƒè™‘äº†è§£é‡Šæ‰§è¡Œçš„åŠŸèƒ½,è¿™éå¸¸å…¶ä½œä¸ºä¸€æ¬¾è·¨å¹³å°çš„ä¸­é—´å­—èŠ‚ç æ¥ä½¿ç”¨,å¯ä»¥æ–¹ä¾¿åœ°è·¨å¹³å°è¿è¡Œã€‚åˆå…·æœ‰ç¼–è¯‘å‹è¯­è¨€çš„ä¼˜åŠ¿ï¼Œéå¸¸çš„æ–¹ä¾¿ã€‚\næˆ‘ä»¬ä½¿ç”¨çš„LLVM3.6ç‰ˆï¼Œç§»é™¤äº†åŸç‰ˆJITï¼Œæ”¹æ¢æˆäº†æ–°ç‰ˆçš„MCJITï¼Œæ€§æ ¼æœ‰äº†ä¸å°çš„æå‡ï¼Œæœ¬æ–‡å°±MCJITçš„ä½¿ç”¨å’Œæ³¨æ„äº‹é¡¹ï¼Œè¿›è¡Œç®€è¦çš„ä»‹ç»ã€‚\n\nJITæŠ€æœ¯\nJust-In-Time Compilerï¼Œæ˜¯ä¸€ç§åŠ¨æ€ç¼–è¯‘ä¸­é—´ä»£ç çš„æ–¹å¼ï¼Œæ ¹æ®éœ€è¦ï¼Œåœ¨ç¨‹åºä¸­ç¼–è¯‘å¹¶æ‰§è¡Œç”Ÿæˆçš„æœºå™¨ç ï¼Œèƒ½å¤Ÿå¤§å¹…æå‡åŠ¨æ€è¯­è¨€çš„æ‰§è¡Œé€Ÿåº¦ã€‚\nåƒJavaè¯­è¨€ï¼Œ.netå¹³å°ï¼Œluajitç­‰ï¼Œå¹¿æ³›ä½¿ç”¨jitæŠ€æœ¯ï¼Œä½¿å¾—ç¨‹åºè¾¾åˆ°äº†éå¸¸é«˜çš„æ‰§è¡Œæ•ˆç‡ï¼Œé€æ¸æ¥è¿‘åŸç”Ÿæœºå™¨è¯­è¨€ä»£ç çš„æ€§èƒ½äº†ã€‚\nJITå¼•æ“çš„å·¥ä½œåŸç†å¹¶æ²¡æœ‰é‚£ä¹ˆå¤æ‚ï¼Œæœ¬è´¨ä¸Šæ˜¯å°†åŸæ¥ç¼–è¯‘å™¨è¦ç”Ÿæˆæœºå™¨ç çš„éƒ¨åˆ†è¦ç›´æ¥å†™å…¥åˆ°å½“å‰çš„å†…å­˜ä¸­ï¼Œç„¶åé€šè¿‡å‡½æ•°æŒ‡é’ˆçš„è½¬æ¢ï¼Œæ‰¾åˆ°å¯¹åº”çš„æœºå™¨ç å¹¶è¿›è¡Œæ‰§è¡Œã€‚\nä½†å®è·µä¸­å¾€å¾€éœ€è¦å¤„ç†è®¸å¤šå¤´ç–¼çš„é—®é¢˜ï¼Œä¾‹å¦‚å†…å­˜çš„ç®¡ç†ï¼Œç¬¦å·çš„é‡å®šå‘ï¼Œå¤„ç†å¤–éƒ¨ç¬¦å·ï¼Œç›¸å½“äºè¦å¤„ç†ç¼–è¯‘å™¨åç«¯çš„è¯¸å¤šå¤æ‚çš„äº‹æƒ…ï¼ŒçœŸæ­£è¦è®¾è®¡ä¸€æ¬¾èƒ½ç”¨çš„JITå¼•æ“è¿˜æ˜¯éå¸¸å›°éš¾çš„ã€‚\nä½¿ç”¨LLVMçš„MCJITèƒ½å¼€å‘ä»€ä¹ˆ\nå½“ç„¶åŸºæœ¬çš„åŠŸèƒ½æ˜¯æä¾›ä¸€æ¬¾è§£é‡Šå™¨çš„åº•å±‚å·¥å…·ï¼Œå°†LLVMå­—èŠ‚ç è§£é‡Šæ‰§è¡Œï¼Œå…·ä½“èƒ½å¤Ÿåšçš„äº‹ï¼Œä¾‹å¦‚å¯ä»¥åˆ¶ä½œä¸€æ¬¾è·¨å¹³å°çš„Cæ’ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨clangå°†C/Cä»£ç ä¸€æ¬¡ç¼–è¯‘åˆ°.bcå­—èŠ‚ç ï¼Œç„¶ååœ¨å„ä¸ªå¹³å°ä¸Šè§£é‡Šè¿è¡Œã€‚ä¹Ÿå¯ä»¥åˆ¶ä½œä¸€æ¬¾äº‘è°ƒè¯•ç³»ç»Ÿï¼Œè”ç½‘è¿œç¨‹å‘ç³»ç»Ÿæ³¨å†Œæ–¹æ³•ï¼Œè·å–C++å®¢æˆ·ç«¯çš„debugä¿¡æ¯ç­‰ç­‰ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç”¨æ³•ç­‰ç€å¤§å®¶æ¥å¼€å‘ã€‚\nä½¿ç”¨MCJITåšä¸€æ¬¾è§£é‡Šå™¨\nåˆ¶ä½œLLVMå­—èŠ‚ç çš„è§£é‡Šå™¨è¿˜æ˜¯éå¸¸ç®€å•çš„ï¼Œæœ€æ£’çš„ç¤ºä¾‹åº”è¯¥æ˜¯LLVMæºç ä¸­çš„å·¥å…·ï¼šlli\nä¸€å…±700è¡Œå·¦å³çš„C++ä»£ç ï¼Œè°ƒç”¨LLVMå·¥å…·é›†å®ç°äº†LLVMå­—èŠ‚ç JITå¼•æ“ï¼Œå¦‚æœæƒ³å¾ˆå¥½çš„å­¦ä¹ llvmä¸­çš„è§£é‡Šå™¨å’ŒJITï¼Œå¯ä»¥å‚è€ƒå…¶åœ¨githubä¸Šçš„æºç ã€‚\nåˆå§‹åŒ–ç³»ç»Ÿ\nä½¿ç”¨LLVMçš„JITåŠŸèƒ½ï¼Œéœ€è¦è°ƒç”¨å‡ æ¡åˆå§‹åŒ–è¯­å¥ï¼Œå¯ä»¥æ”¾åœ¨mainå‡½æ•°å¼€å§‹æ—¶ã€‚\n123InitializeNativeTarget();InitializeNativeTargetAsmPrinter();InitializeNativeTargetAsmParser();\nè¿™å‡ å¥è°ƒç”¨ï¼Œä¸»è¦æ˜¯åœ¨å¤„ç†JITçš„TargetMachineï¼Œåˆå§‹åŒ–æœºå™¨ç›¸å…³ç¼–è¯‘ç›®æ ‡ã€‚\nå¼•ç”¨ç›¸å…³çš„å¤´æ–‡ä»¶\nè¿™é‡Œçš„ç¨ç¨æœ‰ç‚¹å¤šä½™çš„ï¼Œä¸å»ç®¡äº†ã€‚ï¼Œllvmçš„å¤´æ–‡ä»¶æ˜¯å±‚æ¬¡ç»„ç»‡çš„ï¼Œåƒæ‰§è¡Œå¼•æ“ï¼Œéƒ½åœ¨llvm/ExecutionEngine/ä¸‹ï¼Œè€ŒIRç›¸å…³çš„ï¼Œä¹Ÿéƒ½åœ¨llvm/IR/ä¸‹ï¼Œåˆç”¨LLVMå¾€å¾€æä¸æ¸…éœ€è¦å“ªäº›ï¼Œè¿™æ—¶å°±éœ€è¦å¤šæŸ¥ç›¸å…³çš„æ–‡æ¡£ï¼Œäº†è§£LLVMçš„å„ä¸ªæ¨¡å—çš„åŠŸèƒ½ã€‚\n12345678910111213141516171819#include \"llvm/ExecutionEngine/GenericValue.h\"#include \"llvm/ExecutionEngine/MCJIT.h\"#include \"llvm/ExecutionEngine/Interpreter.h\"#include \"llvm/ExecutionEngine/SectionMemoryManager.h\"#include \"llvm/IR/Verifier.h\"#include \"llvm/IR/Constants.h\"#include \"llvm/IR/DerivedTypes.h\"#include \"llvm/IR/IRBuilder.h\"#include \"llvm/IR/Instructions.h\"#include \"llvm/IR/LLVMContext.h\"#include \"llvm/IR/Module.h\"#include &lt;llvm/IRReader/IRReader.h&gt;#include &lt;llvm/Support/SourceMgr.h&gt;#include \"llvm/Support/ManagedStatic.h\"#include \"llvm/Support/TargetSelect.h\"#include &lt;llvm/Support/MemoryBuffer.h&gt;#include \"llvm/Support/raw_ostream.h\"#include &lt;llvm/Support/DynamicLibrary.h&gt;#include \"llvm/Support/Debug.h\"\nä¸»è¦è¯´è¦æ³¨æ„çš„å‡ ä¸ªç»†èŠ‚ï¼Œé¦–å…ˆæ˜¯\n12#include \"llvm/ExecutionEngine/MCJIT.h\"#include \"llvm/ExecutionEngine/Interpreter.h\"\nC++ç¼–è¯‘æ—¶ï¼Œè¿™ä¸¤ä¸ªå¤´æ–‡ä»¶å±…ç„¶ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœä½ ä¸æ³¨æ„æ—¶ï¼Œç¼–è¯‘ä¸ä¼šæŠ¥é”™ã€‚å› ä¸ºæ‰§è¡Œå¼•æ“æ˜¯ä¸€ä¸ªæ¥å£çš„æ¨¡å¼ï¼Œä¸å¯¹å¤–æš´éœ²å­ç±»çš„ç»†èŠ‚ï¼Œæˆ‘ä»¬å¿…é¡»æ³¨æ„å¼•ç”¨å…¶ä¸­ä¸€ä¸ªæˆ–ä¸¤ä¸ªéƒ½å¼•ç”¨ï¼Œå¦åˆ™ä¼šé“¾æ¥ä¸åˆ°å¯¹åº”çš„å¼•æ“ã€‚\nä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š\nCreate Engine Error\nJIT has not been linked in.\n\nä½¿ç”¨EngineBuilderæ„å»ºJITå¼•æ“\nç”±äºJITå¼•æ“æˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºå¤šä¸ªï¼Œæˆ‘ä»¬è¿™é‡Œä½¿ç”¨å•ä¾‹ç±»çš„æ–¹å¼ï¼Œä½¿ç”¨ä¸€ä¸ªLLVMä¸­çš„Moduleè¿›è¡Œåˆå§‹åŒ–ï¼Œå¦‚æœå¼•æ“å·²ç»åˆ›å»ºè¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨addModuleæ–¹æ³•ï¼Œå°†LLVMçš„Moduleæ·»åŠ åˆ°å¼•æ“çš„Moduleé›†åˆä¸­ã€‚\nfinalizeObjectå‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªå…³é”®çš„å‡½æ•°ï¼Œå¯¹åº”JITå¼•æ“å¾ˆé‡è¦ï¼Œæˆ‘ä»¬è¦ä¿éšœæˆ‘ä»¬åœ¨è°ƒç”¨JITç¼–è¯‘åçš„ä»£ç å‰ï¼Œè¦è°ƒç”¨è¿‡è¯¥å‡½æ•°\n1234567891011121314151617181920ExecutionEngine* EE = NULL;RTDyldMemoryManager* RTDyldMM = NULL;void initEE(std::unique_ptr&lt;Module&gt; Owner) &#123;    string ErrStr;    if (EE == NULL) &#123;        RTDyldMM = new SectionMemoryManager();        EE = EngineBuilder(std::move(Owner))            .setEngineKind(EngineKind::JIT)            .setErrorStr(&amp;ErrStr)            .setVerifyModules(true)            .setMCJITMemoryManager(std::unique_ptr&lt;RTDyldMemoryManager&gt;(RTDyldMM))            .setOptLevel(CodeGenOpt::Default)            .create();&#125; else    EE-&gt;addModule(std::move(Owner));if (ErrStr.length() != 0)    cerr &lt;&lt; \"Create Engine Error\" &lt;&lt; endl &lt;&lt; ErrStr &lt;&lt; endl;EE-&gt;finalizeObject();&#125;\nè¿™é‡Œæ˜¯finalizeObjectçš„æ–‡æ¡£è§£é‡Šï¼š\nfinalizeObject - ensure the module is fully processed and is usable.\nIt is the user-level function for completing the process of making the object usable for execution. It should be called after sections within an object have been relocated using mapSectionAddress. When this method is called the MCJIT execution engine will reapply relocations for a loaded object. This method has no effect for the interpeter.\nsetEngineKindå¯é€‰çš„æœ‰JITå’ŒInterpreterï¼Œå¦‚æœé»˜è®¤çš„è¯ï¼Œåˆ™æ˜¯ä¼˜å…ˆJITï¼Œæ£€æµ‹åˆ°å“ªä¸ªå¼•æ“èƒ½ç”¨å°±ç”¨å“ªä¸ªã€‚\nsetMCJITMemoryManageræ˜¯ä¸€ä¸ªå…³é”®çš„ç®¡ç†å™¨ï¼Œå½“ç„¶è²Œä¼¼é»˜è®¤ä¸å†™ä¹Ÿä¼šæ„å»ºï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ºäº†æ¸…æ™°æ‰€è§ï¼Œè¿˜æ˜¯æ·»åŠ äº†è¿™æ¡é…ç½®ï¼Œè¿™ä¸ªå†…å­˜ç®¡ç†å™¨åœ¨æ‰§è¡Œå¼•æ“ä¸­å¾ˆé‡è¦ï¼Œä¸€èˆ¬æœ¬åœ°çš„åº”ç”¨æˆ‘ä»¬è¦é€‰æ‹©SectionMemoryManagerç±»ï¼Œè€Œlliä¸­ç”šè‡³è¿˜åŒ…å«ç€è¿œç¨‹è°ƒç”¨çš„ç›¸å…³ç±»ã€‚\nsetOptLevelæ˜¯è®¾ç½®ä»£ç çš„ä¼˜åŒ–ç­‰çº§ï¼Œé»˜è®¤æ˜¯O2ï¼Œå¯ä»¥ä¿®æ”¹ä¸ºä¸‹é¢æšä¸¾å€¼ï¼š\nNone\nLess\nDefault\nAggressive\nMCJITæ¶æ„å›¾\nç¼–å†™æ ¸å¿ƒçš„è°ƒç”¨æ–¹æ³•\n12345678910111213141516171819202122232425typedef void (*func_type)(void*);// pathæ˜¯bcæ–‡ä»¶çš„è·¯å¾„ï¼Œfunc_nameæ˜¯è¦æ‰§è¡Œçš„å‡½æ•°åvoid Run(const std::string&amp; path, const std::string&amp; func_name) &#123;// é¦–å…ˆè¦è¯»å–è¦æ‰§è¡Œçš„bcå­—èŠ‚ç SMDiagnostic error;std::unique_ptr&lt;Module&gt; Owner = parseIRFile(path, error, context);if(Owner == nullptr) &#123;    cout &lt;&lt; \"Load Error: \" &lt;&lt; path &lt;&lt; endl;    Owner-&gt;dump();    return;&#125;// å•ä¾‹çš„æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œæš‚æœªè€ƒè™‘å¤šçº¿ç¨‹initEE(std::move(Owner));// è·å–ç¼–è¯‘åçš„å‡½æ•°æŒ‡é’ˆå¹¶æ‰§è¡Œuint64_t func_addr = EE-&gt;getFunctionAddress(func_name.c_str());if (func_addr == 0) &#123;    printf(\"é”™è¯¯, æ‰¾ä¸åˆ°å‡½æ•°: %s\\n\", func_name.c_str());    return;&#125;func_type func = (func_type) func_addr;func(NULL); // éœ€è¦ä¼ å‚æ•°æ—¶å¯ä»¥ä»è¿™é‡Œä¼ é€’&#125;\nè§£é‡Šå™¨ç‰ˆæœ¬\nè§£é‡Šå™¨æ•ˆç‡ç¨ä½ä¸€ä¸‹ï¼Œä¸è¿‡èƒ½å¤Ÿåšåˆ°æƒ°æ€§çš„ä¸€ä¸‹ä»£ç è½½å…¥å’Œæ‰§è¡Œå·¥ä½œï¼Œæœ‰æ—¶ä¹Ÿå¾ˆæœ‰ç”¨é€”ã€‚ä¸‹é¢æˆ‘ä»¬å°±åœ¨jitçš„åŸºç¡€ä¸Šï¼Œä»‹ç»ä¸€ä¸‹ç®€å•çš„è§£é‡Šå™¨åŠŸèƒ½ã€‚ä»‹ç»å™¨æœ€ä¸»è¦éœ€è¦åšçš„å°±æ˜¯å°†ç”Ÿæˆå¼•æ“æ”¹å˜ï¼š\n12345678EE = EngineBuilder(std::move(Owner))    // è¿™é‡Œæ”¹å®Œè§£é‡Šå™¨    .setEngineKind(EngineKind::Interpreter)    .setErrorStr(&amp;ErrStr)    .setVerifyModules(true)    .setMCJITMemoryManager(std::unique_ptr&lt;RTDyldMemoryManager&gt;(RTDyldMM))    .setOptLevel(CodeGenOpt::Default)    .create();\nå¦å¤–è§£é‡Šå™¨å¯ä»¥ä½¿ç”¨getLazyIRFileModuleå‡½æ•°å¯ä»¥æ›¿æ¢parseIRFileå®ç°.bcæ–‡ä»¶çš„æƒ°æ€§åŠ è½½ã€‚\nè§£é‡Šå™¨çš„æ‰§è¡Œæ–¹å¼å’ŒJITæœ‰ä¸€äº›ä¸åŒï¼Œè¦ä½¿ç”¨FindFunctionNamedå‡½æ•°æ¥å¯»æ‰¾å¯¹åº”çš„å‡½æ•°å¯¹è±¡ï¼Œè§£é‡Šå™¨èƒ½å¤Ÿè·å–æ›´å…¨çš„LLVMå­—èŠ‚ç çš„ä¸­é—´ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸€äº›å±æ€§å’Œå…ƒæ•°æ®ï¼Œåœ¨åšä¸€äº›çµæ´»çš„åŠ¨æ€è¯­è¨€è§£é‡Šå™¨æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚\n12345678910111213141516171819// ç»™è§£é‡Šå™¨ä½¿ç”¨çš„éƒ¨åˆ†Function* func = EE-&gt;FindFunctionNamed(func_name.c_str());if (func == NULL) &#123;    printf(\"å¿½ç•¥, æ‰¾ä¸åˆ°å‡½æ•°: %s\\n\", func_name.c_str());    return;&#125;// å¦‚æœéœ€è¦ä¼ å‚æ•°çš„è¯std::vector&lt;GenericValue&gt; args;args.push_back(GenericValue(NULL));EE-&gt;runFunction(func, args);åˆ›å»ºæµ‹è¯•çš„Cä»£ç æˆ‘åœ¨æ˜¯Eliteç¼–è¯‘å™¨å·¥ç¨‹ä¸‹å¼€å‘çš„ï¼Œæ‰€ä»¥ä¼šæœ‰æ¥å£è°ƒç”¨çš„æµ‹è¯•ï¼Œå¤§å®¶å¯ä»¥ï¼Œåˆ›å»ºç®€å•çš„Cå‡½æ•°è¿›è¡Œè°ƒç”¨æµ‹è¯•ï¼šextern voidtestï¼’_elite_plugin_init(CodeGenContext* context) &#123;    printf(\"testï¼’_elite_plugin_init\\n\");    if (context == NULL) printf(\"Error for context\\n\");    else context-&gt;AddOrReplaceMacros(macro_funcs);&#125;æ‰§è¡Œç»“æœï¼š\næœ€è¿‘ç ”ç©¶çš„LLVMæŠ€æœ¯ï¼Œå¤§éƒ¨åˆ†åº”ç”¨äºæ­£åœ¨è¿›è¡Œçš„ELiteç¼–è¯‘å™¨å¼€å‘ï¼Œæ¬¢è¿æœ‹å‹ä»¬å…³æ³¨å’Œå‚ä¸ã€‚\ngithub: https://github.com/elite-lang/Elite\næ–‡æ¡£: http://elite-lang.org/doc/zh-cn/\n\nç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œè¥¿é£é€é¥æ¸¸ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/xfxyy_sxfancy/article/details/50485090\n","thumbnail":"/posts/ç¼–è¯‘å™¨æ¶æ„çš„ç‹è€…LLVMâ€”â€”ä½¿ç”¨JITå¼•æ“/llvm.png","plink":"https://shuntan.github.io/posts/ç¼–è¯‘å™¨æ¶æ„çš„ç‹è€…LLVMâ€”â€”ä½¿ç”¨JITå¼•æ“/"},{"title":"æºç è§£è¯»Linuxçš„limits.confæ–‡ä»¶","date":"2019-09-09T12:19:38.000Z","date_formatted":{"ll":"Sep 9, 2019","L":"09/09/2019","MM-DD":"09-09"},"updated":"2020-04-22T06:31:01.613Z","content":"å‰è¨€\næœ¬æ–‡ä¸ä¸€å®šé€‚åˆæ¯”è¾ƒè€ç‰ˆæœ¬çš„Linuxï¼Œå¦‚æœåªå…³å¿ƒä½¿ç”¨ï¼Œè¯·ç›´æ¥çœ‹â€œæ€»ç»“â€ï¼Œæœ¬æ–‡ä¸»è¦é’ˆå¯¹CentOSï¼Œå…¶å®ƒLinuxå‘è¡Œç‰ˆæœ¬ç±»ä¼¼ï¼Œä½†ç»†èŠ‚å¯èƒ½æœ‰å‡ºå…¥ï¼Œæ¯”å¦‚é‡å¯æœåŠ¡å¯èƒ½ä¸æ˜¯ç”¨systemctlï¼Œè€Œæ˜¯serviceç­‰ã€‚\nå½“éœ€è¦è°ƒæ•´ä¸€ä¸ªè¿›ç¨‹å¯æ‰“å¼€çš„æœ€å¤šæ–‡ä»¶æ•°æˆ–SOCKETè¿æ¥æ•°ç­‰ï¼Œä»¥CentOSä¸ºä¾‹ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ä¿®æ”¹æ–‡ä»¶/etc/security/limits.confï¼Œæ¯”å¦‚å°†æœ€å¤šå¯æ‰“å¼€æ•°è°ƒæ•´ä¸º10ä¸‡ï¼š\n \nvi /etc/security/limits.conf\n\nsoft nofile 100000\nhard nofile 100000\n\nè¯»å–limit.confæ–‡ä»¶çš„å¹¶ä¸æ˜¯Linuxå†…æ ¸ï¼Œè€Œæ˜¯ä¸€ä¸ªå†…æ ¸æ¨¡å—PAMï¼Œå¯¹åº”çš„æ¨¡å—æ–‡ä»¶ä¸ºï¼š\n/usr/lib64/security/pam_limits.so\n/usr/lib/security/pam_limits.so\nè€Œ/etc/pam.dç›®å½•ä¸‹çš„é…ç½®æ–‡ä»¶ï¼Œåˆ™ç”±libpam.soè¯»å–ï¼Œå®é™…ä¸Šæ‰€æœ‰çš„æ¨¡å—å‡ç”±libpam.soåŠ è½½ï¼Œå¯å°†libpam.soçœ‹æˆæ˜¯æ‰€æœ‰PAMæ¨¡å—çš„æ¡†æ¶æˆ–å®¹å™¨ï¼Œè€Œä¸”libpam.soæœ¬èº«ä¹Ÿä¸æ˜¯å†…æ ¸çš„ç»„æˆéƒ¨åˆ†ã€‚\nå¤šä¸ªä¸åŒLinuxç‰ˆæœ¬ä¸ŠæŸ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å«libpam.soçš„æ–‡ä»¶åï¼Œå‡æ˜¯libpam.so.0ï¼ˆä¸æ¸…æ¥šæ˜¯å¦æ‰€æœ‰éƒ½è¿™æ ·ï¼‰ï¼Œä½†æ˜¯ç¼–è¯‘Linux-PAM-1.3.1æºä»£ç æœ‰åä¸ºlibpam.soè½¯é“¾æ¥ï¼ŒæŒ‡å‘libpam.so.0.84.2ã€‚\n/usr/lib64/libpam.so.0 -&gt; libpam.so.0.83.1\n/usr/lib64/libpam.so.0.83.1\n/usr/lib64/libpam_misc.so.0.82.0\n/usr/lib/libpam.so.0 -&gt; libpam.so.0.83.1\n/usr/lib/libpam.so.0.83.1\n/usr/lib/libpam_misc.so.0.82.0\nlibpam.soä¼šè¢«åŠ è½½åˆ°crondç­‰è¿›ç¨‹ç©ºé—´ï¼ˆé‚£å½“ç„¶ä¹Ÿå¯ä»¥ä¸åŠ è½½ï¼‰ï¼Œå¦‚æœæ²¡æœ‰åŠ è½½libpam.soï¼Œåˆ™limits.confä¸ä¼šç”Ÿæ•ˆã€‚crondç­‰ä¸ä¼šä¸»åŠ¨åŠ è½½libpam.soï¼Œé‚£ä¹ˆæ˜¯è°è®©libpam.soè¿›å…¥crondç­‰è¿›ç¨‹ç©ºé—´çš„äº†ï¼Ÿï¼ˆæ‰§è¡Œâ€œgrep libpam /proc/pidof crond/mapsâ€å¯æŸ¥çœ‹libpamæ˜¯å¦åœ¨crondçš„è¿›ç¨‹ç©ºé—´ï¼‰ã€‚\nåœ¨CentOSï¼Œå¯ç”¨serviceæ¥å¯åŠ¨æˆ–é‡å¯crondï¼Œæ‰€ä»¥è·Ÿå®ƒåº”å½“æ˜¯ç›¸å…³çš„ï¼Œè€Œserviceå®é™…è°ƒç”¨çš„æ˜¯systemctlè¿™ä¸€ç³»ç»Ÿå·¥å…·ï¼ˆéShellè„šæœ¬ï¼Œserviceä¸ºè€ç‰ˆæœ¬ä½¿ç”¨æ–¹å¼ï¼Œä½¿ç”¨systemctlå¯åŠ¨å’Œé‡å¯æœåŠ¡ï¼Œä½¿ç”¨æ–¹å¼å’Œserviceç›¸åŒï¼‰ã€‚\nservice crond restart\nRedirecting to /bin/systemctl restart  crond.service\nfile /bin/systemctl\n/bin/systemctl: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV)\nsystemctl crond restart # é‡å¯crontabæœåŠ¡è¿›ç¨‹crond\nPAM\nPAMçš„å…¨ç§°ä¸ºâ€œPluggable Authentication Modulesâ€ï¼Œå³å¯æ’å…¥è®¤è¯æ¨¡å—ã€‚æœ€åˆç”±å¤ªé˜³å¾®ç³»ç»Ÿå…¬å¸ï¼ˆSun Microsystemsï¼Œå·²äº2009å¹´è¢«ç”²éª¨æ–‡æ”¶è´­ï¼‰äº1995å¹´åœ¨Solariså¼€å‘ã€‚PAMä»£ç ä¸åŒ…å«åœ¨Linuxå†…æ ¸ä¸­ï¼Œå¹¶æœ‰ä¸“é—¨çš„ç½‘ç«™ï¼šhttp://linux-pam.org/ï¼Œæºä»£ç æ‰˜ç®¡åœ¨Githubä¸Šï¼ˆhttps://github.com/linux-pam/linux-pam/releasesï¼‰ã€‚\npam_limits\npam_limitsæ˜¯PAMå…¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼ˆæ¨¡å—æ–‡ä»¶åä¸ºpam_limits.soï¼‰ï¼Œä¹Ÿæ˜¯ç¨‹åºå‘˜æ¥è§¦è¾ƒå¤šçš„æ¨¡å‹ä¹‹ä¸€ï¼Œå¯¹åº”çš„æºä»£ç æ–‡ä»¶ä¸ºpam_limits.cï¼Œä»£ç è§„æ¨¡ä¸ºå‡ ç™¾è¡Œï¼ŒåŠ ä¸Šæ‰€æœ‰æ³¨é‡Šå’Œç©ºæ ¼æœ‰1100å¤šè¡Œï¼š\n123#if !defined(linux) &amp;&amp; !defined(__linux)#warning THIS CODE IS KNOWN TO WORK ONLY ON LINUX !!!#endif\næºä»£ç æä¾›autoconfç¼–è¯‘ï¼Œå°è¯•åœ¨Linux-3.10ä¸Šå¯ç¼–è¯‘æˆåŠŸï¼š\n~/Linux-PAM-1.3.1]$ ./configure --prefix=/usr/local/Linux-PAM-1.3.1\nmake\nlimits.confçš„ç”±æ¥\nç¡®å®šæ¨¡å—pam_limitsçš„é…ç½®æ–‡ä»¶ï¼Œç”±å®CONF_FILEå†³å®šï¼š\n// pam_limits.c\n#define CONF_FILE (pl-&gt;conf_file != NULL)?pl-&gt;conf_file:LIMITS_FILE\nä½¿ç”¨çš„åœ°æ–¹ï¼š\n12345678910111213141516// pam_limits.cstatic intparse_config_file(pam_handle_t *pamh, const char *uname, uid_t uid, gid_t gid,     int ctrl, struct pam_limit_s *pl)&#123;    FILE *fil;    char buf[LINE_LENGTH];/* check for the LIMITS_FILE */if (ctrl &amp; PAM_DEBUG_ARG)    pam_syslog(pamh, LOG_DEBUG, \"reading settings from '%s'\", CONF_FILE);fil = fopen(CONF_FILE, \"r\"); // æ‰“å¼€é…ç½®æ–‡ä»¶ï¼Œè·Ÿå‚æ•°â€œplâ€æœ‰å…³ç³»if (fil == NULL) &#123;    pam_syslog (pamh, LOG_WARNING,\"cannot read settings from %s: %m\", CONF_FILE);    return PAM_SERVICE_ERR;&#125;\nå¦‚æœå‡½æ•°parse_config_fileçš„å‚æ•°â€œplâ€å€¼ä¸ºNULLï¼Œåˆ™é…ç½®æ–‡ä»¶ååœ¨ç¼–è¯‘æ—¶å†³å®šï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œé…ç½®æ–‡ä»¶åè¢«å›ºå®šä¸ºlimits.confï¼š\nMakefile.am\nmodules/pam_limits/Makefile.am: -DLIMITS_FILE_DIR=&quot;$(limits_conf_dir)/*.conf&quot; \nmodules/pam_limits/Makefile.am: -DLIMITS_FILE=&quot;$(SCONFIGDIR)/limits.conf&quot;\nåªæ˜¯limits.confæ‰€åœ¨ç›®å½•å¯ç”±ç¼–è¯‘æ—¶å†³å®šï¼Œä¹Ÿå°±æ˜¯çœ‹SCONFIGDIRï¼Œå†³å®šåœ¨automakeçš„configure.acæ–‡ä»¶ï¼š\nconfigure.ac\n1234567891011121314AC_ARG_ENABLE(sconfigdir,        AS_HELP_STRING([--enable-sconfigdir=DIR],[path to module conf files @&lt;:@default=$sysconfdir/security@:&gt;@]),        SCONFIGDIR=$enableval, SCONFIGDIR=$sysconfdir/security)AC_SUBST(SCONFIGDIR)dnl and some hacks to use /etc and /libtest \"$&#123;prefix&#125;\" = \"NONE\" &amp;&amp; prefix=\"/usr\"if test $&#123;prefix&#125; = '/usr'thendnl If we use /usr as prefix, use /etc for config files        if test $&#123;sysconfdir&#125; = '$&#123;prefix&#125;/etc'        then                sysconfdir=\"/etc\"        fi\næ¨å¯¼å‡ºé»˜è®¤ä¸ºâ€œ/etc/security/limits.confâ€ï¼Œä½†ä»å‰é¢çš„åˆ†æï¼Œå¯çœ‹åˆ°å®é™…è¿˜å¯å‚æ•°åŠ¨æ€æŒ‡å®šï¼Œè¿™ä¸ªå‚æ•°æ€ä¹ˆæ¥ï¼Ÿå¯è¿›å…¥Linuxçš„/etc/pam.dç›®å½•ï¼Œæ‰¾ä¸€ä¸ªçœ‹ä¸€çœ‹ï¼š\nvi /etc/pam.d/login\nsession    required     pam_selinux.so close\nsession    required     pam_selinux.so open\nä¸Šè¿°æœ€åä¸€ä¸ªé…ç½®é¡¹å³ä¸ºæ¨¡å‹çš„å‚æ•°å€¼ï¼Œå‚æ•°å€¼å¯æœ‰0ã€ä¸€ä¸ªæˆ–å¤šä¸ªã€‚é€šå¸¸pam_limits.soä½¿ç”¨é»˜è®¤å‚æ•°å€¼ï¼Œå› æ­¤å®ƒçš„é…ç½®æ–‡ä»¶limits.confå®Œæ•´è·¯å¾„ä¸ºï¼š/etc/security/limits.confã€‚\næ¨¡å—å…¥å£å‡½æ•°\nä¼šè¯ï¼ˆSessionï¼‰ç±»çš„PAMæ¨¡å—çš„å…¥å£å‡½æ•°å‡ä¸ºpam_sm_open_sessionï¼ˆæˆæƒç±»çš„ä¸ºpam_sm_authenticateï¼Œå¯†ç ç±»çš„ä¸ºpam_sm_chauthtokï¼‰ï¼Œæ„ä¸ºåˆ›å»ºï¼ˆæ‰“å¼€ï¼‰ä¸€ä¸ªä¼šè¯ï¼š\nint\npam_sm_open_session (pam_handle_t *pamh, int flags UNUSED, int argc, const char **argv);\n// libpam/pam_handlers.c:  sym = â€œpam_sm_open_sessionâ€;\nåŠ è½½æ¨¡å—åœ¨pam_handlers.cä¸­å®Œæˆï¼Œå®é™…ä¸Šä¸€ä¸ªæ¨¡å—å¯åŠ è½½å¤šæ¬¡ï¼ˆå¯åœ¨/etc/securityä¸‹çœ‹åˆ°æœ‰äº›é…ç½®æ–‡ä»¶ä¸­åŒä¸€æ¨¡å‹æœ‰å¤šè¡Œï¼‰ã€‚ç±»ä¼¼äºiptablesï¼Œæ¯åŠ è½½ä¸€æ¬¡åˆ›å»ºä¸€ä¸ªhandlerï¼Œä¾æ¬¡ç»„æˆä¸€ä¸ªhandlerè°ƒç”¨é“¾ï¼ˆå®é™…ç”±é…ç½®æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œé…ç½®ç»„æˆé“¾ï¼‰ï¼š\n123456789101112131415161718192021222324252627282930313233343536373839404142434445// pam_handlers.c// è¢«_pam_parse_conf_fileç›´æ¥è°ƒç”¨ï¼Œ// å’Œè¢«_pam_init_handlersã€_pam_load_conf_fileä¸€çº§é—´æ¥è°ƒç”¨int _pam_add_handler(pam_handle_t *pamh     , int handler_type, int other, int stack_level, int type     , int *actions, const char *mod_path     , int argc, char **argv, int argvlen)&#123;    struct loaded_module *mod = NULL;    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    if ((handler_type == PAM_HT_MODULE ||         handler_type == PAM_HT_SILENT_MODULE) &amp;&amp;        mod_path != NULL) &#123;if (mod_path[0] == '/') &#123;    mod = _pam_load_module(pamh, mod_path, handler_type);&#125; else if (asprintf(&amp;mod_full_path, \"%s%s\",     DEFAULT_MODULE_PATH, mod_path) &gt;= 0) &#123;    mod = _pam_load_module(pamh, mod_full_path, handler_type);    _pam_drop(mod_full_path);&#125; else &#123;    pam_syslog(pamh, LOG_CRIT, \"cannot malloc full mod path\");    return PAM_ABORT;&#125;if (mod == NULL) &#123;    /* if we get here with NULL it means allocation error */    return PAM_ABORT;&#125;    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚        /* point handler_p's at the root addresses of the function stacks */    switch (type) &#123;        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚        case PAM_T_SESS:            handler_p = &amp;the_handlers-&gt;open_session;            sym = \"pam_sm_open_session\";            handler_p2 = &amp;the_handlers-&gt;close_session;            sym2 = \"pam_sm_close_session\";            break;        ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    &#125;if ((mod_type == PAM_MT_DYNAMIC_MOD) &amp;&amp;    !(func = _pam_dlsym(mod-&gt;dl_handle, sym)) ) &#123;    pam_syslog(pamh, LOG_ERR, \"unable to resolve symbol: %s\", sym);&#125;ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&#125;\næ¯ä¸ªæ¨¡å—çš„ç»“æœå¯èƒ½æ˜¯æˆåŠŸPAM_SUCCESS(0)ï¼Œå…¨å®šä¹‰åœ¨æ–‡ä»¶libpam/include/security/_pam_types.hä¸­ï¼Œä¸‹åˆ—å±•ç¤ºå°éƒ¨åˆ†ï¼š\n1234567/* ----------------- The Linux-PAM return values ------------------ */#define PAM_SUCCESS 0 /* Successful function return */#define PAM_OPEN_ERR 1 /* dlopen() failure when dynamically *//* loading a service module */#define PAM_SYMBOL_ERR 2 /* Symbol not found */#define PAM_SERVICE_ERR 3 /* Error in service module */#define PAM_SYSTEM_ERR 4 /* System error */\nè§£ælimits.conf\né‡èšç„¦åˆ°pam_limitsæ¨¡å—ï¼Œçœ‹çœ‹å®ƒçš„é…ç½®æ–‡ä»¶è§£æï¼Œè¿™å‘ç”Ÿåœ¨å‡½æ•°pam_limits.cä¸­çš„parse_config_fileå‡½æ•°ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// pam_limits.cstatic intparse_config_file(pam_handle_t *pamh, const char *uname, uid_t uid, gid_t gid,     int ctrl, struct pam_limit_s *pl)&#123;    FILE *fil;    char buf[LINE_LENGTH]; // #define LINE_LENGTH 1024    // ä»¥åªè¯»æ–¹å¼æ‰“å¼€limits.conf\t\tfil = fopen(CONF_FILE, \"r\");\t\tif (fil == NULL) &#123;    pam_syslog (pamh, LOG_WARNING,\"cannot read settings from %s: %m\", CONF_FILE);    return PAM_SERVICE_ERR;&#125;/* start the show */// ä¸€è¡Œè¡Œéå†limits.confwhile (fgets(buf, LINE_LENGTH, fil) != NULL) &#123;    line = buf;    /* skip the leading white space */    while (*line &amp;&amp; isspace(*line)) // è·³è¿‡ç©ºè¡Œ        line++;            /* Rip off the comments */    tptr = strchr(line,'#'); // å»æ‰æ³¨é‡Š    if (tptr)        *tptr = '\\0';    /* Rip off the newline char */    tptr = strchr(line,'\\n'); // åˆ é™¤æ¢è¡Œç¬¦ï¼Œæ³¨æ„å¹¶ä¸åŒ…æ‹¬å›è½¦ç¬¦    if (tptr)        *tptr = '\\0';    /* Anything left ? */    if (!strlen(line)) // ç»è¿‡ä¸Šé¢å‡ æ­¥æŠ˜è…¾ï¼Œå¯èƒ½æˆäº†ç©ºè¡Œ        continue;        // ç›´æ¥è°ƒç”¨sscanfè§£æé…ç½®é¡¹    //    // é…ç½®è¡Œç¤ºä¾‹ï¼š    // * soft nofile 100000    //    // domainï¼šä½œç”¨åŸŸåï¼Œâ€œ*â€è¡¨ç¤ºå¯¹æ‰€æœ‰ç”¨æˆ·æœ‰æ•ˆ    i = sscanf(line,\"%s%s%s%s\", domain, ltype, item, value);    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    // ä¸‹é¢åªçœ‹ä¸¤ä¸ªå¸¸ç”¨é…ç½®ï¼šdomainé…ç½®ä¸ºâ€œ*â€æˆ–æŒ‡å®šçš„ç”¨æˆ·å    // å¯ä»¥çœ‹åˆ°åœ¨åŠ è½½limits.confï¼Œä¸»è¦æ˜¯è®¾ç½®è¾“å‡ºå‚æ•°plçš„å€¼ã€‚    // è€Œparse_config_fileç”±pam_sm_open_sessionè°ƒç”¨ï¼Œäº¦å³æ¨¡å—è¢«åŠ è½½æ—¶è¢«è°ƒç”¨ã€‚    //    // ä¹Ÿå› æ­¤ä¿®æ”¹limits.confæ˜¯ä¸èƒ½ç«‹å³ç”Ÿæ•ˆçš„ï¼Œ    // é™¤éé‡å¯è¯¥è¿›ç¨‹ï¼Œè€Œå­è¿›ç¨‹åˆç»§æ‰¿çˆ¶è¿›ç¨‹çš„è®¾ç½®ã€‚    //    // å‡è®¾ç¨‹åºè·‘åœ¨crontabä¸­ï¼Œåˆ™åº”é‡å¯crondè¿›ç¨‹ï¼Œ    // æ¯”å¦‚CentOSä¸­é‡å¯crondï¼šservice crond restart    // è™½ç„¶crontabä¸­çš„è¿›ç¨‹æ˜¯ç”±crondæ‹‰èµ·æ¥çš„ï¼Œä½†å®ƒå¹¶åŠ è½½PAMæ¨¡å—ï¼Œ    // åŸå› æ˜¯crondåœ¨æ‹‰èµ·å­è¿›ç¨‹æ—¶ï¼Œå¯¹å­è¿›ç¨‹å…³é—­äº†æ‰€æœ‰æè¿°ç¬¦ã€‚    //    // process_limité’ˆå¯¹å½“å‰è°ƒç”¨è¿›ç¨‹è¿›è¡Œlimitè®¾ç½®    if (strcmp(domain, \"*\") == 0)        // limit was set by a default entry        process_limit(pamh, LIMITS_DEF_DEFAULT, ltype, item, value, ctrl, pl);    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚            if (strcmp(uname, domain) == 0) /* this user have a limit */        // limit was set by an user entry        process_limit(pamh, LIMITS_DEF_USER, ltype, item, value, ctrl, pl);&#125;&#125;\nç”Ÿæ•ˆlimits.conf\nåŠ è½½PAMæ¨¡å—æ—¶ï¼Œå³ä¼šç”Ÿæ•ˆlimits.confï¼Œå› ä¸ºè¿™ä¸ªåœ¨pam_sm_open_sessionå°±å·²æ‰§è¡Œäº†ï¼š\n1234567891011121314151617/* now the session stuff */intpam_sm_open_session (pam_handle_t *pamh, int flags UNUSED,     int argc, const char **argv)&#123;    struct pam_limit_s plstruct;    struct pam_limit_s *pl = &amp;plstruct;    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    // è°ƒç”¨parse_config_fileè§£ælimits.confï¼Œ    // é…ç½®è¡Œè§£æç»“æœå­˜å‚¨åœ¨plä¸­ï¼ˆäº¦å³plstructï¼‰    retval = parse_config_file(pamh, pwd-&gt;pw_name, pwd-&gt;pw_uid, pwd-&gt;pw_gid, ctrl, pl);    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    // ä½¿é…ç½®ç«‹å³ç”Ÿæ•ˆï¼ˆsetup_limitsè°ƒç”¨ç³»ç»Ÿå‡½æ•°setrlimitï¼‰    retval = setup_limits(pamh, pwd-&gt;pw_name, pwd-&gt;pw_uid, ctrl, pl);    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    return PAM_SUCCESS;&#125;\næ¨¡å—pam_limits.soæ˜¯ç”±PAMæ¨¡å—libpam.soåŠ è½½çš„ï¼ŒcrondåŠ è½½çš„åªæ˜¯libpam.soã€‚â€œ/etc/pam.dâ€ç›®å½•ä¸‹çš„æ–‡ä»¶ä»€ä¹ˆæ—¶å€™ç”Ÿæ•ˆï¼ŸåŠ è½½libpam.soæ—¶ç”Ÿæ•ˆï¼š\n123456789101112131415161718192021222324// pam_start.cint pam_start (    const char *service_name,    const char *user,    const struct pam_conv *pam_conversation,    pam_handle_t **pamh)&#123;    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    if ( _pam_init_handlers(*pamh) != PAM_SUCCESS ) &#123;    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&#125;// pam_handlers.cint _pam_init_handlers(pam_handle_t *pamh)&#123;    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚    // å‡½æ•°_pam_parse_conf_fileè´Ÿè´£è§£ælibpam.soçš„é…ç½®æ–‡ä»¶ï¼Œ    // è¿™äº›é…ç½®æ–‡ä»¶ä¸€èˆ¬ä½äºç›®å½•/etc/pam.dä¸‹ï¼Œå¦‚ï¼š    // # ls -l /etc/pam.d/pass*    // -rw-r--r-- 1 root root 188 6æœˆ  10 2014 /etc/pam.d/passwd    // -rw-r--r-- 1 root root 974 12æœˆ 29 2016 /etc/pam.d/password-auth    retval = _pam_parse_conf_file(pamh, f, NULL, PAM_T_ANY, 0);    ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&#125;\nsystemctlå’Œsystemd\nCentOSä¸Šçš„systemctlï¼ˆCentOS-7.Xä¹‹å‰ä¸ºserviceè„šæœ¬ï¼‰ç±»ä¼¼äºWindowså¹³å°çš„æœåŠ¡ç®¡ç†å™¨ï¼Œæ›¿ä»£è€ç‰ˆæœ¬ä¸­çš„serviceè„šæœ¬æ¥ç®¡ç†æœåŠ¡ã€‚SystemctlåŠŸèƒ½éå¸¸å¤šï¼Œæœ‰å…³systemctlçš„åŠŸèƒ½ä¸åœ¨æœ¬æ–‡è¿‡å¤šæè¿°ã€‚\nsytemctlçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡ä¸æœåŠ¡systemdäº¤äº’ï¼Œæ¥å®Œæˆå„é¡¹å·¥ä½œï¼Œæ¯”å¦‚é‡å¯crondè¿›ç¨‹ã€‚åœ¨CentOSï¼Œsystemctlæ›¿ä»£äº†inittabã€‚\nå¯ä»¥çœ‹åˆ°æ­£æ˜¯systemdåŠ è½½äº†pamï¼Œä»lddç»“æœå¯ä»¥çœ‹å‡ºsystemdä¹Ÿä¸æ˜¯åŠ¨æ€åŠ è½½pamæ¨¡å—ï¼Œè€Œæ˜¯ç¼–è¯‘æ—¶å°±ç»‘å®šäº†ï¼Œå› æ­¤libpam.soæˆäº†ç³»ç»Ÿçš„å¿…é¡»éƒ¨åˆ†ï¼ˆä½†pam_limits.soä»ç„¶ä¸æ˜¯ï¼Œæ€»æ˜¯å¯æ’æ‹”ï¼‰ï¼š\nldd /usr/lib/systemd/systemd\n    linux-vdso.so.1 =&gt;  (0x00007ffce5b72000)\n    /$LIB/libonion.so =&gt; /lib64/libonion.so (0x00007f2430f56000)\n    libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007f2430d31000)\n    libcap.so.2 =&gt; /lib64/libcap.so.2 (0x00007f2430b2c000)\n    libpam.so.0 =&gt; /lib64/libpam.so.0 (0x00007f243091d000)\n    libaudit.so.1 =&gt; /lib64/libaudit.so.1 (0x00007f24306f5000)\n    libkmod.so.2 =&gt; /lib64/libkmod.so.2 (0x00007f24304df000)\n    libmount.so.1 =&gt; /lib64/libmount.so.1 (0x00007f24302a0000)\n    librt.so.1 =&gt; /lib64/librt.so.1 (0x00007f2430098000)\n    libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007f242fe82000)\n    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f242fc66000)\n    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f242f8a2000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007f243105c000)\n    libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007f242f69e000)\n    libpcre.so.1 =&gt; /lib64/libpcre.so.1 (0x00007f242f43d000)\n    liblzma.so.5 =&gt; /lib64/liblzma.so.5 (0x00007f242f218000)\n    libattr.so.1 =&gt; /lib64/libattr.so.1 (0x00007f242f013000)\n    libcap-ng.so.0 =&gt; /lib64/libcap-ng.so.0 (0x00007f242ee0d000)\n    libz.so.1 =&gt; /lib64/libz.so.1 (0x00007f242ebf7000)\n    libblkid.so.1 =&gt; /lib64/libblkid.so.1 (0x00007f242e9ba000)\n    libuuid.so.1 =&gt; /lib64/libuuid.so.1 (0x00007f242e7b5000)\n\nldd /usr/sbin/crond\n    linux-vdso.so.1 =&gt;  (0x00007ffef31a5000)\n    /$LIB/libonion.so =&gt; /lib64/libonion.so (0x00007f87b89e5000)\n    libselinux.so.1 =&gt; /lib64/libselinux.so.1 (0x00007f87b8416000)\n    libpam.so.0 =&gt; /lib64/libpam.so.0 (0x00007f87b8207000)\n    libdl.so.2 =&gt; /lib64/libdl.so.2 (0x00007f87b8003000)\n    libaudit.so.1 =&gt; /lib64/libaudit.so.1 (0x00007f87b7ddb000)\n    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f87b7a17000)\n    libpcre.so.1 =&gt; /lib64/libpcre.so.1 (0x00007f87b77b6000)\n    liblzma.so.5 =&gt; /lib64/liblzma.so.5 (0x00007f87b7591000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007f87b88cc000)\n    libcap-ng.so.0 =&gt; /lib64/libcap-ng.so.0 (0x00007f87b738b000)\n    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f87b716f000)\n\nå®é™…ä¸Šï¼Œsystemdä¸ºLinuxç³»ç»Ÿï¼ˆCentOSå¦‚æ­¤ï¼ŒåƒUbuntuæœªå¿…ï¼‰çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹ï¼Œå–ä»£äº†ä»¥å‰çš„initè¿›ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°systemdè¿›ç¨‹å’Œinitè¿›ç¨‹ä¸ä¼šåŒæ—¶å­˜åœ¨ï¼Œä½ç‰ˆæœ¬ä¸ºinitï¼Œé«˜ç‰ˆæœ¬ä¸ºsystemdã€‚Ubuntuä½¿ç”¨çš„æ˜¯upstartï¼Œä½†ä¹Ÿå¯èƒ½ç”¨systemdæ›¿ä»£upstartã€‚\nåœ¨systemdæºä»£ç çš„ç¼–è¯‘æ–‡ä»¶meson.buildï¼ˆç±»ä¼¼äºCMakeçš„CMakeLists.txtæ–‡ä»¶ï¼Œæˆ–bazelçš„BUILDæ–‡ä»¶ï¼‰ä¸­å¯ä»¥çœ‹åˆ°systemdå¯¹libpamçš„ä¾èµ–ã€‚\nsystemctléƒ¨åˆ†ç”¨æ³•ï¼š\n\né‡å¯crond\n\nsystemctl restart crond\n\næ˜¾ç¤ºç³»ç»ŸçŠ¶æ€\n\nsystemctl status\nâ— Jian.mooon\nState: degraded\nJobs: 0 queued\nFailed: 2 units\nSince: äºŒ 2017-10-24 02:38:50 CST; 1 years 3 months ago\nCGroup: /\nã€‚ã€‚ã€‚ã€‚ã€‚ã€‚\n\né‡å¯ç³»ç»Ÿ\n\nsystemctl reboot\n\nå…³é—­ç”µæº\n\nsystemctl poweroff\n\nå¾…æœº\n\nsystemctl suspend\n\nä¼‘çœ \n\nsystemctl hibernate\næœ‰å…³systemctlçš„æ›´å¤šä¿¡æ¯ï¼Œå¯æµè§ˆï¼š\nhttps://wiki.archlinux.org/index.php/systemd_(ç®€ä½“ä¸­æ–‡)ã€‚\næ€»ç»“\nä¿®æ”¹limits.confä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼Œé™¤éé‡å¯ç›¸å…³çš„çˆ¶è¿›ç¨‹ï¼Œæ¯”å¦‚crontabçš„crondï¼Œè€Œæœ‰äº›è€ç‰ˆæœ¬çš„Linuxå¯èƒ½åªèƒ½é‡å¯ä»¥ç”Ÿæ•ˆã€‚\n\n\nç³»ç»Ÿå¯åŠ¨ -&gt; å¯åŠ¨åˆå§‹åŒ–è¿›ç¨‹systemd -&gt; è¿›ç¨‹sytemdåŠ è½½libpam.soæ¨¡å—\n\n\nlibpam.soæ ¹æ®/etc/pam.då†³å®šæ˜¯å¦åŠ è½½pam_limits.soç­‰\n\n\nåœ¨åŠ è½½pam_limits.soæ—¶ï¼Œä¼šè¯»å–/etc/security/limits.conf\n\n\né‡å¯crondç­‰ï¼Œå®é™…æ˜¯å‘systemdå‘é‡å¯æŒ‡ä»¤\n\n\nä¸€å¥è¯ï¼šå¦‚æœè¦ä½¿ç”¨limits.confç”Ÿæ•ˆï¼Œä¸€å®šè¦æœ‰åŠ è½½pam_limits.soï¼Œå¦‚æœä¿®æ”¹limits.confï¼Œè‡³å°‘è¦è®©pam_limits.soé‡è¯»limits.confã€‚\né™„1ï¼šèµ„æº\n\n\nPAMå®˜æ–¹\n\n\nhttp://linux-pam.org/\n\nPAMæºä»£ç \n\nhttps://github.com/linux-pam/linux-pam/releases\n\nsystemdæºä»£ç \n\nhttps://github.com/systemd/systemdï¼ˆä½¿ç”¨mesonç¼–è¯‘ï¼ŒMeson is an open source build systemï¼Œä¾èµ–ninjaï¼‰\n\nVixie-cronæºä»£ç \n\nhttp://ftp.isc.org/isc/cron/\nhttps://github.com/svagner/vixie-cron\nftp://ftp.riken.jp/Linux/cern/updates/slc52/SRPMS/repoview/vixie-cron.html\né™„2ï¼šç¼–è¯‘ninja\nninjaç±»ä¼¼äºmakeï¼Œä½¿ç”¨mesonä¹‹å‰å¿…é¡»å…ˆå‡†å¤‡å¥½ninjaã€‚\n\n\nä»https://github.com/ninja-build/ninjaä¸‹è½½ninjaæºä»£ç \n\n\nè§£å‹æºä»£ç åŒ…ï¼Œç„¶åè¿›å…¥è§£å‹åçš„ç›®å½•\n\n\næ‰§è¡Œâ€œ./configure.py --bootstrapâ€\n\n\næˆåŠŸåä¼šåœ¨ç›®å½•ä¸‹ç”Ÿæˆåä¸ºninjaçš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶\n\n\nå°†å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶å¤åˆ¶åˆ°PATHç›®å½•ä¸‹ï¼Œæ¯”å¦‚ï¼š/usr/local/binæˆ–/usr/binç­‰ç›®å½•\n\n\nå®Œæˆã€‚\n\n\né™„3ï¼šä½¿ç”¨mesonç¼–è¯‘systemd\nMeson-0.49.1è¦æ±‚3.5æˆ–æ›´é«˜ç‰ˆæœ¬çš„Pythonï¼ˆhttps://www.python.org/ï¼‰ï¼Œå’Œ1.5æˆ–æ›´é«˜ç‰ˆæœ¬çš„Ninjaï¼Œè¿˜ä¾èµ–gperfï¼ˆç®€å•å®‰è£…ï¼šyum install -y gperfï¼‰ï¼Œè¿˜ä¾èµ–libcap-devï¼ˆæ‰§è¡Œyum install -y libcapå®‰è£…ï¼Œå¦‚æœä»ç„¶ä¸è¡Œï¼Œä»https://git.kernel.org/pub/scm/linux/kernel/git/morgan/libcap.git/ä¸‹è½½æºä»£ç å®‰è£…ï¼‰ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ä¸€äº›å…¶å®ƒçš„ä¾èµ–ï¼Œéœ€é€ä¸ªè§£å†³ã€‚\n\n\nä»https://github.com/mesonbuild/mesonä¸‹è½½mesonæºä»£ç \n\n\nè§£å‹åï¼Œå°†mesonç›®å½•æ·»åŠ åˆ°PATHä¸­ï¼Œæ¯”å¦‚ï¼šexport PATH=/root/X/meson-0.49.1:$PATH\n\n\nè¿›å…¥systemdæºä»£ç ç›®å½•\n\n\næ‰§è¡Œâ€œmeson.py buildâ€ï¼ˆå¦‚æœå‡ºé”™ï¼Œå¯èƒ½æ˜¯Pythonç‰ˆæœ¬ä¸å¤Ÿï¼‰\n\n\næˆåŠŸåä¼šç”Ÿæˆbuildå­ç›®å½•\n\n\nè¿›å…¥buildç›®å½•ï¼Œæ‰§è¡Œninjaå¼€å§‹ç¼–è¯‘ï¼ˆninjaç±»ä¼¼äºmakeï¼‰\n\n\né™„4ï¼šå®‰è£…Python-3.7.2\nPython-3.7.2é‡‡ç”¨automakeç¼–è¯‘ï¼š\n\n\næ‰§è¡Œconfigureç”ŸæˆMakefileæ–‡ä»¶ï¼š./configure --prefix=/usr/local/Python-3.7.2\n\n\næ‰§è¡Œmakeå¼€å§‹ç¼–è¯‘Pythonï¼ˆç¼–è¯‘æ—¶é—´ä¼šæœ‰ç‚¹é•¿ï¼‰\n\n\næ‰§è¡Œmake installï¼Œå®‰è£…Pythonï¼ˆå®‰è£…æ—¶é—´ç¨æœ‰ç‚¹é•¿ï¼‰\n\n\nå°†Pythonçš„binç›®å½•åŠ å…¥åˆ°PATHä¸­ï¼Œå¦‚ï¼šexport PATH=/usr/local/Python-3.7.2/bin:$PATH\n\n\nå¯ä»¥å¼€å§‹ä½¿ç”¨Python-3.7.2äº†ã€‚\n\n\nå¦‚æœé‡åˆ°é”™è¯¯â€œModuleNotFoundError: No module named â€˜_ctypesâ€™â€ï¼Œæ˜¯å› ä¸ºä¾èµ–çš„libffi-develç‰ˆæœ¬ä¸å¤Ÿï¼ˆå¯æ‰§è¡Œâ€œyum install -y libffi-develâ€å®‰è£…libffiï¼Œæˆ–æºç æ–¹å¼å®‰è£…libffiï¼‰ã€‚\né™„5ï¼šå®‰è£…libcap\n\n\nä»https://git.kernel.org/pub/scm/linux/kernel/git/morgan/libcap.git/ä¸‹è½½æºä»£ç åŒ…\n\n\nè§£å‹åè¿›å…¥è§£å‹ç›®å½•\n\n\næ‰§è¡Œmakeç¼–è¯‘\n\n\næ‰§è¡Œmake installå®‰è£…\n\n\nå®Œæˆã€‚\n\n\n\nç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œä¸€è§ã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ª CC 4.0 BY-SA ç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚\nåŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/Aquester/article/details/86694644\n","thumbnail":"/posts/æºç è§£è¯»Linuxçš„limits-confæ–‡ä»¶/linux.png","plink":"https://shuntan.github.io/posts/æºç è§£è¯»Linuxçš„limits-confæ–‡ä»¶/"},{"title":"æ¨¡ç‰ˆå…ƒç¼–ç¨‹åº”ç”¨","date":"2019-06-19T02:34:15.000Z","date_formatted":{"ll":"Jun 19, 2019","L":"06/19/2019","MM-DD":"06-19"},"updated":"2020-04-22T06:48:02.945Z","content":"1.æ¦‚è¿°\nå…³äºC11æ¨¡æ¿å…ƒçš„åŸºæœ¬ç”¨æ³•å’Œå¸¸ç”¨æŠ€å·§ï¼Œåœ¨å¸¸è§„ç¼–ç¨‹ä¸­å¯èƒ½å¾ˆå°‘é‡åˆ°ï¼Œé‚£ä¹ˆC11æ¨¡ç‰ˆå…ƒç¼–ç¨‹ç”¨æ¥è§£å†³ä»€ä¹ˆå®é™…é—®é¢˜å‘¢ï¼Œåœ¨å®é™…å·¥ç¨‹ä¸­åˆè¯¥å¦‚ä½•åº”ç”¨å‘¢ï¼Ÿæœ¬æ–‡å°†ä¾§é‡ä»‹ç»C++11æ¨¡æ¿çš„ä¸€äº›å…·ä½“åº”ç”¨ï¼Œå‘è¯»è€…å±•ç¤ºæ¨¡ç‰ˆå…ƒç¼–ç¨‹çš„å…·ä½“åº”ç”¨ã€‚\n\næˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•é€šè¿‡C++11æ¨¡ç‰ˆå…ƒæ¥å®ç°function_traitsã€Vairantç±»å‹å’Œæ³›å‹bindç»‘å®šå™¨ã€‚function_traitsä¾§é‡äºå¦‚ä½•èƒå–å¯è°ƒç”¨å¯¹è±¡çš„ä¸€äº›å…ƒä¿¡æ¯ï¼ŒVariantåˆ™æ˜¯ä¸€ç§èƒ½æ¥å—å¤šç§ç±»å‹æ•°æ®çš„â€œä¸‡èƒ½â€ç±»å‹ï¼Œbindåˆ™æ˜¯ä¸€ä¸ªæ³›åŒ–çš„ç»‘å®šå™¨ï¼Œä¸‹é¢æ¥çœ‹çœ‹è¿™äº›å…·ä½“çš„ä¾‹å­ã€‚\nç±»å‹èƒå–\nCæ¨¡æ¿ä¸­çš„ç±»å‹å‚æ•°Tæ˜¯æŠ½è±¡çš„ï¼Œæˆ‘ä»¬å¹¶ä¸èƒ½åœ¨æ¨¡æ¿å†…éƒ¨ç›´æ¥è·å¾—å®ƒçš„å…·ä½“ç‰¹å¾ã€‚ç±»å‹èƒå–ï¼ˆæŠ½å–ï¼‰æŠ€æœ¯å°±æ˜¯è¦æŠ½å–ç±»å‹çš„ä¸€äº›å…·ä½“ç‰¹å¾(trait)ï¼Œæ¯”å¦‚å®ƒæ˜¯å“ªç§å…·ä½“ç±»å‹ï¼Œå®ƒæ˜¯å¼•ç”¨ç±»å‹ï¼Œå†…å»ºç±»å‹ï¼Œè¿˜æ˜¯ç±»ç±»å‹ç­‰ã€‚å¯è§ï¼Œç±»å‹èƒå–æŠ€æœ¯å…¶å®å°±æ˜¯traitæ¨¡æ¿æŠ€æœ¯çš„å…·ä½“ä½“ç°ã€‚è·å–ç±»å‹çš„å…·ä½“ç‰¹å¾åœ¨Javaã€C#ç­‰è¯­è¨€ä¸­ä¹Ÿç§°ä¸ºåå°„(reflection)ï¼ŒCä¸­é€šè¿‡æ¨¡æ¿æŠ€æœ¯ä¹Ÿå¯ä»¥å®ç°ä¸€å®šçš„åå°„è¡Œä¸ºã€‚\nã€€ã€€ç±»å‹ä¿¡æ¯æ˜¯ç¼–è¯‘æœŸçš„å®ä½“ï¼Œç°åœ¨è¦é’ˆå¯¹ç±»å‹æ¥è¿›è¡Œç¼–ç¨‹ï¼Œè¿™å…¶å®å°±æ˜¯æ¨¡æ¿å…ƒç¼–ç¨‹çš„ä¸€ä¸ªæ–¹é¢ã€‚æˆ‘ä»¬å¹³å¸¸ä½¿ç”¨çš„if/elseï¼Œwhileï¼Œforç­‰åŸºæœ¬çš„é€»è¾‘ç»“æ„éƒ½æ˜¯è¿è¡ŒæœŸçš„è¡Œä¸ºï¼Œåœ¨é¢å‘ç±»å‹çš„ç¼–ç¨‹ä¸­å¹¶ä¸èƒ½ä½¿ç”¨ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°ä¸€äº›ç‰¹æ®Šçš„æ¨¡æ¿æŠ€æœ¯ã€‚å®ç°ç±»å‹èƒå–è¦ç”¨åˆ°çš„åŸºæœ¬æ€æƒ³ä¸€ä¸ªæ˜¯ç‰¹åŒ–ï¼Œä¸€ä¸ªå°±æ˜¯ç”¨typedefæ¥æºå¸¦ç±»å‹ä¿¡æ¯ã€‚å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨ç”¨æ¨¡æ¿åšè®¾è®¡æ—¶ï¼Œä¸€èˆ¬å»ºè®®åœ¨æ¨¡æ¿å®šä¹‰å†…éƒ¨ï¼Œä¸ºæ¨¡æ¿çš„æ¯ä¸ªç±»å‹å‚æ•°æä¾›typedefå®šä¹‰ï¼Œè¿™æ ·åœ¨æ³›å‹ä»£ç ä¸­å¯ä»¥å¾ˆå®¹æ˜“åœ°è®¿é—®æˆ–æŠ½å–è¿™äº›ç±»å‹ã€‚\nã€€ã€€åœ¨Cå’ŒC++ä¸­ï¼Œæ™®é€šçš„å‡½æ•°å¯ä»¥ç§°ä¸ºå€¼å‡½æ•°ï¼Œå®ƒä»¬æ¥å—çš„å‚æ•°æ˜¯æŸäº›å€¼ï¼Œè¿”å›çš„ç»“æœä¹Ÿæ˜¯å€¼ã€‚è€Œæ‰€è°“çš„ç±»å‹å‡½æ•°æ¥å—çš„å®å‚æ˜¯ç±»å‹ï¼Œè¿”å›çš„æ˜¯è¢«æŠ½å–å‡ºæ¥çš„ç±»å‹æˆ–å¸¸é‡å€¼ç­‰ï¼ˆå³ç”¨typedefå®šä¹‰çš„ç±»å‹åˆ«åï¼Œä¸€èˆ¬ä¸åŒçš„å…·ä½“ç±»å‹éƒ½å®šä¹‰ç»Ÿä¸€çš„åˆ«åï¼‰ã€‚å¦‚ç±»æ¨¡æ¿å°±æ˜¯ç±»å‹å‡½æ•°ï¼Œsizeofæ˜¯å†…å»ºçš„ç±»å‹å‡½æ•°ï¼Œè¿”å›ç»™å®šç±»å‹å®å‚çš„å¤§å°ã€‚åœ¨ç±»å‹ç¼–ç¨‹ä¸­ï¼Œå¾ˆå¤šåœ°æ–¹éƒ½è¦ç”¨åˆ°sizeofã€‚\n//ä¸‹é¢æ¼”ç¤ºä¸€äº›æœ‰ç”¨çš„ç±»å‹èƒå–å®ç°ï¼Œè¿™äº›éƒ½æ˜¯ç±»å‹å‡½æ•°ã€‚\n2.function_traits\nfunction_traitsç”¨æ¥è·å–å‡½æ•°è¯­ä¹‰çš„å¯è°ƒç”¨å¯¹è±¡çš„ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚å‡½æ•°ç±»å‹ã€è¿”å›ç±»å‹ã€å‡½æ•°æŒ‡é’ˆç±»å‹å’Œå‚æ•°ç±»å‹ç­‰ã€‚ä¸‹é¢æ¥çœ‹çœ‹å¦‚ä½•å®ç°function_traitsã€‚\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#include &lt;iostream&gt;#include &lt;functional&gt;template&lt;typename T&gt;struct function_traits;//æ™®é€šå‡½æ•°èƒå–template&lt;typename Ret, typename... Args&gt;struct function_traits&lt;Ret(Args...)&gt;&#123;public:    enum &#123; arity = sizeof...(Args) &#125;;    typedef Ret function_type(Args...);    typedef Ret return_type;    using stl_function_type = std::function&lt;function_type&gt;;    typedef Ret(*pointer)(Args...);    template&lt;size_t I&gt;    struct args    &#123;        static_assert(I &lt; arity, \"index is out of range, index must less than sizeof Args\");        using type = typename std::tuple_element&lt;I, std::tuple&lt;Args...&gt;&gt;::type;    &#125;;&#125;;//ç±»å‡½æ•°èƒå–template&lt;typename Ret, typename Class, typename... Args&gt;struct function_traits&lt;Ret(Class::*) (Args...)&gt;&#123;public:    enum &#123; arity = sizeof...(Args) &#125;;    typedef Ret function_type(Args...);    typedef Ret return_type;    using stl_function_type = std::function&lt;function_type&gt;;    typedef Ret(Class::* pointer)(Args...);    typedef Class class_type;    template&lt;size_t I&gt;    struct args    &#123;        static_assert(I &lt; arity, \"index is out of range, index must less than sizeof Args\");        using type = typename std::tuple_element&lt;I, std::tuple&lt;Args...&gt;&gt;::type;    &#125;;&#125;;//å‡½æ•°æŒ‡é’ˆtemplate&lt;typename Ret, typename... Args&gt;struct function_traits&lt;Ret(*)(Args...)&gt; : function_traits&lt;Ret(Args...)&gt; &#123;&#125;;//std::functiontemplate &lt;typename Ret, typename... Args&gt;struct function_traits&lt;std::function&lt;Ret(Args...)&gt;&gt; : function_traits&lt;Ret(Args...)&gt; &#123;&#125;;//member functiontemplate &lt;typename ReturnType, typename ClassType, typename... Args&gt;struct function_traits&lt;ReturnType(ClassType::*)(Args...) const&gt; : function_traits&lt;ReturnType(ClassType::*)(Args...)&gt; &#123;&#125;;//å‡½æ•°å¯¹è±¡template&lt;typename Callable&gt;struct function_traits : function_traits&lt;decltype(&amp;Callable::operator())&gt; &#123;&#125;;\nç”±äºå¯è°ƒç”¨å¯¹è±¡å¯èƒ½æ˜¯æ™®é€šçš„å‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€lambdaã€std::functionå’Œæˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é’ˆå¯¹è¿™äº›ç±»å‹åˆ†åˆ«åšåç‰¹åŒ–ï¼Œç„¶åèƒå–å‡ºå¯è°ƒç”¨å¯¹è±¡çš„å…ƒä¿¡æ¯ã€‚å…¶ä¸­ï¼Œæˆå‘˜å‡½æ•°çš„åç‰¹åŒ–ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œå› ä¸ºæ¶‰åŠåˆ°cvç¬¦çš„å¤„ç†ï¼Œè¿™é‡Œé€šè¿‡å®šä¹‰ä¸€ä¸ªå®æ¥æ¶ˆé™¤é‡å¤çš„æ¨¡æ¿ç±»å®šä¹‰ã€‚å‚æ•°ç±»å‹çš„è·å–æˆ‘ä»¬æ˜¯å€ŸåŠ©äºtupleï¼Œå°†å‚æ•°è½¬æ¢ä¸ºtupleç±»å‹ï¼Œç„¶åæ ¹æ®ç´¢å¼•æ¥è·å–å¯¹åº”ç±»å‹ã€‚å®ƒçš„ç”¨æ³•æ¯”è¾ƒç®€å•ï¼š\n1234567891011121314151617181920212223242526272829303132333435363738394041424344//ç±»å‡½æ•°struct S&#123;    inline void fun(const char*) &#123;&#125;;&#125;;//æ™®é€šå‡½æ•°double fun() &#123; return 0.1; &#125;;template&lt;typename T&gt;void PrintType()&#123;    std::cout &lt;&lt; typeid(T).name() &lt;&lt; std::endl;&#125;int main()&#123;\t\tvoid (S::* cfptr)(const char*) = &amp;S::fun; // class fnptr    double (*fptr)() = fun; //fnptr    std::function&lt;int(int)&gt; f = [](int a) &#123;return a; &#125;;  //function    auto lambda = [](int a) &#123;return a; &#125;; // lambda    //æ‰“å°å‡½æ•°ç±»å‹    PrintType&lt;function_traits&lt;decltype(fptr)&gt;::function_type&gt;(); //å°†è¾“å‡ºdouble __cdecl&lt;void&gt;      //æ‰“å°ç±»å‡½æ•°æŒ‡é’ˆç±»å‹    PrintType&lt;function_traits&lt;decltype(&amp;cfptr)&gt;::pointer&gt;(); //å°†è¾“å‡ºvoid &lt;__thiscall S::*&gt;&lt;char const *&gt;    //æ‰“å°å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹    PrintType&lt;function_traits&lt;std::function&lt;int(bool)&gt;&gt;::args&lt;0&gt;::type&gt;();//å°†è¾“å‡ºbool    //æ‰“å°å‡½æ•°çš„è¿”å›ç±»å‹    PrintType&lt;function_traits&lt;decltype(f)&gt;::return_type&gt;(); //å°†è¾“å‡ºint    //æ‰“å°å‡½æ•°æŒ‡é’ˆç±»å‹    PrintType&lt;function_traits&lt;decltype(f)&gt;::pointer&gt;(); //å°†è¾“å‡ºint &lt;__cdecl*&gt;&lt;int&gt;    //æ‰“å°functionå‡½æ•°ç±»å‹    PrintType&lt;function_traits&lt;decltype(f)&gt;::stl_function_type&gt;(); //å°†è¾“å‡ºclass std::function&lt;int __cdecl&lt;int&gt;&gt;    //lambda =&gt; éšå¼è½¬åŒ–ä¸ºäº†åŒ¿åç±»å¯¹è±¡    PrintType&lt;function_traits&lt;decltype(lambda)&gt;::class_type&gt;(); //å°†è¾“å‡ºclass &lt;lambda_13vr3tgewf32rt23rfgt435g41239da&gt;&#125;\ngun gccä¸‹ï¼š\n1234567FdvEbiPFiiESt8functionIFiiEEZ4mainEUliE0_M1SFvPKcE\nVisual studioä¸‹ï¼š\n1234567double __cdecl(void)void (__thiscall S::*)(char const *)boolintint (__cdecl*)(int)class std::function&lt;int __cdecl(int)&gt;class &lt;lambda_173ed6f42b6e4df55bf9ec2e4778d93a&gt;\nå…¶å®ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥å‚è€ƒè¿™é‡Œ\nå¯ä»¥çœ‹åˆ°è¿™ä¸ªfunction_traitsé€šè¿‡ç±»å‹èƒå–ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è·å–å¯è°ƒç”¨å¯¹è±¡ï¼ˆå‡½æ•°ã€å‡½æ•°æŒ‡é’ˆã€å‡½æ•°å¯¹è±¡ã€std::functionå’Œlambdaè¡¨è¾¾å¼ï¼‰çš„ä¸€äº›å…ƒä¿¡æ¯ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œè¿™ä¸ªfunction_traitsç»å¸¸ä¼šç”¨åˆ°æ˜¯æ›´é«˜å±‚æ¨¡ç‰ˆå…ƒç¨‹åºçš„åŸºç¡€ã€‚æ¯”å¦‚Variantç±»å‹çš„å®ç°å°±è¦ç”¨åˆ°è¿™ä¸ªfunction_traitsï¼Œä¸‹é¢æ¥çœ‹çœ‹Variantçš„å®ç°ã€‚\n3.Variant\nå€ŸåŠ©ä¸Šé¢çš„function_traitså’Œå‰æ–‡å®ç°çš„ä¸€äº›å…ƒå‡½æ•°ï¼Œæˆ‘ä»¬å°±èƒ½æ–¹ä¾¿çš„å®ç°ä¸€ä¸ªâ€œä¸‡èƒ½ç±»å‹â€â€”Variantï¼ŒVariantå®é™…ä¸Šä¸€ä¸ªæ³›åŒ–çš„ç±»å‹ï¼Œè¿™ä¸ªVariantå’Œboost.variantçš„ç”¨æ³•ç±»ä¼¼ï¼Œéœ€è¦é¢„å®šä¹‰ä¸€äº›ç±»å‹ä½œä¸ºå¯æ¥å—çš„ç±»å‹ã€‚boost.variantçš„åŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š\n1234typedef variant&lt;int,char, double&gt; vt;vt v = 1;v = 'a';v = 12.32;\nè¿™ä¸ªvariantå¯ä»¥æ¥å—å·²ç»å®šä¹‰çš„é‚£äº›ç±»å‹ï¼Œçœ‹èµ·æ¥æœ‰ç‚¹ç±»ä¼¼äºc#å’Œjavaä¸­çš„objectç±»å‹ï¼Œå®é™…ä¸Švariantæ˜¯æ“¦é™¤äº†ç±»å‹ï¼Œè¦è·å–å®ƒçš„å®é™…ç±»å‹çš„æ—¶å€™å°±ç¨æ˜¾éº»çƒ¦ï¼Œéœ€è¦é€šè¿‡boost.visitoræ¥è®¿é—®ï¼š\n12345678910111213141516171819202122232425struct VariantVisitor : public boost::static_visitor&lt;void&gt;&#123;    void operator() (int a)    &#123;        cout &lt;&lt; \"int\" &lt;&lt; endl;    &#125;    void operator() (short val)    &#123;        cout &lt;&lt; \"short\" &lt;&lt; endl;    &#125;    void operator() (double val)    &#123;        cout &lt;&lt; \"double\" &lt;&lt; endl;    &#125;    void operator() (std::string val)    &#123;        cout &lt;&lt; \"string\" &lt;&lt; endl;    &#125;&#125;;boost::variant&lt;int,short,double,std::string&gt; v = 1;boost::apply_visitor(visitor, v); //å°†è¾“å‡ºint\nâ€‹\tã€€é€šè¿‡C++11æ¨¡ç‰ˆå…ƒå®ç°çš„Variantå°†æ”¹è¿›å€¼çš„è·å–ï¼Œå°†è·å–å®é™…å€¼çš„æ–¹å¼æ”¹ä¸ºå†…ç½®çš„ï¼Œå³é€šè¿‡ä¸‹é¢çš„æ–¹å¼æ¥è®¿é—®ï¼š\n123typedef Variant&lt;int, double, string, int&gt; cv;cv v = 10;v.Visit([&amp;](double i)&#123;cout &lt;&lt; i &lt;&lt; endl; &#125;, [](short i)&#123;cout &lt;&lt; i &lt;&lt; endl; &#125;, [=](int i)&#123;cout &lt;&lt; i &lt;&lt; endl; &#125;,[](const string&amp; i)&#123;cout &lt;&lt; i &lt;&lt; endl; &#125;);//ç»“æœå°†è¾“å‡º10\nè¿™ç§æ–¹å¼æ›´æ–¹ä¾¿ç›´è§‚ã€‚Variantçš„å®ç°éœ€è¦å€ŸåŠ©å‰æ–‡ä¸­å®ç°çš„ä¸€äº›å…ƒå‡½æ•°MaxIntegerã€MaxAlignã€Containså’ŒAtç­‰ç­‰ã€‚å¯ä»¥åœ¨ä¸‹é¢çš„tabä¸­å±•å¼€è§‚çœ‹ï¼Œä¸‹é¢æ¥çœ‹çœ‹Variantå®ç°çš„å…³é”®ä»£ç ã€‚\nIntegerMaxä»£ç ï¼š\n1234567891011121314/** è·å–æ•´æ•°åˆ—è¡¨ä¸­æœ€å¤§çš„æ•´æ•° */template &lt;std::size_t arg, std::size_t... rest&gt;struct IntegerMax;template &lt;std::size_t arg&gt;struct IntegerMax&lt;arg&gt; : std::integral_constant&lt;std::size_t, arg&gt;&#123;&#125;;template &lt;std::size_t arg1, std::size_t arg2, std::size_t... rest&gt;struct IntegerMax&lt;arg1, arg2, rest...&gt; : std::integral_constant&lt;std::size_t, arg1 &gt;= arg2 ? IntegerMax&lt;arg1, rest...&gt;::value    : IntegerMax&lt;arg2, rest...&gt;::value&gt;&#123;&#125;;\nMaxAlignä»£ç ï¼š\n12345/** è·å–æœ€å¤§çš„align */template&lt;typename... Args&gt;struct MaxAlign : std::integral_constant&lt;int, IntegerMax&lt;std::alignment_of&lt;Args&gt;::value...&gt;::value&gt;&#123;&#125;;\nContainsä»£ç ï¼š\n1234567891011121314/** æ˜¯å¦åŒ…å«æŸä¸ªç±»å‹ */template &lt;typename T, typename... List&gt;struct Contains;template &lt;typename T, typename Head, typename... Rest&gt;struct Contains&lt;T, Head, Rest...&gt;    : std::conditional&lt;std::is_same&lt;T, Head&gt;::value, std::true_type, Contains&lt;T, Rest... &gt;&gt; ::type&#123;&#125;;template &lt;typename T&gt;struct Contains&lt;T&gt; : std::false_type&#123;&#125;;\nIndexOfä»£ç ï¼š\n1234567891011121314151617181920template &lt;typename T, typename... List&gt;struct IndexOf;template &lt;typename T, typename Head, typename... Rest&gt;struct IndexOf&lt;T, Head, Rest...&gt;&#123;    enum &#123; value = IndexOf&lt;T, Rest...&gt;::value + 1 &#125;;&#125;;template &lt;typename T, typename... Rest&gt;struct IndexOf&lt;T, T, Rest...&gt;&#123;    enum &#123; value = 0 &#125;;&#125;;template &lt;typename T&gt;struct IndexOf&lt;T&gt;&#123;    enum&#123;value = -1&#125;;&#125;;\nAtä»£ç ï¼š\n1234567891011121314template&lt;int index, typename... Types&gt;struct At;template&lt;int index, typename First, typename... Types&gt;struct At&lt;index, First, Types...&gt;&#123;    using type = typename At&lt;index - 1, Types...&gt;::type;&#125;;template&lt;typename T, typename... Types&gt;struct At&lt;0, T, Types...&gt;&#123;    using type = T;&#125;;\nVariantå…³é”®ä»£ç ï¼š\n12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697template&lt;typename... Types&gt;class Variant&#123;    enum&#123;        data_size = IntegerMax&lt;sizeof(Types)...&gt;::value, //å‚æ•°ä¸ªæ•°        align_size = MaxAlign&lt;Types...&gt;::value\t//å‚æ•°æœ€å¤§å­—èŠ‚æ•°    &#125;;    using data_t = typename std::aligned_storage&lt;data_size, align_size&gt;::type;public:    template&lt;int index&gt;    using IndexType = typename At&lt;index, Types...&gt;::type;    Variant(void) :m_typeIndex(typeid(void))&#123;&#125;    ~Variant()&#123; Destroy(m_typeIndex, &amp;m_data); &#125;    Variant(Variant&lt;Types...&gt;&amp;&amp; old) : m_typeIndex(old.m_typeIndex)&#123;        Move(old.m_typeIndex, &amp;old.m_data, &amp;m_data);    &#125;    Variant(const Variant&lt;Types...&gt;&amp; old) : m_typeIndex(old.m_typeIndex)&#123;        Copy(old.m_typeIndex, &amp;old.m_data, &amp;m_data);    &#125;    template &lt;class T,    class = typename std::enable_if&lt;Contains&lt;typename std::remove_reference&lt;T&gt;::type, Types...&gt;::value&gt;::type&gt; Variant(T&amp;&amp; value) : m_typeIndex(typeid(void))&#123;            Destroy(m_typeIndex, &amp;m_data);            typedef typename std::remove_reference&lt;T&gt;::type U;            new(&amp;m_data) U(std::forward&lt;T&gt;(value));            m_typeIndex = type_index(typeid(U));    &#125;    template&lt;typename T&gt;    bool Is() const&#123;        return (m_typeIndex == type_index(typeid(T)));    &#125;    template&lt;typename T&gt;    typename std::decay&lt;T&gt;::type&amp; Get()&#123;        using U = typename std::decay&lt;T&gt;::type;        if (!Is&lt;U&gt;())        &#123;            cout &lt;&lt; typeid(U).name() &lt;&lt; \" is not defined. \" &lt;&lt; \"current type is \" &lt;&lt;                m_typeIndex.name() &lt;&lt; endl;            throw std::bad_cast();        &#125;        return *(U*)(&amp;m_data);    &#125;    template&lt;typename F&gt;    void Visit(F&amp;&amp; f)&#123;        using T = typename Function_Traits&lt;F&gt;::template arg&lt;0&gt;::type;        if (Is&lt;T&gt;())            f(Get&lt;T&gt;());    &#125;    template&lt;typename F, typename... Rest&gt;    void Visit(F&amp;&amp; f, Rest&amp;&amp;... rest)&#123;        using T = typename Function_Traits&lt;F&gt;::template arg&lt;0&gt;::type;        if (Is&lt;T&gt;())            Visit(std::forward&lt;F&gt;(f));        else            Visit(std::forward&lt;Rest&gt;(rest)...);    &#125;private:    void Destroy(const type_index&amp; index, void * buf)&#123;        std::initializer_list&lt;int&gt;&#123;(Destroy0&lt;Types&gt;(index, buf), 0)...&#125;;    &#125;    template&lt;typename T&gt;    void Destroy0(const type_index&amp; id, void* data)&#123;        if (id == type_index(typeid(T)))            reinterpret_cast&lt;T*&gt;(data)-&gt;~T();    &#125;    void Move(const type_index&amp; old_t, void* old_v, void* new_v) &#123;        std::initializer_list&lt;int&gt;&#123;(Move0&lt;Types&gt;(old_t, old_v, new_v), 0)...&#125;;    &#125;    template&lt;typename T&gt;    void Move0(const type_index&amp; old_t, void* old_v, void* new_v)&#123;        if (old_t == type_index(typeid(T)))            new (new_v)T(std::move(*reinterpret_cast&lt;T*&gt;(old_v)));    &#125;    void Copy(const type_index&amp; old_t, void* old_v, void* new_v)&#123;        std::initializer_list&lt;int&gt;&#123;(Copy0&lt;Types&gt;(old_t, old_v, new_v), 0)...&#125;;    &#125;    template&lt;typename T&gt;    void Copy0(const type_index&amp; old_t, void* old_v, void* new_v)&#123;        if (old_t == type_index(typeid(T)))            new (new_v)T(*reinterpret_cast&lt;const T*&gt;(old_v));    &#125;private:    data_t m_data;    std::type_index m_typeIndex;//ç±»å‹ID&#125;;\nå®ç°Varianté¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªè¶³å¤Ÿå¤§çš„ç¼“å†²åŒºç”¨æ¥å­˜æ”¾ä¸åŒçš„ç±»å‹çš„å€¼ï¼Œè¿™ä¸ªç¼“ç±»å‹å†²åŒºå®é™…ä¸Šå°±æ˜¯ç”¨æ¥æ“¦é™¤ç±»å‹ï¼Œä¸åŒçš„ç±»å‹éƒ½é€šè¿‡placement newåœ¨è¿™ä¸ªç¼“å†²åŒºä¸Šåˆ›å»ºå¯¹è±¡ï¼Œå› ä¸ºç±»å‹é•¿åº¦ä¸åŒï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘å†…å­˜å¯¹é½ï¼ŒC++11åˆšå¥½æä¾›äº†å†…å­˜å¯¹é½çš„ç¼“å†²åŒºaligned_storageï¼š\n12template&lt; std::size_t Len, std::size_t Align = /*default-alignment*/ &gt;struct aligned_storage;\nå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç¼“å†²åŒºçš„é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç¼“å†²åŒºå†…å­˜å¯¹é½çš„å¤§å°ï¼Œç”±äºVaraintå¯ä»¥æ¥å—å¤šç§ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·å–æœ€å¤§çš„ç±»å‹é•¿åº¦ï¼Œä¿è¯ç¼“å†²åŒºè¶³å¤Ÿå¤§ï¼Œç„¶åè¿˜è¦è·å–æœ€å¤§çš„å†…å­˜å¯¹é½å¤§å°ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡å‰é¢å®ç°çš„MaxIntegerå’ŒMaxAlignå°±å¯ä»¥äº†ï¼ŒVaraintä¸­å†…å­˜å¯¹é½çš„ç¼“å†²åŒºå®šä¹‰å¦‚ä¸‹ï¼š\n1234567enum&#123;        data_size = IntegerMax&lt;sizeof(Types)...&gt;::value,        align_size = MaxAlign&lt;Types...&gt;::value&#125;;using data_t = typename std::aligned_storage&lt;data_size, align_size&gt;::type; //å†…å­˜å¯¹é½çš„ç¼“å†²åŒºç±»å‹\nå…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜è¦å®ç°å¯¹ç¼“å†²åŒºçš„æ„é€ ã€æ‹·è´ã€ææ„å’Œç§»åŠ¨ï¼Œå› ä¸ºVarianté‡æ–°èµ‹å€¼çš„æ—¶å€™éœ€è¦å°†ç¼“å†²åŒºä¸­åŸæ¥çš„ç±»å‹ææ„æ‰ï¼Œæ‹·è´æ„é€ å’Œç§»åŠ¨æ„é€ æ—¶åˆ™éœ€è¦æ‹·è´å’Œç§»åŠ¨ã€‚è¿™é‡Œä»¥ææ„ä¸ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®å½“å‰çš„type_indexæ¥éå†Variantçš„æ‰€æœ‰ç±»å‹ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç±»å‹ç„¶åè°ƒç”¨è¯¥ç±»å‹çš„ææ„å‡½æ•°ã€‚\n123456789101112ã€€ã€€ void Destroy(const type_index&amp; index, void * buf)&#123;    std::initializer_list&lt;int&gt;&#123;(Destroy0&lt;Types&gt;(index, buf), 0)...&#125;; //è¿™é‡Œé€šè¿‡ä¸€ä¸ªåˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ–ä¸€ä¸ªå˜é•¿æ•°ç»„ï¼Œintæ•°ç»„çš„ç›®çš„å°±æ˜¯ä¸ºäº†åœ¨æ•°ç»„æ„é€ çš„è¿‡ç¨‹å±•å¼€å‚æ•°åŒ…&#125;template&lt;typename T&gt;void Destroy0(const type_index&amp; id, void* data)&#123;    if (id == type_index(typeid(T)))        reinterpret_cast&lt;T*&gt;(data)-&gt;~T();&#125;\nè¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨å’Œé€—å·è¡¨è¾¾å¼æ¥å±•å¼€å¯å˜æ¨¡æ¿å‚æ•°ï¼Œåœ¨å±•å¼€çš„è¿‡ç¨‹ä¸­æŸ¥æ‰¾å¯¹åº”çš„ç±»å‹ï¼Œå¦‚æœæ‰¾åˆ°äº†åˆ™ææ„ã€‚åœ¨Variantæ„é€ æ—¶è¿˜éœ€è¦æ³¨æ„ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼ŒVariantä¸èƒ½æ¥å—æ²¡æœ‰é¢„å…ˆå®šä¹‰çš„ç±»å‹ï¼Œæ‰€ä»¥åœ¨æ„é€ Variantæ—¶ï¼Œéœ€è¦é™å®šç±»å‹å¿…é¡»åœ¨é¢„å®šä¹‰çš„ç±»å‹èŒƒå›´å½“ä¸­ï¼Œè¿™é‡Œé€šè¿‡type_traitsçš„enable_ifæ¥é™å®šæ¨¡æ¿å‚æ•°çš„ç±»å‹ã€‚\n1234567template &lt;class T,    class = typename std::enable_if&lt;Contains&lt;typename std::remove_reference&lt;T&gt;::type, Types...&gt;::value&gt;::type&gt; Variant(T&amp;&amp; value) : m_typeIndex(typeid(void))&#123;            Destroy(m_typeIndex, &amp;m_data);            typedef typename std::remove_reference&lt;T&gt;::type U;            new(&amp;m_data) U(std::forward&lt;T&gt;(value));            m_typeIndex = type_index(typeid(U));    &#125;\nè¿™é‡Œenbale_ifçš„æ¡ä»¶å°±æ˜¯å‰é¢å®ç°çš„å…ƒå‡½æ•°Containsçš„å€¼ï¼Œå½“æ²¡æœ‰åœ¨é¢„å®šä¹‰çš„ç±»å‹ä¸­æ‰¾åˆ°å¯¹åº”çš„ç±»å‹æ—¶ï¼Œå³Containsè¿”å›falseæ—¶ï¼Œç¼–è¯‘æœŸä¼šæŠ¥ä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚\næœ€åè¿˜éœ€è¦å®ç°å†…ç½®çš„VistitåŠŸèƒ½ï¼ŒVisitçš„å®ç°éœ€è¦å…ˆé€šè¿‡å®šä¹‰ä¸€ç³»åˆ—çš„è®¿é—®å‡½æ•°ï¼Œç„¶åå†éå†è¿™äº›å‡½æ•°ï¼Œéå†è¿‡ç¨‹ä¸­ï¼Œåˆ¤æ–­å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ç±»å‹çš„type_indexæ˜¯å¦ä¸å½“å‰çš„type_indexç›¸åŒï¼Œå¦‚æœç›¸åŒåˆ™è·å–å½“å‰ç±»å‹çš„å€¼ã€‚\n123456789101112131415template&lt;typename F&gt;    void Visit(F&amp;&amp; f)&#123;        using T = typename Function_Traits&lt;F&gt;::template arg&lt;0&gt;::type;        if (Is&lt;T&gt;())            f(Get&lt;T&gt;());    &#125;    template&lt;typename F, typename... Rest&gt;    void Visit(F&amp;&amp; f, Rest&amp;&amp;... rest)&#123;        using T = typename Function_Traits&lt;F&gt;::template arg&lt;0&gt;::type;        if (Is&lt;T&gt;())            Visit(std::forward&lt;F&gt;(f));        else            Visit(std::forward&lt;Rest&gt;(rest)...);    &#125;\nVisitåŠŸèƒ½çš„å®ç°åˆ©ç”¨äº†å¯å˜æ¨¡æ¿å‚æ•°å’Œfunction_traitsï¼Œé€šè¿‡å¯å˜æ¨¡æ¿å‚æ•°æ¥éå†ä¸€ç³»åˆ—çš„è®¿é—®å‡½æ•°ï¼Œéå†è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡function_traitsæ¥è·å–ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹ï¼Œå’ŒVariantå½“å‰çš„type_indexç›¸åŒæ—¶åˆ™å–å€¼ã€‚ä¸ºä»€ä¹ˆè¦è·å–è®¿é—®å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹å‘¢ï¼Ÿå› ä¸ºVariantçš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œåªæœ‰ä¸€ä¸ªå€¼ï¼Œæ‰€ä»¥è·å–çš„è®¿é—®å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹å°±æ˜¯Variantä¸­å­˜å‚¨çš„å¯¹è±¡çš„å®é™…ç±»å‹ã€‚\næœªå®Œå¾…ç»­ã€‚ã€‚ã€‚\n","thumbnail":"/posts/æ¨¡ç‰ˆå…ƒç¼–ç¨‹åº”ç”¨/templeteMeta.png","plink":"https://shuntan.github.io/posts/æ¨¡ç‰ˆå…ƒç¼–ç¨‹åº”ç”¨/"},{"title":"C++ä¸­ä¼˜é›…çš„å¼‚æ­¥æ“ä½œ","date":"2019-06-14T06:21:26.000Z","date_formatted":{"ll":"Jun 14, 2019","L":"06/14/2019","MM-DD":"06-14"},"updated":"2020-04-22T06:56:23.983Z","content":"c++11ä¸­å¢åŠ äº†çº¿ç¨‹ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿çš„åˆ›å»ºçº¿ç¨‹ï¼Œå®ƒçš„åŸºæœ¬ç”¨æ³•æ˜¯è¿™æ ·çš„ï¼š\n123void f(int n);std::thread t(f, n + 1);t.join();\nã€€ã€€\nâ€‹\t\tä½†æ˜¯çº¿ç¨‹æ¯•ç«Ÿæ˜¯å±äºæ¯”è¾ƒä½å±‚æ¬¡çš„ä¸œè¥¿ï¼Œæœ‰æ—¶å€™ä½¿ç”¨æœ‰äº›ä¸ä¾¿ï¼Œæ¯”å¦‚æˆ‘å¸Œæœ›è·å–çº¿ç¨‹å‡½æ•°çš„è¿”å›ç»“æœçš„æ—¶å€™ï¼Œæˆ‘å°±ä¸èƒ½ç›´æ¥é€šè¿‡thread.join()å¾—åˆ°ç»“æœï¼Œè¿™æ—¶å°±å¿…é¡»å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œåœ¨çº¿ç¨‹å‡½æ•°ä¸­å»ç»™è¿™ä¸ªå˜é‡èµ‹å€¼ï¼Œç„¶åjoin,æœ€åå¾—åˆ°ç»“æœï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¯”è¾ƒç¹ççš„ã€‚c++11è¿˜æä¾›äº†å¼‚æ­¥æ¥å£std::asyncï¼Œé€šè¿‡è¿™ä¸ªå¼‚æ­¥æ¥å£å¯ä»¥å¾ˆæ–¹ä¾¿çš„è·å–çº¿ç¨‹å‡½æ•°çš„æ‰§è¡Œç»“æœã€‚std::asyncä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»è°ƒç”¨çº¿ç¨‹å‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªstd::futureï¼Œè¿™ä¸ªfutureä¸­å­˜å‚¨äº†çº¿ç¨‹å‡½æ•°è¿”å›çš„ç»“æœï¼Œå½“æˆ‘ä»¬éœ€è¦çº¿ç¨‹å‡½æ•°çš„ç»“æœæ—¶ï¼Œç›´æ¥ä»futureä¸­è·å–ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä½†æ˜¯æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œå…¶å®std::asyncç»™æˆ‘ä»¬æä¾›çš„ä¾¿åˆ©å¯ä¸ä»…ä»…æ˜¯è¿™ä¸€ç‚¹ï¼Œå®ƒé¦–å…ˆè§£è€¦äº†çº¿ç¨‹çš„åˆ›å»ºå’Œæ‰§è¡Œï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™è·å–å¼‚æ­¥æ“ä½œçš„ç»“æœï¼›å…¶æ¬¡å®ƒè¿˜æä¾›äº†çº¿ç¨‹çš„åˆ›å»ºç­–ç•¥ï¼ˆæ¯”å¦‚å¯ä»¥é€šè¿‡å»¶è¿ŸåŠ è½½çš„æ–¹å¼å»åˆ›å»ºçº¿ç¨‹ï¼‰ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä»¥å¤šç§æ–¹å¼å»åˆ›å»ºçº¿ç¨‹ã€‚åœ¨ä»‹ç»asyncå…·ä½“ç”¨æ³•ä»¥åŠä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»ºä¹‹å‰ï¼Œæˆ‘æƒ³å…ˆè¯´ä¸€è¯´std::futureã€std::promiseå’Œstd::packaged_taskã€‚\nstd::futur\nstd::futureæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨ä¹Ÿå¾ˆæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œç®€å•è¯´std::futureæä¾›äº†ä¸€ç§è®¿é—®å¼‚æ­¥æ“ä½œç»“æœçš„æœºåˆ¶ã€‚ä»å­—é¢æ„æ€æ¥ç†è§£ï¼Œå®ƒè¡¨ç¤ºæœªæ¥ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªåå­—éå¸¸è´´åˆ‡ï¼Œå› ä¸ºä¸€ä¸ªå¼‚æ­¥æ“ä½œæˆ‘ä»¬æ˜¯ä¸å¯èƒ½é©¬ä¸Šå°±è·å–æ“ä½œç»“æœçš„ï¼Œåªèƒ½åœ¨æœªæ¥æŸä¸ªæ—¶å€™è·å–ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä»¥åŒæ­¥ç­‰å¾…çš„æ–¹å¼æ¥è·å–ç»“æœï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢futureçš„çŠ¶æ€ï¼ˆfuture_statusï¼‰æ¥è·å–å¼‚æ­¥æ“ä½œçš„ç»“æœã€‚future_statusæœ‰ä¸‰ç§çŠ¶æ€ï¼š\n\ndeferredï¼šå¼‚æ­¥æ“ä½œè¿˜æ²¡å¼€å§‹\nreadyï¼šå¼‚æ­¥æ“ä½œå·²ç»å®Œæˆ\ntimeoutï¼šå¼‚æ­¥æ“ä½œè¶…æ—¶\n\n123456789101112//æŸ¥è¯¢futureçš„çŠ¶æ€std::future_status status;    do &#123;        status = future.wait_for(std::chrono::seconds(1));        if (status == std::future_status::deferred) &#123;            std::cout &lt;&lt; \"deferred\\n\"; //ä»£è¡¨å»¶è¿Ÿæ‰§è¡Œ        &#125; else if (status == std::future_status::timeout) &#123;            std::cout &lt;&lt; \"timeout\\n\";  //ä»£è¡¨æ‰§è¡Œä¸­        &#125; else if (status == std::future_status::ready) &#123;            std::cout &lt;&lt; \"ready!\\n\";   //ä»£è¡¨å·²ç»æ‰§è¡Œå®Œæˆ        &#125;    &#125; while (status != std::future_status::ready);\nè·å–futureç»“æœæœ‰ä¸‰ç§æ–¹å¼ï¼šgetã€waitã€wait_forï¼Œå…¶ä¸­getç­‰å¾…å¼‚æ­¥æ“ä½œç»“æŸå¹¶è¿”å›ç»“æœï¼Œwaitåªæ˜¯ç­‰å¾…å¼‚æ­¥æ“ä½œå®Œæˆï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œwait_foræ˜¯è¶…æ—¶ç­‰å¾…è¿”å›ç»“æœã€‚\nstd::promise\nstd::promiseä¸ºè·å–çº¿ç¨‹å‡½æ•°ä¸­çš„æŸä¸ªå€¼æä¾›ä¾¿åˆ©ï¼Œåœ¨çº¿ç¨‹å‡½æ•°ä¸­ç»™å¤–é¢ä¼ è¿›æ¥çš„promiseèµ‹å€¼ï¼Œå½“çº¿ç¨‹å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åå°±å¯ä»¥é€šè¿‡promisè·å–è¯¥å€¼äº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å–å€¼æ˜¯é—´æ¥çš„é€šè¿‡promiseå†…éƒ¨æä¾›çš„futureæ¥è·å–çš„ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼š\n1234std::promise&lt;int&gt; pr;std::thread t([](std::promise&lt;int&gt;&amp; p)&#123; p.set_value_at_thread_exit(9); &#125;,std::ref(pr));std::future&lt;int&gt; f = pr.get_future();auto r = f.get();\nstd::packaged_task\nstd::packaged_taskå®ƒåŒ…è£…äº†ä¸€ä¸ªå¯è°ƒç”¨çš„ç›®æ ‡ï¼ˆå¦‚function, lambda expression, bind expression, or another function objectï¼‰,ä»¥ä¾¿å¼‚æ­¥è°ƒç”¨ï¼Œå®ƒå’Œpromiseåœ¨æŸç§ç¨‹åº¦ä¸Šæœ‰ç‚¹åƒï¼Œpromiseä¿å­˜äº†ä¸€ä¸ªå…±äº«çŠ¶æ€çš„å€¼ï¼Œè€Œpackaged_taskä¿å­˜çš„æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼š\n1234std::packaged_task&lt;int()&gt; task([]()&#123; return 7; &#125;);std::thread t1(std::ref(task)); std::future&lt;int&gt; f1 = task.get_future(); auto r1 = f1.get();\nstd::promiseã€std::packaged_taskå’Œstd::futureçš„å…³ç³»\nè‡³æ­¤, æˆ‘ä»¬ä»‹ç»äº†std::asyncç›¸å…³çš„å‡ ä¸ªå¯¹è±¡std::futureã€std::promiseå’Œstd::packaged_taskï¼Œå…¶ä¸­std::promiseå’Œstd::packaged_taskçš„ç»“æœæœ€ç»ˆéƒ½æ˜¯é€šè¿‡å…¶å†…éƒ¨çš„futureè¿”å›å‡ºæ¥çš„ï¼Œä¸çŸ¥é“è¯»è€…æœ‰æ²¡æœ‰æç³Šæ¶‚ï¼Œä¸ºä»€ä¹ˆæœ‰è¿™ä¹ˆå¤šä¸œè¥¿å‡ºæ¥ï¼Œä»–ä»¬ä¹‹é—´çš„å…³ç³»åˆ°åº•æ˜¯æ€æ ·çš„ï¼Ÿä¸”å¬æˆ‘æ…¢æ…¢é“æ¥ï¼Œstd::futureæä¾›äº†ä¸€ä¸ªè®¿é—®å¼‚æ­¥æ“ä½œç»“æœçš„æœºåˆ¶ï¼Œå®ƒå’Œçº¿ç¨‹æ˜¯ä¸€ä¸ªçº§åˆ«çš„å±äºä½å±‚æ¬¡çš„å¯¹è±¡ï¼Œåœ¨å®ƒä¹‹ä¸Šé«˜ä¸€å±‚çš„æ˜¯std::packaged_taskå’Œstd::promiseï¼Œä»–ä»¬å†…éƒ¨éƒ½æœ‰futureä»¥ä¾¿è®¿é—®å¼‚æ­¥æ“ä½œç»“æœï¼Œstd::packaged_taskåŒ…è£…çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè€Œstd::promiseåŒ…è£…çš„æ˜¯ä¸€ä¸ªå€¼ï¼Œéƒ½æ˜¯ä¸ºäº†æ–¹ä¾¿å¼‚æ­¥æ“ä½œçš„ï¼Œå› ä¸ºæœ‰æ—¶æˆ‘éœ€è¦è·å–çº¿ç¨‹ä¸­çš„æŸä¸ªå€¼ï¼Œè¿™æ—¶å°±ç”¨std::promiseï¼Œè€Œæœ‰æ—¶æˆ‘éœ€è¦è·ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„è¿”å›å€¼ï¼Œè¿™æ—¶å°±ç”¨std::packaged_taskã€‚é‚£std::promiseå’Œstd::packaged_taskä¹‹é—´åˆæ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿè¯´ä»–ä»¬æ²¡å…³ç³»ä¹Ÿå…³ç³»ï¼Œè¯´ä»–ä»¬æœ‰å…³ç³»ä¹Ÿæœ‰å…³ç³»ï¼Œéƒ½å–å†³äºä½ äº†ï¼Œå› ä¸ºæˆ‘å¯ä»¥å°†ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœä¿å­˜åˆ°std::promiseä¸­ã€‚å¦‚æœè¯»è€…è¿˜æ²¡ææ¸…æ¥šä»–ä»¬çš„å…³ç³»çš„è¯ï¼Œæˆ‘å°±ç”¨æ›´é€šä¿—çš„è¯æ¥è§£é‡Šä¸€ä¸‹ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªå°ä¼™å­ç»™ä¸€ä¸ªå§‘å¨˜è¡¨ç™½çœŸå¿ƒçš„æ—¶å€™ä¹Ÿè®¸ä¼šè¯´ï¼šâ€æˆ‘è®¸è¯ºä¼šç»™ä½ ä¸€ä¸ªç¾å¥½çš„æœªæ¥â€œæˆ–è€…â€æˆ‘ä¼šåŠªåŠ›å¥‹æ–—ä¸ºä½ åˆ›é€ ä¸€ä¸ªç¾å¥½çš„æœªæ¥â€œã€‚å§‘å¨˜å¾€å¾€ä¼šè¯´ï¼šâ€æˆ‘ç­‰ç€â€œã€‚ç°åœ¨æˆ‘æ¥å°†è¿™ä¸‰å¥è¯ç”¨c++11æ¥ç¿»è¯‘ä¸€ä¸‹ï¼š\nå°ä¼™å­è¯´ï¼šæˆ‘è®¸è¯ºä¼šç»™ä½ ä¸€ä¸ªç¾å¥½çš„æœªæ¥ç­‰äºc11ä¸­&quot;std::promise a std::future&quot;;\nå°ä¼™å­è¯´ï¼šæˆ‘ä¼šåŠªåŠ›å¥‹æ–—ä¸ºä½ åˆ›é€ ä¸€ä¸ªç¾å¥½çš„æœªæ¥ç­‰äºc11ä¸­&quot;std::packaged_task a future&quot;;\nå§‘å¨˜è¯´ï¼šæˆ‘ç­‰ç€ç­‰äºc++11ä¸­&quot;future.get()/wait()&quot;;\nå°ä¼™å­ä¸¤å¥è¯çš„ä¸ªä¸­å·®å¼‚ï¼Œè‡ªå·±ç¢ç£¨ä¸€ä¸‹ï¼Œè¿™ç‚¹å·®å¼‚ä¹Ÿæ˜¯std::promiseå’Œstd::packaged_taskçš„å·®å¼‚ã€‚ç°å®ä¸­çš„å±±ç›Ÿæµ·èª“é ä¸é å¾—ä½æˆ‘ä¸çŸ¥é“ï¼Œä½†æ˜¯c11ä¸­çš„è®¸è¯ºå’Œæœªæ¥æ˜¯ä¸€å®šå¯é çš„ï¼Œå‘èµ·æ¥äº†è®¸è¯ºå°±ä¸€å®šæœ‰æœªæ¥ã€‚ç»†æƒ³èµ·æ¥c11æ ‡å‡†çš„åˆ¶å®šè€…é€‰å®šçš„å…³é”®å­—çœŸæ˜¯è´´åˆ‡è€Œæœ‰æ„æ€ï¼å¥½äº†ï¼Œæ’ç§‘æ‰“è¯¨åˆ°æ­¤äº†ï¼Œç°åœ¨è¨€å½’æ­£ä¼ ï¼Œå›è¿‡å¤´æ¥è¯´è¯´std::asyncã€‚\nä¸ºä»€ä¹ˆè¦ç”¨std::asyncä»£æ›¿çº¿ç¨‹çš„åˆ›å»º\nstd::asyncåˆæ˜¯å¹²å•¥çš„ï¼Œå·²ç»æœ‰äº†td::futureã€std::promiseå’Œstd::packaged_taskï¼Œå¤Ÿå¤šçš„äº†ï¼ŒçœŸçš„è¿˜è¦ä¸€ä¸ªstd::asyncæ¥å‡‘çƒ­é—¹å—ï¼Œstd::asyncè¡¨ç¤ºå¾ˆå§”å±ˆï¼šæˆ‘ä¸æ˜¯æ¥å‡‘çƒ­é—¹çš„ï¼Œæˆ‘æ˜¯æ¥å¸®å¿™çš„ã€‚æ˜¯çš„ï¼Œstd::asyncæ˜¯ä¸ºäº†è®©ç”¨æˆ·çš„å°‘è´¹ç‚¹è„‘å­çš„ï¼Œå®ƒè®©è¿™ä¸‰ä¸ªå¯¹è±¡é»˜å¥‘çš„å·¥ä½œã€‚å¤§æ¦‚çš„å·¥ä½œè¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šstd::asyncå…ˆå°†å¼‚æ­¥æ“ä½œç”¨std::packaged_taskåŒ…è£…èµ·æ¥ï¼Œç„¶åå°†å¼‚æ­¥æ“ä½œçš„ç»“æœæ”¾åˆ°std::promiseä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯åˆ›é€ æœªæ¥çš„è¿‡ç¨‹ã€‚å¤–é¢å†é€šè¿‡future.get/waitæ¥è·å–è¿™ä¸ªæœªæ¥çš„ç»“æœï¼Œæ€ä¹ˆæ ·ï¼Œstd::asyncçœŸçš„æ˜¯æ¥å¸®å¿™çš„å§ï¼Œä½ ä¸ç”¨å†æƒ³åˆ°åº•è¯¥æ€ä¹ˆç”¨std::futureã€std::promiseå’Œstd::packaged_taskäº†ï¼Œstd::asyncå·²ç»å¸®ä½ æå®šä¸€åˆ‡äº†ï¼\nç°åœ¨æ¥çœ‹çœ‹std::asyncçš„åŸå‹async(std::launch::async | std::launch::deferred, f, argsâ€¦)ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯çº¿ç¨‹çš„åˆ›å»ºç­–ç•¥ï¼Œæœ‰ä¸¤ç§ç­–ç•¥ï¼Œé»˜è®¤çš„ç­–ç•¥æ˜¯ç«‹å³åˆ›å»ºçº¿ç¨‹ï¼š\n\nstd::launch::asyncï¼šåœ¨è°ƒç”¨asyncå°±å¼€å§‹åˆ›å»ºçº¿ç¨‹ã€‚\nstd::launch::deferredï¼šå»¶è¿ŸåŠ è½½æ–¹å¼åˆ›å»ºçº¿ç¨‹ã€‚è°ƒç”¨asyncæ—¶ä¸åˆ›å»ºçº¿ç¨‹ï¼Œç›´åˆ°è°ƒç”¨äº†futureçš„getæˆ–è€…waitæ—¶æ‰åˆ›å»ºçº¿ç¨‹ã€‚å¯èƒ½åœ¨è¿™é‡Œä¼šé˜»å¡ä½ä¸»çº¿ç¨‹ã€‚\n\nç¬¬äºŒä¸ªå‚æ•°æ˜¯çº¿ç¨‹å‡½æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯çº¿ç¨‹å‡½æ•°çš„å‚æ•°ã€‚\nstd::asyncåŸºæœ¬ç”¨æ³•ï¼š\n12345678910111213141516171819202122232425262728293031323334353637std::future&lt;int&gt; f1 = std::async(std::launch::async, []()&#123;         return 8;      &#125;); cout&lt;&lt;f1.get()&lt;&lt;endl; //output: 8std::future&lt;int&gt; f2 = std::async(std::launch::async, []()&#123;         cout&lt;&lt;8&lt;&lt;endl;    &#125;); f2.wait(); //output: 8std::future&lt;int&gt; future = std::async(std::launch::async, []()&#123;         std::this_thread::sleep_for(std::chrono::seconds(3));        return 8;      &#125;);      std::cout &lt;&lt; \"waiting...\\n\";    std::future_status status;    do &#123;        status = future.wait_for(std::chrono::seconds(1));        if (status == std::future_status::deferred) &#123;            std::cout &lt;&lt; \"deferred\\n\";        &#125; else if (status == std::future_status::timeout) &#123;            std::cout &lt;&lt; \"timeout\\n\";        &#125; else if (status == std::future_status::ready) &#123;            std::cout &lt;&lt; \"ready!\\n\";        &#125;    &#125; while (status != std::future_status::ready);      std::cout &lt;&lt; \"result is \" &lt;&lt; future.get() &lt;&lt; '\\n';å¯èƒ½çš„ç»“æœï¼šwaiting...timeouttimeoutready!result is 8\næ€»ç»“ï¼š\nstd::asyncæ˜¯æ›´é«˜å±‚æ¬¡ä¸Šçš„å¼‚æ­¥æ“ä½œï¼Œä½¿æˆ‘ä»¬ä¸ç”¨å…³æ³¨çº¿ç¨‹åˆ›å»ºå†…éƒ¨ç»†èŠ‚ï¼Œå°±èƒ½æ–¹ä¾¿çš„è·å–å¼‚æ­¥æ‰§è¡ŒçŠ¶æ€å’Œç»“æœï¼Œè¿˜å¯ä»¥æŒ‡å®šçº¿ç¨‹åˆ›å»ºç­–ç•¥ï¼Œåº”è¯¥ç”¨std::asyncæ›¿ä»£çº¿ç¨‹çš„åˆ›å»ºï¼Œè®©å®ƒæˆä¸ºæˆ‘ä»¬åšå¼‚æ­¥æ“ä½œçš„é¦–é€‰ã€‚\n","thumbnail":"/posts/C++ä¸­ä¼˜é›…çš„å¼‚æ­¥æ“ä½œ/sync.png","plink":"https://shuntan.github.io/posts/C++ä¸­ä¼˜é›…çš„å¼‚æ­¥æ“ä½œ/"},{"title":"Mutexä»‹ç»","date":"2019-06-14T03:00:47.000Z","date_formatted":{"ll":"Jun 14, 2019","L":"06/14/2019","MM-DD":"06-14"},"updated":"2020-04-22T07:13:19.836Z","content":"Mutex åˆç§°äº’æ–¥é‡ï¼ŒC++ 11ä¸­ä¸ Mutex ç›¸å…³çš„ç±»ï¼ˆåŒ…æ‹¬é”ç±»å‹ï¼‰å’Œå‡½æ•°éƒ½å£°æ˜åœ¨  å¤´æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥å¦‚æœä½ éœ€è¦ä½¿ç”¨ std::mutexï¼Œå°±å¿…é¡»åŒ…å«  å¤´æ–‡ä»¶ã€‚\n\n å¤´æ–‡ä»¶ä»‹ç»\nMutex ç³»åˆ—ç±»(å››ç§)\n\n\nstd::mutexï¼Œæœ€åŸºæœ¬çš„ Mutex ç±»ã€‚\n\n\nstd::recursive_mutexï¼Œé€’å½’ Mutex ç±»ã€‚\n\n\nstd::time_mutexï¼Œå®šæ—¶ Mutex ç±»ã€‚\n\n\nstd::recursive_timed_mutexï¼Œå®šæ—¶é€’å½’ Mutex ç±»ã€‚\n\n\nLock ç±»ï¼ˆä¸¤ç§ï¼‰\n\nstd::lock_guardï¼Œä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ã€‚\nstd::unique_lockï¼Œä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ï¼Œä½†æä¾›äº†æ›´å¥½çš„ä¸Šé”å’Œè§£é”æ§åˆ¶ã€‚\n\nå…¶ä»–ç±»å‹\n\nstd::once_flag\nstd::adopt_lock_t\nstd::defer_lock_t\nstd::try_to_lock_t\n\nå‡½æ•°\n\nstd::try_lockï¼Œå°è¯•åŒæ—¶å¯¹å¤šä¸ªäº’æ–¥é‡ä¸Šé”ã€‚\nstd::lockï¼Œå¯ä»¥åŒæ—¶å¯¹å¤šä¸ªäº’æ–¥é‡ä¸Šé”ã€‚\nstd::call_onceï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹éœ€è¦åŒæ—¶è°ƒç”¨æŸä¸ªå‡½æ•°ï¼Œcall_once å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹å¯¹è¯¥å‡½æ•°åªè°ƒç”¨ä¸€æ¬¡ã€‚\n\nstd::mutex ä»‹ç»\nä¸‹é¢ä»¥ std::mutex ä¸ºä¾‹ä»‹ç» C++11 ä¸­çš„äº’æ–¥é‡ç”¨æ³•ã€‚\nstd::mutex æ˜¯C++11 ä¸­æœ€åŸºæœ¬çš„äº’æ–¥é‡ï¼Œstd::mutex å¯¹è±¡æä¾›äº†ç‹¬å æ‰€æœ‰æƒçš„ç‰¹æ€§â€”â€”å³ä¸æ”¯æŒé€’å½’åœ°å¯¹ std::mutex å¯¹è±¡ä¸Šé”ï¼Œè€Œ std::recursive_lock åˆ™å¯ä»¥é€’å½’åœ°å¯¹äº’æ–¥é‡å¯¹è±¡ä¸Šé”ã€‚\nstd::mutex çš„æˆå‘˜å‡½æ•°\n\næ„é€ å‡½æ•°ï¼Œstd::mutexä¸å…è®¸æ‹·è´æ„é€ ï¼Œä¹Ÿä¸å…è®¸ move æ‹·è´ï¼Œæœ€åˆäº§ç”Ÿçš„ mutex å¯¹è±¡æ˜¯å¤„äº unlocked çŠ¶æ€çš„ã€‚\nlock()ï¼Œè°ƒç”¨çº¿ç¨‹å°†é”ä½è¯¥äº’æ–¥é‡ã€‚çº¿ç¨‹è°ƒç”¨è¯¥å‡½æ•°ä¼šå‘ç”Ÿä¸‹é¢ 3 ç§æƒ…å†µï¼š(1). å¦‚æœè¯¥äº’æ–¥é‡å½“å‰æ²¡æœ‰è¢«é”ä½ï¼Œåˆ™è°ƒç”¨çº¿ç¨‹å°†è¯¥äº’æ–¥é‡é”ä½ï¼Œç›´åˆ°è°ƒç”¨ unlockä¹‹å‰ï¼Œè¯¥çº¿ç¨‹ä¸€ç›´æ‹¥æœ‰è¯¥é”ã€‚(2). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹é”ä½ï¼Œåˆ™å½“å‰çš„è°ƒç”¨çº¿ç¨‹è¢«é˜»å¡ä½ã€‚(3). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å½“å‰è°ƒç”¨çº¿ç¨‹é”ä½ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”(deadlock)ã€‚\nunlock()ï¼Œ è§£é”ï¼Œé‡Šæ”¾å¯¹äº’æ–¥é‡çš„æ‰€æœ‰æƒã€‚\ntry_lock()ï¼Œå°è¯•é”ä½äº’æ–¥é‡ï¼Œå¦‚æœäº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹ä¹Ÿä¸ä¼šè¢«é˜»å¡ã€‚çº¿ç¨‹è°ƒç”¨è¯¥å‡½æ•°ä¹Ÿä¼šå‡ºç°ä¸‹é¢ 3 ç§æƒ…å†µï¼Œ(1). å¦‚æœå½“å‰äº’æ–¥é‡æ²¡æœ‰è¢«å…¶ä»–çº¿ç¨‹å æœ‰ï¼Œåˆ™è¯¥çº¿ç¨‹é”ä½äº’æ–¥é‡ï¼Œç›´åˆ°è¯¥çº¿ç¨‹è°ƒç”¨ unlock é‡Šæ”¾äº’æ–¥é‡ã€‚(2). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å…¶ä»–çº¿ç¨‹é”ä½ï¼Œåˆ™å½“å‰è°ƒç”¨çº¿ç¨‹è¿”å› falseï¼Œè€Œå¹¶ä¸ä¼šè¢«é˜»å¡æ‰ã€‚(3). å¦‚æœå½“å‰äº’æ–¥é‡è¢«å½“å‰è°ƒç”¨çº¿ç¨‹é”ä½ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”(deadlock)ã€‚\n\nä¸‹é¢ç»™å‡ºä¸€ä¸ªä¸ std::mutex çš„å°ä¾‹å­ï¼ˆå‚è€ƒï¼‰\n1234567891011121314151617181920212223242526#include &lt;iostream&gt;       // std::cout#include &lt;thread&gt;         // std::thread#include &lt;mutex&gt;          // std::mutexvolatile int counter(0); // non-atomic counterstd::mutex mtx;           // locks access to countervoid attempt_10k_increases() &#123;    for (int i=0; i&lt;10000; ++i) &#123;        if (mtx.try_lock()) &#123;   // only increase if currently not locked:            ++counter;            mtx.unlock();        &#125;    &#125;&#125;int main (int argc, const char* argv[]) &#123;    std::thread threads[10];    for (int i=0; i&lt;10; ++i)        threads[i] = std::thread(attempt_10k_increases);    for (auto&amp; th : threads) th.join();    std::cout &lt;&lt; counter &lt;&lt; \" successful increases of the counter.\\n\";    return 0;&#125;\nè¾“å‡ºç»“æœï¼š\n123$g++ -lpthread -std=c++11 -o main *.cpp$main9012 successful increases of the counter.\n\nå¯ä»¥çœ‹å‡ºæœ‰å¾ˆå¤šæ¬¡mtx.try_lock()è¿”å›äº†falseï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œ++counteræ“ä½œã€‚\nå¦‚æœæŠŠmtx.try_lock()æ”¹æˆmtx.lock()ï¼Œåˆ™å¿…å®šä¼šé˜»å¡å…¶ä»–çº¿ç¨‹ã€‚\n\nè¾“å‡ºç»“æœ2:\n123$g++ -lpthread -std=c++11 -o main *.cpp$main100000 successful increases of the counter.\nstd::recursive_mutex ä»‹ç»\nstd::recursive_mutex ä¸ std::mutex ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€ç§å¯ä»¥è¢«ä¸Šé”çš„å¯¹è±¡ï¼Œä½†æ˜¯å’Œ std::mutex ä¸åŒçš„æ˜¯ï¼Œstd::recursive_mutex å…è®¸åŒä¸€ä¸ªçº¿ç¨‹å¯¹äº’æ–¥é‡å¤šæ¬¡ä¸Šé”ï¼ˆå³é€’å½’ä¸Šé”ï¼‰ï¼Œæ¥è·å¾—å¯¹äº’æ–¥é‡å¯¹è±¡çš„å¤šå±‚æ‰€æœ‰æƒï¼Œstd::recursive_mutex é‡Šæ”¾äº’æ–¥é‡æ—¶éœ€è¦è°ƒç”¨ä¸è¯¥é”å±‚æ¬¡æ·±åº¦ç›¸åŒæ¬¡æ•°çš„ unlock()ï¼Œå¯ç†è§£ä¸º lock() æ¬¡æ•°å’Œ unlock() æ¬¡æ•°ç›¸åŒï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œstd::recursive_mutex çš„ç‰¹æ€§å’Œ std::mutex å¤§è‡´ç›¸åŒã€‚\n12345678910111213141516171819202122232425#include &lt;iostream&gt;       // std::cout#include &lt;thread&gt;         // std::thread#include &lt;mutex&gt;          // std::mutexvolatile int counter(0); // non-atomic counterstd::recursive_mutex  rmtx;           // locks access to countervoid attempt_1k_increases() &#123;    for (int i=0; i&lt;10000; ++i) &#123;        rmtx.lock();           ++counter;     &#125;    for (int i=0; i&lt;10000; ++i) &#123;         counter-=2;         rmtx.unlock();    &#125;&#125;int main (int argc, const char* argv[]) &#123;    auto th = std::thread(attempt_1k_increases);    th.join();    std::cout &lt;&lt; counter &lt;&lt; \" successful increases of the counter.\\n\";    return 0;&#125;\nè¾“å‡ºç»“æœï¼š\n123$g++ -lpthread -o main *.cpp$main-10000 successful increases of the counter.\nstd::time_mutex ä»‹ç»\nstd::time_mutex æ¯” std::mutex å¤šäº†ä¸¤ä¸ªæˆå‘˜å‡½æ•°ï¼Œtry_lock_for()ï¼Œtry_lock_until()ã€‚\ntry_lock_for å‡½æ•°æ¥å—ä¸€ä¸ªæ—¶é—´èŒƒå›´ï¼Œè¡¨ç¤ºåœ¨è¿™ä¸€æ®µæ—¶é—´èŒƒå›´ä¹‹å†…çº¿ç¨‹å¦‚æœæ²¡æœ‰è·å¾—é”åˆ™è¢«é˜»å¡ä½ï¼ˆä¸ std::mutex çš„ try_lock() ä¸åŒï¼Œtry_lock å¦‚æœè¢«è°ƒç”¨æ—¶æ²¡æœ‰è·å¾—é”åˆ™ç›´æ¥è¿”å› falseï¼‰ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´å…¶ä»–çº¿ç¨‹é‡Šæ”¾äº†é”ï¼Œåˆ™è¯¥çº¿ç¨‹å¯ä»¥è·å¾—å¯¹äº’æ–¥é‡çš„é”ï¼Œå¦‚æœè¶…æ—¶ï¼ˆå³åœ¨æŒ‡å®šæ—¶é—´å†…è¿˜æ˜¯æ²¡æœ‰è·å¾—é”ï¼‰ï¼Œåˆ™è¿”å› falseã€‚\ntry_lock_until å‡½æ•°åˆ™æ¥å—ä¸€ä¸ªæ—¶é—´ç‚¹ä½œä¸ºå‚æ•°ï¼Œåœ¨æŒ‡å®šæ—¶é—´ç‚¹æœªåˆ°æ¥ä¹‹å‰çº¿ç¨‹å¦‚æœæ²¡æœ‰è·å¾—é”åˆ™è¢«é˜»å¡ä½ï¼Œå¦‚æœåœ¨æ­¤æœŸé—´å…¶ä»–çº¿ç¨‹é‡Šæ”¾äº†é”ï¼Œåˆ™è¯¥çº¿ç¨‹å¯ä»¥è·å¾—å¯¹äº’æ–¥é‡çš„é”ï¼Œå¦‚æœè¶…æ—¶ï¼ˆå³åœ¨æŒ‡å®šæ—¶é—´å†…è¿˜æ˜¯æ²¡æœ‰è·å¾—é”ï¼‰ï¼Œåˆ™è¿”å› falseã€‚\nä¸‹é¢çš„å°ä¾‹å­è¯´æ˜äº† std::time_mutex çš„ç”¨æ³•ï¼ˆå‚è€ƒï¼‰ã€‚\n1234567891011121314151617181920212223242526272829#include &lt;iostream&gt;       // std::cout#include &lt;chrono&gt;         // std::chrono::milliseconds#include &lt;thread&gt;         // std::thread#include &lt;mutex&gt;          // std::timed_mutexstd::timed_mutex mtx;void fireworks() &#123;  // waiting to get a lock: each thread prints \"-\" every 200ms:  while (!mtx.try_lock_for(std::chrono::milliseconds(200))) &#123;    std::cout &lt;&lt; \"-\";  &#125;  // got a lock! - wait for 1s, then this thread prints \"*\"  std::this_thread::sleep_for(std::chrono::milliseconds(1000));  std::cout &lt;&lt; \"*\\n\";  mtx.unlock();&#125;int main ()&#123;  std::thread threads[10];  // spawn 10 threads:  for (int i=0; i&lt;10; ++i)    threads[i] = std::thread(fireworks);  for (auto&amp; th : threads) th.join();  return 0;&#125;\nè¾“å‡ºç»“æœï¼š\n\nçº¿ç¨‹è¾“å‡º*è¡¨ç¤ºè¯¥çº¿ç¨‹å·²ç»æ­£å¸¸é€€å‡ºï¼Œå¹¶ä¸”é‡Šæ”¾è¯¥é”ã€‚å¦åˆ™å°†æ¯200mså°è¯•è·å–mutexğŸ”’ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚\n\nstd::recursive_timed_mutex ä»‹ç»\nå’Œ std:recursive_mutex ä¸ std::mutex çš„å…³ç³»ä¸€æ ·ï¼Œstd::recursive_timed_mutex çš„ç‰¹æ€§ä¹Ÿå¯ä»¥ä» std::timed_mutex æ¨å¯¼å‡ºæ¥ï¼Œæ„Ÿå…´è¶£çš„åŒé‹å¯ä»¥è‡ªè¡ŒæŸ¥é˜…ã€‚ ;-)\nstd::lock_guard ä»‹ç»\nä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ã€‚ä¾‹å­ï¼ˆå‚è€ƒï¼‰:\n\n1.std::lock_guard åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡ŒåŠ é”ï¼Œææ„å‡½æ•°ä¸­è¿›è¡Œè§£é”ã€‚\n2.é”åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œä½¿ç”¨è¾ƒå¤šï¼Œå› æ­¤c++11æä¾›äº†lock_guardæ¨¡æ¿ç±»ï¼›åœ¨å®é™…ç¼–ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„åœºæ™¯ç¼–å†™resource_guard RAIIç±»ï¼Œé¿å…å¿˜æ‰é‡Šæ”¾èµ„æºã€‚\n\n12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;       // std::cout#include &lt;thread&gt;         // std::thread#include &lt;mutex&gt;          // std::mutex, std::lock_guard#include &lt;stdexcept&gt;      // std::logic_errorstd::mutex mtx;void print_even (int x) &#123;    if (x%2==0) std::cout &lt;&lt; x &lt;&lt; \" is even\\n\";    else throw (std::logic_error(\"not even\"));&#125;void print_thread_id (int id) &#123;    try &#123;        // using a local lock_guard to lock mtx guarantees unlocking on destruction / exception:        std::lock_guard&lt;std::mutex&gt; lck (mtx);        print_even(id);    &#125;    catch (std::logic_error&amp;) &#123;        std::cout &lt;&lt; \"[exception caught]\\n\";    &#125;&#125;int main ()&#123;    std::thread threads[10];    // spawn 10 threads:    for (int i=0; i&lt;10; ++i)        threads[i] = std::thread(print_thread_id,i+1);    for (auto&amp; th : threads) th.join();    return 0;&#125;\nè¾“å‡ºç»“æœï¼š\n123456789101112$g++ -lpthread -o main *.cpp$main[exception caught]4 is even[exception caught]2 is even[exception caught]6 is even8 is even[exception caught][exception caught]10 is even\nstd::unique_lock ä»‹ç»\nä¸ Mutex RAII ç›¸å…³ï¼Œæ–¹ä¾¿çº¿ç¨‹å¯¹äº’æ–¥é‡ä¸Šé”ï¼Œä½†æä¾›äº†æ›´å¥½çš„ä¸Šé”å’Œè§£é”æ§åˆ¶ã€‚ä¾‹å­ï¼ˆå‚è€ƒï¼‰ï¼š\n\n1.ç±» unique_lock æ˜¯é€šç”¨äº’æ–¥åŒ…è£…å™¨ï¼Œå…è®¸å»¶è¿Ÿé”å®šã€é”å®šçš„æœ‰æ—¶é™å°è¯•ã€é€’å½’é”å®šã€æ‰€æœ‰æƒè½¬ç§»å’Œä¸æ¡ä»¶å˜é‡ä¸€åŒä½¿ç”¨ã€‚\n2.unique_lockæ¯”lock_guardä½¿ç”¨æ›´åŠ çµæ´»ï¼ŒåŠŸèƒ½æ›´åŠ å¼ºå¤§ã€‚\nä½¿ç”¨unique_lockéœ€è¦ä»˜å‡ºæ›´å¤šçš„æ—¶é—´ã€æ€§èƒ½æˆæœ¬ã€‚\n\n12345678910111213141516171819202122232425#include &lt;iostream&gt;       // std::cout#include &lt;thread&gt;         // std::thread#include &lt;mutex&gt;          // std::mutex, std::unique_lockstd::mutex mtx;           // mutex for critical sectionvoid print_block (int n, char c) &#123;    // critical section (exclusive access to std::cout signaled by lifetime of lck):    std::unique_lock&lt;std::mutex&gt; lck (mtx);    for (int i=0; i&lt;n; ++i) &#123;        std::cout &lt;&lt; c;    &#125;    std::cout &lt;&lt; '\\n';&#125;int main ()&#123;    std::thread th1 (print_block,50,'*');    std::thread th2 (print_block,50,'$');    th1.join();    th2.join();    return 0;&#125;\nè¾“å‡ºç»“æœï¼š\n1234$g++ -lpthread -o main *.cpp$main**************************************************$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$\nå¥½äº†ï¼Œæœ¬æ–‡æš‚æ—¶è®²åˆ°è¿™é‡Œï¼Œè¿˜å‰©ä¸‹ std::try_lockï¼Œstd::lockï¼Œstd::call_once ä¸‰ä¸ªå‡½æ•°æ²¡æœ‰è®²åˆ°ï¼Œç•™åœ¨ä¸‹ä¸€ç¯‡åšå®¢ä¸­è®²å§ ;-)\n","thumbnail":"/posts/Mutexä»‹ç»/mutex.png","plink":"https://shuntan.github.io/posts/Mutexä»‹ç»/"},{"title":"C++ä¹‹Lambdaç ”ç©¶","date":"2019-06-03T12:20:52.000Z","date_formatted":{"ll":"Jun 3, 2019","L":"06/03/2019","MM-DD":"06-03"},"updated":"2020-04-22T14:07:50.758Z","content":"1.Â å‰è¨€\næœ¬æ–‡ä»£ç æµ‹è¯•ç¯å¢ƒä¸ºâ€œGCC-9.1.0â€ï¼Œæœ‰å…³ç¼–è¯‘å™¨çš„å®‰è£…è¯·å‚è€ƒã€Šå®‰è£…GCC-8.3.0åŠå…¶ä¾èµ–ã€‹ï¼Œé€‚ç”¨äºâ€œGCC-9.1.0â€ã€‚\næœ¬æ–‡è¯•å›¾æ­éœ²LambdaèƒŒåä¸€é¢ï¼Œä»¥æ–¹ä¾¿æ›´å¥½çš„ç†è§£å’ŒæŒæ¡Lambdaã€‚Lambdaä»£ç æ®µå®é™…ä¸ºä¸€ä¸ªç¼–è¯‘å™¨ç”Ÿæˆçš„ç±»çš„â€œoperatorÂ ()â€å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸€ä¸ªLambdaå‡½æ•°ç”Ÿæˆä¸€ä¸ªåŒ¿åçš„ç±»ï¼ˆåœ¨C++ä¸­ï¼Œç±»å’Œç»“æ„ä½“å®é™…ä¸€æ ·ï¼Œæ— æœ¬è´¨åŒºåˆ«ï¼Œé™¤äº†é»˜è®¤çš„è®¿é—®æ§åˆ¶ï¼‰ã€‚\nå¯¹Lambdaçš„æœ€ç®€å•ç†è§£ï¼Œæ˜¯å°†å®ƒçœ‹ä½œä¸€ä¸ªåŒ¿åç±»ï¼ˆæˆ–ç»“æ„ä½“ï¼‰ï¼Œå®é™…ä¸Šä¹Ÿç¡®å®å¦‚æ­¤ï¼Œç¼–è¯‘å™¨æŠŠLambdaç¼–è¯‘æˆäº†åŒ¿åç±»ã€‚\n\n2. ç¤ºä¾‹1\nå…ˆçœ‹ä¸€æ®µå‡ ä¹æœ€ç®€å•çš„Lambdaä»£ç ï¼š\n123456//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;intÂ main()Â &#123;Â Â autoÂ fÂ =Â []Â &#123;Â printf(\"f\\n\");Â &#125;;Â //Â æ³¨æ„â€œ&#125;â€åçš„â€œ;â€å¿…ä¸å¯å°‘ï¼Œå¦åˆ™ç¼–è¯‘æŠ¥é”™Â Â returnÂ 0;&#125;\nå¦‚æœLambdaè¡¨è¾¾å¼ï¼ˆæˆ–å‡½æ•°ï¼‰æ²¡æœ‰ä»¥â€œ;â€ç»“å°¾ï¼Œåˆ™ç¼–è¯‘æ—¶å°†æŠ¥å¦‚ä¸‹é”™è¯¯ï¼š\n1234a3.cpp:Â InÂ functionÂ 'intÂ main()':a3.cpp:4:3:Â error:Â expectedÂ ','Â orÂ ';'Â beforeÂ 'return'Â Â Â Â 4Â |Â Â Â returnÂ 0;Â Â Â Â Â Â |Â Â Â ^~~~~~\nLambdaä¹‹æ‰€ä»¥ç¥å¥‡ï¼Œè¿™å¾—ç›ŠäºC++ç¼–è¯‘å™¨çš„å·¥ä½œï¼Œä¸Šè¿°â€œfâ€å®é™…é•¿è¿™æ ·ï¼š\n12typeÂ =Â structÂ &lt;lambda()&gt;Â &#123;&#125;\nä¸€ä¸ªåŒ¿åçš„ç±»ï¼ˆæˆ–ç»“æ„ä½“ï¼‰ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸€ä¸ªæˆå‘˜å‡½æ•°â€œoperatorÂ ()Â constâ€ã€‚æ³¨æ„è¿™é‡Œæˆå‘˜å‡½æ•°æ˜¯â€constâ€ç±»å‹ï¼Œè¿™æ˜¯é»˜è®¤çš„ã€‚å¦‚æœéœ€éâ€constâ€æˆå‘˜å‡½æ•°ï¼Œéœ€è¦åŠ â€mutableâ€ä¿®é¥°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1autoÂ fÂ =Â [n]()Â mutableÂ &#123;Â printf(\"%d\\n\",Â n);Â &#125;;\nä¸Šé¢ä¾‹å­å¯¹åº”çš„åŒ¿åç±»æ²¡æœ‰ä»»ä½•ç±»æ•°æ®æˆå‘˜ï¼Œç°åœ¨æ¥ä¸ªæœ‰ç±»æ•°æ®æˆå‘˜çš„ä»£ç ï¼š\n12345678//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;intÂ main()Â &#123;Â Â intÂ nÂ =Â 3;Â Â autoÂ fÂ =Â [n]Â &#123;Â printf(\"%d\\n\",Â n);Â &#125;;Â Â f();Â //Â è¿™é‡Œå®é™…è°ƒç”¨çš„æ˜¯åŒ¿åç±»çš„æˆå‘˜å‡½æ•°â€œoperatorÂ ()â€Â Â returnÂ 0;&#125;\nè¿™æ—¶ï¼Œâ€œfâ€å®é™…é•¿è¿™æ ·ï¼Œå®ƒæ˜¯ä¸€ä¸ªå«æœ‰ç±»æ•°æ®æˆå‘˜çš„åŒ¿åç±»ï¼Œè€Œä¸å†æ˜¯ç©ºæ— ä¸€ç‰¹çš„ç±»ï¼š\n123typeÂ =Â structÂ &lt;lambda()&gt;Â &#123;Â Â Â Â intÂ __n;&#125;\n3.Â ç¤ºä¾‹2\nç»§ç»­æ¥ä¸ªå˜ç§ï¼š\n12345678910//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;intÂ main()Â &#123;Â Â intÂ nÂ =Â 3;Â Â autoÂ fÂ =Â [&amp;n]()Â mutableÂ &#123;Â printf(\"%d\\n\",Â n);Â &#125;;Â Â f();Â Â returnÂ 0;&#125;\nè¿™æ—¶ï¼Œâ€œfâ€å®é™…é•¿è¿™æ ·ï¼Œä¸€ä¸ªåŒ…å«äº†å¼•ç”¨ç±»å‹çš„åŒ¿åç±»ï¼š\n123typeÂ =Â structÂ &lt;lambda()&gt;Â &#123;Â Â Â Â intÂ &amp;__n;&#125;\n4.Â ç¤ºä¾‹3\nç»§ç»­å˜ç§ï¼Œâ€œ&amp;â€çš„ä½œç”¨è®©Lambdaå‡½æ•°å¯ä½¿ç”¨Lambdaæ‰€åœ¨ä½œç”¨åŸŸå†…æ‰€æœ‰å¯è§çš„å±€éƒ¨å˜é‡ï¼ˆåŒ…æ‹¬Lambdaæ‰€åœ¨ç±»çš„thisï¼‰ï¼Œå¹¶ä¸”æ˜¯ä»¥å¼•ç”¨ä¼ é€’æ–¹å¼ï¼š\n123456789//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;intÂ main()Â &#123;Â Â intÂ nÂ =Â 3;Â Â autoÂ fÂ =Â [&amp;]()Â mutableÂ &#123;Â printf(\"%d\\n\",Â n);Â &#125;;Â Â f();Â Â returnÂ 0;&#125;\nâ€œfâ€å®é™…é•¿è¿™æ ·ï¼š\n123typeÂ =Â structÂ &lt;lambda()&gt;Â &#123;Â Â Â Â intÂ &amp;__n;&#125;\nå˜ç¨å¤æ‚ä¸€ç‚¹ï¼š\n123456789//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;intÂ main()Â &#123;Â Â intÂ nÂ =Â 3;Â Â intÂ mÂ =Â 5;Â Â autoÂ fÂ =Â [&amp;]()Â mutableÂ &#123;Â printf(\"%d\\n\",Â n);Â &#125;;Â Â f();Â Â returnÂ 0;&#125;\nå¯ä»¥çœ‹åˆ°ï¼Œâ€œfâ€å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼š\n123typeÂ =Â structÂ &lt;lambda()&gt;Â &#123;Â Â Â Â intÂ &amp;__n;&#125;\n5.Â ç¤ºä¾‹4\nç»§ç»­å¢åŠ å¤æ‚åº¦ï¼š\n123456789//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;intÂ main()Â &#123;Â Â intÂ nÂ =Â 3;Â Â intÂ mÂ =Â 5;Â Â autoÂ fÂ =Â [&amp;]()Â mutableÂ &#123;Â printf(\"%d,%d\\n\",Â n,Â m);Â &#125;;Â Â f();Â Â returnÂ 0;&#125;\nå¯ä»¥çœ‹åˆ°â€œfâ€å˜äº†ï¼š\n1234typeÂ =Â structÂ &lt;lambda()&gt;Â &#123;Â Â Â Â intÂ &amp;__n;Â Â Â Â intÂ &amp;__m;&#125;\nä»ä¸Šé¢ä¸éš¾çœ‹å‡ºï¼Œç¼–è¯‘å™¨åªä¼šæŠŠLambdaå‡½æ•°ç”¨åˆ°çš„å˜é‡æ‰“åŒ…è¿›å¯¹åº”çš„åŒ¿åç±»ã€‚ç»§ç»­ä¸€ä¸ªç¨å¤æ‚ç‚¹çš„ï¼š\n1234567891011121314//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;structÂ XÂ &#123;Â Â voidÂ foo()Â &#123;Â printf(\"foo\\n\");Â &#125;Â Â voidÂ xoo()Â &#123;Â Â Â Â autoÂ fÂ =Â [&amp;]Â &#123;Â foo();Â &#125;;Â Â Â Â f();Â Â &#125;&#125;;intÂ main()Â &#123;Â Â X().xoo();Â Â returnÂ 0;&#125;\nè¿™æ—¶ï¼Œâ€œfâ€å®é™…é•¿è¿™æ ·ï¼š\n123typeÂ =Â structÂ X::&lt;lambda()&gt;Â &#123;Â Â Â Â XÂ *Â constÂ __this;Â //Â Xç±»å‹çš„æŒ‡é’ˆï¼ˆéå¯¹è±¡ï¼‰&#125;\nå¦‚æœå°†â€œautoÂ fÂ =Â [&amp;]Â {Â foo();Â };â€ä¸­çš„â€œ&amp;â€å»æ‰ï¼Œåˆ™ä¼šé‡åˆ°ç¼–è¯‘é”™è¯¯ï¼Œæç¤ºâ€œthisâ€æ²¡æœ‰è¢«Lambdaå‡½æ•°æ•è·ï¼š\n12345a2.cpp:Â InÂ lambdaÂ function:a2.cpp:5:23:Â error:Â 'this'Â wasÂ notÂ capturedÂ forÂ thisÂ lambdaÂ functionÂ Â Â Â 5Â |Â Â Â Â Â autoÂ fÂ =Â []Â &#123;Â foo();Â &#125;;Â Â Â Â Â Â |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^a2.cpp:5:23:Â error:Â cannotÂ callÂ memberÂ functionÂ 'voidÂ X::foo()'Â withoutÂ object\næ”¹æˆä¸‹åˆ—æ–¹å¼æ•è·ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š\n1234567891011121314//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;structÂ XÂ &#123;Â Â voidÂ foo()Â &#123;Â printf(\"foo\\n\");Â &#125;Â Â voidÂ xoo()Â &#123;Â Â Â Â autoÂ fÂ =Â [this]Â &#123;Â foo();Â &#125;;Â Â Â Â f();Â Â &#125;&#125;;intÂ main()Â &#123;Â Â X().xoo();Â Â returnÂ 0;&#125;\nå¦‚æœæ˜¯C++17ï¼Œè¿˜å¯ä»¥è¿™æ ·ï¼š\n1234567891011121314//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++17#includeÂ &lt;stdio.h&gt;structÂ XÂ &#123;Â Â voidÂ foo()Â &#123;Â printf(\"foo\\n\");Â &#125;Â Â voidÂ xoo()Â &#123;Â Â Â Â autoÂ fÂ =Â [*this]()Â mutableÂ &#123;Â foo();Â &#125;;Â Â Â Â f();Â Â &#125;&#125;;intÂ main()Â &#123;Â Â X().xoo();Â Â returnÂ 0;&#125;\næ³¨æ„å¾—æœ‰â€œmutableâ€ä¿®é¥°ï¼Œä¸ç„¶æŠ¥å¦‚ä¸‹ç¼–è¯‘é”™è¯¯ï¼š\n1234567a2.cpp:Â InÂ lambdaÂ function:a2.cpp:5:30:Â error:Â passingÂ 'constÂ X'Â asÂ 'this'Â argumentÂ discardsÂ qualifiersÂ [-fpermissive]Â Â Â Â 5Â |Â Â Â Â Â autoÂ fÂ =Â [*this]()Â &#123;Â foo();Â &#125;;Â Â Â Â Â Â |Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^a2.cpp:3:8:Â note:Â Â Â inÂ callÂ toÂ 'voidÂ X::foo()'Â Â Â Â 3Â |Â Â Â voidÂ foo()Â &#123;Â printf(\"foo\\n\");Â &#125;Â Â Â Â Â Â |Â Â Â Â Â Â Â Â ^~~\nä¹Ÿå¯ä»¥è¿™æ ·ï¼š\n123456789101112131415//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++17#includeÂ &lt;stdio.h&gt;structÂ XÂ &#123;Â Â voidÂ foo()Â &#123;Â printf(\"foo\\n\");Â &#125;Â Â voidÂ xoo()Â &#123;Â Â Â Â autoÂ fÂ =Â [&amp;,*this]()Â mutableÂ &#123;Â foo();Â &#125;;Â Â Â Â f();Â Â &#125;&#125;;intÂ main()Â &#123;Â Â X().xoo();Â Â returnÂ 0;&#125;\nä½¿ç”¨â€œ*thisâ€æ—¶çš„â€œfâ€æ ·å­å¦‚ä¸‹ï¼š\n123typeÂ =Â structÂ X::&lt;lambda()&gt;Â &#123;Â Â Â Â XÂ __this;Â //Â Xç±»å‹çš„å¯¹è±¡ï¼ˆéæŒ‡é’ˆï¼‰&#125;\n6.Â ç¤ºä¾‹5\nç»§ç»­ç ”ç©¶ï¼Œä½¿ç”¨C++Â RTTIï¼ˆRun-TimeÂ TypeÂ Identificationï¼Œè¿è¡Œæ—¶ç±»å‹è¯†åˆ«ï¼‰è®¾æ–½â€œtypeidâ€æŸ¥çœ‹Lambdaå‡½æ•°ï¼š\n123456789101112131415//Â g++Â -gÂ -oÂ a1Â a1.cppÂ -std=c++11#includeÂ &lt;stdio.h&gt;#includeÂ &lt;typeinfo&gt;structÂ XÂ &#123;Â Â voidÂ xoo()Â &#123;Â Â Â Â autoÂ fÂ =Â []Â &#123;Â printf(\"f\\n\");Â &#125;;Â Â Â Â printf(\"%s\\n\",Â typeid(f).name());Â Â Â Â //Â æ³¨ï¼štypeidè¿”å›å€¼ç±»å‹ä¸ºâ€œstd::type_infoâ€Â Â &#125;&#125;;intÂ main()Â &#123;Â Â X().xoo();Â Â returnÂ 0;&#125;\nè¿è¡Œè¾“å‡ºï¼š\nZN1X3xooEvEUlvE_\n7. åŒ¿åç±»è§„åˆ™\nç¼–è¯‘å™¨ä¸ºLambdaç”Ÿæˆçš„åŒ¿åç±»è§„åˆ™ï¼ˆä¸åŒæ ‡å‡†æœ‰åŒºåˆ«ï¼‰ï¼š\n\t\t\tæ„é€ å‡½æ•°\t\t\tæ‹·è´æ„é€ å‡½æ•°\t\t\t\t\t\t\t\t\tClosureType()&nbsp;=&nbsp;delete;\t\t\t\t\t\t\t\t\tC++14å‰\t\t\t\t\t\t\t\tClosureType()&nbsp;=&nbsp;default;\t\t\t\t\t\t\t\t\tC++20èµ·ï¼Œ\t\t\tä»…å½“æœªæŒ‡å®šä»»ä½•ä¿˜è·æ—¶\t\t\t\t\t\t\t\tClosureType(const&nbsp;ClosureType&amp;&nbsp;)&nbsp;=&nbsp;default;\t\t\t\t\t\t\t\t\tC++14èµ·\t\t\t\t\t\t\t\tClosureType(ClosureType&amp;&amp;&nbsp;)&nbsp;=&nbsp;default;\t\t\t\t\t\t\t\t\tC++14èµ·\t\t\t\t\t\t\t\tæ‹·è´å¤åˆ¶å‡½æ•°\t\t\t\t\t\t\t\t\tClosureType&amp;&nbsp;operator=(const&nbsp;ClosureType&amp;)&nbsp;=&nbsp;delete;\t\t\t\t\t\t\t\t\tC++20å‰\t\t\t\t\t\t\t\tClosureType&amp;&nbsp;operator=(const&nbsp;ClosureType&amp;)&nbsp;=&nbsp;default;\t\t\tClosureType&amp;&nbsp;operator=(ClosureType&amp;&amp;)&nbsp;=&nbsp;default;\t\t\t\t\t\t\t\t\tC++20èµ·ï¼Œ\t\t\tä»…å½“æœªæŒ‡å®šä»»ä½•ä¿˜è·æ—¶\t\t\t\t\t\t\t\tClosureType&amp;&nbsp;operator=(const&nbsp;ClosureType&amp;)&nbsp;=&nbsp;delete;\t\t\t\t\t\t\t\t\tC++20èµ·ï¼Œå…¶ä»–æƒ…å†µ\t\t\t\t\t\t\t\tææ„å‡½æ•°\t\t\t\t\t\t\t\t\t~ClosureType()&nbsp;=&nbsp;default;\t\t\t\t\t\t\t\t\tææ„å‡½æ•°æ˜¯éšå¼å£°æ˜çš„\t\t\t\t\t\nå¯¹äºæ ‡è®°ä¸ºâ€œdeleteâ€çš„å‡½æ•°æ˜¯ä¸èƒ½è°ƒç”¨çš„ï¼Œå¦‚ä¸‹åˆ—ä»£ç ä¸­çš„â€œf2Â =Â f1;â€å°†è§¦å‘ç¼–è¯‘é”™è¯¯ï¼š\n1234567891011intÂ main()Â &#123;Â Â autoÂ f1Â =Â []&#123;&#125;;Â Â autoÂ f2Â =Â f1;Â Â f2Â =Â f1;Â Â returnÂ 0;&#125;\nä¸Šåˆ—ä»£ç åœ¨C11ã€C14å’ŒC17å‡ä¼šæŠ¥é”™ã€‚ä¸è¿‡å¦‚è§„åˆ™æ‰€ç¤ºï¼ŒC20ï¼ˆå«C++2aï¼‰ä¸Šåˆ™å¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼š\n1234567a3.cpp:Â InÂ functionÂ 'intÂ main()':a3.cpp:4:8:Â error:Â useÂ ofÂ deletedÂ functionÂ 'main()::&lt;lambda()&gt;&amp;Â main()::&lt;lambda()&gt;::operator=(constÂ main()::&lt;lambda()&gt;&amp;)'Â Â Â Â 4Â |Â Â Â f2Â =Â f1;Â Â Â Â Â Â |Â Â Â Â Â Â Â Â ^~a3.cpp:2:14:Â note:Â aÂ lambdaÂ closureÂ typeÂ hasÂ aÂ deletedÂ copyÂ assignmentÂ operatorÂ Â Â Â 2Â |Â Â Â autoÂ f1Â =Â []&#123;&#125;;Â Â Â Â Â Â |Â Â Â Â Â Â Â Â Â Â Â Â Â Â ^\nå¸Œæœ›é€šè¿‡æœ¬æ–‡ï¼Œå¯¹ç†è§£Lambdaæœ‰æ‰€å¸®åŠ©ã€‚\n8.Â å‚è€ƒèµ„æ–™\n\n\n1)Â https://zh.cppreference.com/w/cpp/language/lambda\n\n\n2)Â https://docs.microsoft.com/en-us/cpp/cpp/lambda-expressions-in-cpp?view=vs-2019\n\n\n3)Â https://en.cpprefeence.com/w/cpp/language/lambda\n\n\n4)Â https://stackoverflow.com/questions/7627098/what-is-a-lambda-expression-in-c11\n\n\n5)Â https://www.cprogramming.com/c11/c11-lambda-closures.html\n\n\n\n\n            ä½œè€…ï¼šä¸€è§æ¥æºï¼šCSDNåŸæ–‡ï¼šhttps://blog.csdn.net/Aquester/article/details/90691479\n          \n","thumbnail":"/posts/Lambda/lambda.png","plink":"https://shuntan.github.io/posts/Lambda/"},{"title":"C++ æ¨¡æ¿åç‰¹åŒ–ï¼æ¥è‡ªSTLçš„æ€è€ƒ","date":"2019-05-31T06:29:52.000Z","date_formatted":{"ll":"May 31, 2019","L":"05/31/2019","MM-DD":"05-31"},"updated":"2020-04-22T11:20:30.342Z","content":"ä¹‹å‰å­¦ä¹ STLæ—¶æ¥è§¦è¿‡ä¸€æ®µæ—¶é—´çš„æ¨¡æ¿ï¼Œæ¨¡æ¿æ˜¯C++æ³›å‹ç¼–ç¨‹ç¼–ç¨‹çš„åŸºç¡€\nSTLä»å¤´åˆ°å°¾éƒ½æ˜¯æ¨¡æ¿æ³›å‹ç¼–ç¨‹ï¼Œæˆ‘è§‰å¾—ç”¨çš„æœ€å·§å¦™çš„å°±æ˜¯åœ¨traitsèƒå–æŠ€å·§æ—¶ç”¨åˆ°çš„æ¨¡æ¿åç‰¹åŒ–\n\n\nå…ˆç®€è¦å›é¡¾ä¸€ä¸‹æ¨¡æ¿å§ï¼Œæ¨¡æ¿ä¸»è¦åˆ†ä¸ºå‡½æ•°æ¨¡æ¿ä¸ç±»æ¨¡æ¿\n\nå‡½æ•°æ¨¡æ¿\n12345678910template&lt;class T&gt;T add(T a, T b) &#123; return a + b;&#125;int main()&#123;    int a = 1, b = 2;    std::cout &lt;&lt; add(a + b) &lt;&lt; std::endl;    return 0;&#125;\n\nå¦‚ä¸Šå°±æ˜¯æœ€ç®€å•çš„å‡½æ•°æ¨¡æ¿ï¼Œå½“å®ä¾‹åŒ–å‡½æ•°æ¨¡æ¿æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è¿›è¡Œå®å‚ç±»å‹æ¨å¯¼\nä¸Šé¢ç±»å‹Tå°±è¢«è‡ªåŠ¨æ¨å¯¼ä¸ºintç±»å‹\nç±»æ¨¡æ¿\n12345678910111213141516templete&lt;class T&gt;class A&#123;public:    explicit A(T val) : t(val) &#123; &#125;    T add(T x) &#123; return t + y; &#125;    privete:    T t;&#125;;int main()&#123;    A&lt;int&gt; a(10);    std::cout &lt;&lt; a.add(5) &lt;&lt; std::endl;    return 0;&#125;\nå¦‚ä¸Šå°±æ˜¯æœ€ç®€å•çš„ç±»æ¨¡æ¿ï¼Œå®ä¾‹åŒ–ç±»æ¨¡æ¿å¿…é¡»è¦æŒ‡å®šç±»å‹ï¼Œç¼–è¯‘å™¨æ— æ³•ä¸ºç±»æ¨¡æ¿è‡ªåŠ¨æ¨å¯¼ç±»å‹\nå‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹\n\n\nï¼‘ï¼ç±»æ¨¡æ¿çš„å’Œå‡½æ•°æ¨¡æ¿éƒ½å¿…é¡»å®šä¹‰åœ¨.hå¤´æ–‡ä»¶ä¸­\n\n\nï¼’ï¼æ¨¡æ¿çš„å®ä¾‹åŒ–ç±»å‹ç¡®å®šæ˜¯åœ¨ç¼–è¯‘æœŸé—´\n\n\nï¼“ï¼åªæ˜¯æ¨¡æ¿å†™å¥½äº†ï¼Œç¼–è¯‘ä¸€èˆ¬ä¸ä¼šå¾ˆå¤šå‡ºé”™ï¼Œå‡ºé”™ä¸€èˆ¬ä¼šåœ¨å®ä¾‹åŒ–ç¼–è¯‘ä¹‹å\n\n\nï¼”ï¼æ¨¡æ¿å®ä¾‹åŒ–åªä¼šå®ä¾‹åŒ–ç”¨åˆ°çš„éƒ¨åˆ†ï¼Œæ²¡æœ‰ç”¨åˆ°çš„éƒ¨åˆ†å°†ä¸ä¼šè¢«å®ä¾‹åŒ–\n\n\n\næˆ‘è§‰å¾—æ¨¡æ¿çš„ç‰¹ä¾‹åŒ–æ˜¯æ¨¡æ¿ä¸­æ¯”è¾ƒç²¾é«“çš„ä¸œè¥¿\næœ‰å‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼Œç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼Œå…¶ä¸­åˆåˆ†ä¸ºå…¨ç‰¹åŒ–ä¸åç‰¹åŒ–\nä¸»è¦çš„ç”¨é€”éƒ½æ˜¯å¯¹äºç‰¹å®šçš„ç±»å‹ï¼ŒæŒ‡å®šç‰¹å®šçš„å¤„ç†æ–¹å¼\nå°±ç›¸å½“äºæ™®é€šç¼–ç¨‹ä¸­if-else if - elseè¿™æ ·çš„æ–¹å¼\nç¼–è¯‘é˜¶æ®µç¡®å®šå¦‚æœæ˜¯æŸä¸ªç‰¹åŒ–ç±»å‹ï¼Œå°±ç”¨ç‰¹åŒ–çš„æ¨¡æ¿\nå¦‚æœéƒ½ä¸æ˜¯ï¼Œå°±ç”¨æœ€ä¸€èˆ¬çš„æ¨¡æ¿\nå‡½æ•°æ¨¡æ¿ç‰¹ä¾‹åŒ–\nå‡½æ•°æ¨¡æ¿åªèƒ½å…¨ç‰¹åŒ–ï¼Œä¸èƒ½åç‰¹åŒ–ï¼Œå¦‚æœè¦åç‰¹åŒ–çš„è¯åªèƒ½é‡è½½\nå‡½æ•°æ¨¡æ¿å…¨ç‰¹åŒ–\n1234567891011template&lt; &gt;                                  // å…¨ç‰¹åŒ–ã€€æ³¨æ„è¯­æ³•double add(double a, double b)  &#123; return a + b; &#125;int main()&#123;    int x = 10, y = 20;    double z = 1.1, w = 2.2;    std::cout &lt;&lt; add(x, y) &lt;&lt; std::endl;   // è°ƒç”¨æ™®é€šç‰ˆæœ¬    std::cout &lt;&lt; add(z, w) &lt;&lt; std::endl;   // è°ƒç”¨å…¨ç‰¹åŒ–ç‰ˆæœ¬    return 0;&#125;\nå¦‚æœæœ‰ä¸å®å‚æ›´åŠ åŒ¹é…çš„ç‰¹ä¾‹åŒ–ç‰ˆæœ¬ï¼Œç¼–è¯‘å™¨å°†ä¼šé€‰æ‹©ç‰¹ä¾‹åŒ–ç‰ˆæœ¬\nå‡½æ•°æ¨¡æ¿é‡è½½ï¼ˆä¸å­˜åœ¨åç‰¹åŒ–ï¼‰\nå› ä¸ºåç‰¹åŒ–ç‰ˆæœ¬æœ¬è´¨ä¸Šä»ç„¶æ˜¯æ¨¡æ¿ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦çš„è¯ï¼Œå¯ä»¥é‡è½½ä¸€ä¸ªå‡½æ•°æ¨¡æ¿\n12345678910template&lt;class T1&gt;ã€€ã€€// é‡è½½ç‰ˆæœ¬ï¼Œæ¥æ”¶å‚æ•°ä¸ºæŒ‡é’ˆT1 add(T1* a, T1* b) &#123; return *a + *b; &#125;   int main()&#123;    int a = 10, b = 20;    int *x = &amp;a, *y = &amp;b;    add(a, b);    // è°ƒç”¨æ™®é€šæ¨¡æ¿    add(x, y);ã€€  // è°ƒç”¨é‡è½½çš„æ¨¡æ¿    return 0;&#125;\nå¦‚ä¸Šï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªæ¥æ”¶æŒ‡é’ˆçš„åç‰¹åŒ–ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨é‡è½½æ¨¡æ¿å®ç°\nå‡½æ•°æ¨¡æ¿ä¸å­˜åœ¨åç‰¹åŒ–\nç±»æ¨¡æ¿ç‰¹ä¾‹åŒ–\nç±»æ¨¡æ¿æ—¢æœ‰å…¨ç‰¹åŒ–ï¼Œåˆæœ‰åç‰¹åŒ–\nè¿™é‡Œé‡æ–°å†™ä¸€ä¸ªæ›´ä¸€èˆ¬çš„æ¨¡æ¿ç±»æ¥è¯´æ˜ç±»æ¨¡æ¿çš„ç‰¹ä¾‹åŒ–\nç±»æ¨¡æ¿å…¨ç‰¹åŒ–æ¯”è¾ƒå¥½ç†è§£ï¼Œè·Ÿå‡½æ•°æ¨¡æ¿ä¸€æ ·ï¼Œå…¨ç‰¹åŒ–æ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œå½“ç¼–è¯‘å™¨åŒ¹é…æ—¶ä¼šä¼˜å…ˆåŒ¹é…å‚æ•°ä¸€è‡´çš„å®ä¾‹\n123456789template&lt; &gt;     ã€€ã€€ã€€// æ³¨æ„è¯­æ³•class A&lt;char*&gt;       // ä¸€ä¸ªå…¨ç‰¹åŒ–çš„æ¨¡æ¿ç±»A&#123;                    // å½“ç”¨char*ç±»å‹æ¥å®ä¾‹åŒ–ç±»æ¨¡æ¿Aæ—¶ï¼Œå°†ä¼šä¼˜å…ˆè°ƒç”¨è¿™ä¸ªå…¨ç‰¹åŒ–å®ä¾‹public:    explicit A(char* val) : t(val) &#123; &#125;    char* add(char* a, char* b) &#123; return strcat(a, b); &#125;private:    char* t;&#125;;\nç±»æ¨¡æ¿çš„åç‰¹åŒ–\nç±»æ¨¡æ¿çš„åç‰¹åŒ–ä¼šç¨å¾®å¤æ‚ä¸€ç‚¹ç‚¹ï¼Œå®ƒæœ‰å¤šç§å½¢å¼\nç±»æ¨¡æ¿åç‰¹åŒ–æœ¬è´¨ä¸Šéƒ½æ˜¯æŒ‡å®šéƒ¨åˆ†ç±»å‹ï¼Œè®©åç‰¹åŒ–ç‰ˆæœ¬ç§°ä¸ºæ™®é€šç‰ˆæœ¬çš„å­é›†ï¼Œè‹¥å®ä¾‹åŒ–æ—¶å‚æ•°ç±»å‹ä¸ºæŒ‡å®šçš„ç±»å‹ï¼Œåˆ™ä¼˜å…ˆè°ƒç”¨ç‰¹ä¾‹åŒ–ç‰ˆæœ¬\nç¬¬ä¸€ç§å½¢å¼\n12345template&lt;class T1, class T2&gt;      // æ™®é€šç‰ˆæœ¬ï¼Œæœ‰ä¸¤ä¸ªæ¨¡æ¿å‚æ•°class B &#123; ..... &#125;;template&lt;class T2&gt;ã€€ã€€ã€€         // åç‰¹åŒ–ç‰ˆæœ¬ï¼ŒæŒ‡å®šå…¶ä¸­ä¸€ä¸ªå‚æ•°ï¼Œå³æŒ‡å®šäº†éƒ¨åˆ†ç±»å‹class B&lt;int , T2&gt; &#123; ..... &#125;;ã€€ã€€// å½“å®ä¾‹åŒ–æ—¶çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºint åˆ™ä¼šä¼˜å…ˆè°ƒç”¨è¿™ä¸ªç‰ˆæœ¬\nç¬¬äºŒç§å½¢å¼ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ç‰ˆæœ¬\n12345678template&lt;class T&gt;     // æ™®é€šç‰ˆæœ¬class B &#123; ..... &#125;;template&lt;class T&gt;ã€€ã€€ã€€//è¿™ä¸ªåç‰¹åŒ–ç‰ˆæœ¬åªæ¥æ”¶æŒ‡é’ˆç±»å‹çš„æ¨¡æ¿å®å‚ class B&lt;T*&gt; &#123; ..... &#125;; template&lt;class T&gt;class B&lt;T&amp;&gt; &#123; ..... &#125;;     // è¿™ä¸ªåç‰¹åŒ–ç‰ˆæœ¬åªæ¥å—å¼•ç”¨ç±»å‹çš„æ¨¡æ¿å®å‚\nç¬¬ä¸‰ç§å½¢å¼\n12345template&lt;class T&gt;    //æ™®é€šç‰ˆæœ¬class B &#123; ..... &#125;;template&lt;class T&gt;ã€€ã€€ã€€// è¿™ç§åªæ¥å—ç”¨Tå®ä¾‹åŒ–çš„vectorçš„æ¨¡æ¿å®å‚ï¼ä¹Ÿæ˜¯ä¸€ç§åç‰¹åŒ–class B&lt;vector&lt;T&gt;&gt; &#123; ......  &#125;;\nå‡ ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹\n\nï¼‘ï¼ç‰¹ä¾‹åŒ–æœ¬è´¨ä¸Šæ˜¯æˆ‘ä»¬é¡¶æ›¿äº†ç¼–è¯‘å™¨çš„å·¥ä½œï¼Œæˆ‘ä»¬å¸®ç¼–è¯‘å™¨åšäº†ç±»å‹æ¨å¯¼\nï¼’ï¼å…¨ç‰¹åŒ–æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®ä¾‹ï¼Œè€Œåç‰¹åŒ–æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œåªæ˜¯åŸæ¥æ¨¡æ¿çš„ä¸€ä¸ªå­é›†\nï¼“ï¼æ‰€ä»¥å…¨ç‰¹åŒ–çš„å‡½æ•°æ¨¡æ¿ï¼Œæœ¬è´¨ä¸Šæ˜¯å®ä¾‹ï¼Œä»è€Œä¸ä¼šä¸å‡½æ•°æ¨¡æ¿äº§ç”ŸäºŒä¹‰æ€§\nï¼”ï¼è‹¥æƒ³è®©ç”¨æˆ·èƒ½ä½¿ç”¨ç‰¹ä¾‹åŒ–ç‰ˆæœ¬ï¼Œç‰¹ä¾‹åŒ–ç‰ˆæœ¬å¿…é¡»ä¸æ¨¡æ¿å®šä¹‰åœ¨åŒä¸€ä¸ª.hå¤´æ–‡ä»¶ä¸­\n\n\nSTLä¸­çš„è¿­ä»£å™¨å®ç°ä¸é«˜æ•ˆå®ç°ä¸æ¨¡æ¿åç‰¹åŒ–æ¯æ¯ç›¸å…³ï¼\nç±»æ¨¡æ¿åç‰¹åŒ–ä¸STL\nåç‰¹åŒ–åœ¨STLä¸­æœ€é‡è¦çš„ä¸¤ä¸ªåº”ç”¨\nï¼‘ï¼åº”ç”¨åœ¨è¿­ä»£å™¨è®¾è®¡ä¸­ï¼Œä¸ºäº†ä½¿è¿­ä»£å™¨æ—¢å¯ä»¥èƒå–å‡ºå€¼ç±»å‹ï¼Œåˆå¯ä»¥åŒ…å®¹åŸç”ŸæŒ‡é’ˆ\nå¦‚æœè¦é€šè¿‡ä¸€ä¸ªè¿­ä»£å™¨å°±èƒ½çŸ¥é“å®ƒçš„å€¼ç±»å‹ï¼Œé‚£ä¹ˆä¸€èˆ¬ä¼šä½¿ç”¨iterator_traits\nè¿­ä»£å™¨èƒå–æŠ€æœ¯çš„ä¸¤ä¸ªæ ¸å¿ƒæ˜¯ï¼š\n\nï¼‘ï¼‰åœ¨æ¯ä¸ªè¿­ä»£å™¨ç±»ä¸­å®šä¹‰value_typeå€¼ç±»å‹çš„ç±»å‹æˆå‘˜ï¼Œè¿™æ ·ç›´æ¥é€šè¿‡è¿­ä»£å™¨çš„value_typeç±»å‹æˆå‘˜å°±å¯ä»¥çŸ¥é“å€¼ç±»å‹\nï¼’ï¼‰é—®é¢˜å°±åœ¨äºï¼Œè¿­ä»£å™¨å¿…é¡»å…¼å®¹åŸç”ŸæŒ‡é’ˆï¼Œè€ŒåŸç”ŸæŒ‡é’ˆå¾ˆéš¾è¢«é‡æ–°å®šä¹‰ï¼Œå³è¦åœ¨åŸç”ŸæŒ‡é’ˆçš„ç±»ä¸­æ·»åŠ value_typeçš„å€¼ç±»å‹çš„ç±»å‹æˆå‘˜ï¼è¿™æ—¶å€™ï¼Œé çš„å°±æ˜¯ç±»æ¨¡æ¿çš„åç‰¹åŒ–äº†ï¼æ–°æ·»åŠ ä¸€å±‚iterator_traitsç±»ï¼Œä¸“é—¨èƒå–è¿­ä»£å™¨çš„å±æ€§ï¼Œç„¶åå†å¯¹iterator_traitsç±»è®¾è®¡åŸç”ŸæŒ‡é’ˆä¸åŸç”Ÿå¼•ç”¨çš„åç‰¹åŒ–ç‰ˆæœ¬ï¼Œå°±è§£å†³äº†è¿™ä¸ªæ£˜æ‰‹çš„é—®é¢˜\n\nï¼’ï¼ type_traitsç±»å‹èƒå–ï¼Œå¯¹å¾…ç‰¹æ®Šç±»å‹ï¼Œç‰¹æ®Šå¤„ç†ï¼Œæé«˜æ•ˆç‡\nå¯¹äºæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œææ„å‡½æ•°ç­‰çš„å†…ç½®ç±»å‹ï¼Œå¦‚æœä¸å¤æ‚ç±»å‹ä¸€æ ·ï¼Œæ‰§è¡ŒåŒæ ·çš„æ“ä½œï¼Œæ˜¾ç„¶æ˜¯æ•ˆç‡ä¸é«˜çš„\nå…ˆå®ç°ä¸€ä¸ªå¯¹æ‰€æœ‰ç±»å‹éƒ½è®¾ç½®ä¸€ä¸ªæœ€ä¿å®ˆå€¼çš„type_traitsæ¨¡æ¿ç±»ï¼Œç„¶åå†å¯¹æ¯ä¸ªå†…ç½®ç±»å‹è®¾ç½®åç‰¹åŒ–ç‰ˆæœ¬ï¼Œå†…ç½®ç±»å‹è®¾ç½®ä¸€ä¸ªæ›´ä¸ºæ¿€è¿›çš„å€¼ï¼Œè¡¨æ˜å¯ä»¥é‡‡å–æ›´ä¸ºé«˜æ•ˆçš„æ“ä½œæ¥æé«˜æ•ˆç‡\næ¯”å¦‚copyå‡½æ•°ï¼Œå¦‚æœä¼ é€’çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¤æ‚ç±»å‹ï¼Œé‚£ä¹ˆå¯èƒ½åªèƒ½é‡‡å–æœ€ä¿å®ˆçš„å¤„ç†æ–¹å¼ï¼Œä¸€ä¸ªä¸€ä¸ªçš„æ„é€ ï¼›å¦‚æœæ˜¯å†…ç½®ç±»å‹ï¼Œè¿™æ ·æ˜¾ç„¶å¤ªä½æ•ˆï¼Œä½¿ç”¨memcpy()å¯èƒ½ä¼šå¥½ä¸€äº›\nå…¶å®iterator_traitsä¹Ÿä¸æ­¢æ˜¯å¤„ç†å…¼å®¹åŸç”ŸæŒ‡é’ˆçš„é—®é¢˜ï¼Œå®ƒä¹Ÿå¯ä»¥æé«˜æ•ˆç‡ï¼\nè¿­ä»£å™¨åˆ†ä¸ºå¾ˆå¤šç§ï¼Œæœ‰å¯ä»¥éšæœºè®¿é—®çš„ï¼ˆvectorï¼‰ï¼Œæœ‰åªèƒ½å‰åä¸€ä¸ªä¸€ä¸ªç§»åŠ¨çš„ï¼ˆlistï¼‰,ä¹Ÿæœ‰åªèƒ½å•å‘ç§»åŠ¨çš„ï¼ˆslistï¼‰ï¼Œæ‰€ä»¥ä¸€èˆ¬æŠŠè¿­ä»£å™¨åˆ†ä¸ºäº”ç§ï¼š\n\nInputIteratorã€€ã€€ã€€ã€€ã€€ã€€ã€€è¾“å…¥è¿­ä»£å™¨\nOutputIterator ã€€ã€€ã€€ã€€ã€€ ã€€è¾“å‡ºè¿­ä»£å™¨\nForwardIteratorã€€ã€€ã€€ã€€ã€€ã€€å•å‘è¿­ä»£å™¨\nBidirectionIteratorã€€ã€€ã€€ã€€ã€€åŒå‘è¿­ä»£å™¨\nRandomAccessIteratorã€€ã€€ã€€éšæœºè®¿é—®è¿­ä»£å™¨\n\næ¯”å¦‚ä¸€ä¸ªadvance(n)å‡½æ•°ï¼Œå¯¹äºå•å‘è¿­ä»£å™¨åªèƒ½ä¸€ä¸ªä¸€ä¸ªç§»åŠ¨è¿‡å»ï¼Œä½†æ˜¯è¿™ç§å®ç°å¯¹äºéšæœºè®¿é—®è¿­ä»£å™¨æ˜¾ç„¶ä¸æ˜¯ç†æƒ³çš„å¤„ç†æ–¹å¼\nå¤„ç†çš„æ–¹å¼å°±æ˜¯å…ˆå®ç°è¿™äº”ä¸ªç±»ï¼Œç”¨ä½œæ ‡è®°ç”¨ï¼Œåœ¨æ¯ä¸ªè¿­ä»£å™¨é‡Œé¢éƒ½å®šä¹‰è¿­ä»£å™¨ç±»å‹çš„ç±»å‹æˆå‘˜iterator_catagoryï¼Œå†å¯¹ä¸åŒç‰ˆæœ¬çš„è¿­ä»£å™¨å®ç°ä¸åŒçš„advance(n)å¤„ç†æ–¹å¼\næ¯”å¦‚stlä¸­æ·»åŠ å³å€¼å¼•ç”¨å…ƒæ¨¡æ¿çš„å®ç°ï¼š\n1234567891011121314template&lt;typename _Tp,\t\t   bool = __and_&lt;__not_&lt;is_reference&lt;_Tp&gt;&gt;,\t\t   \t\t\t\t\t__not_&lt;is_void&lt;_Tp&gt;&gt;&gt;::value&gt;\tstruct __add_rvalue_reference_helper\t&#123;typedef __Tp   type; &#125;;template&lt;typename _Tp&gt;\tstruct __add_rvalue_reference_helper&lt;__Tp, true&gt;\t&#123;typedef __Tp&amp;&amp;  type; &#125;;\ttemplate&lt;typename _Tp&gt;struct add_rvalue_reference: public __add_rvalue_reference_helper&lt;_Tp&gt;&#123; &#125;;\nå¯ä»¥å‘ç°è°ƒç”¨æ—¶ä¸€èˆ¬ä¸ºstatic_cast&lt;typenameadd_rvalue_reference&lt;T&gt;::type&gt;(__t),é¦–å…ˆä¼šåŒ¹é…æ³›åŒ–ç‰ˆæœ¬çš„å…ƒæ¨¡æ¿ç±»ï¼Œç¬¬äºŒä¸ªæ¨¡ç‰ˆå‚æ•°boolä¼šåŒ¹é…_Tpçš„ç±»å‹ï¼Œå¦‚æœåŸæ¥ä¸æ˜¯å¼•ç”¨ç±»å‹çš„è¯å°±ç›´æ¥åŒ¹é…trueçš„åç‰¹åŒ–ç‰ˆæœ¬ï¼ˆä¼˜å…ˆçº§é«˜ï¼‰ï¼Œå¦åˆ™falseä¸ºåŸæ³›åŒ–ç‰ˆæœ¬ã€‚\nçŸ­çŸ­å‡ è¡Œä»£ç å·²ç»å±•ç¤ºå‡ºäº†æ¨¡æ¿å/å…¨ç‰¹åŒ–çš„å¼ºå¤§åŒ¹é…åŠŸèƒ½ï¼\n","thumbnail":"/posts/æ¨¡æ¿ç‰¹åŒ–/github-badge.png","plink":"https://shuntan.github.io/posts/æ¨¡æ¿ç‰¹åŒ–/"},{"title":"C++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘","date":"2019-05-29T02:05:19.000Z","date_formatted":{"ll":"May 29, 2019","L":"05/29/2019","MM-DD":"05-29"},"updated":"2020-04-22T07:26:24.324Z","content":"C++ä¸­çš„ä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘\n\né˜…è¯»è¿™ç¯‡åšæ–‡éœ€è¦äº†è§£Cä¸­çš„å·¦å€¼ï¼ˆlvalueï¼‰å’Œå³å€¼ï¼ˆrvalueï¼‰çš„æ¦‚å¿µï¼Œè¯¦æƒ…å‚è§æˆ‘çš„å¦å¤–ä¸€ç¯‡åšæ–‡ï¼šCç§»åŠ¨è¯­ä¹‰åŠæ‹·è´ä¼˜åŒ–\nä¸‡èƒ½å¼•ç”¨å’Œå®Œç¾è½¬å‘å¤šæ¶‰åŠåˆ°æ¨¡æ¿çš„ä½¿ç”¨ï¼Œå¦‚è‹¥ä¸æ˜¯è‡ªå·±å†™æ¨¡æ¿ï¼Œåˆ™å¯ä¸ç”¨å…³å¿ƒ\n\n\nå·¦å€¼ä¸å³å€¼çš„åŒºåˆ†\né¦–å…ˆç†è§£ä»€ä¹ˆæ˜¯å³å€¼å¼•ç”¨ï¼ˆä¸‹é¢æ˜¯ç™¾åº¦ç™¾ç§‘ç»™å‡ºçš„è§£é‡Šï¼‰ï¼š\nå³å€¼å¼•ç”¨ï¼ˆåŠå…¶æ”¯æŒçš„Moveè¯­æ„å’Œå®Œç¾è½¬å‘ï¼‰æ˜¯C0xå°†è¦åŠ å…¥çš„æœ€é‡å¤§è¯­è¨€ç‰¹æ€§ä¹‹ä¸€ï¼Œè¿™ç‚¹ä»è¯¥ç‰¹æ€§çš„ææ¡ˆåœ¨C - State of the Evolutionåˆ—è¡¨ä¸Šé«˜å±…æ¦œé¦–ä¹Ÿå¯ä»¥çœ‹å¾—å‡ºæ¥ã€‚ä»å®è·µè§’åº¦è®²ï¼Œå®ƒèƒ½å¤Ÿå®Œç¾è§£å†³Cä¸­é•¿ä¹…ä»¥æ¥ä¸ºäººæ‰€è¯Ÿç—…çš„ä¸´æ—¶å¯¹è±¡æ•ˆç‡é—®é¢˜ã€‚ä»è¯­è¨€æœ¬èº«è®²ï¼Œå®ƒå¥å…¨äº†Cä¸­çš„å¼•ç”¨ç±»å‹åœ¨å·¦å€¼å³å€¼æ–¹é¢çš„ç¼ºé™·ã€‚ä»åº“è®¾è®¡è€…çš„è§’åº¦è®²ï¼Œå®ƒç»™åº“è®¾è®¡è€…åˆå¸¦æ¥äº†ä¸€æŠŠåˆ©å™¨ã€‚ä»åº“ä½¿ç”¨è€…çš„è§’åº¦è®²ï¼Œä¸åŠ¨ä¸€å…µä¸€å’ä¾¿å¯ä»¥è·å¾—â€œå…è´¹çš„â€æ•ˆç‡æå‡â€¦ ã€€ã€€åœ¨æ ‡å‡†Cè¯­è¨€ä¸­ï¼Œä¸´æ—¶é‡ï¼ˆæœ¯è¯­ä¸ºå³å€¼ï¼Œå› å…¶å‡ºç°åœ¨èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹ï¼‰å¯ä»¥è¢«ä¼ ç»™å‡½æ•°ï¼Œä½†åªèƒ½è¢«æ¥å—ä¸ºconst &amp;ç±»å‹ã€‚è¿™æ ·å‡½æ•°ä¾¿æ— æ³•åŒºåˆ†ä¼ ç»™const &amp;çš„æ˜¯çœŸå®çš„å³å€¼è¿˜æ˜¯å¸¸è§„å˜é‡ã€‚è€Œä¸”ï¼Œç”±äºç±»å‹ä¸ºconst &amp;ï¼Œå‡½æ•°ä¹Ÿæ— æ³•æ”¹å˜æ‰€ä¼ å¯¹è±¡çš„å€¼ã€‚C0xå°†å¢åŠ ä¸€ç§åä¸ºå³å€¼å¼•ç”¨çš„æ–°çš„å¼•ç”¨ç±»å‹ï¼Œè®°ä½œtypename &amp;&amp;ã€‚è¿™ç§ç±»å‹å¯ä»¥è¢«æ¥å—ä¸ºéconstå€¼ï¼Œä»è€Œå…è®¸æ”¹å˜å…¶å€¼ã€‚\nåŒºåˆ†å·¦å€¼ä¸å³å€¼ï¼š\nC++ 11ä¸­å¼•å…¥çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µå°±æ˜¯å³å€¼å¼•ç”¨ã€‚ç†è§£å³å€¼å¼•ç”¨æ˜¯å­¦ä¹ â€œç§»åŠ¨è¯­ä¹‰â€ï¼ˆmove semanticsï¼‰çš„åŸºç¡€ã€‚è€Œè¦ç†è§£å³å€¼å¼•ç”¨ï¼Œå°±å¿…é¡»å…ˆåŒºåˆ†å·¦å€¼ä¸å³å€¼ã€‚\nå¯¹å·¦å€¼å’Œå³å€¼çš„ä¸€ä¸ªæœ€å¸¸è§çš„è¯¯è§£æ˜¯ï¼šç­‰å·å·¦è¾¹çš„å°±æ˜¯å·¦å€¼ï¼Œç­‰å·å³è¾¹çš„å°±æ˜¯å³å€¼ã€‚\nä»€ä¹ˆæ˜¯å·¦å€¼å¼•ç”¨ï¼š\nåŒºåˆ†æ¸…æ¥šäº†å·¦å€¼ä¸å³å€¼ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹å·¦å€¼å¼•ç”¨ã€‚å·¦å€¼å¼•ç”¨æ ¹æ®å…¶ä¿®é¥°ç¬¦çš„ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºéå¸¸é‡å·¦å€¼å¼•ç”¨(eg.1 double &amp;r =i;)å’Œå¸¸é‡å·¦å€¼å¼•ç”¨(eg.1 const double &amp;r =i;)ã€‚\néå¸¸é‡å·¦å€¼å¼•ç”¨åªèƒ½ç»‘å®šåˆ°éå¸¸é‡å·¦å€¼ï¼Œä¸èƒ½ç»‘å®šåˆ°å¸¸é‡å·¦å€¼ã€éå¸¸é‡å³å€¼å’Œå¸¸é‡å³å€¼ã€‚å¦‚æœå…è®¸ç»‘å®šåˆ°å¸¸é‡å·¦å€¼å’Œå¸¸é‡å³å€¼ï¼Œåˆ™éå¸¸é‡å·¦å€¼å¼•ç”¨å¯ä»¥ç”¨äºä¿®æ”¹å¸¸é‡å·¦å€¼å’Œå¸¸é‡å³å€¼ï¼Œè¿™æ˜æ˜¾è¿åäº†å…¶å¸¸é‡çš„å«ä¹‰(eg.1ä¸­å°±æ˜¯å‡ºç°äº†éå¸¸é‡å·¦å€¼å¼•ç”¨ç»‘å®šåˆ°å¸¸é‡å³å€¼çš„æƒ…å†µ)ã€‚å¦‚æœå…è®¸ç»‘å®šåˆ°éå¸¸é‡å³å€¼ï¼Œåˆ™ä¼šå¯¼è‡´éå¸¸å±é™©çš„æƒ…å†µå‡ºç°ï¼Œå› ä¸ºéå¸¸é‡å³å€¼æ˜¯ä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œéå¸¸é‡å·¦å€¼å¼•ç”¨å¯èƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå·²ç»è¢«é”€æ¯äº†çš„ä¸´æ—¶å¯¹è±¡ã€‚\nå¸¸é‡å·¦å€¼å¼•ç”¨å¯ä»¥ç»‘å®šåˆ°æ‰€æœ‰ç±»å‹çš„å€¼ï¼ŒåŒ…æ‹¬éå¸¸é‡å·¦å€¼ã€å¸¸é‡å·¦å€¼ã€éå¸¸é‡å³å€¼å’Œå¸¸é‡å³å€¼ã€‚\nå¦‚æœåŒæ—¶åŒ…å«å·¦å€¼å’Œå³å€¼çš„å‡½æ•°é‡è½½ï¼Œå³å€¼ä¼šä¼˜å…ˆåŒ¹é…å³å€¼çš„é‡è½½ç‰ˆæœ¬ï¼Œå…¶æ¬¡åŒ¹é…å¸¸é‡å·¦å€¼é‡è½½ç‰ˆæœ¬ã€‚\nä¸‡èƒ½å¼•ç”¨ï¼ˆUniversal Referenceï¼‰\né¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š\n1234567891011121314151617#include &lt;iostream&gt;using std::cout;using std::endl;template&lt;typename T&gt;void func(T&amp; param) &#123;    cout &lt;&lt; param &lt;&lt; endl;&#125;int main() &#123;    int num = 2019;    func(num);    return 0;&#125;\nè¿™æ ·ä¾‹å­çš„ç¼–è¯‘è¾“å‡ºéƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¿®æ”¹æˆä¸‹é¢çš„è°ƒç”¨æ–¹å¼å‘¢ï¼Ÿ\n1234int main() &#123;    func(2019);    return 0;&#125;\nåˆ™ä¼šå¾—åˆ°ä¸€ä¸ªå¤§å¤§çš„ç¼–è¯‘é”™è¯¯ã€‚å› ä¸ºä¸Šé¢çš„æ¨¡æ¿å‡½æ•°åªèƒ½æ¥å—å·¦å€¼æˆ–è€…å·¦å€¼å¼•ç”¨ï¼ˆå·¦å€¼ä¸€èˆ¬æ˜¯æœ‰åå­—çš„å˜é‡ï¼Œå¯ä»¥å–åˆ°åœ°å€çš„ï¼‰ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥é‡è½½ä¸€ä¸ªæ¥å—å³å€¼çš„æ¨¡æ¿å‡½æ•°ï¼Œå¦‚ä¸‹ä¹Ÿå¯ä»¥è¾¾åˆ°æ•ˆæœã€‚\n1234567891011121314151617template&lt;typename T&gt;void func(T&amp; param) &#123;    cout &lt;&lt; \"ä¼ å…¥çš„æ˜¯å·¦å€¼\" &lt;&lt; endl;&#125;template&lt;typename T&gt;void func(T&amp;&amp; param) &#123;    cout &lt;&lt; \"ä¼ å…¥çš„æ˜¯å³å€¼\" &lt;&lt; endl;&#125;int main() &#123;    int num = 2019;    func(num);    func(2019);    return 0;&#125;\nè¾“å‡ºç»“æœï¼š\n12ä¼ å…¥çš„æ˜¯å·¦å€¼ä¼ å…¥çš„æ˜¯å³å€¼\nç¬¬ä¸€æ¬¡å‡½æ•°è°ƒç”¨çš„æ˜¯å·¦å€¼å¾—ç‰ˆæœ¬ï¼Œç¬¬äºŒæ¬¡å‡½æ•°è°ƒç”¨çš„æ˜¯å³å€¼ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œæœ‰æ²¡æœ‰åŠæ³•åªå†™ä¸€ä¸ªæ¨¡æ¿å‡½æ•°å³å¯ä»¥æ¥æ”¶å·¦å€¼åˆå¯ä»¥æ¥æ”¶å³å€¼å‘¢ï¼Ÿ\nâ€‹     C++ 11ä¸­æœ‰ä¸‡èƒ½å¼•ç”¨ï¼ˆUniversal Referenceï¼‰çš„æ¦‚å¿µï¼šä½¿ç”¨T&amp;&amp;ç±»å‹çš„å½¢å‚æ—¢èƒ½ç»‘å®šå³å€¼ï¼Œåˆèƒ½ç»‘å®šå·¦å€¼ã€‚åªæœ‰åœ¨æ¨¡ç‰ˆä¸­æ‰ç”Ÿæ•ˆï¼Œæ™®é€šå‡½æ•°ä¸­å·¦å€¼å¼•ç”¨ï¼ˆéå¸¸é‡ï¼‰åªæ¥å—å·¦å€¼ï¼Œå³å€¼å¼•ç”¨åªæ¥å—å³å€¼ï¼Œconst å·¦å€¼å¼•ç”¨å¯ä»¥æ¥å—ä»»ä½•å€¼ï¼Œconst å³å€¼å¼•ç”¨èƒ½æ¥å—ä»»ä½•å³å€¼ï¼Œæ¨å¯¼åçš„æ¨¡ç‰ˆä¹ŸåŒç†ã€‚\nä½†æ˜¯æ³¨æ„äº†ï¼šåªæœ‰å‘ç”Ÿç±»å‹æ¨å¯¼çš„æ—¶å€™ï¼ŒT&amp;&amp;æ‰è¡¨ç¤ºä¸‡èƒ½å¼•ç”¨ï¼› å¦åˆ™ï¼Œè¡¨ç¤ºå³å€¼å¼•ç”¨ã€‚\næ‰€ä»¥ï¼Œä¸Šé¢çš„æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¸ºï¼š\n123456789101112template&lt;typename T&gt;void func(T&amp;&amp; param) &#123;    cout &lt;&lt; param &lt;&lt; endl;&#125;int main() &#123;    int num = 2019;    func(num);    func(2019);    return 0;&#125;\nå¼•ç”¨æŠ˜å ï¼ˆUniversal Collapseï¼‰\nä¸‡èƒ½å¼•ç”¨è¯´å®Œäº†ï¼Œæ¥ç€æ¥èŠå¼•ç”¨æŠ˜å ï¼ˆUnivers Collapseï¼‰ï¼Œå› ä¸ºå®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰çš„æ¦‚å¿µæ¶‰åŠå¼•ç”¨æŠ˜å ã€‚ä¸€ä¸ªæ¨¡æ¿å‡½æ•°ï¼Œæ ¹æ®å®šä¹‰çš„å½¢å‚å’Œä¼ å…¥çš„å®å‚çš„ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä¸‹é¢å››ä¸­ç»„åˆï¼š\n\nå·¦å€¼-å·¦å€¼ T&amp; &amp;        # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å·¦å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å·¦å€¼å¼•ç”¨\nå·¦å€¼-å³å€¼ T&amp; &amp;&amp;      # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å·¦å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å³å€¼å¼•ç”¨ï¼ˆå¿…é¡»constä¿®é¥°ï¼‰\nå³å€¼-å·¦å€¼ T&amp;&amp; &amp;      # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å³å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å·¦å€¼å¼•ç”¨\nå³å€¼-å³å€¼ T&amp;&amp; &amp;&amp;    # å‡½æ•°å®šä¹‰çš„å½¢å‚ç±»å‹æ˜¯å³å€¼å¼•ç”¨ï¼Œä¼ å…¥çš„å®å‚æ˜¯å³å€¼å¼•ç”¨\n\nä½†æ˜¯C++ä¸­ä¸å…è®¸å¯¹å¼•ç”¨å†è¿›è¡Œå¼•ç”¨ï¼Œå¯¹äºä¸Šè¿°æƒ…å†µçš„å¤„ç†æœ‰å¦‚ä¸‹çš„è§„åˆ™ï¼š\næ‰€æœ‰çš„æŠ˜å å¼•ç”¨æœ€ç»ˆéƒ½ä»£è¡¨ä¸€ä¸ªå¼•ç”¨ï¼Œè¦ä¹ˆæ˜¯å·¦å€¼å¼•ç”¨ï¼Œè¦ä¹ˆæ˜¯å³å€¼å¼•ç”¨ã€‚è§„åˆ™æ˜¯ï¼šå¦‚æœä»»ä¸€å¼•ç”¨ä¸ºå·¦å€¼å¼•ç”¨ï¼Œåˆ™ç»“æœä¸ºå·¦å€¼å¼•ç”¨ã€‚å¦åˆ™ï¼ˆå³ä¸¤ä¸ªéƒ½æ˜¯å³å€¼å¼•ç”¨ï¼‰ï¼Œç»“æœä¸ºå³å€¼å¼•ç”¨ã€‚\nå³å°±æ˜¯å‰é¢ä¸‰ç§æƒ…å†µä»£è¡¨çš„éƒ½æ˜¯å·¦å€¼å¼•ç”¨ï¼Œè€Œç¬¬å››ç§ä»£è¡¨çš„å³å€¼å¼•ç”¨ã€‚\nå®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰\nä¸‹é¢æ¥ç€è¯´å®Œç¾è½¬å‘ï¼ˆPerfect Forwardingï¼‰ï¼Œé¦–å…ˆï¼Œçœ‹ä¸ªä¾‹å­ï¼š\nğŸŒ°[æ —å­]\nè¦äº†è§£å®Œç¾è½¬å‘ï¼Œå…ˆå¾—æ¸…æ¥šæ¨¡æ¿Tçš„æ¨å¯¼è¿‡ç¨‹ï¼Œåœ¨æ²¡æœ‰åç‰¹åŒ–çš„æ¨¡ç‰ˆå‰æä¸‹ï¼Œæ¨¡æ¿æ€»æ˜¯æ ¹æ®æœ€åŒ¹é…çš„è§„åˆ™æ¥æ¨å¯¼å‚æ•°ï¼Œå·¦å€¼å¼•ç”¨templateå‡½æ•°æ¨å¯¼å‡ºæ¥æ€»æ˜¯å·¦å€¼å¼•ç”¨å‡½æ•°ï¼Œå³å€¼å¼•ç”¨templateå‡½æ•°èƒ½æ¨å¯¼å‡ºå·¦å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨å‡½æ•°ï¼Œå¯ä»¥æ ¹æ®ä¸‹é¢çš„ä¾‹å­æ¥çœ‹å‡ºæ¨å¯¼è¿‡ç¨‹ã€‚\n1234567891011121314151617181920212223242526272829303132333435363738#include &lt;iostream&gt;using namespace std;template &lt;typename T&gt;void func(T&amp;&amp; arg) &#123;    //auto is_lval = std::is_lvalue_reference&lt;T&gt;::value;    //auto is_rval  = std::is_rvalue_reference&lt;T&gt;::value;    if(std::is_same&lt;T, int&gt;::value) &#123;        std::cout &lt;&lt; \"'T' is type[int]\"  &lt;&lt; \" arg:\" &lt;&lt; arg &lt;&lt; std::endl;    &#125;    else if(std::is_same&lt;T, const int&gt;::value) &#123;        std::cout &lt;&lt; \"'T' is type[const int]\" &lt;&lt; \" arg:\" &lt;&lt; arg &lt;&lt; std::endl;    &#125;    else if(std::is_same&lt;T, int&amp;&gt;::value) &#123;        std::cout &lt;&lt; \"'T' is type[int&amp;]\" &lt;&lt; \" arg:\" &lt;&lt; arg &lt;&lt; std::endl;    &#125;    else if(std::is_same&lt;T, const int&amp;&gt;::value) &#123;        std::cout &lt;&lt; \"'T' is type[const int&amp;]\" &lt;&lt; \" arg:\" &lt;&lt; arg &lt;&lt; std::endl;    &#125;        std::cout &lt;&lt; \"-----------------\" &lt;&lt; std::endl;&#125;int main() &#123;  int a = 1;  const int&amp; b = 2;  func(a);  //ä¼ å…¥å·¦å€¼å¼•ç”¨ T =&gt; int&amp;  func(b);  //ä¼ å…¥å¸¸é‡å·¦å€¼å¼•ç”¨ T =&gt; const int&amp;  func(3);  //ä¼ å…¥å³å€¼å¼•ç”¨ T =&gt; int  func(static_cast&lt;int&gt;(a));        //ä¼ å…¥è½¬æ¢åçš„å³å€¼å¼•ç”¨ T =&gt; int  func(static_cast&lt;int&amp;&gt;(a));       //ä¼ å…¥è½¬æ¢åçš„å·¦å€¼å¼•ç”¨ T =&gt; int&amp;  func(static_cast&lt;const int&amp;&amp;&gt;(a));//ä¼ å…¥è½¬æ¢åçš„å¸¸é‡å³å€¼ T =&gt; const int  func&lt;int&gt;(a);  //é”™è¯¯âŒ æ˜¾ç¤ºæŒ‡å®šæ¨¡ç‰ˆå½¢å‚ï¼Œæ¨å¯¼ååªèƒ½æ¥å—å³å€¼å¼•ç”¨ï¼Œè€Œaæ˜¯å·¦å€¼  func&lt;int&amp;&gt;(a); //ç¤ºæŒ‡å®šæ¨¡ç‰ˆå½¢å‚ï¼Œæ¨å¯¼ååªå¯æ¥å—å·¦å€¼å¼•ç”¨ï¼Œaæ˜¯å·¦å€¼  func&lt;const int&gt;(1); //ç¤ºæŒ‡å®šæ¨¡ç‰ˆå½¢å‚ï¼Œæ¨å¯¼ååªå¯æ¥å—å³å€¼ï¼Œä¸”ä¸èƒ½ä¿®æ”¹ï¼Œ1æ˜¯å³å€¼&#125;\nè¾“å‡ºç»“æœä¸ºï¼š\n123456789101112131415161718$g++ -std=c++11 -o main *.cpp$main'T' is type[int&amp;] arg:1-----------------'T' is type[const int&amp;] arg:2-----------------'T' is type[int] arg:3-----------------'T' is type[int] arg:1-----------------'T' is type[int&amp;] arg:1-----------------'T' is type[const int] arg:1-----------------'T' is type[int&amp;] arg:1-----------------'T' is type[const int] arg:1-----------------\né”™è¯¯ä¿¡æ¯ï¼š\n123main.cpp:6:6: note:   template argument deduction/substitution failed:main.cpp:35:14: note:   cannot convert â€˜aâ€™ (type â€˜intâ€™) to type â€˜int&amp;&amp;â€™   func&lt;int&gt;(a);\næ ¹æ®C++ Primerä¸­æ–‡ç‰ˆ(ç¬¬äº”ç‰ˆ) 18ç« ç¬¬2èŠ‚æ¨¡æ¿å®å‚æ¨æ–­\nNote:å¦‚æœæ˜¾ç¤ºæ¨å¯¼æ¨¡ç‰ˆTçš„ç±»å‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç¼–è¯‘ä¸è¿‡ï¼Œå› ä¸ºä¼šå¯¼è‡´æ¨åˆ°å‡ºæ¥çš„å‡½æ•°å®å‚å’Œå½¢å‚å¼•ç”¨ç±»å‹ä¸ä¸€è‡´\nstd::forward()\nstd::forwardå®Œç¾è½¬å‘è§£æ\n\nå®Œç¾è½¬å‘å®ç°äº†å‚æ•°åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ä¿æŒå…¶å€¼å±æ€§çš„åŠŸèƒ½ï¼Œå³è‹¥æ˜¯å·¦å€¼ï¼Œåˆ™ä¼ é€’ä¹‹åä»ç„¶æ˜¯å·¦å€¼ï¼Œè‹¥æ˜¯å³å€¼ï¼Œåˆ™ä¼ é€’ä¹‹åä»ç„¶æ˜¯å³å€¼ã€‚\nC++11 lets us perform perfect forwarding, which means that we can forward the parameters passed to a function template to another function call inside it without losing their own qualifiers (const-ref, ref, value, rvalue, etc.).\n\nstd::forward()è§£æ\nstd::forwardåªæœ‰åœ¨å®ƒçš„å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šçš„æ—¶å€™ï¼Œå®ƒæ‰è½¬æ¢å®ƒçš„å‚æ•°åˆ°ä¸€ä¸ªå³å€¼ã€‚\n12345678class Foo&#123;public:    std::string member;    template&lt;typename T&gt;    Foo(T&amp;&amp; member): member&#123;std::forward&lt;T&gt;(member)&#125; &#123;&#125;&#125;;\nå¯¹äºFooå‡½æ•°ä¸­memberå˜é‡ï¼Œæ— è®ºä¹‹å‰æ˜¯ä»€ä¹ˆï¼Œéƒ½å˜ä¸ºå·¦å€¼äº†ï¼Œå› ä¸ºä»–æœ‰åå­—äº†:smile:\nä¼ é€’ä¸€ä¸ªlvalueæˆ–è€…ä¼ é€’ä¸€ä¸ªconst lvaue\n\nä¼ é€’ä¸€ä¸ªlvalueï¼Œæ¨¡æ¿æ¨å¯¼ä¹‹å T = std::string&amp;\nä¼ é€’ä¸€ä¸ªconst lvaue, æ¨¡æ¿æ¨å¯¼ä¹‹åT = const std::string&amp;\nT&amp; &amp;&amp;å°†æŠ˜å ä¸ºT&amp;ï¼Œå³std::string&amp; &amp;&amp; æŠ˜å ä¸º std::string&amp;\næœ€ç»ˆå‡½æ•°ä¸º: Foo(string&amp; member): member{std::forward&lt;string&amp;&gt;(member)} {}\nstd::forward&lt;string&amp;&gt;(member)å°†è¿”å›ä¸€ä¸ªå·¦å€¼ï¼Œæœ€ç»ˆè°ƒç”¨æ‹·è´æ„é€ å‡½æ•°\n\nä¼ é€’ä¸€ä¸ªrvalue\n\nä¼ é€’ä¸€ä¸ªrvalueï¼Œæ¨¡æ¿æ¨å¯¼ä¹‹å T = std::string\næœ€ç»ˆå‡½æ•°ä¸º: Foo(string&amp;&amp; member): member{std::forward&lt;string&gt;(member)} {}\nstd::forward(member) å°†è¿”å›ä¸€ä¸ªå³å€¼ï¼Œæœ€ç»ˆè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼›\n\nstd::moveå’Œstd::forwardæœ¬è´¨éƒ½æ˜¯è½¬æ¢ã€‚std::moveæ‰§è¡Œåˆ°å³å€¼çš„æ— æ¡ä»¶è½¬æ¢ã€‚std::forwardåªæœ‰åœ¨å®ƒçš„å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šçš„æ—¶å€™ï¼Œæ‰è½¬æ¢å®ƒçš„å‚æ•°åˆ°ä¸€ä¸ªå³å€¼ã€‚\nstd::moveæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ï¼Œstd::forwardæ²¡æœ‰è½¬å‘ä»»ä½•ä¸œè¥¿ã€‚åœ¨è¿è¡ŒæœŸï¼Œå®ƒä»¬æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚å®ƒä»¬æ²¡æœ‰äº§ç”Ÿéœ€è¦æ‰§è¡Œçš„ä»£ç ï¼Œä¸€byteéƒ½æ²¡æœ‰ã€‚\nstd::move\nstd::moveçš„ä½¿ç”¨\n1234567891011class Foo&#123;public:    std::string member;    // Copy member.    Foo(const std::string&amp; m): member(m) &#123;&#125;    // Move member.    Foo(std::string&amp;&amp; m): member(std::move(m)) &#123;&#125;&#125;;\nä¸Šè¿°Foo(std::string&amp;&amp; member)ä¸­çš„memberæ˜¯rvalue referenceï¼Œä½†æ˜¯memberå´æ˜¯ä¸€ä¸ªå·¦å€¼lvalueï¼Œå› æ­¤åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­éœ€è¦ä½¿ç”¨std::moveå°†å…¶è½¬æ¢æˆrvalueã€‚\nstd::move()è§£æ\næ ‡å‡†åº“ä¸­moveçš„å®šä¹‰å¦‚ä¸‹ï¼š\n12345template&lt;typename T&gt;typename remove_reference&lt;T&gt;::type &amp;&amp; move(T&amp;&amp; t)&#123;    return static_cast&lt;typename remove_reference&lt;T&gt;::type &amp;&amp;&gt;(t);&#125;\n\nmoveå‡½æ•°çš„å‚æ•°T&amp;&amp;æ˜¯ä¸€ä¸ªæŒ‡å‘æ¨¡æ¿ç±»å‹å‚æ•°çš„å³å€¼å¼•ç”¨ã€è§„åˆ™2ã€‘ï¼Œé€šè¿‡å¼•ç”¨æŠ˜å ï¼Œæ­¤å‚æ•°å¯ä»¥å’Œä»»ä½•ç±»å‹çš„å®å‚åŒ¹é…ï¼Œå› æ­¤moveæ—¢å¯ä»¥ä¼ é€’ä¸€ä¸ªå·¦å€¼ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªå³å€¼ï¼›\nstd::move(string(â€œhelloâ€))è°ƒç”¨è§£æï¼š\n\né¦–å…ˆï¼Œæ ¹æ®æ¨¡æ¿æ¨æ–­è§„åˆ™ï¼Œç¡®åœ°Tçš„ç±»å‹ä¸ºstring;\ntypename remove_reference::type &amp;&amp; çš„ç»“æœä¸º string &amp;&amp;;\nmoveå‡½æ•°çš„å‚æ•°ç±»å‹ä¸ºstring&amp;&amp;;\nstatic_cast&lt;string &amp;&amp;&gt;(t)ï¼Œtå·²ç»æ˜¯string&amp;&amp;ï¼Œäºæ˜¯ç±»å‹è½¬æ¢ä»€ä¹ˆéƒ½ä¸åšï¼Œè¿”å›string &amp;&amp;;\n\n\nstring s1(â€œhelloâ€); std::move(s1); è°ƒç”¨è§£æï¼š\n\né¦–å…ˆï¼Œæ ¹æ®æ¨¡æ¿æ¨æ–­è§„åˆ™ï¼Œç¡®å®šTçš„ç±»å‹ä¸ºstring&amp;;\ntypename remove_reference::type &amp;&amp; çš„ç»“æœä¸º string&amp;\nmoveå‡½æ•°çš„å‚æ•°ç±»å‹ä¸ºstring&amp; &amp;&amp;ï¼Œå¼•ç”¨æŠ˜å ä¹‹åä¸ºstring&amp;;\nstatic_cast&lt;string &amp;&amp;&gt;(t)ï¼Œtæ˜¯string&amp;ï¼Œç»è¿‡static_castä¹‹åè½¬æ¢ä¸ºstring&amp;&amp;, è¿”å›string &amp;&amp;;\n\n\n\n\nä»moveçš„å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œmoveè‡ªèº«é™¤äº†åšä¸€äº›å‚æ•°çš„æ¨æ–­ä¹‹å¤–ï¼Œè¿”å›å³å€¼å¼•ç”¨æœ¬è´¨ä¸Šè¿˜æ˜¯é static_cast&lt;T&amp;&amp;&gt;å®Œæˆçš„ã€‚\n\nå› æ­¤ä¸‹é¢ä¸¤ä¸ªè°ƒç”¨æ˜¯ç­‰ä»·çš„ï¼Œstd::moveå°±æ˜¯ä¸ªè¯­æ³•ç³–ã€‚\n12345678910void func(int&amp;&amp; a)&#123;    cout &lt;&lt; a &lt;&lt; endl;&#125;int a = 6;func(std::move(a));int b = 10;func(static_cast&lt;int&amp;&amp;&gt;(b));\nstd::moveæ‰§è¡Œåˆ°å³å€¼çš„æ— æ¡ä»¶è½¬æ¢ã€‚å°±å…¶æœ¬èº«è€Œè¨€ï¼Œå®ƒæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ã€‚\nstd::move()å’Œstd::forward()å¯¹æ¯”\n\nstd::moveæ‰§è¡Œåˆ°å³å€¼çš„æ— æ¡ä»¶è½¬æ¢ã€‚å°±å…¶æœ¬èº«è€Œè¨€ï¼Œå®ƒæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ã€‚\nstd::forwardåªæœ‰åœ¨å®ƒçš„å‚æ•°ç»‘å®šåˆ°ä¸€ä¸ªå³å€¼ä¸Šçš„æ—¶å€™ï¼Œå®ƒæ‰è½¬æ¢å®ƒçš„å‚æ•°åˆ°ä¸€ä¸ªå³å€¼ã€‚\nstd::moveå’Œstd::forwardåªä¸è¿‡å°±æ˜¯æ‰§è¡Œç±»å‹è½¬æ¢çš„ä¸¤ä¸ªå‡½æ•°ï¼›std::moveæ²¡æœ‰moveä»»ä½•ä¸œè¥¿ï¼Œstd::forwardæ²¡æœ‰è½¬å‘ä»»ä½•ä¸œè¥¿ã€‚åœ¨è¿è¡ŒæœŸï¼Œå®ƒä»¬æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚å®ƒä»¬æ²¡æœ‰äº§ç”Ÿéœ€è¦æ‰§è¡Œçš„ä»£ç ï¼Œä¸€byteéƒ½æ²¡æœ‰ã€‚\nstd::forward()ä¸ä»…å¯ä»¥ä¿æŒå·¦å€¼æˆ–è€…å³å€¼ä¸å˜ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¿æŒconstã€Lreferenceã€Rreferenceã€validateç­‰å±æ€§ä¸å˜ï¼›\n\n","thumbnail":"/posts/å®Œç¾è½¬å‘/apple.png","plink":"https://shuntan.github.io/posts/å®Œç¾è½¬å‘/"},{"title":"ä»4è¡Œä»£ç çœ‹å³å€¼å¼•ç”¨","date":"2019-05-23T06:50:40.000Z","date_formatted":{"ll":"May 23, 2019","L":"05/23/2019","MM-DD":"05-23"},"updated":"2020-04-22T07:28:05.889Z","content":"æ¦‚è¿°\nå³å€¼å¼•ç”¨çš„æ¦‚å¿µæœ‰äº›è¯»è€…å¯èƒ½ä¼šæ„Ÿåˆ°é™Œç”Ÿï¼Œå…¶å®ä»–å’ŒC98/03ä¸­çš„å·¦å€¼å¼•ç”¨æœ‰äº›ç±»ä¼¼ï¼Œä¾‹å¦‚ï¼Œc98/03ä¸­çš„å·¦å€¼å¼•ç”¨æ˜¯è¿™æ ·çš„ï¼š\n12int i = 0;int&amp; j = i;\nè¿™é‡Œçš„int&amp;æ˜¯å¯¹å·¦å€¼è¿›è¡Œç»‘å®šï¼ˆä½†æ˜¯int&amp;å´ä¸èƒ½ç»‘å®šå³å€¼ï¼‰ï¼Œç›¸åº”çš„ï¼Œå¯¹å³å€¼è¿›è¡Œç»‘å®šçš„å¼•ç”¨å°±æ˜¯å³å€¼å¼•ç”¨ï¼Œä»–çš„è¯­æ³•æ˜¯è¿™æ ·çš„A&amp;&amp;ï¼Œé€šè¿‡åŒå¼•å·æ¥è¡¨ç¤ºç»‘å®šç±»å‹ä¸ºAçš„å³å€¼ã€‚é€šè¿‡&amp;&amp;æˆ‘ä»¬å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç»‘å®šå³å€¼äº†ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç»‘å®šä¸€ä¸ªå³å€¼ï¼š\nã€€ã€€\n1int&amp;&amp; i = 0;\nè¿™é‡Œæˆ‘ä»¬ç»‘å®šäº†ä¸€ä¸ªå³å€¼0ï¼Œå…³äºå³å€¼çš„æ¦‚å¿µä¼šåœ¨åé¢ä»‹ç»ã€‚å³å€¼å¼•ç”¨æ˜¯C11ä¸­æ–°å¢åŠ çš„ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§ï¼Œä»–ä¸»æ˜¯è¦ç”¨æ¥è§£å†³C98/03ä¸­é‡åˆ°çš„ä¸¤ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜å°±æ˜¯ä¸´æ—¶å¯¹è±¡éå¿…è¦çš„æ˜‚è´µçš„æ‹·è´æ“ä½œï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯åœ¨æ¨¡æ¿å‡½æ•°ä¸­å¦‚ä½•æŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹è¿›è¡Œè½¬å‘ã€‚é€šè¿‡å¼•å…¥å³å€¼å¼•ç”¨ï¼Œå¾ˆå¥½çš„è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæ”¹è¿›äº†ç¨‹åºæ€§èƒ½ï¼Œåé¢å°†ä¼šè¯¦ç»†ä»‹ç»å³å€¼å¼•ç”¨æ˜¯å¦‚ä½•è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„ã€‚\nå’Œå³å€¼å¼•ç”¨ç›¸å…³çš„æ¦‚å¿µæ¯”è¾ƒå¤šï¼Œæ¯”å¦‚ï¼šå³å€¼ã€çº¯å³å€¼ã€å°†äº¡å€¼ã€universal referencesã€å¼•ç”¨æŠ˜å ã€ç§»åŠ¨è¯­ä¹‰ã€moveè¯­ä¹‰å’Œå®Œç¾è½¬å‘ç­‰ç­‰ã€‚å¾ˆå¤šéƒ½æ˜¯æ–°æ¦‚å¿µï¼Œå¯¹äºåˆšå­¦ä¹ C++11å³å€¼å¼•ç”¨çš„åˆå­¦è€…æ¥è¯´ï¼Œå¯èƒ½ä¼šè§‰å¾—å³å€¼å¼•ç”¨è¿‡äºå¤æ‚ï¼Œæ¦‚å¿µä¹‹é—´çš„å…³ç³»éš¾ä»¥ç†æ¸…ã€‚\nå³å€¼å¼•ç”¨å®é™…ä¸Šå¹¶æ²¡æœ‰é‚£ä¹ˆå¤æ‚ï¼Œå…¶å®æ˜¯å…³äº4è¡Œä»£ç çš„æ•…äº‹ï¼Œé€šè¿‡ç®€å•çš„4è¡Œä»£ç æˆ‘ä»¬å°±èƒ½æ¸…æ™°çš„ç†è§£å³å€¼å¼•ç”¨ç›¸å…³çš„æ¦‚å¿µäº†ã€‚æœ¬æ–‡å¸Œæœ›å¸¦é¢†è¯»è€…é€šè¿‡4è¡Œä»£ç æ¥ç†è§£å³å€¼å¼•ç”¨ç›¸å…³çš„æ¦‚å¿µï¼Œç†æ¸…ä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æœ€ç»ˆèƒ½é€å½»åœ°æŒæ¡C++11çš„æ–°ç‰¹æ€§â€“å³å€¼å¼•ç”¨ã€‚\nå››è¡Œä»£ç çš„æ•…äº‹\nç¬¬1è¡Œä»£ç çš„æ•…äº‹\n1int i = getVar();\nä¸Šé¢çš„è¿™è¡Œä»£ç å¾ˆç®€å•ï¼Œä»getVar()å‡½æ•°è·å–ä¸€ä¸ªæ•´å½¢å€¼ï¼Œç„¶è€Œï¼Œè¿™è¡Œä»£ç ä¼šäº§ç”Ÿå‡ ç§ç±»å‹çš„å€¼å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¼šäº§ç”Ÿä¸¤ç§ç±»å‹çš„å€¼ï¼Œä¸€ç§æ˜¯å·¦å€¼iï¼Œä¸€ç§æ˜¯å‡½æ•°getVar()è¿”å›çš„ä¸´æ—¶å€¼ï¼Œè¿™ä¸ªä¸´æ—¶å€¼åœ¨è¡¨è¾¾å¼ç»“æŸåå°±é”€æ¯äº†ï¼Œè€Œå·¦å€¼iåœ¨è¡¨è¾¾å¼ç»“æŸåä»ç„¶å­˜åœ¨ï¼Œè¿™ä¸ªä¸´æ—¶å€¼å°±æ˜¯å³å€¼ï¼Œå…·ä½“æ¥è¯´æ˜¯ä¸€ä¸ªçº¯å³å€¼ï¼Œå³å€¼æ˜¯ä¸å…·åçš„ã€‚åŒºåˆ†å·¦å€¼å’Œå³å€¼çš„ä¸€ä¸ªç®€å•åŠæ³•æ˜¯ï¼šçœ‹èƒ½ä¸èƒ½å¯¹è¡¨è¾¾å¼å–åœ°å€ï¼Œå¦‚æœèƒ½ï¼Œåˆ™ä¸ºå·¦å€¼ï¼Œå¦åˆ™ä¸ºå³å€¼ã€‚\næ‰€æœ‰çš„å…·åå˜é‡æˆ–å¯¹è±¡éƒ½æ˜¯å·¦å€¼ï¼Œè€ŒåŒ¿åå˜é‡åˆ™æ˜¯å³å€¼ï¼Œæ¯”å¦‚ï¼Œç®€å•çš„èµ‹å€¼è¯­å¥ï¼š\n1int i = 0;\nåœ¨è¿™æ¡è¯­å¥ä¸­ï¼Œi æ˜¯å·¦å€¼ï¼Œ0 æ˜¯å­—é¢é‡ï¼Œå°±æ˜¯å³å€¼ã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œi å¯ä»¥è¢«å¼•ç”¨ï¼Œ0 å°±ä¸å¯ä»¥äº†ã€‚å…·ä½“æ¥è¯´ä¸Šé¢çš„è¡¨è¾¾å¼ä¸­ç­‰å·å³è¾¹çš„0æ˜¯çº¯å³å€¼ï¼ˆprvalueï¼‰ï¼Œåœ¨C11ä¸­æ‰€æœ‰çš„å€¼å¿…å±äºå·¦å€¼ã€å°†äº¡å€¼ã€çº¯å³å€¼ä¸‰è€…ä¹‹ä¸€ã€‚æ¯”å¦‚ï¼Œéå¼•ç”¨è¿”å›çš„ä¸´æ—¶å˜é‡ã€è¿ç®—è¡¨è¾¾å¼äº§ç”Ÿçš„ä¸´æ—¶å˜é‡ã€åŸå§‹å­—é¢é‡å’Œlambdaè¡¨è¾¾å¼ç­‰éƒ½æ˜¯çº¯å³å€¼ã€‚è€Œå°†äº¡å€¼æ˜¯C11æ–°å¢çš„ã€ä¸å³å€¼å¼•ç”¨ç›¸å…³çš„è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼Œå°†è¦è¢«ç§»åŠ¨çš„å¯¹è±¡ã€T&amp;&amp;å‡½æ•°è¿”å›å€¼ã€std::moveè¿”å›å€¼å’Œè½¬æ¢ä¸ºT&amp;&amp;çš„ç±»å‹çš„è½¬æ¢å‡½æ•°çš„è¿”å›å€¼ç­‰ã€‚å…³äºå°†äº¡å€¼æˆ‘ä»¬ä¼šåœ¨åé¢ä»‹ç»ï¼Œå…ˆçœ‹ä¸‹é¢çš„ä»£ç ï¼š\n123int j = 5;auto f = []&#123;return 5;&#125;;\nä¸Šé¢çš„ä»£ç ä¸­5æ˜¯ä¸€ä¸ªåŸå§‹å­—é¢é‡ï¼Œ []{return 5;}æ˜¯ä¸€ä¸ªlambdaè¡¨è¾¾å¼ï¼Œéƒ½æ˜¯å±äºçº¯å³å€¼ï¼Œä»–ä»¬çš„ç‰¹ç‚¹æ˜¯åœ¨è¡¨è¾¾å¼ç»“æŸä¹‹åå°±é”€æ¯äº†ã€‚\né€šè¿‡åœ°è¡Œä»£ç æˆ‘ä»¬å¯¹å³å€¼æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ï¼ŒçŸ¥é“äº†ä»€ä¹ˆæ˜¯å³å€¼ï¼Œæ¥ä¸‹æ¥å†æ¥çœ‹çœ‹ç¬¬äºŒè¡Œä»£ç ã€‚\nç¬¬2è¡Œä»£ç çš„æ•…äº‹\n1T&amp;&amp; k = getVar();\nç¬¬äºŒè¡Œä»£ç å’Œç¬¬ä¸€è¡Œä»£ç å¾ˆåƒï¼Œåªæ˜¯ç›¸æ¯”ç¬¬ä¸€è¡Œä»£ç å¤šäº†â€œ&amp;&amp;â€ï¼Œä»–å°±æ˜¯å³å€¼å¼•ç”¨ï¼Œæˆ‘ä»¬çŸ¥é“å·¦å€¼å¼•ç”¨æ˜¯å¯¹å·¦å€¼çš„å¼•ç”¨ï¼Œé‚£ä¹ˆï¼Œå¯¹åº”çš„ï¼Œå¯¹å³å€¼çš„å¼•ç”¨å°±æ˜¯å³å€¼å¼•ç”¨ï¼Œè€Œä¸”å³å€¼æ˜¯åŒ¿åå˜é‡ï¼Œæˆ‘ä»¬ä¹Ÿåªèƒ½é€šè¿‡å¼•ç”¨çš„æ–¹å¼æ¥è·å–å³å€¼ã€‚è™½ç„¶ç¬¬äºŒè¡Œä»£ç å’Œç¬¬ä¸€è¡Œä»£ç çœ‹èµ·æ¥å·®åˆ«ä¸å¤§ï¼Œä½†æ˜¯å®é™…ä¸Šè¯­ä¹‰çš„å·®åˆ«å¾ˆå¤§ï¼Œè¿™é‡Œï¼ŒgetVar()äº§ç”Ÿçš„ä¸´æ—¶å€¼ä¸ä¼šåƒç¬¬ä¸€è¡Œä»£ç é‚£æ ·ï¼Œåœ¨è¡¨è¾¾å¼ç»“æŸä¹‹åå°±é”€æ¯äº†ï¼Œè€Œæ˜¯ä¼šè¢«â€œç»­å‘½â€ï¼Œä»–çš„ç”Ÿå‘½å‘¨æœŸå°†ä¼šé€šè¿‡å³å€¼å¼•ç”¨å¾—ä»¥å»¶ç»­ï¼Œå’Œå˜é‡kçš„å£°æ˜å‘¨æœŸä¸€æ ·é•¿ã€‚\nå³å€¼å¼•ç”¨çš„ç¬¬ä¸€ä¸ªç‰¹ç‚¹\nã€€ã€€é€šè¿‡å³å€¼å¼•ç”¨çš„å£°æ˜ï¼Œå³å€¼åˆâ€œé‡è·æ–°ç”Ÿâ€ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¸å³å€¼å¼•ç”¨ç±»å‹å˜é‡çš„ç”Ÿå‘½å‘¨æœŸä¸€æ ·é•¿ï¼Œåªè¦è¯¥å˜é‡è¿˜æ´»ç€ï¼Œè¯¥å³å€¼ä¸´æ—¶é‡å°†ä¼šä¸€ç›´å­˜æ´»ä¸‹å»ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹çœ‹å³å€¼çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚ä»£ç æ¸…å•1-1æ‰€ç¤ºã€‚\nä»£ç æ¸…å•1-1\n12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;using namespace std;int g_constructCount=0;int g_copyConstructCount=0;int g_destructCount=0;struct A&#123;    A()&#123;        cout&lt;&lt;\"construct: \"&lt;&lt;++g_constructCount&lt;&lt;endl;        &#125;        A(const A&amp; a)    &#123;        cout&lt;&lt;\"copy construct: \"&lt;&lt;++g_copyConstructCount &lt;&lt;endl;    &#125;    ~A()    &#123;        cout&lt;&lt;\"destruct: \"&lt;&lt;++g_destructCount&lt;&lt;endl;    &#125;&#125;;A GetA()&#123;    return A();&#125;int main() &#123;    A a = GetA();    return 0;&#125;\nä¸ºäº†æ¸…æ¥šçš„è§‚å¯Ÿä¸´æ—¶å€¼ï¼Œåœ¨ç¼–è¯‘æ—¶è®¾ç½®ç¼–è¯‘é€‰é¡¹-fno-elide-constructorsç”¨æ¥å…³é—­è¿”å›å€¼ä¼˜åŒ–æ•ˆæœã€‚\nè¾“å‡ºç»“æœï¼š\n123456construct: 1copy construct: 1destruct: 1copy construct: 2destruct: 2destruct: 3\nä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ²¡æœ‰è¿”å›å€¼ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæ‹·è´æ„é€ å‡½æ•°è°ƒç”¨äº†ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯GetA()å‡½æ•°å†…éƒ¨åˆ›å»ºçš„å¯¹è±¡è¿”å›å‡ºæ¥æ„é€ ä¸€ä¸ªä¸´æ—¶å¯¹è±¡äº§ç”Ÿçš„ï¼Œå¦ä¸€æ¬¡æ˜¯åœ¨mainå‡½æ•°ä¸­æ„é€ aå¯¹è±¡äº§ç”Ÿçš„ã€‚ç¬¬äºŒæ¬¡çš„destructæ˜¯å› ä¸ºä¸´æ—¶å¯¹è±¡åœ¨æ„é€ aå¯¹è±¡ä¹‹åå°±é”€æ¯äº†ã€‚å¦‚æœå¼€å¯è¿”å›å€¼ä¼˜åŒ–çš„è¯ï¼Œè¾“å‡ºç»“æœå°†æ˜¯ï¼š\nconstruct: 1\ndestruct: 1\nå¯ä»¥çœ‹åˆ°è¿”å›å€¼ä¼˜åŒ–å°†ä¼šæŠŠä¸´æ—¶å¯¹è±¡ä¼˜åŒ–æ‰ï¼Œä½†è¿™ä¸æ˜¯c++æ ‡å‡†ï¼Œæ˜¯å„ç¼–è¯‘å™¨çš„ä¼˜åŒ–è§„åˆ™ã€‚æˆ‘ä»¬åœ¨å›åˆ°ä¹‹å‰æåˆ°çš„å¯ä»¥é€šè¿‡å³å€¼å¼•ç”¨æ¥å»¶é•¿ä¸´æ—¶å³å€¼çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸Šé¢çš„ä»£ç ä¸­æˆ‘ä»¬é€šè¿‡å³å€¼å¼•ç”¨æ¥ç»‘å®šå‡½æ•°è¿”å›å€¼çš„è¯ï¼Œç»“æœåˆä¼šæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿåœ¨ç¼–è¯‘æ—¶è®¾ç½®ç¼–è¯‘é€‰é¡¹-fno-elide-constructorsã€‚\n123456789int main() &#123;    A&amp;&amp; a = GetA();    return 0;&#125;è¾“å‡ºç»“æœï¼šconstruct: 1copy construct: 1destruct: 1destruct: 2\né€šè¿‡å³å€¼å¼•ç”¨ï¼Œæ¯”ä¹‹å‰å°‘äº†ä¸€æ¬¡æ‹·è´æ„é€ å’Œä¸€æ¬¡ææ„ï¼ŒåŸå› åœ¨äºå³å€¼å¼•ç”¨ç»‘å®šäº†å³å€¼ï¼Œè®©ä¸´æ—¶å³å€¼çš„ç”Ÿå‘½å‘¨æœŸå»¶é•¿äº†ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹åšä¸€äº›æ€§èƒ½ä¼˜åŒ–ï¼Œå³é¿å…ä¸´æ—¶å¯¹è±¡çš„æ‹·è´æ„é€ å’Œææ„ï¼Œäº‹å®ä¸Šï¼Œåœ¨c++98/03ä¸­ï¼Œé€šè¿‡å¸¸é‡å·¦å€¼å¼•ç”¨ä¹Ÿç»å¸¸ç”¨æ¥åšæ€§èƒ½ä¼˜åŒ–ã€‚ä¸Šé¢çš„ä»£ç æ”¹æˆï¼š\nconst A&amp; a = GetA();\nè¾“å‡ºçš„ç»“æœå’Œå³å€¼å¼•ç”¨ä¸€æ ·ï¼Œå› ä¸ºå¸¸é‡å·¦å€¼å¼•ç”¨æ˜¯ä¸€ä¸ªâ€œä¸‡èƒ½â€çš„å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥æ¥å—å·¦å€¼ã€å³å€¼ã€å¸¸é‡å·¦å€¼å’Œå¸¸é‡å³å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æ™®é€šçš„å·¦å€¼å¼•ç”¨ä¸èƒ½æ¥å—å³å€¼ï¼Œæ¯”å¦‚è¿™æ ·çš„å†™æ³•æ˜¯ä¸å¯¹çš„ï¼š\nA&amp; a = GetA();\nä¸Šé¢çš„ä»£ç ä¼šæŠ¥ä¸€ä¸ªç¼–è¯‘é”™è¯¯ï¼Œå› ä¸ºéå¸¸é‡å·¦å€¼å¼•ç”¨åªèƒ½æ¥å—å·¦å€¼ã€‚\nå³å€¼å¼•ç”¨çš„ç¬¬äºŒä¸ªç‰¹ç‚¹\nã€€ã€€å³å€¼å¼•ç”¨ç‹¬ç«‹äºå·¦å€¼å’Œå³å€¼ã€‚æ„æ€æ˜¯å³å€¼å¼•ç”¨ç±»å‹çš„å˜é‡å¯èƒ½æ˜¯å·¦å€¼ä¹Ÿå¯èƒ½æ˜¯å³å€¼ã€‚æ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š\n1int&amp;&amp; var1 = 1;\nvar1ç±»å‹ä¸ºå³å€¼å¼•ç”¨ï¼Œä½†var1æœ¬èº«æ˜¯å·¦å€¼ï¼Œå› ä¸ºå…·åå˜é‡éƒ½æ˜¯å·¦å€¼ã€‚\nå…³äºå³å€¼å¼•ç”¨ä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜æ˜¯ï¼šT&amp;&amp;æ˜¯ä»€ä¹ˆï¼Œä¸€å®šæ˜¯å³å€¼å—ï¼Ÿè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n12345template&lt;typename T&gt;void f(T&amp;&amp; t)&#123;&#125;f(10); //tæ˜¯å³å€¼int x = 10;f(x); //tæ˜¯å·¦å€¼\nä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼ŒT&amp;&amp;è¡¨ç¤ºçš„å€¼ç±»å‹ä¸ç¡®å®šï¼Œå¯èƒ½æ˜¯å·¦å€¼åˆå¯èƒ½æ˜¯å³å€¼ï¼Œè¿™ä¸€ç‚¹çœ‹èµ·æ¥æœ‰ç‚¹å¥‡æ€ªï¼Œè¿™å°±æ˜¯å³å€¼å¼•ç”¨çš„ä¸€ä¸ªç‰¹ç‚¹ã€‚\nå³å€¼å¼•ç”¨çš„ç¬¬ä¸‰ä¸ªç‰¹ç‚¹\nã€€ã€€T&amp;&amp; tåœ¨å‘ç”Ÿè‡ªåŠ¨ç±»å‹æ¨æ–­çš„æ—¶å€™ï¼Œå®ƒæ˜¯æœªå®šçš„å¼•ç”¨ç±»å‹ï¼ˆuniversal referencesï¼‰ï¼Œå¦‚æœè¢«ä¸€ä¸ªå·¦å€¼åˆå§‹åŒ–ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå·¦å€¼ï¼›å¦‚æœå®ƒè¢«ä¸€ä¸ªå³å€¼åˆå§‹åŒ–ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå³å€¼ï¼Œå®ƒæ˜¯å·¦å€¼è¿˜æ˜¯å³å€¼å–å†³äºå®ƒçš„åˆå§‹åŒ–ã€‚\næˆ‘ä»¬å†å›è¿‡å¤´çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå¯¹äºå‡½æ•°templatevoid f(T&amp;&amp; t)ï¼Œå½“å‚æ•°ä¸ºå³å€¼10çš„æ—¶å€™ï¼Œæ ¹æ®universal referencesçš„ç‰¹ç‚¹ï¼Œtè¢«ä¸€ä¸ªå³å€¼åˆå§‹åŒ–ï¼Œé‚£ä¹ˆtå°±æ˜¯å³å€¼ï¼›å½“å‚æ•°ä¸ºå·¦å€¼xæ—¶ï¼Œtè¢«ä¸€ä¸ªå·¦å€¼å¼•ç”¨åˆå§‹åŒ–ï¼Œé‚£ä¹ˆtå°±æ˜¯ä¸€ä¸ªå·¦å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»…ä»…æ˜¯å½“å‘ç”Ÿè‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼ˆå¦‚å‡½æ•°æ¨¡æ¿çš„ç±»å‹è‡ªåŠ¨æ¨å¯¼ï¼Œæˆ–autoå…³é”®å­—ï¼‰çš„æ—¶å€™ï¼ŒT&amp;&amp;æ‰æ˜¯universal referencesã€‚å†çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n1234567template&lt;typename T&gt;void f(T&amp;&amp; param); template&lt;typename T&gt;class Test &#123;    Test(Test&amp;&amp; rhs); &#125;;\nä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œparamæ˜¯universal referenceï¼Œrhsæ˜¯Test&amp;&amp;å³å€¼å¼•ç”¨ï¼Œå› ä¸ºæ¨¡ç‰ˆå‡½æ•°få‘ç”Ÿäº†ç±»å‹æ¨æ–­ï¼Œè€ŒTest&amp;&amp;å¹¶æ²¡æœ‰å‘ç”Ÿç±»å‹æ¨å¯¼ï¼Œå› ä¸ºTest&amp;&amp;æ˜¯ç¡®å®šçš„ç±»å‹äº†ã€‚\næ­£æ˜¯å› ä¸ºå³å€¼å¼•ç”¨å¯èƒ½æ˜¯å·¦å€¼ä¹Ÿå¯èƒ½æ˜¯å³å€¼ï¼Œä¾èµ–äºåˆå§‹åŒ–ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸‹å­å°±ç¡®å®šçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹åšå¾ˆå¤šæ–‡ç« ï¼Œæ¯”å¦‚åé¢è¦ä»‹ç»çš„ç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ã€‚\nè¿™é‡Œå†æä¸€ä¸‹å¼•ç”¨æŠ˜å ï¼Œæ­£æ˜¯å› ä¸ºå¼•å…¥äº†å³å€¼å¼•ç”¨ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨å·¦å€¼å¼•ç”¨ä¸å³å€¼å¼•ç”¨å’Œå³å€¼å¼•ç”¨ä¸å³å€¼å¼•ç”¨çš„æŠ˜å ï¼ŒC++11ç¡®å®šäº†å¼•ç”¨æŠ˜å çš„è§„åˆ™ï¼Œè§„åˆ™æ˜¯è¿™æ ·çš„ï¼š\n\næ‰€æœ‰çš„å³å€¼å¼•ç”¨å åŠ åˆ°å³å€¼å¼•ç”¨ä¸Šä»ç„¶è¿˜æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼›\næ‰€æœ‰çš„å…¶ä»–å¼•ç”¨ç±»å‹ä¹‹é—´çš„å åŠ éƒ½å°†å˜æˆå·¦å€¼å¼•ç”¨ã€‚\n\nç¬¬3è¡Œä»£ç çš„æ•…äº‹\n1T(T&amp;&amp; a) : m_val(val)&#123; a.m_val=nullptr; &#125;\nè¿™è¡Œä»£ç å®é™…ä¸Šæ¥è‡ªäºä¸€ä¸ªç±»çš„æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°çš„ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ï¼Œä¸ºä»€ä¹ˆå°†å³å€¼å¼•ç”¨ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°å‘¢ï¼Ÿåœ¨è§£ç­”è¿™ä¸ªé—®é¢˜ä¹‹å‰æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªä¾‹å­ã€‚å¦‚ä»£ç æ¸…å•1-2æ‰€ç¤ºã€‚\nä»£ç æ¸…å•1-2\n1234567891011121314151617181920class A&#123;public:    A():m_ptr(new int(0))&#123;cout &lt;&lt; \"construct\" &lt;&lt; endl;&#125;    A(const A&amp; a):m_ptr(new int(*a.m_ptr)) //æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°    &#123;        cout &lt;&lt; \"copy construct\" &lt;&lt; endl;    &#125;    ~A()&#123; delete m_ptr;&#125;private:    int* m_ptr;&#125;;int main() &#123;    A a = GetA();    return 0;&#125;    è¾“å‡ºï¼šconstructcopy constructcopy construct\nè¿™ä¸ªä¾‹å­å¾ˆç®€å•ï¼Œä¸€ä¸ªå¸¦æœ‰å †å†…å­˜çš„ç±»ï¼Œå¿…é¡»æä¾›ä¸€ä¸ªæ·±æ‹·è´æ‹·è´æ„é€ å‡½æ•°ï¼Œå› ä¸ºé»˜è®¤çš„æ‹·è´æ„é€ å‡½æ•°æ˜¯æµ…æ‹·è´ï¼Œä¼šå‘ç”Ÿâ€œæŒ‡é’ˆæ‚¬æŒ‚â€çš„é—®é¢˜ã€‚å¦‚æœä¸æä¾›æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œä¸Šé¢çš„æµ‹è¯•ä»£ç å°†ä¼šå‘ç”Ÿé”™è¯¯ï¼ˆç¼–è¯‘é€‰é¡¹-fno-elide-constructorsï¼‰ï¼Œå†…éƒ¨çš„m_ptrå°†ä¼šè¢«åˆ é™¤ä¸¤æ¬¡ï¼Œä¸€æ¬¡æ˜¯ä¸´æ—¶å³å€¼ææ„çš„æ—¶å€™åˆ é™¤ä¸€æ¬¡ï¼Œç¬¬äºŒæ¬¡å¤–é¢æ„é€ çš„aå¯¹è±¡é‡Šæ”¾æ—¶åˆ é™¤ä¸€æ¬¡ï¼Œè€Œè¿™ä¸¤ä¸ªå¯¹è±¡çš„m_ptræ˜¯åŒä¸€ä¸ªæŒ‡é’ˆï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æŒ‡é’ˆæ‚¬æŒ‚é—®é¢˜ã€‚æä¾›æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°è™½ç„¶å¯ä»¥ä¿è¯æ­£ç¡®ï¼Œä½†æ˜¯åœ¨æœ‰äº›æ—¶å€™ä¼šé€ æˆé¢å¤–çš„æ€§èƒ½æŸè€—ï¼Œå› ä¸ºæœ‰æ—¶å€™è¿™ç§æ·±æ‹·è´æ˜¯ä¸å¿…è¦çš„ã€‚æ¯”å¦‚ä¸‹é¢çš„ä»£ç ï¼š\nä¸Šé¢ä»£ç ä¸­çš„GetAå‡½æ•°ä¼šè¿”å›ä¸´æ—¶å˜é‡ï¼Œç„¶åé€šè¿‡è¿™ä¸ªä¸´æ—¶å˜é‡æ‹·è´æ„é€ äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡aï¼Œä¸´æ—¶å˜é‡åœ¨æ‹·è´æ„é€ å®Œæˆä¹‹åå°±é”€æ¯äº†ï¼Œå¦‚æœå †å†…å­˜å¾ˆå¤§çš„è¯ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªæ‹·è´æ„é€ çš„ä»£ä»·ä¼šå¾ˆå¤§ï¼Œå¸¦æ¥äº†é¢å¤–çš„æ€§èƒ½æŸå¤±ã€‚æ¯æ¬¡éƒ½ä¼šäº§ç”Ÿä¸´æ—¶å˜é‡å¹¶é€ æˆé¢å¤–çš„æ€§èƒ½æŸå¤±ï¼Œæœ‰æ²¡æœ‰åŠæ³•é¿å…ä¸´æ—¶å˜é‡é€ æˆçš„æ€§èƒ½æŸå¤±å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼ŒC++11å·²ç»æœ‰äº†è§£å†³æ–¹æ³•ï¼Œçœ‹çœ‹ä¸‹é¢çš„ä»£ç ã€‚å¦‚ä»£ç æ¸…å•1-3æ‰€ç¤ºã€‚\nä»£ç æ¸…å•1-3\n123456789101112131415161718192021222324class A&#123;public:    A() :m_ptr(new int(0))&#123;&#125;    A(const A&amp; a):m_ptr(new int(*a.m_ptr)) //æ·±æ‹·è´çš„æ‹·è´æ„é€ å‡½æ•°    &#123;        cout &lt;&lt; \"copy construct\" &lt;&lt; endl;    &#125;    A(A&amp;&amp; a) :m_ptr(a.m_ptr)    &#123;        a.m_ptr = nullptr;        cout &lt;&lt; \"move construct\" &lt;&lt; endl;    &#125;    ~A()&#123; delete m_ptr;&#125;private:    int* m_ptr;&#125;;int main()&#123;    A a = Get(false); &#125; è¾“å‡ºï¼šconstructmove constructmove construct\nä»£ç æ¸…å•1-3å’Œ1-2ç›¸æ¯”åªå¤šäº†ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¾“å‡ºç»“æœè¡¨æ˜ï¼Œå¹¶æ²¡æœ‰è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œåªè°ƒç”¨äº†move constructå‡½æ•°ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸ªmove constructå‡½æ•°ï¼š\n12345A(A&amp;&amp; a) :m_ptr(a.m_ptr)&#123;    a.m_ptr = nullptr;    cout &lt;&lt; \"move construct\" &lt;&lt; endl;&#125;\nè¿™ä¸ªæ„é€ å‡½æ•°å¹¶æ²¡æœ‰åšæ·±æ‹·è´ï¼Œä»…ä»…æ˜¯å°†æŒ‡é’ˆçš„æ‰€æœ‰è€…è½¬ç§»åˆ°äº†å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶ï¼Œå°†å‚æ•°å¯¹è±¡açš„æŒ‡é’ˆç½®ä¸ºç©ºï¼Œè¿™é‡Œä»…ä»…æ˜¯åšäº†æµ…æ‹·è´ï¼Œå› æ­¤ï¼Œè¿™ä¸ªæ„é€ å‡½æ•°é¿å…äº†ä¸´æ—¶å˜é‡çš„æ·±æ‹·è´é—®é¢˜ã€‚\nä¸Šé¢è¿™ä¸ªå‡½æ•°å…¶å®å°±æ˜¯ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œä»–çš„å‚æ•°æ˜¯ä¸€ä¸ªå³å€¼å¼•ç”¨ç±»å‹ï¼Œè¿™é‡Œçš„A&amp;&amp;è¡¨ç¤ºå³å€¼ï¼Œä¸ºä»€ä¹ˆï¼Ÿå‰é¢å·²ç»æåˆ°ï¼Œè¿™é‡Œæ²¡æœ‰å‘ç”Ÿç±»å‹æ¨æ–­ï¼Œæ˜¯ç¡®å®šçš„å³å€¼å¼•ç”¨ç±»å‹ã€‚ä¸ºä»€ä¹ˆä¼šåŒ¹é…åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ï¼Ÿå› ä¸ºè¿™ä¸ªæ„é€ å‡½æ•°åªèƒ½æ¥å—å³å€¼å‚æ•°ï¼Œè€Œå‡½æ•°è¿”å›å€¼æ˜¯å³å€¼ï¼Œæ‰€ä»¥å°±ä¼šåŒ¹é…åˆ°è¿™ä¸ªæ„é€ å‡½æ•°ã€‚è¿™é‡Œçš„A&amp;&amp;å¯ä»¥çœ‹ä½œæ˜¯ä¸´æ—¶å€¼çš„æ ‡è¯†ï¼Œå¯¹äºä¸´æ—¶å€¼æˆ‘ä»¬ä»…ä»…éœ€è¦åšæµ…æ‹·è´å³å¯ï¼Œæ— éœ€å†åšæ·±æ‹·è´ï¼Œä»è€Œè§£å†³äº†å‰é¢æåˆ°çš„ä¸´æ—¶å˜é‡æ‹·è´æ„é€ äº§ç”Ÿçš„æ€§èƒ½æŸå¤±çš„é—®é¢˜ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ç§»åŠ¨è¯­ä¹‰ï¼Œå³å€¼å¼•ç”¨çš„ä¸€ä¸ªé‡è¦ä½œç”¨æ˜¯ç”¨æ¥æ”¯æŒç§»åŠ¨è¯­ä¹‰çš„ã€‚\néœ€è¦æ³¨æ„çš„ä¸€ä¸ªç»†èŠ‚æ˜¯ï¼Œæˆ‘ä»¬æä¾›ç§»åŠ¨æ„é€ å‡½æ•°çš„åŒæ—¶ä¹Ÿä¼šæä¾›ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œä»¥é˜²æ­¢ç§»åŠ¨ä¸æˆåŠŸçš„æ—¶å€™è¿˜èƒ½æ‹·è´æ„é€ ï¼Œä½¿æˆ‘ä»¬çš„ä»£ç æ›´å®‰å…¨ã€‚\næˆ‘ä»¬çŸ¥é“ç§»åŠ¨è¯­ä¹‰æ˜¯é€šè¿‡å³å€¼å¼•ç”¨æ¥åŒ¹é…ä¸´æ—¶å€¼çš„ï¼Œé‚£ä¹ˆï¼Œæ™®é€šçš„å·¦å€¼æ˜¯å¦ä¹Ÿèƒ½å€ŸåŠ©ç§»åŠ¨è¯­ä¹‰æ¥ä¼˜åŒ–æ€§èƒ½å‘¢ï¼Œé‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿäº‹å®ä¸ŠC++11ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæä¾›äº†std::moveæ–¹æ³•æ¥å°†å·¦å€¼è½¬æ¢ä¸ºå³å€¼ï¼Œä»è€Œæ–¹ä¾¿åº”ç”¨ç§»åŠ¨è¯­ä¹‰ã€‚moveæ˜¯å°†å¯¹è±¡èµ„æºçš„æ‰€æœ‰æƒä»ä¸€ä¸ªå¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªå¯¹è±¡ï¼Œåªæ˜¯è½¬ç§»ï¼Œæ²¡æœ‰å†…å­˜çš„æ‹·è´ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„moveè¯­ä¹‰ã€‚å¦‚å›¾1-1æ‰€ç¤ºæ˜¯æ·±æ‹·è´å’Œmoveçš„åŒºåˆ«ã€‚\nå›¾1-1 æ·±æ‹·è´å’Œmoveçš„åŒºåˆ«\nå†çœ‹çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n1234567&#123;    std::list&lt; std::string&gt; tokens;    //çœç•¥åˆå§‹åŒ–...    std::list&lt; std::string&gt; t = tokens; //è¿™é‡Œå­˜åœ¨æ‹·è´ &#125;std::list&lt; std::string&gt; tokens;std::list&lt; std::string&gt; t = std::move(tokens);  //è¿™é‡Œæ²¡æœ‰æ‹·è´\nå¦‚æœä¸ç”¨std::moveï¼Œæ‹·è´çš„ä»£ä»·å¾ˆå¤§ï¼Œæ€§èƒ½è¾ƒä½ã€‚ä½¿ç”¨moveå‡ ä¹æ²¡æœ‰ä»»ä½•ä»£ä»·ï¼Œåªæ˜¯è½¬æ¢äº†èµ„æºçš„æ‰€æœ‰æƒã€‚ä»–å®é™…ä¸Šå°†å·¦å€¼å˜æˆå³å€¼å¼•ç”¨ï¼Œç„¶ååº”ç”¨ç§»åŠ¨è¯­ä¹‰ï¼Œè°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°ï¼Œå°±é¿å…äº†æ‹·è´ï¼Œæé«˜äº†ç¨‹åºæ€§èƒ½ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡å†…éƒ¨æœ‰è¾ƒå¤§çš„å¯¹å†…å­˜æˆ–è€…åŠ¨æ€æ•°ç»„æ—¶ï¼Œå¾ˆæœ‰å¿…è¦å†™moveè¯­ä¹‰çš„æ‹·è´æ„é€ å‡½æ•°å’Œèµ‹å€¼å‡½æ•°ï¼Œé¿å…æ— è°“çš„æ·±æ‹·è´ï¼Œä»¥æé«˜æ€§èƒ½ã€‚äº‹å®ä¸Šï¼ŒC++11ä¸­æ‰€æœ‰çš„å®¹å™¨éƒ½å®ç°äº†ç§»åŠ¨è¯­ä¹‰ï¼Œæ–¹ä¾¿æˆ‘ä»¬åšæ€§èƒ½ä¼˜åŒ–ã€‚\nè¿™é‡Œä¹Ÿè¦æ³¨æ„å¯¹moveè¯­ä¹‰çš„è¯¯è§£ï¼Œmoveå®é™…ä¸Šå®ƒå¹¶ä¸èƒ½ç§»åŠ¨ä»»ä½•ä¸œè¥¿ï¼Œå®ƒå”¯ä¸€çš„åŠŸèƒ½æ˜¯å°†ä¸€ä¸ªå·¦å€¼å¼ºåˆ¶è½¬æ¢ä¸ºä¸€ä¸ªå³å€¼å¼•ç”¨ã€‚å¦‚æœæ˜¯ä¸€äº›åŸºæœ¬ç±»å‹æ¯”å¦‚intå’Œchar[10]å®šé•¿æ•°ç»„ç­‰ç±»å‹ï¼Œä½¿ç”¨moveçš„è¯ä»ç„¶ä¼šå‘ç”Ÿæ‹·è´ï¼ˆå› ä¸ºæ²¡æœ‰å¯¹åº”çš„ç§»åŠ¨æ„é€ å‡½æ•°ï¼‰ã€‚æ‰€ä»¥ï¼Œmoveå¯¹äºå«èµ„æºï¼ˆå †å†…å­˜æˆ–å¥æŸ„ï¼‰çš„å¯¹è±¡æ¥è¯´æ›´æœ‰æ„ä¹‰ã€‚\nç¬¬4è¡Œä»£ç æ•…äº‹\n1template &lt;typename T&gt;void f(T&amp;&amp; val)&#123; foo(std::forward&lt;T&gt;(val)); &#125;\nC++11ä¹‹å‰è°ƒç”¨æ¨¡æ¿å‡½æ•°æ—¶ï¼Œå­˜åœ¨ä¸€ä¸ªæ¯”è¾ƒå¤´ç–¼çš„é—®é¢˜ï¼Œå¦‚ä½•æ­£ç¡®çš„ä¼ é€’å‚æ•°ã€‚æ¯”å¦‚ï¼š\n12345678910template &lt;typename T&gt;void forwardValue(T&amp; val)&#123;    processValue(val); //å³å€¼å‚æ•°ä¼šå˜æˆå·¦å€¼ &#125;template &lt;typename T&gt;void forwardValue(const T&amp; val)&#123;    processValue(val); //å‚æ•°éƒ½å˜æˆå¸¸é‡å·¦å€¼å¼•ç”¨äº† &#125;\néƒ½ä¸èƒ½æŒ‰ç…§å‚æ•°çš„æœ¬æ¥çš„ç±»å‹è¿›è¡Œè½¬å‘ã€‚\nC11å¼•å…¥äº†å®Œç¾è½¬å‘ï¼šåœ¨å‡½æ•°æ¨¡æ¿ä¸­ï¼Œå®Œå…¨ä¾ç…§æ¨¡æ¿çš„å‚æ•°çš„ç±»å‹ï¼ˆå³ä¿æŒå‚æ•°çš„å·¦å€¼ã€å³å€¼ç‰¹å¾ï¼‰ï¼Œå°†å‚æ•°ä¼ é€’ç»™å‡½æ•°æ¨¡æ¿ä¸­è°ƒç”¨çš„å¦å¤–ä¸€ä¸ªå‡½æ•°ã€‚C11ä¸­çš„std::forwardæ­£æ˜¯åšè¿™ä¸ªäº‹æƒ…çš„ï¼Œä»–ä¼šæŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹è¿›è¡Œè½¬å‘ã€‚çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n12345678910111213141516void processValue(int&amp; a)&#123; cout &lt;&lt; \"lvalue\" &lt;&lt; endl; &#125;void processValue(int&amp;&amp; a)&#123; cout &lt;&lt; \"rvalue\" &lt;&lt; endl; &#125;template &lt;typename T&gt;void forwardValue(T&amp;&amp; val)&#123;    processValue(std::forward&lt;T&gt;(val)); //ç…§å‚æ•°æœ¬æ¥çš„ç±»å‹è¿›è¡Œè½¬å‘ã€‚&#125;void Testdelcl()&#123;    int i = 0;    forwardValue(i); //ä¼ å…¥å·¦å€¼     forwardValue(0);//ä¼ å…¥å³å€¼ &#125;è¾“å‡ºï¼šlvaue rvalue\nå³å€¼å¼•ç”¨T&amp;&amp;æ˜¯ä¸€ä¸ªuniversal referencesï¼Œå¯ä»¥æ¥å—å·¦å€¼æˆ–è€…å³å€¼ï¼Œæ­£æ˜¯è¿™ä¸ªç‰¹æ€§è®©ä»–é€‚åˆä½œä¸ºä¸€ä¸ªå‚æ•°çš„è·¯ç”±ï¼Œç„¶åå†é€šè¿‡std::forwardæŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹å»åŒ¹é…å¯¹åº”çš„é‡è½½å‡½æ•°ï¼Œæœ€ç»ˆå®ç°å®Œç¾è½¬å‘ã€‚\næˆ‘ä»¬å¯ä»¥ç»“åˆå®Œç¾è½¬å‘å’Œç§»åŠ¨è¯­ä¹‰æ¥å®ç°ä¸€ä¸ªæ³›å‹çš„å·¥å‚å‡½æ•°ï¼Œè¿™ä¸ªå·¥å‚å‡½æ•°å¯ä»¥åˆ›å»ºæ‰€æœ‰ç±»å‹çš„å¯¹è±¡ã€‚å…·ä½“å®ç°å¦‚ä¸‹ï¼š\n12345template&lt;typenameâ€¦  Args&gt;T* Instance(Args&amp;&amp;â€¦ args)&#123;    return new T(std::forward&lt;Args &gt;(args)â€¦);&#125;\nè¿™ä¸ªå·¥å‚å‡½æ•°çš„å‚æ•°æ˜¯å³å€¼å¼•ç”¨ç±»å‹ï¼Œå†…éƒ¨ä½¿ç”¨std::forwardæŒ‰ç…§å‚æ•°çš„å®é™…ç±»å‹è¿›è¡Œè½¬å‘ï¼Œå¦‚æœå‚æ•°çš„å®é™…ç±»å‹æ˜¯å³å€¼ï¼Œé‚£ä¹ˆåˆ›å»ºçš„æ—¶å€™ä¼šè‡ªåŠ¨åŒ¹é…ç§»åŠ¨æ„é€ ï¼Œå¦‚æœæ˜¯å·¦å€¼åˆ™ä¼šåŒ¹é…æ‹·è´æ„é€ ã€‚\næ€»ç»“\né€šè¿‡4è¡Œä»£ç æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯å³å€¼å’Œå³å€¼å¼•ç”¨ï¼Œä»¥åŠå³å€¼å¼•ç”¨çš„ä¸€äº›ç‰¹ç‚¹ï¼Œåˆ©ç”¨è¿™äº›ç‰¹ç‚¹æˆ‘ä»¬æ‰æ–¹ä¾¿å®ç°ç§»åŠ¨è¯­ä¹‰å’Œå®Œç¾è½¬å‘ã€‚C++11æ­£æ˜¯é€šè¿‡å¼•å…¥å³å€¼å¼•ç”¨æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œå…·ä½“æ¥è¯´æ˜¯é€šè¿‡ç§»åŠ¨è¯­ä¹‰æ¥é¿å…æ— è°“æ‹·è´çš„é—®é¢˜ï¼Œé€šè¿‡moveè¯­ä¹‰æ¥å°†ä¸´æ—¶ç”Ÿæˆçš„å·¦å€¼ä¸­çš„èµ„æºæ— ä»£ä»·çš„è½¬ç§»åˆ°å¦å¤–ä¸€ä¸ªå¯¹è±¡ä¸­å»ï¼Œé€šè¿‡å®Œç¾è½¬å‘æ¥è§£å†³ä¸èƒ½æŒ‰ç…§å‚æ•°å®é™…ç±»å‹æ¥è½¬å‘çš„é—®é¢˜ï¼ˆåŒæ—¶ï¼Œå®Œç¾è½¬å‘è·å¾—çš„ä¸€ä¸ªå¥½å¤„æ˜¯å¯ä»¥å®ç°ç§»åŠ¨è¯­ä¹‰ï¼‰ã€‚\næœ¬æ–‡æ›¾å‘è¡¨äºã€Šç¨‹åºå‘˜ã€‹2015å¹´1æœˆåˆŠã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚\n*åè®°ï¼š*æœ¬æ–‡çš„å†…å®¹ä¸»è¦æ¥è‡ªäºæˆ‘åœ¨å…¬å¸å†…éƒ¨åŸ¹è®­çš„ä¸€æ¬¡è¯¾ç¨‹ï¼Œå› ä¸ºå¾ˆå¤šäººå¯¹C++11å³å€¼å¼•ç”¨æä¸æ¸…æˆ–è€…ç†è§£å¾—ä¸æ·±å…¥ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—æœ‰å¿…è¦æ‹¿å‡ºæ¥åˆ†äº«ä¸€ä¸‹ï¼Œè®©æ›´å¤šçš„äººçœ‹åˆ°ï¼Œå°±æ•´ç†äº†ä¸€ä¸‹å‘åˆ°ç¨‹åºå‘˜æ‚å¿—äº†ï¼Œæˆ‘ç›¸ä¿¡è¯»è€…çœ‹å®Œä¹‹åå¯¹å³å€¼å¼•ç”¨ä¼šæœ‰å…¨é¢æ·±å…¥çš„äº†è§£ã€‚\nä¸€ç‚¹æ¢¦æƒ³ï¼šå°½è‡ªå·±ä¸€ä»½åŠ›ï¼Œè®©c++çš„ä¸–ç•Œå˜å¾—æ›´ç¾å¥½ï¼\n","thumbnail":"/posts/å³å€¼å¼•ç”¨/app-launch.png","plink":"https://shuntan.github.io/posts/å³å€¼å¼•ç”¨/"},{"title":"squidä»‹ç»åŠå…¶ç®€å•é…ç½®","date":"2019-05-15T07:15:30.000Z","date_formatted":{"ll":"May 15, 2019","L":"05/15/2019","MM-DD":"05-15"},"updated":"2020-04-22T07:21:20.523Z","content":"squidçš„æ¦‚å¿µ\nsquidæ˜¯ä¸€ç§ç”¨æ¥ç¼“å­˜Internetæ•°æ®çš„è½¯ä»¶ã€‚æ¥å—æ¥è‡ªäººä»¬éœ€è¦ä¸‹è½½çš„ç›®æ ‡ï¼ˆobjectï¼‰çš„è¯·æ±‚å¹¶é€‚å½“çš„å¤„ç†è¿™äº›è¯·æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªäººæƒ³ä¸‹è½½ä¸€webç•Œé¢ï¼Œä»–è¯·æ±‚squidä¸ºä»–å–å¾—è¿™ä¸ªé¡µé¢ã€‚squidéšä¹‹è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨å¹¶å‘è¿™ä¸ªé¡µé¢å‘å‡ºè¯·æ±‚ã€‚ç„¶åï¼Œsquidæ˜¾å¼åœ°èšé›†æ•°æ®åˆ°å®¢æˆ·ç«¯æœºå™¨ï¼Œè€Œä¸”åŒæ—¶å¤åˆ¶ä¸€ä»½ã€‚å½“ä¸‹ä¸€æ¬¡æœ‰äººéœ€è¦åŒä¸€é¡µé¢æ—¶ï¼Œ squidå¯ä»¥ç®€å•çš„ä»ç£ç›˜ä¸­è¯»åˆ°å®ƒï¼Œé‚£æ ·æ•°æ®ä¼šç«‹å³ä¼ è¾“åˆ°å®¢æˆ·æœºä¸Šã€‚\n\nä¸‹è½½åœ°å€\nsquid-cache å®˜ç½‘ http://www.squid-cache.org\nsquidä»‹ç»åŠå…¶ç®€å•é…ç½® https://www.cnblogs.com/cherishry/p/5706736.html\nCentOS 7å®‰è£…squidä»£ç†æœåŠ¡å™¨ https://blog.csdn.net/ithomer/article/details/78136993\nsquidä»£ç†çš„ä½œç”¨\n\né€šè¿‡ç¼“å­˜çš„æ–¹å¼ä¸ºç”¨æˆ·æä¾›Webè®¿é—®åŠ é€Ÿ\nå¯¹ç”¨æˆ·çš„Webè®¿é—®è¿›è¡Œè¿‡æ»¤æ§åˆ¶\n\nå·¥ä½œæµç¨‹\nå½“ä»£ç†æœåŠ¡å™¨ä¸­æœ‰å®¢æˆ·ç«¯éœ€è¦çš„æ•°æ®æ—¶ï¼š\na.å®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ï¼›\nb.ä»£ç†æœåŠ¡å™¨æ£€æŸ¥è‡ªå·±çš„æ•°æ®ç¼“å­˜ï¼›\nc.ä»£ç†æœåŠ¡å™¨åœ¨ç¼“å­˜ä¸­æ‰¾åˆ°äº†ç”¨æˆ·æƒ³è¦çš„æ•°æ®ï¼Œå–å‡ºæ•°æ®ï¼›\nd.ä»£ç†æœåŠ¡å™¨å°†ä»ç¼“å­˜ä¸­å–å¾—çš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚\nå½“ä»£ç†æœåŠ¡å™¨ä¸­æ²¡æœ‰å®¢æˆ·ç«¯éœ€è¦çš„æ•°æ®æ—¶äº†ï¼š\n1.å®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ï¼›\n2.ä»£ç†æœåŠ¡å™¨æ£€æŸ¥è‡ªå·±çš„æ•°æ®ç¼“å­˜ï¼›\n3.ä»£ç†æœåŠ¡å™¨åœ¨ç¼“å­˜ä¸­æ²¡æœ‰æ‰¾åˆ°ç”¨æˆ·æƒ³è¦çš„æ•°æ®ï¼›\n4.ä»£ç†æœåŠ¡å™¨å‘Internet ä¸Šçš„è¿œç«¯æœåŠ¡å™¨å‘é€æ•°æ®è¯·æ±‚ï¼›\n5.è¿œç«¯æœåŠ¡å™¨å“åº”ï¼Œè¿”å›ç›¸åº”çš„æ•°æ®ï¼›\n6.ä»£ç†æœåŠ¡å™¨å–å¾—è¿œç«¯æœåŠ¡å™¨çš„æ•°æ®ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¹¶ä¿ç•™ä¸€ä»½åˆ°è‡ªå·±çš„æ•°æ®ç¼“å­˜ä¸­ã€‚\n\nSquidä»£ç†æœåŠ¡å™¨å·¥ä½œåœ¨TCP/IPåº”ç”¨å±‚\n\nSquidå„ç§ä»£ç†çš„å®šä¹‰\næ­£å‘ä»£ç†\næ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡å™¨\nä¸€ä¸ªæ ‡å‡†çš„ä»£ç†ç¼“å†²æœåŠ¡è¢«ç”¨äºç¼“å­˜é™æ€çš„ç½‘é¡µåˆ°æœ¬åœ°ç½‘ç»œä¸Šçš„ä¸€å°ä¸»æœºä¸Šï¼ˆå³ä»£ç†æœåŠ¡å™¨ï¼‰ã€‚å½“è¢«ç¼“å­˜çš„é¡µé¢è¢«ç¬¬äºŒæ¬¡è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°†ç›´æ¥ä»æœ¬åœ°ä»£ç†æœåŠ¡å™¨é‚£é‡Œè·å–è¯·æ±‚æ•°æ®è€Œä¸å†å‘åŸwebç«™ç‚¹è¯·æ±‚æ•°æ®ã€‚è¿™æ ·å°±èŠ‚çœäº†å®è´µçš„ç½‘ç»œå¸¦å®½ï¼Œè€Œä¸”æé«˜äº†è®¿é—®é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œè¦æƒ³å®ç°è¿™ç§æ–¹å¼ï¼Œå¿…é¡»åœ¨æ¯ä¸€ä¸ªå†…éƒ¨ä¸»æœºçš„æµè§ˆå™¨ä¸Šæ˜ç¡®æŒ‡åä»£ç†æœåŠ¡å™¨çš„IPåœ°å€å’Œç«¯å£å·ã€‚å®¢æˆ·ç«¯ä¸Šç½‘æ—¶ï¼Œæ¯æ¬¡éƒ½æŠŠè¯·æ±‚å‘é€ç»™ä»£ç†æœåŠ¡å™¨å¤„ç†,ä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚ç¡®å®šæ˜¯å¦è¿æ¥åˆ°è¿œç¨‹webæœåŠ¡å™¨è·å–æ•°æ®ã€‚å¦‚æœåœ¨æœ¬åœ°ç¼“å†²åŒºæœ‰ç›®æ ‡æ–‡ä»¶ï¼Œåˆ™ç›´æ¥å°†æ–‡ä»¶ä¼ ç»™ç”¨æˆ·å³å¯ã€‚å¦‚æœæ²¡æœ‰çš„è¯åˆ™å…ˆå–å›æ–‡ä»¶ï¼Œå…ˆåœ¨æœ¬åœ°ä¿å­˜ä¸€ä»½ç¼“å†²ï¼Œç„¶åå°†æ–‡ä»¶å‘é€ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚\né€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨\né€æ˜ä»£ç†ç¼“å†²æœåŠ¡å™¨å’Œæ ‡å‡†ä»£ç†æœåŠ¡å™¨çš„åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚ä½†æ˜¯ï¼Œä»£ç†æ“ä½œå¯¹å®¢æˆ·ç«¯çš„æµè§ˆå™¨æ˜¯é€æ˜çš„ï¼ˆå³ä¸éœ€æŒ‡æ˜ä»£ç†æœåŠ¡å™¨çš„IPå’Œç«¯å£ï¼‰ã€‚é€æ˜ä»£ç†æœåŠ¡å™¨é˜»æ–­ç½‘ç»œé€šä¿¡ï¼Œå¹¶ä¸”è¿‡æ»¤å‡ºè®¿é—®å¤–éƒ¨çš„HTTPï¼ˆ80ç«¯å£ï¼‰æµé‡ã€‚å¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚åœ¨æœ¬åœ°æœ‰ç¼“å†²åˆ™å°†ç¼“å†²çš„æ•°æ®ç›´æ¥å‘ç»™ç”¨æˆ·ï¼Œå¦‚æœåœ¨æœ¬åœ°æ²¡æœ‰ç¼“å†²åˆ™å‘è¿œç¨‹webæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå…¶ä½™æ“ä½œå’Œæ ‡å‡†çš„ä»£ç†æœåŠ¡å™¨å®Œå…¨ç›¸åŒã€‚å¯¹äºlinuxæ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œé€æ˜ä»£ç†ä½¿ç”¨Iptablesæˆ–è€…Ipchainså®ç°ã€‚å› æ­¤ä¸éœ€è¦å¯¹æµè§ˆå™¨ä½œä»»ä½•è®¾ç½®ï¼Œæ‰€ä»¥ï¼Œé€æ˜ä»£ç†å¯¹äºISPï¼ˆInternetæœåŠ¡å™¨æä¾›å•†ï¼‰ç‰¹åˆ«æœ‰ç”¨ã€‚\nåå‘ä»£ç†\nåå‘ä»£ç†ç¼“å†²å™¨\nåå‘ä»£ç†æ˜¯å’Œå‰ä¸¤ç§ä»£ç†å®Œå…¨ä¸åŒçš„ä¸€ç§ä»£ç†æœåŠ¡ã€‚ä½¿ç”¨å®ƒå¯ä»¥é™ä½åŸå§‹WEBæœåŠ¡å™¨çš„è´Ÿè½½ã€‚åå‘ä»£ç†æœåŠ¡å™¨æ‰¿æ‹…äº†å¯¹åŸå§‹WEBæœåŠ¡å™¨çš„é™æ€é¡µé¢çš„è¯·æ±‚ï¼Œé˜²æ­¢åŸå§‹æœåŠ¡å™¨è¿‡è½½ã€‚å®ƒä½äºWEBæœåŠ¡å™¨å’ŒInternetä¹‹é—´ï¼Œå¤„ç†æ‰€æœ‰å¯¹WEBæœåŠ¡å™¨çš„è¯·æ±‚ï¼Œç»„ç»‡äº†WEBæœåŠ¡å™¨å’ŒInternetçš„ç›´æ¥é€šä¿¡ã€‚å¦‚æœäº’è”ç½‘ç”¨æˆ·è¯·æ±‚çš„é¡µé¢åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šæœ‰ç¼“å†²çš„è¯ï¼Œä»£ç†æœåŠ¡å™¨ç›´æ¥å°†ç¼“å†²å†…å®¹å‘é€ç»™ç”¨æˆ·ã€‚å¦‚æœæ²¡æœ‰ç¼“å†²åˆ™å…ˆå‘WEBæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œå–å›æ•°æ®ï¼Œæœ¬åœ°ç¼“å­˜åå†å‘ç»™ç”¨æˆ·ã€‚è¿™ç§æ–¹å¼é€šè¿‡é™ä½äº†WEBæœåŠ¡å™¨çš„è¯·æ±‚æ•°ä»è€Œé™ä½äº†WEBæœåŠ¡å™¨çš„è´Ÿè½½ã€‚\næ­£å‘ä»£ç†ä¸åå‘ä»£ç†çš„åŒºåˆ«\næ¦‚å¿µ\næ­£å‘ä»£ç†ï¼šå¯¹äºåŸå§‹æœåŠ¡å™¨è€Œè¨€ï¼Œå°±æ˜¯å®¢æˆ·ç«¯çš„ä»£è¨€äºº\nåå‘ä»£ç†ï¼šå¯¹äºå®¢æˆ·ç«¯è€Œè¨€ï¼Œå°±åƒæ˜¯åŸå§‹æœåŠ¡å™¨\nç”¨é€”\næ­£å‘ä»£ç†çš„å…¸å‹ç”¨é€”æ˜¯ä¸ºåœ¨é˜²ç«å¢™å†…çš„å±€åŸŸç½‘å®¢æˆ·ç«¯æä¾›è®¿é—®Internetçš„é€”å¾„ã€‚æ­£å‘ä»£ç†è¿˜å¯ä»¥ä½¿ç”¨ç¼“å†²ç‰¹æ€§å‡å°‘ç½‘ç»œä½¿ç”¨ç‡ã€‚\nåå‘ä»£ç†è¿˜å¯ä»¥ä¸ºåç«¯çš„å¤šå°æœåŠ¡å™¨æä¾›è´Ÿè½½å¹³è¡¡ï¼Œæˆ–ä¸ºåç«¯è¾ƒæ…¢çš„æœåŠ¡å™¨æä¾›ç¼“å†²æœåŠ¡ã€‚å¦å¤–ï¼Œåå‘ä»£ç†è¿˜å¯ä»¥å¯ç”¨é«˜çº§URLç­–ç•¥å’Œç®¡ç†æŠ€æœ¯ï¼Œä»è€Œä½¿å¤„äºä¸åŒwebæœåŠ¡å™¨ç³»ç»Ÿçš„webé¡µé¢åŒæ—¶å­˜åœ¨äºåŒä¸€ä¸ªURLç©ºé—´ä¸‹ã€‚\nå®‰å…¨æ€§\næ­£å‘ä»£ç†å…è®¸å®¢æˆ·ç«¯é€šè¿‡å®ƒè®¿é—®ä»»æ„ç½‘ç«™å¹¶ä¸”éšè—å®¢æˆ·ç«¯è‡ªèº«ï¼Œå› æ­¤ä½ å¿…é¡»é‡‡å–å®‰å…¨æªæ–½ä»¥ç¡®ä¿ä»…ä¸ºç»è¿‡æˆæƒçš„å®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚\nåå‘ä»£ç†å¯¹å¤–éƒ½æ˜¯é€æ˜çš„ï¼Œè®¿é—®è€…å¹¶ä¸çŸ¥é“è‡ªå·±è®¿é—®çš„æ˜¯ä¸€ä¸ªä»£ç†ã€‚\nSquidä¸»è¦ç»„æˆéƒ¨åˆ†\næœåŠ¡åï¼šsquid\nä¸»ç¨‹åºï¼š/usr/sbin/squid\né…ç½®ç›®å½•ï¼š/etc/squid\nä¸»é…ç½®æ–‡ä»¶ï¼š/etc/squid/squid.conf\nç›‘å¬tcpç«¯å£å·ï¼š3128\né»˜è®¤è®¿é—®æ—¥å¿—æ–‡ä»¶ï¼š/var/log/squid/access.log\nsquidå¸¸ç”¨é…ç½®é€‰é¡¹\n/etc/squid/squid.conf\n123456789101112131415http_port 3128  (è¿˜å¯ä»¥åªç›‘å¬ä¸€ä¸ªIP http_port 192.168.0.1:3128)cache_mem 64MB  #ç¼“å­˜å å†…å­˜å¤§å°maximum_object_size 4096KB  #æœ€å¤§ç¼“å­˜å—reply_body_max_size  1024000 allow all      #é™å®šä¸‹è½½æ–‡ä»¶å¤§å°access_log /var/log/squid/access.log    #è®¿é—®æ—¥å¿—å­˜æ”¾çš„åœ°æ–¹visible_hostname    proxy.test.xom  #å¯è§çš„ä¸»æœºåcache_dir ufs /var/spool/squid  100 16 256 #ufs:ç¼“å­˜æ•°æ®çš„å­˜å‚¨æ ¼å¼#/var/spool/squid    ç¼“å­˜ç›®å½•#100ï¼šç¼“å­˜ç›®å½•å ç£ç›˜ç©ºé—´å¤§å°ï¼ˆMï¼‰#16ï¼šç¼“å­˜ç©ºé—´ä¸€çº§å­ç›®å½•ä¸ªæ•°#256ï¼šç¼“å­˜ç©ºé—´äºŒçº§å­ç›®å½•ä¸ªæ•°cache_mgr webmaster@test.com    #å®šä¹‰ç®¡ç†å‘˜é‚®ç®±http_access deny all    #è®¿é—®æ§åˆ¶\nsquidä¸­çš„è®¿é—®æ§åˆ¶\nä½¿ç”¨è®¿é—®æ§åˆ¶ç‰¹æ€§ï¼Œå¯ä»¥æ§åˆ¶åœ¨è®¿é—®æ—¶æ ¹æ®ç‰¹å®šçš„æ—¶é—´é—´éš”è¿›è¡Œç¼“å­˜ã€è®¿é—®ç‰¹å®šç«™ç‚¹æˆ–ä¸€ç»„ç«™ç‚¹ç­‰ç­‰ã€‚squidè®¿é—®æ§åˆ¶æœ‰ä¸¤ä¸ªè¦ç´ ï¼šACLå…ƒç´ å’Œè®¿é—®åˆ—è¡¨ã€‚è®¿é—®åˆ—è¡¨å¯ä»¥å…è®¸æˆ–æ‹’ç»æŸäº›ç”¨æˆ·å¯¹æ­¤æœåŠ¡çš„è®¿é—®ã€‚\nACLå…ƒç´ ç±»å‹\n\nsrcï¼šæºåœ°å€ï¼ˆå³å®¢æˆ·æœºIPåœ°å€ï¼‰\ndstï¼šç›®æ ‡åœ°å€ï¼ˆå³æœåŠ¡å™¨IPåœ°å€ï¼‰\nsrcdomainï¼šæºåç§°ï¼ˆå³å®¢æˆ·æœºåç§°ï¼‰\ndstdomainï¼šç›®æ ‡åç§°ï¼ˆå³æœåŠ¡å™¨åç§°ï¼‰\ntimeï¼šä¸€å¤©ä¸­çš„æ—¶åˆ»å’Œä¸€å‘¨å†…çš„ä¸€å¤©\nurl_regexï¼šURLè§„åˆ™è¡¨è¾¾å¼åŒ¹é…\nurlpath_regexï¼šURL-pathè§„åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œç•¥å»åè®®å’Œä¸»æœºå\nproxy_authï¼šé€šè¿‡å¤–éƒ¨ç¨‹åºè¿›è¡Œç”¨æˆ·éªŒè¯\nmaxconnï¼šå•ä¸€IPçš„æœ€å¤§è¿æ¥æ•°\n\nACLæ ¼å¼\nä¸ºäº†ä½¿ç”¨æ§åˆ¶åŠŸèƒ½ï¼Œå¿…é¡»å…ˆè®¾ç½®ACLè§„åˆ™å¹¶åº”ç”¨ã€‚ACLå£°æ˜çš„æ ¼å¼å¦‚ä¸‹ï¼š\n\næ³¨ï¼š\n\nacl_element_name å¯ä»¥æ˜¯ä»»ä¸€ä¸ªåœ¨ACLä¸­å®šä¹‰çš„åç§°\nä»»ä½•ä¸¤ä¸ªACLå…ƒç´ ä¸èƒ½ç”¨ç›¸åŒçš„åå­—\næ¯ä¸ªACLç”±åˆ—è¡¨å€¼ç»„æˆã€‚å½“è¿›è¡ŒåŒ¹é…æ£€æµ‹çš„æ—¶å€™ï¼Œå¤šä¸ªå€¼ç”±é€»è¾‘æˆ–è¿ç®—è¿æ¥ï¼›æ¢è¨€ä¹‹ï¼Œå³ä»»ä¸€ACLå…ƒç´ çš„å€¼è¢«åŒ¹é…ï¼Œåˆ™è¿™ä¸ªACLå…ƒç´ å³è¢«åŒ¹é…ã€‚\nå¹¶ä¸æ˜¯æ‰€æœ‰ACLå…ƒç´ éƒ½èƒ½ä½¿ç”¨è®¿é—®åˆ—è¡¨ä¸­çš„å…¨éƒ¨ç±»å‹\nä¸åŒçš„ACLå…ƒç´ å†™åœ¨ä¸åŒè¡Œä¸­ï¼Œsquidå°†æŠŠä»–ä»¬ç»„åˆåœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­\n\nè®¿é—®æ¡ç›®\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨è®¸å¤šä¸åŒçš„è®¿é—®æ¡ç›®ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„å‡ ä¸ªï¼š\n\nhttp_access:å…è®¸HTTPè®¿é—®\nno_cache:å®šä¹‰å¯¹ç¼“å­˜è¯·æ±‚çš„å“åº”ã€‚\nè®¿é—®åˆ—è¡¨çš„è§„åˆ™ç”±ä¸€äº›ç±»ä¼¼â€™allowâ€™æˆ–â€˜denyâ€™çš„å…³é”®å­—æ„æˆï¼Œç”¨ä»¥å…è®¸æˆ–æ‹’ç»å‘ç‰¹å®šæˆ–ä¸€ç»„ACLå…ƒç´ æä¾›æœåŠ¡ã€‚\n\n\nä¸€ä¸ªè®¿é—®åˆ—è¡¨å¯ä»¥ç”±å¤šæ¡è§„åˆ™ç»„æˆ\nå¦‚æœæ²¡æœ‰ä»»ä½•è§„åˆ™ä¸è®¿é—®è¯·æ±‚åŒ¹é…ï¼Œé»˜è®¤åŠ¨ä½œå°†ä¸åˆ—è¡¨ä¸­æœ€åä¸€æ¡è§„åˆ™å¯¹åº”ã€‚\nä¸€ä¸ªè®¿é—®æ¡ç›®ä¸­æ‰€æœ‰å…ƒç´ å°†ç”¨é€»è¾‘ä¸è¿ç®—è¿æ¥\nhttp_access Action å£°æ˜1 AND å£°æ˜2 AND å£°æ˜ OR.\nhttp_access Action å£°æ˜3\nå¤šä¸ªhttp_accessså£°æ˜é—´ç”¨æˆ–è¿ç®—è¿æ¥ï¼Œä½†æ¯ä¸ªè®¿é—®æ¡ç›®çš„å…ƒç´ é—´ç”¨ä¸è¿ç®—è¿æ¥ã€‚\nåˆ—è¡¨ä¸­çš„è§„åˆ™æ€»æ˜¯éµå¾ªç”±ä¸Šè€Œä¸‹çš„é¡ºåº\nè¿™äº›è§„åˆ™æŒ‰ç…§ä»–ä»¬çš„æ’åˆ—é¡ºåºè¿›è¡ŒåŒ¹é…æ£€æµ‹ï¼Œä¸€æ—¦æ£€æµ‹åˆ°åŒ¹é…çš„è§„åˆ™ï¼ŒåŒ¹é…å°±ç«‹å³ç»“æŸã€‚\n\nSquid.confé…ç½®æ–‡ä»¶è¯¦è§£\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156#acl all src 0.0.0.0/0.0.0.0 and http_access allow allé€‰é¡¹å®šä¹‰äº†ä¸€ä¸ªè®¿é—®æ§åˆ¶åˆ—è¡¨ã€‚è¯¦ç»†æƒ…å†µå‚è§å’ŒSquidè½¯ä»¶#æºå¸¦çš„æ–‡æ¡£ã€‚è¿™é‡Œçš„è®¿é—®æ§åˆ¶åˆ—è¡¨å…è®¸æ‰€æœ‰å¯¹ä»£ç†æœåŠ¡çš„è®¿é—®ï¼Œå› ä¸ºè¿™é‡Œè¯¥ä»£ç†æ˜¯åŠ é€ŸwebæœåŠ¡å™¨ã€‚acl all src 0.0.0.0/0.0.0.0                 #å…è®¸æ‰€æœ‰IPè®¿é—®acl manager proto http                 #manager urlåè®®ä¸ºhttpacl localhost src 127.0.0.1/255.255.255.255  #å…åˆæœ¬æœºIPacl to_localhost dst 127.0.0.1                 #å…åˆç›®çš„åœ°å€ä¸ºæœ¬æœºIPacl Safe_ports port 80                # å…è®¸å®‰å…¨æ›´æ–°çš„ç«¯å£ä¸º80acl CONNECT method CONNECT        #è¯·æ±‚æ–¹æ³•ä»¥CONNECThttp_access allow all                #å…è®¸æ‰€æœ‰äººä½¿ç”¨è¯¥ä»£ç†.å› ä¸ºè¿™é‡Œæ˜¯ä»£ç†åŠ é€ŸwebæœåŠ¡å™¨http_reply_access allow all                #å…è®¸æ‰€æœ‰å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†acl OverConnLimit maxconn 16        #é™åˆ¶æ¯ä¸ªIPæœ€å¤§å…è®¸16ä¸ªè¿æ¥ï¼Œé˜²æ­¢æ”»å‡»http_access deny OverConnLimiticp_access deny all                        #ç¦æ­¢ä»é‚»å±…æœåŠ¡å™¨ç¼“å†²å†…å‘é€å’Œæ¥æ”¶ICPè¯·æ±‚.miss_access allow all                #å…è®¸ç›´æ¥æ›´æ–°è¯·æ±‚ident_lookup_access deny all                                #ç¦æ­¢lookupæ£€æŸ¥DNShttp_port 8080 transparent                                #æŒ‡å®šSquidç›‘å¬æµè§ˆå™¨å®¢æˆ·è¯·æ±‚çš„ç«¯å£å·ã€‚hierarchy_stoplist cgi-bin ?                #ç”¨æ¥å¼ºåˆ¶æŸäº›ç‰¹å®šçš„å¯¹è±¡ä¸è¢«ç¼“å­˜ï¼Œä¸»è¦æ˜¯å¤„äºå®‰å…¨çš„ç›®çš„ã€‚acl QUERY urlpath_regex cgi-bin \\?cache deny QUERYcache_mem 1 GB        #è¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–é€‰é¡¹ï¼Œå¢åŠ è¯¥å†…å­˜å€¼æœ‰åˆ©äºç¼“å­˜ã€‚åº”è¯¥æ³¨æ„çš„æ˜¯ï¼š                     #ä¸€èˆ¬æ¥è¯´å¦‚æœç³»ç»Ÿæœ‰å†…å­˜ï¼Œè®¾ç½®è¯¥å€¼ä¸º(n/)3Mã€‚ç°åœ¨æ˜¯3G æ‰€ä»¥è¿™é‡Œ1Gfqdncache_size 1024        #FQDN é«˜é€Ÿç¼“å­˜å¤§å°maximum_object_size_in_memory 2 MB        #å…è®¸æœ€å¤§çš„æ–‡ä»¶è½½å…¥å†…å­˜memory_replacement_policy heap LFUDA  #åŠ¨æ€ä½¿ç”¨æœ€å°çš„ï¼Œç§»å‡ºå†…å­˜cachecache_replacement_policy heap LFUDA         #åŠ¨æ€ä½¿ç”¨æœ€å°çš„ï¼Œç§»å‡ºç¡¬ç›˜cachecache_dir ufs /home/cache 5000 32 512  #é«˜é€Ÿç¼“å­˜ç›®å½• ufs ç±»å‹ ä½¿ç”¨çš„ç¼“å†²å€¼æœ€å¤§å…åˆ1000MBç©ºé—´ï¼Œ#32ä¸ªä¸€çº§ç›®å½•ï¼Œ512ä¸ªäºŒçº§ç›®å½•max_open_disk_fds 0                                 #å…è®¸æœ€å¤§æ‰“å¼€æ–‡ä»¶æ•°é‡,0 æ— é™åˆ¶minimum_object_size 1 KB                         #å…åˆæœ€å°æ–‡ä»¶è¯·æ±‚ä½“å¤§å°maximum_object_size 20 MB                 #å…åˆæœ€å¤§æ–‡ä»¶è¯·æ±‚ä½“å¤§å°cache_swap_low 90                            #æœ€å°å…è®¸ä½¿ç”¨swap 90%cache_swap_high 95                            #æœ€å¤šå…è®¸ä½¿ç”¨swap 95%ipcache_size 2048                                # IP åœ°å€é«˜é€Ÿç¼“å­˜å¤§å° 2Mipcache_low 90                                #æœ€å°å…è®¸ipcacheä½¿ç”¨swap 90%ipcache_high 95                                  #æœ€å¤§å…è®¸ipcacheä½¿ç”¨swap 90%access_log /var/log/squid/access.log squid        #å®šä¹‰æ—¥å¿—å­˜æ”¾è®°å½•cache_log /var/log/squid/cache.log squidcache_store_log none                        #ç¦æ­¢storeæ—¥å¿—emulate_httpd_log on        #å°†ä½¿Squidä»¿ç…§WebæœåŠ¡å™¨çš„æ ¼å¼åˆ›å»ºè®¿é—®è®°å½•ã€‚å¦‚æœå¸Œæœ›ä½¿ç”¨                                #Webè®¿é—®è®°å½•åˆ†æç¨‹åºï¼Œå°±éœ€è¦è®¾ç½®è¿™ä¸ªå‚æ•°ã€‚refresh_pattern . 0 20% 4320 override-expire override-lastmod reload-into-ims ignore-reload   #æ›´æ–°cacheè§„åˆ™acl buggy_server url_regex ^http://.... http://          #åªå…è®¸httpçš„è¯·æ±‚broken_posts allow buggy_serveracl apache rep_header Server ^Apache                 #å…è®¸apacheçš„ç¼–ç broken_vary_encoding allow apacherequest_entities off                                        #ç¦æ­¢éhttpçš„æ ‡åˆ†å‡†è¯·æ±‚ï¼Œé˜²æ­¢æ”»å‡»header_access header allow all                        #å…è®¸æ‰€æœ‰çš„httpæŠ¥å¤´relaxed_header_parser on                                #ä¸ä¸¥æ ¼åˆ†æhttpæŠ¥å¤´.client_lifetime 120 minute                                #æœ€å¤§å®¢æˆ·è¿æ¥æ—¶é—´ 120åˆ†é’Ÿcache_mgr sky@test.com                        #æŒ‡å®šå½“ç¼“å†²å‡ºç°é—®é¢˜æ—¶å‘ç¼“å†²ç®¡ç†è€…å‘é€å‘Šè­¦ä¿¡æ¯çš„åœ°å€ä¿¡æ¯ã€‚cache_effective_user squid                        #è¿™é‡Œä»¥ç”¨æˆ·squidçš„èº«ä»½SquidæœåŠ¡å™¨cache_effective_group squidicp_port 0                       #æŒ‡å®šSquidä»é‚»å±…æœåŠ¡å™¨ç¼“å†²å†…å‘é€å’Œæ¥æ”¶ICPè¯·æ±‚çš„ç«¯å£å·ã€‚                     #è¿™é‡Œè®¾ç½®ä¸º0æ˜¯å› ä¸ºè¿™é‡Œé…ç½®Squidä¸ºå†…éƒ¨WebæœåŠ¡å™¨çš„åŠ é€Ÿå™¨ï¼Œ                     #æ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨é‚»å±…æœåŠ¡å™¨çš„ç¼“å†²ã€‚0æ˜¯ç¦ç”¨# cache_peer è®¾ç½®å…è®¸æ›´æ–°ç¼“å­˜çš„ä¸»æœºï¼Œå› æ˜¯æœ¬æœºæ‰€ä»¥127.0.0.1cache_peer 127.0.0.1 parent 80 0 no-query default multicast-responder no-netdb-exchangecache_peer_domain 127.0.0.1                                 hostname_aliases 127.0.0.1error_directory /usr/share/squid/errors/Simplify_Chinese        #å®šä¹‰é”™è¯¯è·¯å¾„always_direct allow all                # cacheä¸¢å¤±æˆ–ä¸å­˜åœ¨æ˜¯å…è®¸æ‰€æœ‰è¯·æ±‚ç›´æ¥è½¬å‘åˆ°åŸå§‹æœåŠ¡å™¨ignore_unknown_nameservers on        #å¼€åDNSæŸ¥è¯¢ï¼Œå½“åŸŸååœ°å€ä¸ç›¸åŒæ—¶å€™ï¼Œç¦æ­¢è®¿é—®coredump_dir  /var/log/squid                 #å®šä¹‰dumpçš„ç›®å½•max_filedesc 2048                #æœ€å¤§æ‰“å¼€çš„æ–‡ä»¶æè¿°half_closed_clients off        #ä½¿Squidåœ¨å½“readä¸å†è¿”å›æ•°æ®æ—¶ç«‹å³å…³é—­å®¢æˆ·ç«¯çš„è¿æ¥ã€‚                                #æœ‰æ—¶readä¸å†è¿”å›æ•°æ®æ˜¯ç”±äºæŸäº›å®¢æˆ·å…³é—­TCPçš„å‘é€æ•°æ®                                #è€Œä»ç„¶ä¿æŒæ¥æ”¶æ•°æ®ã€‚è€ŒSquidåˆ†è¾¨ä¸å‡ºTCPåŠå…³é—­å’Œå®Œå…¨å…³é—­ã€‚buffered_logs on #è‹¥æ‰“å¼€é€‰é¡¹â€œbuffered_logsâ€å¯ä»¥ç¨ç¨æé«˜åŠ é€ŸæŸäº›å¯¹æ—¥å¿—æ–‡ä»¶çš„å†™å…¥ï¼Œè¯¥é€‰é¡¹ä¸»è¦æ˜¯å®ç°ä¼˜åŒ–ç‰¹æ€§ã€‚#é˜²æ­¢å¤©æ¶¯ç›—é“¾ï¼Œè½¬å«ç»™ç™¾åº¦acl tianya referer_regex -i tianyahttp_access deny tianyadeny_info  tianya#é˜»æ­¢baiduèœ˜è››acl baidu req_header User-Agent Baiduspiderhttp_access deny baidu#é™åˆ¶åŒä¸€IPå®¢æˆ·ç«¯çš„æœ€å¤§è¿æ¥æ•°acl OverConnLimit maxconn 128http_access deny OverConnLimit#é˜²æ­¢è¢«äººåˆ©ç”¨ä¸ºHTTPä»£ç†ï¼Œè®¾ç½®å…è®¸è®¿é—®çš„IPåœ°å€acl myip dst 222.18.63.37http_access deny !myip#å…è®¸æœ¬åœ°ç®¡ç†acl Manager proto cache_objectacl Localhost src 127.0.0.1 222.18.63.37http_access allow Manager Localhostcachemgr_passwd 53034338 allhttp_access deny Manager#ä»…ä»…å…è®¸80ç«¯å£çš„ä»£ç†acl all src 0.0.0.0/0.0.0.0acl Safe_ports port 80 # httphttp_access deny !Safe_portshttp_access allow all#Squidä¿¡æ¯è®¾ç½®visible_hostname happy.swjtu.edu.cncache_mgr  ooopic2008@qq.com#åŸºæœ¬è®¾ç½®cache_effective_user squidcache_effective_group squidtcp_recv_bufsize 65535 bytes#2.6çš„åå‘ä»£ç†åŠ é€Ÿé…ç½®cache_peer 127.0.0.1 parent 80 0 no-query originserver#é”™è¯¯æ–‡æ¡£error_directory /usr/local/squid/share/errors/Simplify_Chinese#å•å°ä½¿ç”¨ï¼Œä¸ä½¿ç”¨è¯¥åŠŸèƒ½icp_port 0hierarchy_stoplist cgi-bin ?acl QUERY urlpath_regex cgi-bin \\? .php .cgi .avi .wmv .rm .ram .mpg .mpeg .zip .execache deny QUERYacl apache rep_header Server ^Apachebroken_vary_encoding allow apacherefresh_pattern ^ftp:           1440 20%     10080refresh_pattern ^gopher:        1440 0%    1440refresh_pattern .             0    20%     4320cache_store_log nonepid_filename /usr/local/squid/var/logs/squid.pidemulate_httpd_log on\nSquidå¸¸ç”¨å‘½ä»¤\n\nåˆå§‹åŒ–åœ¨squid.confé‡Œé…ç½®çš„cacheç›®å½•\nsquid -z\nå¦‚æœæœ‰é”™è¯¯æç¤ºï¼Œè¯·æ£€æŸ¥cacheç›®å½•çš„æƒé™ï¼Œå¯ä»¥æ›´æ”¹ç›®å½•æƒé™\nchown -R squid:squid /cacheç›®å½•\nå¯¹squid.confæ’é”™ï¼Œå³éªŒè¯squid.confçš„è¯­æ³•å’Œé…ç½®\nsquid -k parse\nå¦‚æœåœ¨squid.confä¸­æœ‰è¯­æ³•æˆ–é…ç½®é”™è¯¯ï¼Œè¿™é‡Œä¼šè¿”å›æç¤ºï¼Œè‹¥æ— è¿”å›ï¼Œå°è¯•å¯åŠ¨squid\nå‰å°å¯åŠ¨squidï¼Œå¹¶è¾“å‡ºå¯åŠ¨è¿‡ç¨‹\n/usr/local/squid/sbin/squid -N -d1\nå¦‚æœæœ‰ready to server requesç›¸å…³ä¿¡æ¯ï¼Œè¯´æ˜squidå¯åŠ¨æˆåŠŸ\nç„¶åctrl+c ,åœæ­¢squid,å¹¶ä»¥åå°è¿è¡Œçš„æ–¹å¼å¯åŠ¨å®ƒ\nå¯åŠ¨squidåœ¨åå°è¿è¡Œ\nsquid -s\nå¯ä»¥ä½¿ç”¨ps -ax | grep squid æ¥æŸ¥çœ‹squidè¿›ç¨‹æ˜¯å¦å­˜åœ¨\nåœæ­¢squid\nsquid -k shutdown\né‡æ–°å¼•å¯¼ä¿®æ”¹è¿‡çš„squid.conf\nsquid -k reconfigure -f /XXX/squid.conf\nå½“squidè¿›è¡Œé…ç½®æ›´æ”¹åï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤è¿›è¡Œsquidé…ç½®é‡è½½\næŠŠsquidæ·»åŠ åˆ°ç³»ç»Ÿå¯åŠ¨é¡¹\nvim /etc/rc.local\n/usr/local/squid/sbin/squid -s\nä¿®æ”¹cacheç¼“å­˜ç›®å½•çš„æƒé™\nchown -R squid.squid /cacheç›®å½•\ncacheç¼“å­˜ç›®å½•æ ¹æ®è‡ªå·±çš„é…ç½®æ›´æ”¹ï¼Œsquidç”¨æˆ·å’Œç»„æ˜¯squidï¼Œsquid\nä¿®æ”¹squidæ—¥å¿—ç›®å½•çš„æƒé™\nchown -R squid.squid å®šä¹‰çš„æ—¥å¿—æ–‡ä»¶æ‰€åœ¨ç›®å½•\nè¿™ä¸€æ­¥å¹¶ä¸æ˜¯é€‚åˆæ¯ä¸€ä¸ªä½¿ç”¨squidçš„ç”¨æˆ·ï¼Œæ„ä¸ºè®©squidæœ‰æƒé™åœ¨è¯¥ç›®å½•é‡Œè¿›è¡Œå†™æ“ä½œ\næŸ¥çœ‹ä½ çš„æ—¥å¿—æ–‡æ¡£\nmore /usr/local/squid/var/logs/access.log | grep TCP_MEM_HIT\nè¯¥æŒ‡ä»¤å¯ä»¥çœ‹åˆ°åœ¨squidè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰é‚£äº›æ–‡ä»¶è¢«squidç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œå¹¶è¿”å›ç»™è®¿é—®ç”¨æˆ·ã€‚\nmore /usr/local/squid/var/logs/access.log | grep TCP_HIT\nè¯¥æŒ‡ä»¤å¯ä»¥çœ‹åˆ°åœ¨squidè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰é‚£äº›æ–‡ä»¶è¢«squidç¼“å­˜åˆ°cacheç›®å½•ä¸­ï¼Œå¹¶è¿”å›ç»™è®¿é—®ç”¨æˆ·ã€‚\nmore /usr/local/squid/var/logs/access.log | grep TCP_MISS\nè¯¥æŒ‡ä»¤å¯ä»¥çœ‹åˆ°åœ¨squidè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæœ‰é‚£äº›æ–‡ä»¶æ²¡æœ‰è¢«squidç¼“å­˜ï¼Œè€Œæ˜¯ä»åŸå§‹æœåŠ¡å™¨è·å–å¹¶è¿”å›ç»™è®¿é—®ç”¨æˆ·ã€‚\n\nSquidå‘½ä¸­ç‡åˆ†æ\n12/usr/local/squid/bin/squidclient -p 80 mgr:info/usr/local/squid/bin/squidclient -p 80 mgr:5min\nå¯ä»¥çœ‹åˆ°è¯¦ç»†çš„æ€§èƒ½æƒ…å†µ,å…¶ä¸­PORTæ˜¯ä½ çš„proxyçš„ç«¯å£ï¼Œ5minå¯ä»¥æ˜¯60min\nå–å¾—squidè¿è¡ŒçŠ¶æ€ä¿¡æ¯ï¼š\n1squidclient -p 80 mgr:info\nå–å¾—squidå†…å­˜ä½¿ç”¨æƒ…å†µï¼š\n1squidclient -p 80 mgr:mem\nå–å¾—squidå·²ç»ç¼“å­˜çš„åˆ—è¡¨ï¼š\n1squidclient -p 80 mgr:bjects. use it carefully,it may crash\nå–å¾—squidçš„ç£ç›˜ä½¿ç”¨æƒ…å†µï¼š\n1squidclient -p 80 mgr:diskd\nå¼ºåˆ¶æ›´æ–°æŸä¸ªurlï¼š\n1squidclient -p 80 -m PURGE http://www.xxx.com/xxx.php\næ›´å¤šçš„è¯·æŸ¥çœ‹ï¼šsquidclient-h æˆ–è€… squidclient -p 80 mgr:\næŸ¥å‘½ä¸­ç‡ï¼š\n1squidclient -h IP(å…·ä½“ä¾¦å¬IP) -p 80(å…·ä½“ä¾¦å¬ç«¯å£) mgr:info\nå®šæœŸæ¸…ç†swap.stateå†…æ— æ•ˆæ•°æ®\n123/path/to/squid/sbin/squid -k rotate -f /path/to/squid/conf_filevi /etc/crontab0        0       *       *       *       root    /usr/local/sbin/squid -k rotate -f /usr/local/etc/squid/squid1.conf\nå½“squidåº”ç”¨è¿è¡Œäº†ä¸€æ®µæ—¶é—´ä¹‹åï¼Œcache_dirå¯¹åº”çš„swap.stateæ–‡ä»¶å°±ä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ï¼Œé‡Œé¢çš„æ— æ•ˆæ¥å£æ•°æ®è¶Šæ¥è¶Šå¤šï¼Œè¿™å¯èƒ½å½±å“squidçš„å“åº”æ—¶é—´ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨squidæ¸…ç†swap.stateé‡Œé¢çš„æ— æ•ˆæ•°æ®ï¼Œå‡å°‘swap.stateçš„å¤§å°ã€‚\n","thumbnail":"/posts/squid/squid.png","plink":"https://shuntan.github.io/posts/squid/"},{"title":"ç§‘å­¦ä¸Šç½‘ï¼šç”¨ VPS æ­å»º shadowsocks æœåŠ¡å™¨","date":"2019-05-15T06:38:46.000Z","date_formatted":{"ll":"May 15, 2019","L":"05/15/2019","MM-DD":"05-15"},"updated":"2020-04-22T07:20:49.352Z","content":"shadowsocks ç®€ä»‹\nshadowsocks æ˜¯ä¸€æ¬¾è‡ªå®šä¹‰åè®®çš„ä»£ç†è½¯ä»¶ï¼Œç”±äºå…¶æµé‡ç‰¹å¾ä¸æ˜æ˜¾ï¼Œï¼ˆç›´åˆ°ä¸ä¹…å‰ï¼‰ä¸€ç›´å¯ä»¥ç¨³å®šæä¾›ä¸Šç½‘ä»£ç†ã€‚\nshadowsocks å®¢æˆ·ç«¯ä¼šåœ¨æœ¬åœ°å¼€å¯ä¸€ä¸ª socks5 ä»£ç†ï¼Œé€šè¿‡æ­¤ä»£ç†çš„ç½‘ç»œè®¿é—®è¯·æ±‚ç”±å®¢æˆ·ç«¯å‘é€è‡³æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å‘å‡ºè¯·æ±‚ï¼Œæ”¶åˆ°å“åº”æ•°æ®åå†å‘å›å®¢æˆ·ç«¯ã€‚\nå› æ­¤ä½¿ç”¨ shadowsocks éœ€è¦ä¸€å°å¢™å¤–çš„æœåŠ¡å™¨æ¥éƒ¨ç½² shadowsocks æœåŠ¡ç«¯ã€‚\n\nè´­ä¹° VPS æœåŠ¡å™¨\nä¸»æµçš„ VPSï¼ˆè™šæ‹Ÿä¸»æœºï¼‰æœåŠ¡å™¨æä¾›å•†æœ‰ä¸‰å®¶ï¼š\n\nlinode\ndigital ocean\nbandwagon\n\nä¸‹é¢çš„æ¯”ä¸Šé¢çš„ä¾¿å®œã€‚å¦‚æœåªæ˜¯è‡ªç”¨ï¼Œbandwagon è¶³å¤Ÿã€‚\nä¸€èˆ¬ä½¿ç”¨ paypal ç»‘å®šä¸€ä¸ª visa æˆ– mastercard ä¿¡ç”¨å¡æ¥ä»˜æ¬¾ã€‚æ³¨æ„è¦ç”¨å›½é™… paypal å¸å·ï¼Œå›½å†…çš„æ˜¯ä¸èƒ½ç”¨å¤–å¸ä»˜æ¬¾çš„ã€‚\nåœ¨ bandwagon è´­ä¹° VPS ä»¥åä¼šè·å¾—ä¸€ä¸ªä¸»æœºåœ°å€å’Œç”¨äº ssh ç™»å½•çš„ root å¯†ç ã€‚\nè¿œç¨‹ç™»é™† VPS\nMacæˆ– Linux ä¸‹ç›´æ¥åœ¨ç»ˆç«¯ä¸­ssh root@your_vps_ip your_ssh_portå³å¯ã€‚\nåœ¨ windows ç³»ç»Ÿä¸‹éœ€è¦ä¸“é—¨çš„å®¢æˆ·ç«¯æ¥ SSH ç™»å½• VPSã€‚åœ¨Â xShell å®˜ç½‘Â Â ä¸‹è½½ xShellã€‚\nå®¶åº­å’Œå­¦æ ¡ç”¨æˆ·å¯ä»¥å…è´¹è¯•ç”¨ï¼Œä¸‹è½½æ—¶é€‰æ‹© homeÂ andÂ schoolÂ use å³å¯ã€‚éœ€è¦ç”¨é‚®ç®±æ³¨å†Œä¸€ä¸‹ï¼Œä¸‹è½½é“¾æ¥ä¼šå‘é€åˆ°é‚®ç®±ä¸­ã€‚\nxShell ä¸­æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œä¼šè¦æ±‚è¾“å…¥ç›®æ ‡ IP åœ°å€å’Œç«¯å£ï¼Œä»¥åŠ root å¯†ç ï¼ŒæŒ‰æç¤ºæ“ä½œå³å¯ã€‚\nå®‰è£… shadowsocks\næœ€å¥½æ˜¯centos7\n1.å®‰è£…pip\nç”±äºå®‰è£…çš„æ˜¯python ç‰ˆæœ¬çš„ shadowsocksï¼Œæ‰€ä»¥é¦–å…ˆå®‰è£…pip\n$ curl &quot;https://bootstrap.pypa.io/get-pip.py&quot; -o &quot;get-pip.py&quot;\n\n$ python get-pip.py\n\n2.å®‰è£…shadowsocks\n$ pip install --upgrade pip\n\n$ pip install shadowsocks\n\n3.åˆ›å»ºé…ç½®æ–‡ä»¶\nåˆ›å»ºæ–‡ä»¶æ‰€åœ¨ç›®å½•:/etc\n\nåˆ›å»ºæ–‡ä»¶å‘½ä»¤\n$ vi /etc/shadowsocks.json\n\nè‹¥è¿›å…¥äº†etcç›®å½•\n$ vi shadowsocks.json\n\né…ç½®æ–‡ä»¶å†…å®¹ï¼š\nå•ç«¯å£ï¼š\n1234567891011121314151617&#123; \"server\":\"0.0.0.0\", --æœåŠ¡å™¨IPï¼Œç›´æ¥ç”¨0.0.0.0ä¹Ÿå¯ \"server_port\":8888, --ç«¯å£ç«¯å£ \"local_address\": \"127.0.0.1\", --æœ¬åœ°åœ°å€ï¼Œå¯çœç•¥ \"local_port\":1080,--æœ¬åœ°ç«¯å£ï¼Œå¯çœç•¥ \"password\":\"password\",--å¯†ç  \"timeout\":300, --è¶…æ—¶æ—¶é—´ï¼Œå¯çœç•¥ \"method\":\"aes-256-cfb\", --åŠ å¯†ç­–ç•¥ï¼Œæœ‰å¤šé‡ç­–ç•¥ï¼Œå…·ä½“è‡ªæŸ¥&#125;\nå¤šç«¯å£ï¼š\n12345678910111213141516171819202122232425&#123; \"server\":\"0.0.0.0\", \"local_address\":\"127.0.0.1\", \"local_port\":1080, \"port_password\":&#123;--æ¯ä¸ªç«¯å£å¯¹åº”ä¸€ä¸ªå¯†ç  \"1111\":\"password1\", \"1112\":\"password2\", \"1113\":\"password3\" &#125;, \"timeout\":300, \"method\":\"aes-256-cfb\", \"fast_open\":false&#125;\n4.å¯åŠ¨shadowsocks\nå¯åŠ¨\nssserver -c /etc/shadowsocks.json -d start\n\nåœæ­¢\nssserver -c /etc/shadowsocks.json -d stop\n\né‡å¯\nssserver -c /etc/shadowsocks.json -d restart\n\nå¯åŠ¨æˆåŠŸå³å¯é€šè¿‡sså®¢æˆ·ç«¯ä½¿ç”¨ã€‚\nåœ¨windowç«¯å¯ä»¥åœ¨æ§åˆ¶å°é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç«¯å£æ˜¯å¦æ‰“å¼€\ntelnet {ip} {port}\n\n5.é…ç½®è‡ªå¯åŠ¨\næ–°å»ºå¯åŠ¨è„šæœ¬æ–‡ä»¶/etc/systemd/system/shadowsocks.serviceï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n\n[Unit]\nDescription=Shadowsocks\n\n[Service]\nTimeoutStartSec=0\n\nExecStart=/usr/bin/ssserver -c /etc/shadowsocks.json\n\n[Install]\nWantedBy=multi-user.target\n\né€šè¿‡ä»¥ä¸‹å‘½ä»¤æ³¨å†Œï¼Œå¯åŠ¨æœåŠ¡\n$ systemctl enable shadowsocks\n\n$ systemctl start shadowsocks\n\nå¯åŠ¨åå¯ä»¥æŸ¥çœ‹æœåŠ¡çŠ¶æ€\n$ systemctl status shadowsocks -l\n\nè‹¥å¯åŠ¨æˆåŠŸï¼š\nâ— shadowsocks.service - Shadowsocks\nLoaded: loaded (/etc/systemd/system/shadowsocks.service; enabled; vendor preset: disabled)\nActive: active (running) since Sun 2017-08-13 18:03:41 CST; 1h 29min ago\nMain PID: 9567 (ssserver)\nCGroup: /system.slice/shadowsocks.service\nâ””â”€9567 /usr/bin/python2 /usr/bin/ssserver -c /etc/shadowsocks.json\nå¦‚æœï¼ŒæœåŠ¡å¤±è´¥ï¼Œé‡å¯æœåŠ¡å™¨è¯•ä¸€ä¸‹\nå®‰è£…å¹¶å¯åŠ¨ shadowsocks å®¢æˆ·ç«¯\nshadowsocks æ”¯æŒ windowsã€MacÂ OSÂ Xã€Linuxã€Androidã€iOS ç­‰å¤šä¸ªå¹³å°ã€‚ä¸è¿‡ iOS ç”±äºç³»ç»Ÿå¯¹åº”ç”¨åå°è¿è¡Œçš„é™åˆ¶ï¼Œæ¨èä½¿ç”¨å®¢æˆ·ç«¯å†…åµŒçš„æµè§ˆå™¨ç§‘å­¦ä¸Šç½‘ï¼Œç»™å…¶ä»–åº”ç”¨ä»£ç†æ—¶éœ€è¦æ¯è¿‡å‡ åˆ†é’Ÿé‡æ–°å¯åŠ¨ä¸€ä¸‹ appã€‚\nshadowsocks é¡¹ç›® Github ä¸»é¡µåœ¨è¿™é‡Œã€‚\né‡Œé¢å¯ä»¥æ‰¾åˆ°å®¢æˆ·ç«¯ä¸‹è½½åœ°å€ã€‚\nä¸‹è½½å®‰è£…å®¢æˆ·ç«¯ä»¥åï¼Œåªéœ€æŒ‰æœåŠ¡å™¨çš„é…ç½®å¡«å†™ IP åœ°å€ã€æœåŠ¡å™¨ç«¯å£ã€æœ¬åœ°ç«¯å£ï¼ˆå¦‚æœæ²¡æœ‰æœ¬åœ°ç«¯å£é€‰é¡¹ï¼Œå°±æ˜¯é»˜è®¤çš„ 1080ï¼‰ã€å¯†ç ã€åŠ å¯†æ–¹å¼ç­‰å‚æ•°ï¼Œå¯åŠ¨å°±å¯ä»¥äº†ã€‚\nå®¢æˆ·ç«¯æ”¯æŒå…¨å±€ä»£ç†å’Œ PAC ä»£ç†ä¸¤ç§æ–¹å¼ï¼Œåè€…ä¼šä½¿ç”¨ä¸€ä¸ªè„šæœ¬æ¥è‡ªåŠ¨æ£€æŸ¥ä¸€ä¸ªç½‘ç«™æ˜¯å¦åœ¨éœ€è¦ä»£ç†çš„ç½‘ç«™åˆ—è¡¨ä¸­ï¼Œè‡ªåŠ¨é€‰æ‹©ç›´æ¥è¿æ¥æˆ–ä»£ç†è¿æ¥ã€‚\nPAC åˆ—è¡¨å¯ä»¥åœ¨çº¿æ›´æ–°ï¼Œä½†æ˜¯éš¾å…æœ‰æ”¶å½•ä¸å…¨çš„æƒ…å†µã€‚è¿™æ—¶å¯ä»¥é€‰æ‹©å…³é—­ shadowsocks ä»£ç†ï¼ˆå®é™…ä¸Šæ˜¯å–æ¶ˆå¯¹ç³»ç»Ÿä»£ç†çš„é…ç½®ï¼Œshadowsocks å®¢æˆ·ç«¯ä»ç„¶ä¿æŒå·¥ä½œï¼‰ï¼Œç„¶åä½¿ç”¨æ”¯æŒè‡ªå®šä¹‰è§„åˆ™çš„ä»£ç†ç®¡ç†æ’ä»¶æ¥å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†ï¼Œæ¯”å¦‚ switchyOmegaã€‚\nä½¿ç”¨ switchyOmega å®ç°è‡ªåŠ¨åˆ‡æ¢ä»£ç†\nswitchyOmega æ˜¯ chrome æµè§ˆå™¨ä¸Šä¸€ä¸ªå¾ˆå¥½ç”¨çš„ä»£ç†ç®¡ç†æ’ä»¶ã€‚å®ƒçš„å‰èº« switchySharp æ›´æœ‰åã€‚\n\nchrome åº”ç”¨å•†åº—æœ¬èº«éœ€è¦ç¿»å¢™æ‰èƒ½è®¿é—®ï¼Œå› æ­¤éœ€è¦å…ˆåœ¨ shadowsocks å¯åŠ¨ä»£ç†æ¨¡å¼ä¸‹ä¸‹è½½å®‰è£…ï¼Œå†å…³é—­ shadowsocks ä»£ç†ã€‚\n\nå®‰è£…å®Œæ¯•åï¼Œå³å‡» switchyOmega å›¾æ ‡ï¼Œé€‰æ‹©é€‰é¡¹ï¼Œè¿›å…¥ switchOmega é…ç½®ç•Œé¢ã€‚\n\nåˆ›å»º shadowsocks æƒ…æ™¯æ¨¡å¼\næ–°å»ºä¸€ä¸ªæƒ…æ™¯æ¨¡å¼ï¼Œæ¯”å¦‚å« SSï¼Œä»£ç†åè®®é€‰æ‹© socks5ï¼Œä»£ç†åœ°å€ä¸º 127.0.0.1ï¼Œç«¯å£ 1080ã€‚\n\nç°åœ¨åˆ‡æ¢åˆ° SS æƒ…æ™¯æ¨¡å¼å°±å¯ä»¥é€šè¿‡ shadowsocks ç§‘å­¦ä¸Šç½‘äº†ã€‚åé¢è·å–è‡ªåŠ¨åˆ‡æ¢è§„åˆ™åˆ—è¡¨\n\nè®¾ç½®è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼\nåœ¨è®¾ç½®ç•Œé¢é€‰æ‹©è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼ï¼Œåœ¨ â€œåˆ‡æ¢è§„åˆ™â€ ä¸­å‹¾é€‰â€œè§„åˆ™åˆ—è¡¨è§„åˆ™â€ï¼Œå¯¹åº”çš„æƒ…æ™¯æ¨¡å¼é€‰æ‹©åˆšåˆšæ–°å»ºçš„ SSã€‚\nç„¶ååœ¨ä¸‹é¢çš„è§„åˆ™åˆ—è¡¨åœ°å€ä¸­å¡«å†™\nhttps://autoproxy-gfwlist.googlecode.com/svn/trunk/gfwlist.txt\nè§„åˆ™åˆ—è¡¨æ ¼å¼é€‰æ‹© AutoProxyã€‚\nç„¶åç‚¹å‡»ç«‹å³æ›´æ–°æƒ…æ™¯æ¨¡å¼ï¼Œ æ›´æ–°å®Œæˆåä¼šæœ‰æç¤ºã€‚\nç‚¹å‡»å·¦ä¾§çš„ â€œåº”ç”¨é€‰é¡¹â€ã€‚ç„¶åå•å‡» switchyOmega å›¾æ ‡ï¼Œé€‰æ‹©è‡ªåŠ¨åˆ‡æ¢ï¼Œå°±å¯ä»¥åœ¨è®¿é—®â€œä¸å­˜åœ¨çš„ç½‘ç«™â€ æ—¶è‡ªåŠ¨åˆ‡æ¢åˆ° shadowsocks ä»£ç†äº†ã€‚\næ·»åŠ è‡ªå®šä¹‰è§„åˆ™\nå¦‚æœé‡åˆ°æŸä¸ªå›½å¤–ç½‘ç«™æ— æ³•ç›´æ¥è¿æ¥æˆ–é€Ÿåº¦å¤ªæ…¢æ—¶ï¼Œå¯ä»¥å•å‡» switchyOmega å›¾æ ‡ï¼Œé€‰æ‹© â€œæ·»åŠ æ¡ä»¶â€ï¼Œæƒ…æ™¯æ¨¡å¼é€‰æ‹© SSï¼Œå°±å¯ä»¥äº†ã€‚\nè¿™æ—¶æ‰“å¼€ switchyOmega é€‰é¡¹ï¼Œåœ¨è‡ªåŠ¨åˆ‡æ¢æ¨¡å¼çš„åˆ‡æ¢è§„åˆ™ä¸­å°±å¯ä»¥çœ‹åˆ°åˆšåˆšæ·»åŠ çš„è§„åˆ™ã€‚å¯ä»¥åœ¨è¿™é‡Œç®¡ç†è‡ªå®šä¹‰çš„è§„åˆ™ã€‚\nå¯¼å…¥å’Œå¯¼å‡º switchyOmega è®¾ç½®\nå¦‚æœæ¢äº†ä¸€å°ç”µè„‘ï¼Œé‡æ–°è®¾ç½®ä¸€é switchyOmega å°±å¤ªéº»çƒ¦äº†ã€‚å¯ä»¥åœ¨è®¾ç½®å¥½çš„ switchyOmega ä¸­å¯¼å‡ºè®¾ç½®æ–‡ä»¶ï¼Œåœ¨å¦ä¸€ä¸ª chrome æµè§ˆå™¨ä¸­å¯¼å…¥ï¼Œå°±å¯ä»¥ç›´æ¥å¤åˆ¶åŸæ¥çš„è®¾ç½®äº†ã€‚\nåœ¨ switchyOmega é€‰é¡¹çš„å·¦ä¾§ç‚¹å‡» â€œå¯¼å…¥ / å¯¼å‡ºâ€ï¼Œç‚¹å‡»â€œç”Ÿæˆå¤‡ä»½æ–‡ä»¶â€ å³å¯ç”Ÿæˆ switchyOmega è®¾ç½®å¤‡ä»½ã€‚ç‚¹å‡» â€œä»å¤‡ä»½æ–‡ä»¶æ¢å¤â€ å¯ä»¥å¯¼å…¥å¤‡ä»½æ–‡ä»¶ã€‚\n","thumbnail":"/posts/shadowsocks/shadowsocks.png","plink":"https://shuntan.github.io/posts/shadowsocks/"},{"title":"Tag Plugins","date":"2019-05-10T04:35:58.000Z","date_formatted":{"ll":"May 10, 2019","L":"05/10/2019","MM-DD":"05-10"},"updated":"2020-04-14T14:02:34.820Z","content":"\n            FAQWelcome to tag-plugins\n          \nTag Plugin is a way to make special style contents supported by Hexo. For example, we cannot show a image with custom size in standard Markdown. And then we can use tag plugins to solve it. Hexo has a lot of tags which can help user. And Hexo also have interfaces to themes which make themes able to create their own tags. Following tags is provided by NexT:\n\n\nCentered Quote\nInclude Raw\nButton\nGroup Pictures\nLabel\nMermaid\nNote\nPDF\nTabs\nVideo\n\nCentered Quote\nThis tag will make a quote with two lines before and after it, and text quoted will be centered. When using centered quote, if we have multi-line text, and each line has a different length, the quote wonâ€™t be symmetrical, so itâ€™s recommended to use when only have single line text. For example before article all after article to make a summary.\nUsage\ncenter-quote.js123&#123;% centerquote %&#125;Something&#123;% endcenterquote %&#125;&lt;!-- Tag Alias --&gt;&#123;% cq %&#125;Something&#123;% endcq %&#125;\nExample\n1&#123;% cq %&#125;Elegant in code, simple in core&#123;% endcq %&#125;\nElegant in code, simple in core\n\nInclude Raw\nThis tag include any raw content into your posts. Path is relative to your site source directory.\nUsage\ninclude-raw.js1&#123;% include_raw '_data/path/to/file.html' %&#125;\nExample\nLetâ€™s create include-raw.html file in _data directory under site root directory with following content:\n1Any &lt;strong&gt;raw content&lt;/strong&gt; may be included with this tag.\nThen in any post we can use this content with include_raw tag:\n1&#123;% include_raw '_data/path/to/include-raw.html' %&#125;\nButton\nUsage\nbutton.js1234567891011&#123;% button url, text, icon [class], [title] %&#125;&lt;!-- Tag Alias --&gt;&#123;% btn url, text, icon [class], [title] %&#125;url     : Absolute or relative path to URL.text    : Button text. Required if no icon specified.icon    : FontAwesome icon name (without 'fa-' at the begining). Required if no text specified.[class] : FontAwesome class(es): fa-fw | fa-lg | fa-2x | fa-3x | fa-4x | fa-5x          Optional parameter.[title] : Tooltip at mouseover.          Optional parameter.\nExamples\n1&#123;% button #, Text %&#125;\nText\nButton with text &amp; title\n1&#123;% btn #, Text %&#125;&#123;% btn #, Text &amp; Title,, Title %&#125;\nTextText & Title\n1&#123;% btn #, Text %&#125; &#123;% btn #, Text &amp; Title,, Title %&#125;\nText Text & Title\n12&#123;% btn #, Text %&#125;&#123;% btn #, Text &amp; Title,, Title %&#125;\nText\nText & Title\nButton with icon\n123456&lt;div&gt;&#123;% btn #,, home fa-5x %&#125;&#123;% btn #,, home fa-5x %&#125;&#123;% btn #,, home fa-5x %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, home fa-4x %&#125;&#123;% btn #,, home fa-4x %&#125;&#123;% btn #,, home fa-4x %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, home fa-3x %&#125;&#123;% btn #,, home fa-3x %&#125;&#123;% btn #,, home fa-3x %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, home fa-2x %&#125;&#123;% btn #,, home fa-2x %&#125;&#123;% btn #,, home fa-2x %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, home fa-lg %&#125;&#123;% btn #,, home fa-lg %&#125;&#123;% btn #,, home fa-lg %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, home %&#125;&#123;% btn #,, home %&#125;&#123;% btn #,, home %&#125;&lt;/div&gt;\n\n\n\n\n\n\nButton with text &amp; icon\n12&lt;p&gt;&#123;% btn #, Text &amp; Icon (buggy), home %&#125;&#123;% btn #, Text &amp; Icon (fixed width), home fa-fw %&#125;&lt;/p&gt;\nText & Icon (buggy)\nText & Icon (fixed width)\n12&lt;p&gt;&#123;% btn #, Text &amp; Large Icon, home fa-fw fa-lg %&#125;&#123;% btn #, Text &amp; Large Icon &amp; Title, home fa-fw fa-lg, Title %&#125;&lt;/p&gt;\nText & Large Icon\nText & Large Icon & Title\nButton inside text\n123Lorem &#123;% btn #, Lorem, home fa-fw fa-lg %&#125; ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididu\nButton inside other tag\n123456&#123;% note info %&#125;&#123;% btn #, Text &amp; Icon, home fa-fw %&#125;&#123;% btn #,, home, Title %&#125;&#123;% btn #, Text %&#125;[Link](#)&#123;% endnote %&#125;\n\n            buttonText &amp; IconTextLink\n          \nButton margin\n123&lt;div class=\"text-center\"&gt;&lt;div&gt;&#123;% btn #,, header %&#125;&#123;% btn #,, edge %&#125;&#123;% btn #,, times %&#125;&#123;% btn #,, circle-o %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, italic %&#125;&#123;% btn #,, scribd %&#125;&lt;/div&gt;&lt;div&gt;&#123;% btn #,, google %&#125;&#123;% btn #,, chrome %&#125;&#123;% btn #,, opera %&#125;&#123;% btn #,, diamond fa-rotate-270 %&#125;&lt;/div&gt;&lt;/div&gt;\n\n\n\nButton with relative URL\n1&lt;div class=\"text-center\"&gt;&#123;% btn #, Previous Chapter, arrow-left fa-fw fa-lg, Previous Chapter (Full Image) %&#125; &#123;% btn #, Next Chapter, arrow-right fa-fw fa-lg, Next Chapter (Label) %&#125;&lt;/div&gt;\nPrevious Chapter Next Chapter\nButton with absolute URL\n1&lt;div class=\"text-center\"&gt;&#123;% btn https://github.com/theme-next/hexo-theme-next, NexT, github fa-fw fa-lg, NexT source code %&#125;&lt;/div&gt;\nNexT\nGroup Pictures\nUsage\ngroup-pictures.js12345&#123;% grouppicture [group]-[layout] %&#125;&#123;% endgrouppicture %&#125;&#123;% gp [group]-[layout] %&#125;&#123;% endgp %&#125;[group]  : Total number of pictures to add in the group.[layout] : Default picture under the group to show.\nExamples\n12345678&#123;% grouppicture 6-3 %&#125;  ![](/images/docs/github.png)  ![](/images/docs/github.png)  ![](/images/docs/github.png)  ![](/images/docs/github.png)  ![](/images/docs/github.png)  ![](/images/docs/github.png)&#123;% endgrouppicture %&#125;\n\nLabel\nUsage\nlabel.js123456&#123;% label [class]@Text %&#125;[class] : default | primary | success | info | warning | danger.          '@Text' can be specified with or without space          E.g. 'success @text' similar to 'success@text'.          If not specified, default class will be selected.\nExamples\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\nUt enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.\nDuis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nLorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.\nUt enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.\nDuis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\nMermaid\nSettings\nnext/_config.yml12345# Mermaid tagmermaid:  enable: true  # Available themes: default | dark | forest | neutral  theme: forest\nUsage\nmermaid.js1234&#123;% mermaid type %&#125;&#123;% endmermaid %&#125;type : type of the mermaid chart, visit https://github.com/knsv/mermaid for more information.\nExamples\n1234567&#123;% mermaid graph TD %&#125;A[Christmas] --&gt;|Get money| B(Go shopping)B --&gt; C&#123;Let me thinksssss&lt;br&gt;ssssssssssssssssssssss&lt;br&gt;sssssssssssssssssssssssssss&#125;C --&gt;|One| D[Laptop]C --&gt;|Two| E[iPhone]C --&gt;|Three| F[Car]&#123;% endmermaid %&#125;\n\n            graph TD\n            A[Christmas] -->|Get money| B(Go shopping)\nB --> C{Let me thinkssssssssssssssssssssssssssssssssssssssssssssssssssssss}\nC -->|One| D[Laptop]\nC -->|Two| E[iPhone]\nC -->|Three| F[Car]\n          \nNote\nSettings\nnext/_config.yml1234567891011note:  # Note tag style values:  #  - simple    bs-callout old alert style. Default.  #  - modern    bs-callout new (v2-v3) alert style.  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.  #  - disabled  disable all CSS styles import of note tag.  style: simple  icons: false  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).  # Offset also applied to label tag variables. This option can work with disabled note tag.  light_bg_offset: 0\nUsage\nnote.js12345678&#123;% note [class] [no-icon] %&#125;Any content (support inline tags too.io).&#123;% endnote %&#125;[class]   : default | primary | success | info | warning | danger.[no-icon] : Disable icon in note.All parameters are optional.\n\n            Known IssuesItâ€™s wrong to write this tag with 1 line if you donâ€™t want to see possible bugs.For example, here is wrong syntax to write content like that:1&#123; % note danger % &#125;note text, note text, note text&#123; % endnote % &#125;Or like that:1234&#123; % note danger % &#125;note textnote textnote text&#123; % endnote % &#125;Need to write content at new line, like this:12345&#123; % note danger % &#125;note text, note text, note textnote text, note text, note textnote text, note text, note text&#123; % endnote % &#125;\n          \nExamples\n1234&#123;% note %&#125;#### Header(without define class style)&#123;% endnote %&#125;\n\n            Header(without define class style)\n          \n1234&#123;% note default %&#125;#### Default HeaderWelcome to [Hexo!](https://hexo.io)&#123;% endnote %&#125;\n\n            Default HeaderWelcome to Hexo!\n          \n1234&#123;% note primary %&#125;#### Primary Header**Welcome** to [Hexo!](https://hexo.io)&#123;% endnote %&#125;\n\n            Primary HeaderWelcome to Hexo!\n          \n1234&#123;% note info %&#125;### Info Header**Welcome** to [Hexo!](https://hexo.io)&#123;% endnote %&#125;\n\n            Info HeaderWelcome to Hexo!\n          \n1234&#123;% note success %&#125;#### Success Header**Welcome** to [Hexo!](https://hexo.io)&#123;% endnote %&#125;\n\n            Success HeaderWelcome to Hexo!\n          \n1234&#123;% note warning %&#125;#### Warning Header**Welcome** to [Hexo!](https://hexo.io)&#123;% endnote %&#125;\n\n            Warning HeaderWelcome to Hexo!\n          \n1234&#123;% note danger %&#125;#### Danger Header**Welcome** to [Hexo!](https://hexo.io)&#123;% endnote %&#125;\n\n            Danger HeaderWelcome to Hexo!\n          \n12345678&#123;% note info no-icon %&#125;#### No icon noteNote **without** icon: `note info no-icon`note info, note info, note infonote info, note info, note infonote info, note info, note info&#123;% endnote %&#125;\n\n            No icon noteNote without icon: note info no-iconnote info, note info, note infonote info, note info, note infonote info, note info, note info\n          \n12345678&#123;% note success %&#125;#### Codeblock in note&#123;% code %&#125;code block in note tagcode block in note tagcode block in note tag&#123;% endcode %&#125;&#123;% endnote %&#125;\n\n            Codeblock in note123code block in note tagcode block in note tagcode block in note tag\n          \n1234567891011121314&#123;% note default %&#125;#### Lists in note* ul* ul  * ul  * ul* ul1. ol2. ol  1. ol  2. ol3. ol&#123;% endnote %&#125;\nLists in note\n\n            Lists in noteulululululololololol\n          \n12345678#### Table in Note&#123;% note default %&#125;| 1 | 2 || - | - || 3 | 4 || 5 | 6 || 7 | 8 |&#123;% endnote %&#125;\nTable in note\n\n            Table in Note12345678\n          \nPdf\nSettings\nnext/_config.yml1234pdf:  enable: true  # Default height  height: 500px\nUsage\npdf.js1234&#123;% pdf url [height] %&#125;[url]    : Relative path to PDF file.[height] : Optional. Height of the PDF display element, e.g. 800px.\nExamples\n1&#123;% pdf https://example.com/sample.pdf %&#125;\n1&#123;% pdf /path/to/your/file.pdf 600px %&#125;\nTabs\nSettings\nnext/_config.yml1234tabs:  transition:    tabs: false    labels: true\nUsage\ntabs.js123456789101112131415161718192021&#123;% tabs Unique name, [index] %&#125;&lt;!-- tab [Tab caption] [@icon] --&gt;Any content (support inline tags too).&lt;!-- endtab --&gt;&#123;% endtabs %&#125;Unique name   : Unique name of tabs block tag without comma.                Will be used in #id's as prefix for each tab with their index numbers.                If there are whitespaces in name, for generate #id all whitespaces will replaced by dashes.                Only for current url of post/page must be unique![index]       : Index number of active tab.                If not specified, first tab (1) will be selected.                If index is -1, no tab will be selected. It's will be something like spoiler.                Optional parameter.[Tab caption] : Caption of current tab.                If not caption specified, unique name with tab index suffix will be used as caption of tab.                If not caption specified, but specified icon, caption will empty.                Optional parameter.[@icon]       : FontAwesome icon name (without 'fa-' at the begining).                Can be specified with or without space; e.g. 'Tab caption @icon' similar to 'Tab caption@icon'.                Optional parameter.\nExamples\n12345678910111213&#123;% tabs First unique name %&#125;&lt;!-- tab --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nFirst unique name 1First unique name 2First unique name 3This is Tab 1.This is Tab 2.This is Tab 3.\nTabs with 3rd tab selected\n12345678910111213&#123;% tabs Second unique name, 3 %&#125;&lt;!-- tab --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nSecond unique name 1Second unique name 2Second unique name 3This is Tab 1.This is Tab 2.This is Tab 3.\nTabs with no tab selected\n12345678910111213&#123;% tabs Third unique name, -1 %&#125;&lt;!-- tab --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nThird unique name 1Third unique name 2Third unique name 3This is Tab 1.This is Tab 2.This is Tab 3.\nTabs with custom labels\n12345678910111213&#123;% tabs Fourth unique name %&#125;&lt;!-- tab Solution 1 --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab Solution 2 --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab Solution 3 --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nSolution 1Solution 2Solution 3This is Tab 1.This is Tab 2.This is Tab 3.\nTabs with icons only\n12345678910111213&#123;% tabs Fifth unique name %&#125;&lt;!-- tab @text-width --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab @amazon --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab @bold --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nThis is Tab 1.This is Tab 2.This is Tab 3.\nTabs with icons and labels\n12345678910111213&#123;% tabs Sixth unique name %&#125;&lt;!-- tab Solution 1@text-width --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab Solution 2 @amazon --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab Solution 3@bold --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nSolution 1Solution 2Solution 3This is Tab 1.This is Tab 2.This is Tab 3.\nTabs permalinks test\n12345678910111213141516171819202122232425262728293031323334353637Permalink for &gt; [Tab one](#tab-one).Permalink for &gt; [Tab one 1](#tab-one-1).Permalink for &gt; [Tab one 2](#tab-one-2).Permalink for &gt; [Tab one 3](#tab-one-3).Permalink for &gt; [Tab two](#tab-two).Permalink for &gt; [Tab two 1](#tab-two-1).Permalink for &gt; [Tab two 2](#tab-two-2).Permalink for &gt; [Tab two 3](#tab-two-3).&#123;% tabs Tab one %&#125;&lt;!-- tab --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;&#123;% tabs Tab two %&#125;&lt;!-- tab --&gt;**This is Tab 1.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 2.**&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 3.**&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nPermalink for &gt; Tab one.\nPermalink for &gt; Tab one 1.\nPermalink for &gt; Tab one 2.\nPermalink for &gt; Tab one 3.\nPermalink for &gt; Tab two.\nPermalink for &gt; Tab two 1.\nPermalink for &gt; Tab two 2.\nPermalink for &gt; Tab two 3.\nTab one 1Tab one 2Tab one 3This is Tab 1.This is Tab 2.This is Tab 3.\nTab two 1Tab two 2Tab two 3This is Tab 1.This is Tab 2.This is Tab 3.\nTabs with other tags\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120&#123;% tabs Tags %&#125;&lt;!-- tab --&gt;**This is Tab 1.**1. One2. Two3. Three4-spaces code block:    nano /etcTagged code block:&#123;% code %&#125;code tagcode tagcode tag&#123;% endcode %&#125;&#123;% note default %&#125;Note default tag.&#123;% endnote %&#125;&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 2.*** Five* Six* Seven&#123;% note primary %&#125;&#123;% youtube Kt7u5kr_P5o %&#125;&#123;% endnote %&#125;&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Tab 3.**&#123;% subtabs Sub Tabs %&#125;&lt;!-- tab --&gt;**This is Sub Tab 1.**&#123;% note success %&#125;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.&#123;% note warning %&#125;Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.&#123;% endnote %&#125;Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.&#123;% endnote %&#125;&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Sub Tab 2.**&#123;% note success %&#125;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.&#123;% note danger %&#125;Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.&#123;% endnote %&#125;&#123;% endnote %&#125;&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Sub Tab 3.**&#123;% subtabs Sub-Sub Tabs %&#125;&lt;!-- tab --&gt;**This is Sub-Sub Tab 1 of Sub Tab 3.**&#123;% note success %&#125;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.&#123;% endnote %&#125;&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Sub-Sub Tab 2 of Sub Tab 3.**&#123;% note success %&#125;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.&#123;% note warning %&#125;Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.&#123;% endnote %&#125;&#123;% endnote %&#125;&lt;!-- endtab --&gt;&lt;!-- tab --&gt;**This is Sub-Sub Tab 3 of Sub Tab 3.**&#123;% note success %&#125;Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.&#123;% note warning %&#125;Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.&#123;% note danger %&#125;Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.&#123;% endnote %&#125;&#123;% endnote %&#125;&#123;% endnote %&#125;&lt;!-- endtab --&gt;&#123;% endsubtabs %&#125;&lt;!-- endtab --&gt;&#123;% endsubtabs %&#125;&lt;!-- endtab --&gt;&#123;% endtabs %&#125;\nTags 1Tags 2Tags 3This is Tab 1.\n\nOne\nTwo\nThree\n\n4-spaces code block:\nnano /etc\n\nTagged code block:\n123code tagcode tagcode tag\n\n            Note default tag.\n          This is Tab 2.\n\nFive\nSix\nSeven\n\n\n            \n          This is Tab 3.\nSub Tabs 1Sub Tabs 2Sub Tabs 3This is Sub Tab 1.\n\n            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.            Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.          Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.\n          This is Sub Tab 2.\n\n            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.            Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.          \n          This is Sub Tab 3.\nSub-Sub Tabs 1Sub-Sub Tabs 2Sub-Sub Tabs 3This is Sub-Sub Tab 1 of Sub Tab 3.\n\n            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.\n          This is Sub-Sub Tab 2 of Sub Tab 3.\n\n            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.            Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.          \n          This is Sub-Sub Tab 3 of Sub Tab 3.\n\n            Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Phasellus hendrerit. Pellentesque aliquet nibh nec urna. In nisi neque, aliquet vel, dapibus id, mattis vel, nisi. Sed pretium, ligula sollicitudin laoreet viverra, tortor libero sodales leo, eget blandit nunc tortor eu nibh. Nullam mollis. Ut justo. Suspendisse potenti. Pellentesque fermentum dolor. Aliquam quam lectus, facilisis auctor, ultrices ut, elementum vulputate, nunc.            Sed egestas, ante et vulputate volutpat, eros pede semper est, vitae luctus metus libero eu augue. Morbi purus libero, faucibus adipiscing, commodo quis, gravida id, est. Sed lectus. Praesent elementum hendrerit tortor. Sed semper lorem at felis. Vestibulum volutpat, lacus a ultrices sagittis, mi neque euismod dui, eu pulvinar nunc sapien ornare nisl. Phasellus pede arcu, dapibus eu, fermentum et, dapibus sed, urna.            Morbi interdum mollis sapien. Sed ac risus. Phasellus lacinia, magna a ullamcorper laoreet, lectus arcu pulvinar risus, vitae facilisis libero dolor a purus. Sed vel lacus. Mauris nibh felis, adipiscing varius, adipiscing in, lacinia vel, tellus. Suspendisse ac urna. Etiam pellentesque mauris ut lectus. Nunc tellus ante, mattis eget, gravida vitae, ultricies ac, leo. Integer leo pede, ornare a, lacinia eu, vulputate vel, nisl.                    \n          \nViedo\nUsage\nvideo.js1&#123;% video url %&#125;\nExamples\n12&#123;% video https://example.com/sample.mp4 %&#125;&#123;% video /path/to/your/video.mp4 %&#125;\nSorry, your browser does not support the video tag.\n\nInline image\nNot bad.\nWith link\n\nTravis CI build status: \nLastest release: \nLicense: \n\nhr\nBelow is a &lt;hr&gt;, I guess.\n\nAbove is a &lt;hr&gt;, I guess.\nList\nUnordered list\n\nlist item\nlist item\n\nlist item\nlist item\n\nlist item\nlist item\n\n\n\n\nlist item\n\nOrdered list\n\nlist item\nlist item\n\nlist item\nlist item\n\nlist item\nlist item\n\n\n\n\nlist item\n\nChecklist\n\nGet up at 7:00 AM\nEat breakfast\nGo to bet before 11:00 PM\n\nTable\n\n\nHear no evil\nSpeak no evil\nSee no evil\n\n\n\n\nğŸ™‰\nğŸ™Š\nğŸ™ˆ\n\n\nText align\n\n\nHear no evil\nSpeak no evil\nSee no evil\n\n\n\n\nğŸ™‰\nğŸ™Š\nğŸ™ˆ\n\n\nHeadless\n123&amp;nbsp; | &amp;nbsp; | &amp;nbsp;:-----:|:------:|:-:A      | B      | ğŸ™ˆ\n\n\n\n\n\n\n\n\n\nA\nB\nğŸ™ˆ\n\n\nLong table\n\n\nSun With Face\nGrinning Face\nSmiling Face\nGrinning Face With Big Eyes\nSmiling Face With Smiling Eyes\nFull Moon Face\nGrinning Face With Smiling Eyes\nFace With Monocle\nCowboy Hat Face\nThinking Face\nFace Vomiting\n\n\n\n\nğŸŒ\nğŸ˜€\nâ˜ºï¸\nğŸ˜ƒ\nğŸ˜Š\nğŸŒ\nğŸ˜„\nğŸ§\nğŸ¤ \nğŸ¤”\nğŸ¤®\n\n\nBlockquote\n(https://hexo.io/docs/tag-plugins#Block-Quote)\n\nEvery interaction is both precious and an opportunity to delight.\nSeth GodinWelcome to Island Marketing\n\n\nNEW: DevDocs now comes with syntax highlighting. http://devdocs.io\n@DevDocstwitter.com/devdocs/status/356095192085962752\n\nCode Block\n12345678910111213141516171819202122232425262728293031class Utils &#123;  animate(element: Element, attr: string, change: &#123; from: number, to: number, duration?: number &#125;, onEnd?: () =&gt; void) &#123;    if (change.from === change.to) return;    if (!change.duration)      element[attr] = change.to;    const easing = (t, b, c, d) =&gt; c * ((t = t / d - 1) * t * t + 1) + b,      &#123; from, to &#125; = change,      during = Math.ceil((change.duration || 300) / 17) || 1;    let start = 0,      instance = null;    step();    function step() &#123;      const value = Math.ceil(easing(start, from, to - from, during));      start++;      if (start &lt;= during) &#123;        element[attr] = value;        instance = requestAnimationFrame(step);      &#125;      else &#123;        if (onEnd) onEnd();        cancelAnimationFrame(instance);      &#125;    &#125;  &#125;&#125;\nWith caption\n(https://hexo.io/docs/tag-plugins#Code-Block)\n_.compactUnderscore.js1_.compact([0, 1, false, 2, '', 3]);=&gt; [1, 2, 3]\nGist\n(https://hexo.io/docs/tag-plugins#Gist)\nJSFiddle\n(https://hexo.io/docs/tag-plugins#jsFiddle)\nScript\n123456789stars: &lt;span id=\"stargazers_count\"&gt;&lt;/span&gt;&lt;script&gt;fetch('https://api.github.com/repos/ikeq/hexo-theme-inside')  .then(function(res) &#123; return res.json() &#125;)  .then(function(json) &#123;    document.getElementById('stargazers_count').innerHTML = json.stargazers_count;  &#125;);&lt;/script&gt;\nstars: 309\nFor the lastest ES grammar and code minification.\nRun the following command in the root directory of Hexo (not themes/inside):\n1npm install babel-core babel-preset-env html-minifier uglify-js --save\nCanvas\nSyntaxï¼š\n1234&#123;% canvas [width] [height] %&#125;ctx.fillStyle = 'red';ctx.fillRect(0, 0, w, h);&#123;% endcanvas %&#125;\nwidth is default to 300, height is default to 150ï¼Œalso the following constants are available in the scope:\n\n\nconstant\n\n\n\n\n\nctx\nCanvasRenderingContext2D\n\n\nw\nCanvas width\n\n\nh\nCanvas height\n\n\nFor example:\n(function(){var canvas = document.getElementById('canvas-0'), ctx = canvas.getContext('2d'), w = 100, h = 100; const r = w / 2;\nctx.fillStyle = 'antiquewhite';\nctx.arc(r, r, r, 0, Math.PI * 2);\nctx.fill();})();\nMathJax (SSR)\nWhen \na \\ne 0\n\n\n\n\n\n\n \n \n \n\n, there are two solutions to \nax^2 + bx + c = 0\n\n\n\n\n\n\n\n\n\n\n\n \n\n \n \n\n \n \n \n \n \n \n \n\n and they are\nMATHJAX-SSR-0\n\nA= \\begin{bmatrix}\n{a_{11}}&amp;{a_{12}}&amp;{\\cdots}&amp;{a_{1n}}\\\\\n{a_{21}}&amp;{a_{22}}&amp;{\\cdots}&amp;{a_{2n}}\\\\\n{\\vdots}&amp;{\\vdots}&amp;{\\ddots}&amp;{\\vdots}\\\\\n{a_{m1}}&amp;{a_{m2}}&amp;{\\cdots}&amp;{a_{mn}}\\\\\n\\end{bmatrix}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n \n \n\n\n \n\n \n\n \n\n\n\n\n \n\n \n \n\n\n\n \n\n \n \n\n\n \n\n \n\n \n \n\n\n\n\n\n \n\n \n \n\n\n\n \n\n \n \n\n\n \n\n \n\n \n \n\n\n\n\n \n \n \n \n\n\n\n \n\n \n \n\n\n\n \n\n \n \n\n\n \n\n \n\n \n \n\n\n\n\n\n \n\n \n\n \n\n\n\n\n","plink":"https://shuntan.github.io/posts/Tag Plugins/"},{"title":"ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD","date":"2019-05-06T15:03:34.000Z","date_formatted":{"ll":"May 6, 2019","L":"05/06/2019","MM-DD":"05-06"},"updated":"2020-04-22T11:18:21.947Z","content":"ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD\n\nè¡¥ä¸ç±»å‹ï¼šæ¸¸æˆMOD\næ•´ç†æ—¶é—´ï¼š2019-05-05\nå¤§å°ï¼š18.73MB\nè¡¥ä¸åˆ¶ä½œï¼šhiyokomod\nè¡¥ä¸è¯­è¨€ï¼šå¤šå›½\nç‰ˆæœ¬ï¼šv1.0\n\ndownload\nç”±Nç½‘ä½œè€…â€œhiyokomodâ€åˆ¶ä½œçš„ä¸€æ¬¾äººç‰©å¤–è§‚æ›¿æ¢ç¾åŒ–modâ€œäºŒæ¬¡å…ƒèŒå¦¹MODâ€ï¼Œ\nå°†æ¸¸æˆä¸­å°†æ¸¸æˆä¸­å¤šä½å¥³æ€§NPCå¤–è§‚ä¿®æ”¹ä¸ºäºŒæ¬¡å…ƒç¾å°‘å¥³ï¼Œéå¸¸ç²¾è‡´çš„é¢éƒ¨å»ºæ¨¡å’Œå¯ä¿®æ”¹é¡¹ï¼Œ\nå¸¦ç»™æ¯ä¸€ä¸ªè€å†°æ£ï¼å–œæ¬¢è¿™äº›èŒå¦¹å­å°±æ¥3DMä¸‹è½½ä½“éªŒå§ï¼\n\n\næˆªå›¾\n\n\n\n\n\n\n\n\n\n\næ³¨æ„äº‹é¡¹\néœ€è¦ä¸‹è½½â€œLooksMenuæè„¸èœå•==&gt;ç‚¹æˆ‘ä¸‹è½½â€ã€‚\nä½¿ç”¨è¯´æ˜\nNMMè‡ªåŠ¨å®‰è£…æ–¹æ³•ï¼š\nç‚¹æˆ‘ä¸‹è½½NMM\n1ã€æ·»åŠ å‹ç¼©åŒ…åˆ°NMM(åˆ—è¡¨ä¸­å‡ºç°)ï¼›\n\n2ã€åŒå‡»åˆ—è¡¨å®‰è£…ï¼›\n\n3ã€è¿›å…¥æ¸¸æˆå³å¯ã€‚\n\n**æ‰‹åŠ¨å®‰è£…æ–¹æ³•(ä¸æ¨è)ï¼š** \n\n1ã€è§£å‹ç¼©ï¼›\n\n2ã€å°†dataæ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ¸¸æˆæ ¹ç›®å½•ï¼›\n\n3ã€ç”¨MODç®¡ç†å™¨åŠ è½½ESPï¼›\n\n4ã€è¿›å…¥æ¸¸æˆä¸­å³å¯ã€‚\n\næ¼”ç¤ºè§†é¢‘\n\n\n\n\nåˆ†æµ\n\nç™¾åº¦ç½‘ç›˜(æå–ç ï¼šbr93)\n\næœ¬åœ°\n\nç”µä¿¡\nç½‘é€š\n\n\né«˜é€Ÿä¸‹è½½\nç”µä¿¡ä¸‹è½½\nè”é€šä¸‹è½½\n\n","thumbnail":"/posts/ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD/fallout.png","plink":"https://shuntan.github.io/posts/ã€Šè¾å°„4ã€‹äºŒæ¬¡å…ƒèŒå¦¹MOD/"},{"title":"ç»™hexoåšå®¢nextä¸»é¢˜æ·»åŠ èƒŒæ™¯éŸ³ä¹","date":"2019-05-06T13:11:05.000Z","date_formatted":{"ll":"May 6, 2019","L":"05/06/2019","MM-DD":"05-06"},"updated":"2019-07-14T01:22:20.630Z","content":"\nè¯·è®¿é—®æˆ‘çš„ä¸ªäººåšå®¢ sourcod\n\n\næˆ‘çš„hexoåšå®¢ä½¿ç”¨çš„æ˜¯nextä¸»é¢˜æ‰€æœ‰æ¬¡æ•™ç¨‹åœ¨nextä¸»é¢˜ä¸Šä¿®æ”¹ã€‚\n\nä¿®æ”¹ themes/next/layout/_macro/sidebar.swig æ–‡ä»¶\næ·»åŠ éŸ³ä¹æ’­æ”¾å™¨å†…å®¹\n\n\nåœ¨ themes/next/_config.yml é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ­Œå•åœ°å€é…ç½®\nbackground_music: //music.163.com/outchain/player?type=0&amp;amp;id=2120628564&amp;amp;auto=1&amp;amp;height=66\n\næ³¨å†Œç½‘æ˜“äº‘éŸ³ä¹\nè‡ªå·±ç ”ç©¶\nåˆ›å»ºæ­Œå•\nè‡ªå·±ç ”ç©¶\nç»™æ­Œå•æ·»åŠ è‡ªå·±å–œæ¬¢çš„éŸ³ä¹\nçœ‹ä½ è‡ªå·±äº†\nåˆ†äº«æ­Œå•\nä¸ä¼šè·å–å¤–é“¾çš„è¯·ä¸Šåº¦å¨˜: æ€ä¹ˆæŠŠè‡ªå·±çš„æ­Œå•åšæˆå¤–é“¾\nè·å–å¤–é“¾æ’­æ”¾å™¨\n\næŠŠåœ°å€copyå‡ºæ¥height=90æ”¹æˆ 66\n\n\nè¿™æ ·ä»¥ååªéœ€è¦ä¿®æ”¹ç½‘æ˜“äº‘éŸ³ä¹çš„æ­Œå•ï¼Œåšå®¢çš„èƒŒæ™¯éŸ³ä¹å°±ä¼šè‡ªåŠ¨ä¿®æ”¹äº†ã€‚\nå¦‚æœå‡ºç°éŸ³ä¹ä¸è‡ªåŠ¨æ’­æ”¾ï¼Œé‚£æ˜¯èµ„æºçš„é—®é¢˜ï¼Œè‡ªå·±ä¸Šç½‘æ˜“äº‘éŸ³ä¹ç”Ÿæˆå¤–é“¾çš„é¡µé¢çœ‹çœ‹ä¼šä¸ä¼šè‡ªåŠ¨æ’­æ”¾ã€‚æŠŠåèµ„æºåˆ é™¤å°±OKäº†ã€‚\n\n\nä¿®æ”¹å®Œæˆ‘çš„åšå®¢çš„æ•ˆæœ\n\n","plink":"https://shuntan.github.io/posts/ç»™hexoåšå®¢nextä¸»é¢˜æ·»åŠ èƒŒæ™¯éŸ³ä¹/"},{"title":"é—®é“","date":"2019-04-11T11:12:20.000Z","date_formatted":{"ll":"Apr 11, 2019","L":"04/11/2019","MM-DD":"04-11"},"updated":"2020-04-23T14:28:53.101Z","content":"æ¸¸æˆèƒŒæ™¯ä»‹ç»\né¸¿è’™å¼€åŒ–ä¹‹åˆï¼Œä¸­å·å¤§é™†æ˜†ä»‘ä¹‹é¢ çš„é¸¿é’§ä¸Šäººåˆ›ç«‹é“æ•™ï¼Œå¹¶æ”¶å¾’ä¸‰äººï¼Œå„æˆä»¥é“é—¨ç»æŠ€ï¼Œä¸‰å¾’çš†ä¿®æˆæ··å…ƒå¤§ç½—é‡‘ä»™ä¸‡åŠ«ä¸åä¹‹ä½“ï¼Œåˆ†åˆ«å‘å±•å‡ºé“æ•™çš„äººé“ã€é˜æ•™å’Œæˆªæ•™ä¸‰ä¸ªåˆ†æ”¯ã€‚æ­¤ä¸‰å¾’æ­£æ˜¯äººé“æ•™ä¸»å¤ªä¸Šè€å›ã€é˜æ•™æ•™ä¸»å…ƒå§‹å¤©å°Šå’Œæˆªæ•™çš„é€šå¤©æ•™ä¸»ã€‚\n\nä¸‰æ•™ä¸»ç§‰æ‰¿å¸ˆçˆ¶é¸¿é’§ä¸Šäººæ•™è¯²ï¼Œå¹¿æ”¶é—¨å¾’å°†é“æ•™æµä¼ äºä¸–ã€‚åªå› å…¥é“é—¨ä¸­å³å¯ä¿®ä»™ï¼Œä½¿äººè·³å‡ºä¸‰ç•Œä¹‹å¤–ï¼Œä¸åœ¨äº”è¡Œä¹‹ä¸­ï¼Œå…é™¤ç”Ÿæ­»è½®å›ä¹‹è‹¦ï¼Œä½¿å¾—å…¥é“ä¿®è¡Œä¹‹äººå¤šä¸èƒœæ•°ã€‚ä½†ä¿®ä»™ä¹‹é“å¹¶éè‹¦å¿ƒä¿®ç‚¼ä¾¿å¯è¾¾æˆï¼Œä¿®è¡Œè·¯ä¸Šï¼Œå‡è¦ç»å†ä¸‰ç™¾å¹´ä¸€å°åŠ«ï¼Œä¸€åƒäº”ç™¾å¹´ä¸€å¤§åŠ«çš„åŠ«æ•°ã€‚ä¿®è¡Œä¹‹äººå‡æ— æ³•é¿å¼€åŠ«æ•°ï¼Œåªèƒ½æ ¹æ®è‡ªèº«é“è¡Œçš„æ·±æµ…å»ç»å†åŠ«æ•°ã€‚å€¼å•†å‘¨ä¸¤æœäº¤æ›¿ä¹‹æ—¶ï¼Œæ°é€¢ä¿®ä»™ä¸€åƒäº”ç™¾å¹´ä»™åŠ«ï¼Œäºæ˜¯ä¸‰æ•™ä¸»å…±è®®å°ç¥æ¦œï¼Œä»¥è§‚ä¼—ä»™æ ¹è¡Œæµ…æ·±ã€‚ç„¶åŠ«æ•°éš¾é€ƒï¼Œå°ç¥ä¸€å½¹ï¼Œè‡´ä½¿é“é—¨å†…éƒ¨é˜æ•™å’Œæˆªæ•™ä¸å’Œï¼Œä¿®ä»™ä¼—äººä¿±é­å± æˆ®ï¼Œæ›´å¼•æ¥è¥¿æ–¹æ•™æ´¾å‚ä¸çº·äº‰ï¼Œåå› é¸¿é’§ä¸Šäººäº²è‡ªå‡ºé¢è°ƒåœï¼Œç»ˆå¾—ä»¥å¹³æ¯ã€‚é€šå¤©æ•™ä¸»è¢«é¸¿é’§ä¸Šäººç¦åˆ¶åœ¨ç´«éœ„å®«æ˜†ä»‘ä¹‹é¢ ä¿®è¡Œæ€è¿‡ã€‚\næ—¶å…‰å¦‚æ¢­ï¼Œè½¬çœ¼å·²è¿‡åƒå¹´ï¼Œå¸ˆå°Šé¸¿é’§ä¸Šäººå¤–å‡ºäº‘æ¸¸ï¼Œä¸çŸ¥æ‰€è¸ªã€‚è€Œé€šå¤©ä»¿ä½›å·²ç»ä¹ æƒ¯äº†è¿™ç§è¢«ç¦å›ºçš„ç”Ÿæ´»ï¼Œé™¤äº†æ¯æ—¥çš„å¿…åšçš„ä¿®çœŸç‚¼æ°”å’Œé™è¯µã€Šé»„åº­ã€‹ï¼Œä»–æ›´å¤šçš„æ—¶é—´æ€»æ˜¯åœ¨æ–­å´–è¾¹é™é™åç€ã€‚ä¹Ÿè®¸åªæœ‰è¿™ä¸ªæ—¶åˆ»ï¼Œä»–æ‰èƒ½çœŸçœŸå®å®åœ°æ„Ÿè§‰åˆ°è‡ªå·±çš„å­˜åœ¨ï¼Œåƒå¹´çš„è‹¦è¡Œä½¿ä»–çš„ä¿®ä¸ºå€å¢ï¼ŒåŒæ—¶ä¹Ÿè®©ä»–é¥±å—äº†å­¤å•å’Œå¯‚å¯ï¼Œä»–å·²ç»å¾ˆä¹…æ²¡æœ‰è¯´è¿‡ä¸€å¥è¯äº†ï¼Œå¾ˆä¹…æ˜¯å¤šä¹…ï¼Œä»–è‡ªå·±ä¹Ÿä¸çŸ¥é“ï¼Œä»–åªçŸ¥é“ä»–åœ¨ç­‰ï¼Œä»–ä»¬éƒ½åœ¨ç­‰ã€‚.\nç©ºæ—·çš„æ–­å´–è¾¹ï¼Œä¸€ä¸ªäººå½±ä¼«ç«‹ï¼Œè‰¯ä¹…ï¼Œä¸€åŠ¨ä¸åŠ¨ã€‚å±±é£åŠ²è¢­ï¼ŒäººçŠ¹å¦‚ä¸å±±æµ‘ç„¶ä¸€ä½“ï¼Œä»æ˜¯ä¸€åŠ¨ä¸åŠ¨ï¼Œåšæ¯…çš„é¢å®¹æ¯«æ— è¡¨æƒ…ï¼Œåªæœ‰æ˜äº®çš„åŒçœ¸åœ¨é»‘å¤œå°è¡¬ä¸‹å¯’å…‰é—ªç°ï¼Œçœºæœ›ç€è¿œæ–¹ã€‚è¿œå¤„ï¼Œéª·é«…å±±é¡¶ï¼Œä¸€å—é¡½çŸ³å¥½è±¡åŠ¨äº†ä¸€åŠ¨ï¼ŒåˆåŠ¨äº†ä¸€åŠ¨ï¼Œä»¿ä½›æœ‰äº†å‘¼å¸ã€‚æ…¢æ…¢åœ°ï¼Œé¡½çŸ³å‘¨å›´ç«Ÿç„¶å¿½éšå¿½ç°å‡ºç€ç„é»„è‰²çš„å…‰èŠ’ï¼Œæœ€ç»ˆå¹»åŒ–ä¸ºä¸€ä¸ªäººå½¢çš„å…‰å›¢ï¼Œç¼“ç¼“é£˜å‘å±±åçš„å¹½å†¥æ¶§ã€‚æ­¤æ—¶ï¼Œäººå½±çš„è‹ç™½é¢å®¹ä¸Šæµ®ç°å‡ºå¥‡æ€ªçš„ç¬‘æ„ï¼Œä»¤äººä¸å¯’è€Œæ —ï¼Œä»–æ˜¯é€šå¤©ã€‚\näº”ç™¾å¹´åçš„ä¸­æ´²å¤§é™†ã€‚\nåœ¨ä¸œæµ·æ¸”æ‘ï¼Œä¸–ä¸–ä»£ä»£ä»¥æ•é±¼ä¸ºç”Ÿçš„æ¸”æ°‘æœ‰ä¸€å¤©çªç„¶å‘ç°ç¦»ä»–ä»¬æ‘å­ä¸è¿œçš„æµ·é¢ä¸Šï¼Œç«Ÿç„¶å‡ºç°ä¸€ä¸ªå¼‚å¸¸ç¾ä¸½çš„ä»™å²›ã€‚\nåœ¨å¤©å¢‰åŸï¼Œç†™ç†™æ”˜æ”˜åœ°è¡—é“ä¸Šçªç„¶å¤šäº†ä¸€äº›èº«ç€å¥‡è£…å¥‡æœï¼Œè¡Œä¸ºä¸¾æ­¢ååˆ†å¯ç–‘ä¹‹äººã€‚\nåœ¨æ½ä»™é•‡ï¼Œä¸€ä¸ªå¹³å‡¡å†·æ¸…çš„å°é•‡ä¸Šçªç„¶é—´çƒ­é—¹äº†èµ·æ¥ï¼Œä»å››é¢å…«æ–¹èµ¶æ¥çš„ä¿Šç”·ç¾å¥³ç»œç»ä¸ç»ã€‚\næœ¬æ¥å¹³é™çš„ã€Šé—®é“ã€‹ä¸–ç•Œä¸­å‡ºç°å„ç§å¼‚è±¡å’Œå¾å…†ï¼Œè€Œæ­¤æ—¶ï¼Œå‡†å¤‡ä¸€æ¢ç©¶ç«Ÿçš„ç©å®¶ï¼Œæ­£èµ¶å¾€æ½ä»™é•‡çš„é€”ä¸­ã€‚ [1]\næˆªå›¾\n\næˆªå›¾å†…å®¹å’Œå®é™…æ— å…³\nä¸‹è½½\nå®¢æˆ·ç«¯ä¸‹è½½ç™»å½•å™¨ä¸‹è½½\n            ç›®å‰åªæä¾›1.60.0905ç‰ˆæœ¬å®¢æˆ·ç«¯ç™¾åº¦äº‘ä¸‹è½½é“¾æ¥ğŸ”—\n          \nç™¾åº¦äº‘ å¯†ç (kq7m)\n            ä¸ç‰ˆæœ¬å¯¹åº”çš„ç™»å½•å™¨ï¼ŒæœåŠ¡å™¨ä¸ºå…¬ç›Šæœï¼Œä¸åšä»»ä½•ç›ˆåˆ©å’Œä¸å…·å¤‡å•†ä¸šæ€§è´¨ï¼\n          \né“¾æ¥ï¼šhttps://pan.baidu.com/s/1dllSI4gk4dEjf_84bf0AZQ\næå–ç ï¼šbebc\nå¤åˆ¶è¿™æ®µå†…å®¹åæ‰“å¼€ç™¾åº¦ç½‘ç›˜æ‰‹æœºAppï¼Œæ“ä½œæ›´æ–¹ä¾¿å“¦\n\næ›´å¤šèµ„è®¯: Deployment\n","thumbnail":"/posts/é—®é“/90945-1527190494-850029340.jpeg","plink":"https://shuntan.github.io/posts/é—®é“/"},{"title":"Hello World","date":"2018-10-24T14:19:55.904Z","date_formatted":{"ll":"Oct 24, 2018","L":"10/24/2018","MM-DD":"10-24"},"updated":"2019-07-14T01:20:24.132Z","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\n\nQuick Start\nCreate a new post\n1$ hexo new \"My New Post\"\nMore info: Writing\nRun server\n1$ hexo server\nMore info: Server\nGenerate static files\n1$ hexo generate\nMore info: Generating\nDeploy to remote sites\n1$ hexo deploy\næ›´å¤šèµ„è®¯: Deployment\n","thumbnail":"https://uploadbeta.com/api/pictures/random/","plink":"https://shuntan.github.io/posts/hello-world/"},{"title":"about","date":"2019-05-08T02:08:40.000Z","date_formatted":{"ll":"May 8, 2019","L":"05/08/2019","MM-DD":"05-08"},"updated":"2020-04-22T14:54:43.582Z","content":"ä¸ªäººä»‹ç»\n\nä¸å¿˜åˆå¿ƒï¼Œçº¦å®šæœªæ¥ã€‚\nè¡Œç™¾é‡Œè€…åŠä¹åã€‚\n\nä¸€ä¸ªå¹³å‡¡çš„c++ï½œgolangå¼€å‘è€…ï¼Œåœ¨è‡ªå·±å–œæ¬¢çš„è¡Œä¸šä¸Šä¸€ç›´åŠªåŠ›ï¼Œå¸Œæœ›ä¼šé‡åˆ°æ›´å¤šå¿—åŒé“åˆçš„æœ‹å‹ã€‚\n\n            æŠ€æœ¯äº¤æµæ¬¢è¿æ‚¨æ‰«æä¸‹é¢çš„äºŒç»´ç åŠ å…¥c++&amp;golangæŠ€æœ¯äº¤æµç¾¤ï¼ŒæœŸå¾…é‡è§æ›´å¤šå¿—åŒé“åˆçš„æœ‹å‹ï¼QQäº¤æµç¾¤ï¼š681732945\n          \n2020å¹´è®¡åˆ’\n\nç²¾é€šgolang\né˜…è¯»10æœ¬ä¹¦ï¼ˆå¤§ä½¬å†™çš„é‚£ç§ï¼‰\nç ”ç©¶2ä¸ªä»¥ä¸Šraftå¼€æºçš„åˆ†å¸ƒå¼æ¶æ„\nçœ‹5éƒ¨ç¾å‰§ğŸ˜„\né€šå…³å·«å¸ˆ3å‘¨ç›®2âƒ£ï¸ &amp; ç²¾é€šæ˜†ç‰¹ç‰Œ\n\n","plink":"https://shuntan.github.io/about/"},{"title":"Mac å®ç”¨å·¥å…· ï½œ è®©å·¥ä½œæ›´é«˜æ•ˆ","date":"2020-02-08T01:45:17.000Z","date_formatted":{"ll":"Feb 8, 2020","L":"02/08/2020","MM-DD":"02-08"},"updated":"2020-04-22T14:29:58.671Z","content":"\nğŸ“–è¡¨ç¤ºå¼€æºè½¯ä»¶ï¼Œç‚¹å‡»è¿›å…¥å¼€æºä»“åº“ï¼›\nğŸ†“è¡¨ç¤ºæ‰€æœ‰æˆ–éƒ¨åˆ†ä¸»è¦åŠŸèƒ½æ”¯æŒå…è´¹ä½¿ç”¨ï¼›\nğŸ”¨è¡¨ç¤ºæ”¯æŒç ´è§£ï¼Œç‚¹å‡»æŸ¥çœ‹ç ´è§£æ–¹æ³•ï¼›\nğŸ”—è¡¨ç¤ºå·¥å…·ç›¸å…³çš„æ’ä»¶ï¼Œç‚¹å‡»æŸ¥çœ‹æ’ä»¶åˆ—è¡¨ã€‚\n\næœ¬æ–‡ä¸­åˆ—ä¸¾çš„ï¼Œä»…é™æœ¬äººç”¨è¿‡ä¸”ä½“éªŒè¾ƒå¥½çš„å·¥å…·ï¼Œåœ¨ç²¾ä¸åœ¨å¤šã€‚ä¸å®šæ—¶æ›´æ–°ï¼Œå¦‚æœ‰æ¨èæ¬¢è¿è¡¥å……ã€‚\n\nå¼€å‘ç›¸å…³\nIDE\n\nSublime Text - ä¸€ä¸ªæ¯”è¾ƒç®€æ´å¤§æ–¹å¸¦æ’ä»¶ç®¡ç†ç³»ç»Ÿçš„æµè¡Œç¼–è¾‘å™¨ã€‚ï¼ˆç¨‹åºå‘˜å¿…å¤‡ï¼‰ğŸ†“ğŸ”—\nXcode - å¼€å‘ iOS å’Œ MacOS å·¥ç¨‹çš„å®˜æ–¹ IDEã€‚ï¼ˆiOS å’Œ Mac å¼€å‘å¿…å¤‡ï¼‰ğŸ†“\nAppCode - iOS å¼€å‘å·¥å…·ï¼Œæ”¯æŒ macOS å’Œ iOS å¹³å°ä¸Šæœ€æµè¡Œçš„ç¼–ç¨‹è¯­è¨€ï¼ˆSwiftã€Objective-Cã€C å’Œ C ++ï¼‰ğŸ”¨ğŸ”—\nAndroid Studio - è°·æ­Œæ¨å‡ºçš„ Android é›†æˆå¼€å‘å·¥å…·ï¼ŒåŸºäº Intellij IDEAã€‚ï¼ˆAndroid å¼€å‘å¿…å¤‡ï¼‰ğŸ“–ğŸ†“ğŸ”—\nVisual Studio Code - å¾®è½¯æ¨å‡ºï¼Œå…è´¹å¼€æºçš„è½»é‡çº§ä»£ç ç¼–è¾‘å™¨ã€‚ï¼ˆå‰ç«¯å¼€å‘å¿…å¤‡ï¼‰ğŸ“–ğŸ†“ğŸ”—\nå¾®ä¿¡å¼€å‘è€…å·¥å…· - æ”¯æŒå¾®ä¿¡å…¬ä¼—å·ç½‘é¡µè°ƒè¯•å’Œå°ç¨‹åºè°ƒè¯•çš„å¼€å‘å·¥å…·ã€‚ï¼ˆå‰ç«¯å¼€å‘å¿…å¤‡ï¼‰ğŸ†“\nIntelliJ IDEA - Java ç¼–ç¨‹è¯­è¨€å¼€å‘çš„é›†æˆç¯å¢ƒã€‚åœ¨ä¸šç•Œè¢«å…¬è®¤ä¸ºæœ€å¥½çš„ Java å¼€å‘å·¥å…·ä¹‹ä¸€ã€‚ï¼ˆåç«¯å¼€å‘å¿…å¤‡ï¼‰ğŸ”¨ğŸ”—\nEclipse - å¼€æºã€åŸºäº Java çš„å¯æ‰©å±•å¼€å‘å¹³å°ã€‚ğŸ“–ğŸ†“ğŸ”—\n\nç»ˆç«¯\n\niTerm2 - å…è´¹çš„ç»ˆç«¯å·¥å…·ï¼Œå¯æ›¿ä»£ç³»ç»Ÿè‡ªå¸¦çš„ Terminalã€‚ğŸ“–ğŸ†“\nZsh - ä¸ºäº¤äº’ä½¿ç”¨è€Œè®¾è®¡çš„ä¸€æ¬¾ shellï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå¼ºå¤§çš„è„šæœ¬è¯­è¨€ã€‚ ğŸ“–ğŸ†“ğŸ”—\n\nAPI å¼€å‘ä¸åˆ†æ\n\nPostman - API è°ƒè¯•å·¥å…·ã€‚ğŸ†“\n\næµ‹è¯•è‡ªåŠ¨åŒ–\n\nAppium - é€‚ç”¨äºåŸç”Ÿã€hybridã€H5 ä»¥åŠæ¡Œé¢åº”ç”¨ç¨‹åºçš„å¼€æºã€è·¨å¹³å°çš„æµ‹è¯•è‡ªåŠ¨åŒ–å·¥å…·ã€‚ğŸ“–ğŸ†“\n\nSSH\n\nFinalShell - è‰¯å¿ƒå›½è´§ï¼Œå¥½ç”¨çš„ä¸­æ–‡ SSH å·¥å…·ã€‚ğŸ†“\n\nç‰ˆæœ¬æ§åˆ¶\n\nSourceTree - å¼ºå¤§çš„ Git è·¨å¹³å°å®¢æˆ·ç«¯ã€‚ğŸ†“\nGitHub Desktop - GitHub å®˜æ–¹æ¡Œé¢å®¢æˆ·ç«¯ã€‚ğŸ†“\nCornerstone - SVN å®¢æˆ·ç«¯å·¥å…·ï¼Œè¿˜èƒ½ä¸ Xcodeã€BBEditã€TextMateã€Coda ç­‰å¼€å‘å·¥å…·æ— ç¼é›†æˆä½¿ç”¨ã€‚ğŸ”¨\n\nç½‘ç»œåˆ†æ\n\nCharles - ä»£ç†å·¥å…·ï¼Œå…è®¸ä½ æŸ¥çœ‹æ‰€æœ‰çš„ HTTP å’Œ HTTPS æµé‡ã€‚ğŸ”¨\nWireshark - ä¸–ç•Œä¸Šæœ€å¹¿æ³›ä½¿ç”¨çš„ç½‘ç»œåè®®åˆ†æè½¯ä»¶ï¼Œä¸»è¦ä½œç”¨æ˜¯å°è¯•æ•è·ç½‘ç»œåŒ…ï¼Œå¹¶å°è¯•æ˜¾ç¤ºåŒ…çš„å°½å¯èƒ½è¯¦ç»†çš„æƒ…å†µã€‚ğŸ“–ğŸ†“\n\nHelper\n\nDash - API æ–‡æ¡£æµè§ˆå™¨ä»¥åŠä»£ç ç‰‡æ®µç®¡ç†å·¥å…·ã€‚ğŸ”¨\nPPRows - åœ¨ Mac ä¸Šè®¡ç®—ä½ å†™äº†å¤šå°‘è¡Œä»£ç ã€‚ğŸ“–ğŸ†“\nSwitchHosts - ç®¡ç†ã€åˆ‡æ¢å¤šä¸ª hosts æ–¹æ¡ˆçš„å·¥å…·ã€‚ğŸ“–ğŸ†“\n\nè®¾è®¡&amp;äº§å“\nè®¾è®¡\n\nSketch - æ··åˆçŸ¢é‡/ä½å›¾å¸ƒå±€åº”ç”¨ï¼Œç‰¹åˆ«é€‚ç”¨äºç”¨æˆ·ç•Œé¢ï¼ŒWeb å’Œç§»åŠ¨è®¾è®¡ã€‚ğŸ”—\n\nåŸå‹æµç¨‹\n\nProcessOn - å›½äº§åœ¨çº¿ä½œå›¾å¹³å°ï¼Œæ”¯æŒæµç¨‹å›¾ã€æ€ç»´å¯¼å›¾ã€åŸå‹å›¾ã€UMLã€ç½‘ç»œæ‹“æ‰‘å›¾ã€ç»„ç»‡ç»“æ„å›¾ç­‰ï¼Œå¯ä»¥å…è´¹ä¿å­˜ 5 ä¸ªæ–‡ä»¶ã€‚ğŸ†“\ndraw.io - æµç¨‹å›¾åœ¨çº¿ç»˜åˆ¶å·¥å…·ï¼Œä¹Ÿæ”¯æŒå®¢æˆ·ç«¯ç¦»çº¿ä½¿ç”¨ï¼Œæ²¡æœ‰ä¿å­˜æ–‡ä»¶çš„æ•°é‡é™åˆ¶ã€‚ğŸ“–ğŸ†“\nStarUML - è¶…å¥½ç”¨çš„ UML ç”»å›¾å·¥å…·ã€‚ğŸ“–ğŸ†“ğŸ”¨\nXMind - ä¸“ä¸šæ€ç»´å¯¼å›¾è½¯ä»¶ã€‚ğŸ†“\nMindNode - ç®€æ´å¯çˆ±é£æ ¼çš„æ€ç»´è„‘å›¾ç»˜åˆ¶è½¯ä»¶ã€‚\n\nå›¾ç‰‡å¤„ç†\n\ngifsicle - ç”¨äºæ“ä½œ GIF å›¾ç‰‡çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥ä¿®æ”¹ gif æ–‡ä»¶çš„å°ºå¯¸å¤§å°ã€é¢œè‰²ã€å¸§ç‡ç­‰ã€‚ ğŸ†“\nImageOptim - å›¾ç‰‡ä¼˜åŒ–æ— æŸå‹ç¼©å·¥å…·ã€‚ğŸ“–ğŸ†“\næ™ºå›¾ - è…¾è®¯ ISUX å‰ç«¯å›¢é˜Ÿå¼€å‘çš„ä¸€ä¸ªä¸“é—¨ç”¨äºå›¾ç‰‡å‹ç¼©å’Œå›¾ç‰‡æ ¼å¼è½¬æ¢çš„å¹³å°ï¼Œå…¶åŠŸèƒ½åŒ…æ‹¬é’ˆå¯¹ pngã€jpegã€gif ç­‰å„ç±»æ ¼å¼å›¾ç‰‡çš„å‹ç¼©ï¼Œä»¥åŠä¸ºä¸Šä¼ å›¾ç‰‡è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„å›¾ç‰‡æ ¼å¼ã€‚ğŸ†“\n\nå†™ä½œ\nMarkDown\n\nCmd Markdown - åœ¨çº¿ MarkDown ç¼–è¾‘é˜…è¯»å™¨ï¼Œæ”¯æŒå®æ—¶åŒæ­¥é¢„è§ˆã€‚ğŸ†“\nTypora - â€œè¯»å†™ä¸€ä½“â€ ç®€çº¦ Markdown ç¼–è¾‘å™¨ã€‚ğŸ†“\nMacDown - å¼€æºçš„ Markdown ç¼–è¾‘å™¨ï¼Œå‚ç…§ Mouã€‚ğŸ“–ğŸ†“\nMWeb - ä¸“ä¸šçš„ Markdown å†™ä½œã€è®°ç¬”è®°ã€é™æ€åšå®¢ç”Ÿæˆè½¯ä»¶ã€‚ğŸ”¨\n\næˆªå›¾&amp;å½•å±\n\niShot - å…è´¹ã€åŠŸèƒ½å…¨é¢çš„å½•å±ã€åŒºåŸŸæˆªå›¾ã€çª—å£æˆªå›¾ã€é•¿æˆªå›¾ã€å»¶æ—¶æˆªå›¾ã€å¿«é€Ÿæ ‡æ³¨ã€è´´å›¾å·¥å…·ã€‚ğŸ†“\nGifox - ä¸“ä¸šçš„ GIF åŠ¨å›¾åˆ¶ä½œå·¥å…·ï¼Œæ”¯æŒæˆªé€‰åŒºåŸŸå½•å±å¯¼å‡º GIF åŠ¨å›¾å¹¶è¿›è¡Œå‹ç¼©å¤„ç†ï¼Œæ”¯æŒé¢„è§ˆå’Œç¼–è¾‘å¸§æ–‡ä»¶ã€‚\n\nå›¾åºŠ\n\nuPic - æ”¯æŒå…è´¹ä¸Šä¼ åˆ°å¤šç§å›¾åºŠï¼ˆSM.MSã€ åˆæ‹äº‘ USSã€ä¸ƒç‰›äº‘ KODOã€ é˜¿é‡Œäº‘ OSSã€ è…¾è®¯äº‘ COSã€å¾®åšã€Githubã€ Giteeã€ Amazon S3ã€è‡ªå®šä¹‰ä¸Šä¼ æ¥å£ï¼‰ï¼Œå¼€æºçš„å›¾åºŠå®¢æˆ·ç«¯ã€‚ğŸ“–ğŸ†“\niPic - ä¸Šä¼ åˆ°æŒ‡å®šçš„æ–°æµªå›¾åºŠå…è´¹ï¼Œå…¶å®ƒçš„éœ€è¦ä»˜è´¹å‡çº§é«˜çº§ç‰ˆï¼Œç”¨æˆ·ä½“éªŒç›¸å¯¹è¾ƒä¼˜ï¼Œå¯ä»¥é…åˆ Typora ç›´æ¥é£Ÿç”¨ã€‚ğŸ†“\nPicGo - å…¨å¹³å°å¼€æºçš„å›¾åºŠå·¥å…·ï¼Œæ”¯æŒå…è´¹ä¸Šä¼ åˆ°å¤šç§å›¾åºŠï¼ˆSM.MSã€ åˆæ‹äº‘ USSã€ä¸ƒç‰›äº‘ KODOã€ é˜¿é‡Œäº‘ OSSã€ è…¾è®¯äº‘ COSã€å¾®åšã€Githubã€Imgurï¼‰ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ PicGo-Core æ­å»ºä¸ªäººå›¾åºŠå·¥å…·ï¼Œä¾‹å¦‚ Visual Studio Code çš„ vs-picgo æ’ä»¶ã€‚ğŸ“–ğŸ†“ğŸ”—\n\nOffice\n\nWPS - è·¨å¹³å°çš„åŠå…¬å®¤è½¯ä»¶å¥—ä»¶ã€‚ğŸ†“\n\nç¬”è®°\n\nEvernote - æ”¯æŒæ•°æ®åŒæ­¥çš„çš„ç¬”è®°æœ¬åº”ç”¨ç¨‹åºï¼Œæ”¯æŒ MarkDownã€‚ğŸ†“\n\nRSS\n\nReeder 4 - è€ç‰Œçš„ RSS é˜…è¯»å™¨ï¼Œå› å…¶æµç•…çš„æ“ä½œå’Œç²¾è‡´çš„è®¾è®¡è€Œé—»åã€‚ğŸ”¨\nirreader - é«˜å“è´¨ã€å…è´¹ã€æ— å¹¿å‘Šã€å¤šå¹³å°çš„ RSS å’Œæ’­å®¢é˜…è¯»å™¨ï¼Œæä¾›äº†è®¢é˜…æºå¸‚åœºï¼Œå¯ä»¥è®¢é˜…ä»»ä½•ç½‘ç«™ã€‚ğŸ†“ğŸ“–\n\nç§‘å­¦ä¸Šç½‘\n\nLantern - ç®€å•æ˜“ç”¨çš„è€ç‰Œç§‘å­¦ä¸Šç½‘è½¯ä»¶ï¼Œæ¯æœˆ 500M é«˜é€Ÿå…è´¹æµé‡ã€‚ğŸ†“\nJust My Socks - æ¬ç“¦å·¥æ¨å‡ºçš„ SS æœåŠ¡,æ€§ä»·æ¯”é«˜ä¸”ç¨³å®š,ç”¨çš„æ˜¯ä¸æ¬ç“¦å·¥åŒæ¬¾çš„ CN2 GIA å’Œ CN2 GT çº¿è·¯ï¼Œæœ€ä½ä»· $2.88/æœˆã€‚\nShadowsocksX-NG - Shadowsocks å®¢æˆ·ç«¯è½¯ä»¶ ğŸ†“\nV2rayU - v2ray çš„å®¢æˆ·ç«¯è½¯ä»¶ï¼Œæ”¯æŒ vmessï½œshadowsocksï½œsocks5 ç­‰æœåŠ¡åè®®ï¼Œæ”¯æŒäºŒç»´ç ã€å‰ªè´´æ¿å¯¼å…¥ã€æ‰‹åŠ¨é…ç½®ã€äºŒç»´ç åˆ†äº«ã€è®¢é˜…ç­‰ã€‚ï¼ˆæ­å»º v2ray æœåŠ¡ï¼Œå¯ä¼ªè£…æˆæ­£å¸¸ç½‘ç«™ï¼Œé˜²å°é”ã€‚ï¼‰ğŸ†“\n\nç³»ç»Ÿç›¸å…³\n\nCleanMyMac X - ç»å…¸å¥½ç”¨çš„ Mac æ¸…ç†å·¥å…·ï¼Œéœ€è¦ä»˜è´¹ä½¿ç”¨ã€‚\næŸ æª¬æ¸…ç† - è…¾è®¯å‡ºå“çš„å…è´¹çš„ Mac ç³»ç»Ÿæ¸…ç†è½¯ä»¶ã€‚ğŸ†“\n\næµè§ˆå™¨\n\nGoogle Chrome - è°·æ­Œæµè§ˆå™¨ï¼Œå®ƒçš„æ‹“å±•æ’ä»¶åŠŸèƒ½éå¸¸å‡ºè‰²ï¼Œæ˜¯æå‡å·¥ä½œæ•ˆç‡åˆ©å™¨ã€‚ğŸ†“ğŸ”—\nChromium - å¼€æºå…è´¹ï¼Œç›¸å½“äº Google Chrome çš„å®éªŒç‰ˆï¼Œåœ¨ Chromium ä¸Šçº¿ç¨³å®šåçš„åŠŸèƒ½ï¼Œä¼šåœ¨ Google Chrome ä¸­æ­£å¼æ¨å‡ºã€‚ğŸ“–ğŸ†“\n\nåŠå…¬\n\nThe Unarchiver ï¼ è§£å‹ä¸åŒç±»å‹çš„å­˜æ¡£æ–‡ä»¶ã€‚ğŸ“–ğŸ†“\nTeamViewer - è¿œç¨‹ååŠ©åŠåœ¨çº¿åä½œå’Œä¼šè®®åŠŸèƒ½çš„è½¯ä»¶ï¼Œå•†ä¸šè½¯ä»¶ä¸ªäººä½¿ç”¨å…è´¹ã€‚ğŸ†“\n\nç²¾é€‰ç½‘ç«™\n\nMacWk - ç²¾å“ Mac åº”ç”¨é›†åˆï¼Œæ”¯æŒéƒ¨åˆ†ç ´è§£ç‰ˆã€‚\nåœ¨çº¿å·¥å…· VIP - éå¸¸å…¨çš„å°å·¥å…·åŠŸèƒ½é›†åˆã€‚\nPixabay - å…è´¹æ­£ç‰ˆé«˜æ¸…å›¾ç‰‡ç´ æåº“ã€‚\nunDraw - å…è´¹çš„äººç‰©ä¸»é¢˜æ’ç”»ç´ æç½‘ç«™ï¼Œæ”¯æŒè‡ªå®šä¹‰è‰²ç³»ã€‚\n\n\nå½’çº³äº†ä¸€ä¸‹ä¸Šæ–‡ä¸­æ”¯æŒç ´è§£çš„å·¥å…·ï¼š\n\nâš ï¸âš ï¸âš ï¸ è¯·æ”¯æŒæ­£ç‰ˆï¼Œä»…ä¾›æŠ€æœ¯äº¤æµã€‚\n\n\nJetbrains Mac ç‰ˆå…¨ç³»åˆ— IDE æ°¸ä¹…ç ´è§£æ•™ç¨‹\nCornerstone ç ´è§£\nCharles Mac ç‰ˆç ´è§£\nDash ç ´è§£\nStarUML Mac ç‰ˆç ´è§£\nMWeb ç ´è§£å®‰è£…\nReeder 4 Mac ç‰ˆç ´è§£\n\n","plink":"https://shuntan.github.io/resources/"},{"title":"NNPJ-339","date":"2020-02-08T01:45:17.000Z","date_formatted":{"ll":"Feb 8, 2020","L":"02/08/2020","MM-DD":"02-08"},"updated":"2020-04-23T14:26:58.306Z","content":"æ‚¨å¥½, è¿™é‡Œéœ€è¦å¯†ç .\n","plink":"https://shuntan.github.io/resources/NNPJ-339/"}]